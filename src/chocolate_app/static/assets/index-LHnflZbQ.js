function gy(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(n,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();var wb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function dp(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var vy={exports:{}},Yc={},yy={exports:{}},ze={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ml=Symbol.for("react.element"),bb=Symbol.for("react.portal"),Lb=Symbol.for("react.fragment"),Ab=Symbol.for("react.strict_mode"),_b=Symbol.for("react.profiler"),Cb=Symbol.for("react.provider"),Rb=Symbol.for("react.context"),Ib=Symbol.for("react.forward_ref"),kb=Symbol.for("react.suspense"),Db=Symbol.for("react.memo"),Pb=Symbol.for("react.lazy"),tg=Symbol.iterator;function Ob(t){return t===null||typeof t!="object"?null:(t=tg&&t[tg]||t["@@iterator"],typeof t=="function"?t:null)}var xy={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Sy=Object.assign,Ey={};function Pa(t,e,r){this.props=t,this.context=e,this.refs=Ey,this.updater=r||xy}Pa.prototype.isReactComponent={};Pa.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Pa.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Ty(){}Ty.prototype=Pa.prototype;function fp(t,e,r){this.props=t,this.context=e,this.refs=Ey,this.updater=r||xy}var hp=fp.prototype=new Ty;hp.constructor=fp;Sy(hp,Pa.prototype);hp.isPureReactComponent=!0;var rg=Array.isArray,wy=Object.prototype.hasOwnProperty,pp={current:null},by={key:!0,ref:!0,__self:!0,__source:!0};function Ly(t,e,r){var n,i={},s=null,a=null;if(e!=null)for(n in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)wy.call(e,n)&&!by.hasOwnProperty(n)&&(i[n]=e[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(n in o=t.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:ml,type:t,key:s,ref:a,props:i,_owner:pp.current}}function Mb(t,e){return{$$typeof:ml,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function mp(t){return typeof t=="object"&&t!==null&&t.$$typeof===ml}function Nb(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var ng=/\/+/g;function _d(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Nb(""+t.key):e.toString(36)}function fu(t,e,r,n,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case ml:case bb:a=!0}}if(a)return a=t,i=i(a),t=n===""?"."+_d(a,0):n,rg(i)?(r="",t!=null&&(r=t.replace(ng,"$&/")+"/"),fu(i,e,r,"",function(u){return u})):i!=null&&(mp(i)&&(i=Mb(i,r+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(ng,"$&/")+"/")+t)),e.push(i)),1;if(a=0,n=n===""?".":n+":",rg(t))for(var o=0;o<t.length;o++){s=t[o];var l=n+_d(s,o);a+=fu(s,e,r,l,i)}else if(l=Ob(t),typeof l=="function")for(t=l.call(t),o=0;!(s=t.next()).done;)s=s.value,l=n+_d(s,o++),a+=fu(s,e,r,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Pl(t,e,r){if(t==null)return t;var n=[],i=0;return fu(t,n,"","",function(s){return e.call(r,s,i++)}),n}function Fb(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var dr={current:null},hu={transition:null},Ub={ReactCurrentDispatcher:dr,ReactCurrentBatchConfig:hu,ReactCurrentOwner:pp};function Ay(){throw Error("act(...) is not supported in production builds of React.")}ze.Children={map:Pl,forEach:function(t,e,r){Pl(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return Pl(t,function(){e++}),e},toArray:function(t){return Pl(t,function(e){return e})||[]},only:function(t){if(!mp(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ze.Component=Pa;ze.Fragment=Lb;ze.Profiler=_b;ze.PureComponent=fp;ze.StrictMode=Ab;ze.Suspense=kb;ze.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ub;ze.act=Ay;ze.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=Sy({},t.props),i=t.key,s=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=pp.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)wy.call(e,l)&&!by.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];n.children=o}return{$$typeof:ml,type:t.type,key:i,ref:s,props:n,_owner:a}};ze.createContext=function(t){return t={$$typeof:Rb,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Cb,_context:t},t.Consumer=t};ze.createElement=Ly;ze.createFactory=function(t){var e=Ly.bind(null,t);return e.type=t,e};ze.createRef=function(){return{current:null}};ze.forwardRef=function(t){return{$$typeof:Ib,render:t}};ze.isValidElement=mp;ze.lazy=function(t){return{$$typeof:Pb,_payload:{_status:-1,_result:t},_init:Fb}};ze.memo=function(t,e){return{$$typeof:Db,type:t,compare:e===void 0?null:e}};ze.startTransition=function(t){var e=hu.transition;hu.transition={};try{t()}finally{hu.transition=e}};ze.unstable_act=Ay;ze.useCallback=function(t,e){return dr.current.useCallback(t,e)};ze.useContext=function(t){return dr.current.useContext(t)};ze.useDebugValue=function(){};ze.useDeferredValue=function(t){return dr.current.useDeferredValue(t)};ze.useEffect=function(t,e){return dr.current.useEffect(t,e)};ze.useId=function(){return dr.current.useId()};ze.useImperativeHandle=function(t,e,r){return dr.current.useImperativeHandle(t,e,r)};ze.useInsertionEffect=function(t,e){return dr.current.useInsertionEffect(t,e)};ze.useLayoutEffect=function(t,e){return dr.current.useLayoutEffect(t,e)};ze.useMemo=function(t,e){return dr.current.useMemo(t,e)};ze.useReducer=function(t,e,r){return dr.current.useReducer(t,e,r)};ze.useRef=function(t){return dr.current.useRef(t)};ze.useState=function(t){return dr.current.useState(t)};ze.useSyncExternalStore=function(t,e,r){return dr.current.useSyncExternalStore(t,e,r)};ze.useTransition=function(){return dr.current.useTransition()};ze.version="18.3.1";yy.exports=ze;var L=yy.exports;const ne=dp(L),Bb=gy({__proto__:null,default:ne},[L]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $b=L,jb=Symbol.for("react.element"),Vb=Symbol.for("react.fragment"),Gb=Object.prototype.hasOwnProperty,zb=$b.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Hb={key:!0,ref:!0,__self:!0,__source:!0};function _y(t,e,r){var n,i={},s=null,a=null;r!==void 0&&(s=""+r),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(a=e.ref);for(n in e)Gb.call(e,n)&&!Hb.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:jb,type:t,key:s,ref:a,props:i,_owner:zb.current}}Yc.Fragment=Vb;Yc.jsx=_y;Yc.jsxs=_y;vy.exports=Yc;var E=vy.exports,Cy={exports:{}},Fr={},Ry={exports:{}},Iy={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(W,F){var j=W.length;W.push(F);e:for(;0<j;){var te=j-1>>>1,ee=W[te];if(0<i(ee,F))W[te]=F,W[j]=ee,j=te;else break e}}function r(W){return W.length===0?null:W[0]}function n(W){if(W.length===0)return null;var F=W[0],j=W.pop();if(j!==F){W[0]=j;e:for(var te=0,ee=W.length,fe=ee>>>1;te<fe;){var ye=2*(te+1)-1,Re=W[ye],Ee=ye+1,Fe=W[Ee];if(0>i(Re,j))Ee<ee&&0>i(Fe,Re)?(W[te]=Fe,W[Ee]=j,te=Ee):(W[te]=Re,W[ye]=j,te=ye);else if(Ee<ee&&0>i(Fe,j))W[te]=Fe,W[Ee]=j,te=Ee;else break e}}return F}function i(W,F){var j=W.sortIndex-F.sortIndex;return j!==0?j:W.id-F.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var l=[],u=[],c=1,d=null,f=3,m=!1,h=!1,p=!1,v=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(W){for(var F=r(u);F!==null;){if(F.callback===null)n(u);else if(F.startTime<=W)n(u),F.sortIndex=F.expirationTime,e(l,F);else break;F=r(u)}}function S(W){if(p=!1,x(W),!h)if(r(l)!==null)h=!0,H(T);else{var F=r(u);F!==null&&se(S,F.startTime-W)}}function T(W,F){h=!1,p&&(p=!1,g(b),b=-1),m=!0;var j=f;try{for(x(F),d=r(l);d!==null&&(!(d.expirationTime>F)||W&&!k());){var te=d.callback;if(typeof te=="function"){d.callback=null,f=d.priorityLevel;var ee=te(d.expirationTime<=F);F=t.unstable_now(),typeof ee=="function"?d.callback=ee:d===r(l)&&n(l),x(F)}else n(l);d=r(l)}if(d!==null)var fe=!0;else{var ye=r(u);ye!==null&&se(S,ye.startTime-F),fe=!1}return fe}finally{d=null,f=j,m=!1}}var C=!1,_=null,b=-1,I=5,A=-1;function k(){return!(t.unstable_now()-A<I)}function O(){if(_!==null){var W=t.unstable_now();A=W;var F=!0;try{F=_(!0,W)}finally{F?P():(C=!1,_=null)}}else C=!1}var P;if(typeof y=="function")P=function(){y(O)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,K=G.port2;G.port1.onmessage=O,P=function(){K.postMessage(null)}}else P=function(){v(O,0)};function H(W){_=W,C||(C=!0,P())}function se(W,F){b=v(function(){W(t.unstable_now())},F)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(W){W.callback=null},t.unstable_continueExecution=function(){h||m||(h=!0,H(T))},t.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<W?Math.floor(1e3/W):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(W){switch(f){case 1:case 2:case 3:var F=3;break;default:F=f}var j=f;f=F;try{return W()}finally{f=j}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(W,F){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var j=f;f=W;try{return F()}finally{f=j}},t.unstable_scheduleCallback=function(W,F,j){var te=t.unstable_now();switch(typeof j=="object"&&j!==null?(j=j.delay,j=typeof j=="number"&&0<j?te+j:te):j=te,W){case 1:var ee=-1;break;case 2:ee=250;break;case 5:ee=1073741823;break;case 4:ee=1e4;break;default:ee=5e3}return ee=j+ee,W={id:c++,callback:F,priorityLevel:W,startTime:j,expirationTime:ee,sortIndex:-1},j>te?(W.sortIndex=j,e(u,W),r(l)===null&&W===r(u)&&(p?(g(b),b=-1):p=!0,se(S,j-te))):(W.sortIndex=ee,e(l,W),h||m||(h=!0,H(T))),W},t.unstable_shouldYield=k,t.unstable_wrapCallback=function(W){var F=f;return function(){var j=f;f=F;try{return W.apply(this,arguments)}finally{f=j}}}})(Iy);Ry.exports=Iy;var Wb=Ry.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kb=L,Nr=Wb;function Q(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ky=new Set,Io={};function Ls(t,e){pa(t,e),pa(t+"Capture",e)}function pa(t,e){for(Io[t]=e,t=0;t<e.length;t++)ky.add(e[t])}var ai=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),$f=Object.prototype.hasOwnProperty,Yb=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,ig={},sg={};function qb(t){return $f.call(sg,t)?!0:$f.call(ig,t)?!1:Yb.test(t)?sg[t]=!0:(ig[t]=!0,!1)}function Xb(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Zb(t,e,r,n){if(e===null||typeof e>"u"||Xb(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function fr(t,e,r,n,i,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var Wt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Wt[t]=new fr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Wt[e]=new fr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Wt[t]=new fr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Wt[t]=new fr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Wt[t]=new fr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Wt[t]=new fr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Wt[t]=new fr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Wt[t]=new fr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Wt[t]=new fr(t,5,!1,t.toLowerCase(),null,!1,!1)});var gp=/[\-:]([a-z])/g;function vp(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(gp,vp);Wt[e]=new fr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(gp,vp);Wt[e]=new fr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(gp,vp);Wt[e]=new fr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Wt[t]=new fr(t,1,!1,t.toLowerCase(),null,!1,!1)});Wt.xlinkHref=new fr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Wt[t]=new fr(t,1,!1,t.toLowerCase(),null,!0,!0)});function yp(t,e,r,n){var i=Wt.hasOwnProperty(e)?Wt[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Zb(e,r,i,n)&&(r=null),n||i===null?qb(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(e=i.attributeName,n=i.attributeNamespace,r===null?t.removeAttribute(e):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var fi=Kb.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ol=Symbol.for("react.element"),$s=Symbol.for("react.portal"),js=Symbol.for("react.fragment"),xp=Symbol.for("react.strict_mode"),jf=Symbol.for("react.profiler"),Dy=Symbol.for("react.provider"),Py=Symbol.for("react.context"),Sp=Symbol.for("react.forward_ref"),Vf=Symbol.for("react.suspense"),Gf=Symbol.for("react.suspense_list"),Ep=Symbol.for("react.memo"),Si=Symbol.for("react.lazy"),Oy=Symbol.for("react.offscreen"),ag=Symbol.iterator;function Ga(t){return t===null||typeof t!="object"?null:(t=ag&&t[ag]||t["@@iterator"],typeof t=="function"?t:null)}var Et=Object.assign,Cd;function so(t){if(Cd===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);Cd=e&&e[1]||""}return`
`+Cd+t}var Rd=!1;function Id(t,e){if(!t||Rd)return"";Rd=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var n=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){n=u}t.call(e.prototype)}else{try{throw Error()}catch(u){n=u}t()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=n.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var l=`
`+i[a].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=a&&0<=o);break}}}finally{Rd=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?so(t):""}function Qb(t){switch(t.tag){case 5:return so(t.type);case 16:return so("Lazy");case 13:return so("Suspense");case 19:return so("SuspenseList");case 0:case 2:case 15:return t=Id(t.type,!1),t;case 11:return t=Id(t.type.render,!1),t;case 1:return t=Id(t.type,!0),t;default:return""}}function zf(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case js:return"Fragment";case $s:return"Portal";case jf:return"Profiler";case xp:return"StrictMode";case Vf:return"Suspense";case Gf:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Py:return(t.displayName||"Context")+".Consumer";case Dy:return(t._context.displayName||"Context")+".Provider";case Sp:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Ep:return e=t.displayName||null,e!==null?e:zf(t.type)||"Memo";case Si:e=t._payload,t=t._init;try{return zf(t(e))}catch{}}return null}function Jb(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return zf(e);case 8:return e===xp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ui(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function My(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function e1(t){var e=My(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){n=""+a,s.call(this,a)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Ml(t){t._valueTracker||(t._valueTracker=e1(t))}function Ny(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=My(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function Vu(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Hf(t,e){var r=e.checked;return Et({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function og(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=Ui(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Fy(t,e){e=e.checked,e!=null&&yp(t,"checked",e,!1)}function Wf(t,e){Fy(t,e);var r=Ui(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Kf(t,e.type,r):e.hasOwnProperty("defaultValue")&&Kf(t,e.type,Ui(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function lg(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function Kf(t,e,r){(e!=="number"||Vu(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var ao=Array.isArray;function ra(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+Ui(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Yf(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Q(91));return Et({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function ug(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(Q(92));if(ao(r)){if(1<r.length)throw Error(Q(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:Ui(r)}}function Uy(t,e){var r=Ui(e.value),n=Ui(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function cg(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function By(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function qf(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?By(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Nl,$y=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,i){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Nl=Nl||document.createElement("div"),Nl.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Nl.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function ko(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var po={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},t1=["Webkit","ms","Moz","O"];Object.keys(po).forEach(function(t){t1.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),po[e]=po[t]})});function jy(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||po.hasOwnProperty(t)&&po[t]?(""+e).trim():e+"px"}function Vy(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=jy(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}var r1=Et({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Xf(t,e){if(e){if(r1[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Q(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Q(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Q(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Q(62))}}function Zf(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Qf=null;function Tp(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Jf=null,na=null,ia=null;function dg(t){if(t=yl(t)){if(typeof Jf!="function")throw Error(Q(280));var e=t.stateNode;e&&(e=Jc(e),Jf(t.stateNode,t.type,e))}}function Gy(t){na?ia?ia.push(t):ia=[t]:na=t}function zy(){if(na){var t=na,e=ia;if(ia=na=null,dg(t),e)for(t=0;t<e.length;t++)dg(e[t])}}function Hy(t,e){return t(e)}function Wy(){}var kd=!1;function Ky(t,e,r){if(kd)return t(e,r);kd=!0;try{return Hy(t,e,r)}finally{kd=!1,(na!==null||ia!==null)&&(Wy(),zy())}}function Do(t,e){var r=t.stateNode;if(r===null)return null;var n=Jc(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(Q(231,e,typeof r));return r}var eh=!1;if(ai)try{var za={};Object.defineProperty(za,"passive",{get:function(){eh=!0}}),window.addEventListener("test",za,za),window.removeEventListener("test",za,za)}catch{eh=!1}function n1(t,e,r,n,i,s,a,o,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(r,u)}catch(c){this.onError(c)}}var mo=!1,Gu=null,zu=!1,th=null,i1={onError:function(t){mo=!0,Gu=t}};function s1(t,e,r,n,i,s,a,o,l){mo=!1,Gu=null,n1.apply(i1,arguments)}function a1(t,e,r,n,i,s,a,o,l){if(s1.apply(this,arguments),mo){if(mo){var u=Gu;mo=!1,Gu=null}else throw Error(Q(198));zu||(zu=!0,th=u)}}function As(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function Yy(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function fg(t){if(As(t)!==t)throw Error(Q(188))}function o1(t){var e=t.alternate;if(!e){if(e=As(t),e===null)throw Error(Q(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return fg(i),t;if(s===n)return fg(i),e;s=s.sibling}throw Error(Q(188))}if(r.return!==n.return)r=i,n=s;else{for(var a=!1,o=i.child;o;){if(o===r){a=!0,r=i,n=s;break}if(o===n){a=!0,n=i,r=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===r){a=!0,r=s,n=i;break}if(o===n){a=!0,n=s,r=i;break}o=o.sibling}if(!a)throw Error(Q(189))}}if(r.alternate!==n)throw Error(Q(190))}if(r.tag!==3)throw Error(Q(188));return r.stateNode.current===r?t:e}function qy(t){return t=o1(t),t!==null?Xy(t):null}function Xy(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Xy(t);if(e!==null)return e;t=t.sibling}return null}var Zy=Nr.unstable_scheduleCallback,hg=Nr.unstable_cancelCallback,l1=Nr.unstable_shouldYield,u1=Nr.unstable_requestPaint,Lt=Nr.unstable_now,c1=Nr.unstable_getCurrentPriorityLevel,wp=Nr.unstable_ImmediatePriority,Qy=Nr.unstable_UserBlockingPriority,Hu=Nr.unstable_NormalPriority,d1=Nr.unstable_LowPriority,Jy=Nr.unstable_IdlePriority,qc=null,Pn=null;function f1(t){if(Pn&&typeof Pn.onCommitFiberRoot=="function")try{Pn.onCommitFiberRoot(qc,t,void 0,(t.current.flags&128)===128)}catch{}}var pn=Math.clz32?Math.clz32:m1,h1=Math.log,p1=Math.LN2;function m1(t){return t>>>=0,t===0?32:31-(h1(t)/p1|0)|0}var Fl=64,Ul=4194304;function oo(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Wu(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,i=t.suspendedLanes,s=t.pingedLanes,a=r&268435455;if(a!==0){var o=a&~i;o!==0?n=oo(o):(s&=a,s!==0&&(n=oo(s)))}else a=r&~i,a!==0?n=oo(a):s!==0&&(n=oo(s));if(n===0)return 0;if(e!==0&&e!==n&&!(e&i)&&(i=n&-n,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-pn(e),i=1<<r,n|=t[r],e&=~i;return n}function g1(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function v1(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var a=31-pn(s),o=1<<a,l=i[a];l===-1?(!(o&r)||o&n)&&(i[a]=g1(o,e)):l<=e&&(t.expiredLanes|=o),s&=~o}}function rh(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function ex(){var t=Fl;return Fl<<=1,!(Fl&4194240)&&(Fl=64),t}function Dd(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function gl(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-pn(e),t[e]=r}function y1(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-pn(r),s=1<<i;e[i]=0,n[i]=-1,t[i]=-1,r&=~s}}function bp(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-pn(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}var et=0;function tx(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var rx,Lp,nx,ix,sx,nh=!1,Bl=[],Ii=null,ki=null,Di=null,Po=new Map,Oo=new Map,wi=[],x1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function pg(t,e){switch(t){case"focusin":case"focusout":Ii=null;break;case"dragenter":case"dragleave":ki=null;break;case"mouseover":case"mouseout":Di=null;break;case"pointerover":case"pointerout":Po.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Oo.delete(e.pointerId)}}function Ha(t,e,r,n,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},e!==null&&(e=yl(e),e!==null&&Lp(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function S1(t,e,r,n,i){switch(e){case"focusin":return Ii=Ha(Ii,t,e,r,n,i),!0;case"dragenter":return ki=Ha(ki,t,e,r,n,i),!0;case"mouseover":return Di=Ha(Di,t,e,r,n,i),!0;case"pointerover":var s=i.pointerId;return Po.set(s,Ha(Po.get(s)||null,t,e,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,Oo.set(s,Ha(Oo.get(s)||null,t,e,r,n,i)),!0}return!1}function ax(t){var e=rs(t.target);if(e!==null){var r=As(e);if(r!==null){if(e=r.tag,e===13){if(e=Yy(r),e!==null){t.blockedOn=e,sx(t.priority,function(){nx(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function pu(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=ih(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);Qf=n,r.target.dispatchEvent(n),Qf=null}else return e=yl(r),e!==null&&Lp(e),t.blockedOn=r,!1;e.shift()}return!0}function mg(t,e,r){pu(t)&&r.delete(e)}function E1(){nh=!1,Ii!==null&&pu(Ii)&&(Ii=null),ki!==null&&pu(ki)&&(ki=null),Di!==null&&pu(Di)&&(Di=null),Po.forEach(mg),Oo.forEach(mg)}function Wa(t,e){t.blockedOn===e&&(t.blockedOn=null,nh||(nh=!0,Nr.unstable_scheduleCallback(Nr.unstable_NormalPriority,E1)))}function Mo(t){function e(i){return Wa(i,t)}if(0<Bl.length){Wa(Bl[0],t);for(var r=1;r<Bl.length;r++){var n=Bl[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Ii!==null&&Wa(Ii,t),ki!==null&&Wa(ki,t),Di!==null&&Wa(Di,t),Po.forEach(e),Oo.forEach(e),r=0;r<wi.length;r++)n=wi[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<wi.length&&(r=wi[0],r.blockedOn===null);)ax(r),r.blockedOn===null&&wi.shift()}var sa=fi.ReactCurrentBatchConfig,Ku=!0;function T1(t,e,r,n){var i=et,s=sa.transition;sa.transition=null;try{et=1,Ap(t,e,r,n)}finally{et=i,sa.transition=s}}function w1(t,e,r,n){var i=et,s=sa.transition;sa.transition=null;try{et=4,Ap(t,e,r,n)}finally{et=i,sa.transition=s}}function Ap(t,e,r,n){if(Ku){var i=ih(t,e,r,n);if(i===null)Vd(t,e,n,Yu,r),pg(t,n);else if(S1(i,t,e,r,n))n.stopPropagation();else if(pg(t,n),e&4&&-1<x1.indexOf(t)){for(;i!==null;){var s=yl(i);if(s!==null&&rx(s),s=ih(t,e,r,n),s===null&&Vd(t,e,n,Yu,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else Vd(t,e,n,null,r)}}var Yu=null;function ih(t,e,r,n){if(Yu=null,t=Tp(n),t=rs(t),t!==null)if(e=As(t),e===null)t=null;else if(r=e.tag,r===13){if(t=Yy(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Yu=t,null}function ox(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(c1()){case wp:return 1;case Qy:return 4;case Hu:case d1:return 16;case Jy:return 536870912;default:return 16}default:return 16}}var _i=null,_p=null,mu=null;function lx(){if(mu)return mu;var t,e=_p,r=e.length,n,i="value"in _i?_i.value:_i.textContent,s=i.length;for(t=0;t<r&&e[t]===i[t];t++);var a=r-t;for(n=1;n<=a&&e[r-n]===i[s-n];n++);return mu=i.slice(t,1<n?1-n:void 0)}function gu(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function $l(){return!0}function gg(){return!1}function Ur(t){function e(r,n,i,s,a){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(r=t[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?$l:gg,this.isPropagationStopped=gg,this}return Et(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=$l)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=$l)},persist:function(){},isPersistent:$l}),e}var Oa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Cp=Ur(Oa),vl=Et({},Oa,{view:0,detail:0}),b1=Ur(vl),Pd,Od,Ka,Xc=Et({},vl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Rp,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ka&&(Ka&&t.type==="mousemove"?(Pd=t.screenX-Ka.screenX,Od=t.screenY-Ka.screenY):Od=Pd=0,Ka=t),Pd)},movementY:function(t){return"movementY"in t?t.movementY:Od}}),vg=Ur(Xc),L1=Et({},Xc,{dataTransfer:0}),A1=Ur(L1),_1=Et({},vl,{relatedTarget:0}),Md=Ur(_1),C1=Et({},Oa,{animationName:0,elapsedTime:0,pseudoElement:0}),R1=Ur(C1),I1=Et({},Oa,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),k1=Ur(I1),D1=Et({},Oa,{data:0}),yg=Ur(D1),P1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},O1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},M1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function N1(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=M1[t])?!!e[t]:!1}function Rp(){return N1}var F1=Et({},vl,{key:function(t){if(t.key){var e=P1[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=gu(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?O1[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Rp,charCode:function(t){return t.type==="keypress"?gu(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?gu(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),U1=Ur(F1),B1=Et({},Xc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),xg=Ur(B1),$1=Et({},vl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Rp}),j1=Ur($1),V1=Et({},Oa,{propertyName:0,elapsedTime:0,pseudoElement:0}),G1=Ur(V1),z1=Et({},Xc,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),H1=Ur(z1),W1=[9,13,27,32],Ip=ai&&"CompositionEvent"in window,go=null;ai&&"documentMode"in document&&(go=document.documentMode);var K1=ai&&"TextEvent"in window&&!go,ux=ai&&(!Ip||go&&8<go&&11>=go),Sg=" ",Eg=!1;function cx(t,e){switch(t){case"keyup":return W1.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function dx(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Vs=!1;function Y1(t,e){switch(t){case"compositionend":return dx(e);case"keypress":return e.which!==32?null:(Eg=!0,Sg);case"textInput":return t=e.data,t===Sg&&Eg?null:t;default:return null}}function q1(t,e){if(Vs)return t==="compositionend"||!Ip&&cx(t,e)?(t=lx(),mu=_p=_i=null,Vs=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return ux&&e.locale!=="ko"?null:e.data;default:return null}}var X1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Tg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!X1[t.type]:e==="textarea"}function fx(t,e,r,n){Gy(n),e=qu(e,"onChange"),0<e.length&&(r=new Cp("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var vo=null,No=null;function Z1(t){wx(t,0)}function Zc(t){var e=Hs(t);if(Ny(e))return t}function Q1(t,e){if(t==="change")return e}var hx=!1;if(ai){var Nd;if(ai){var Fd="oninput"in document;if(!Fd){var wg=document.createElement("div");wg.setAttribute("oninput","return;"),Fd=typeof wg.oninput=="function"}Nd=Fd}else Nd=!1;hx=Nd&&(!document.documentMode||9<document.documentMode)}function bg(){vo&&(vo.detachEvent("onpropertychange",px),No=vo=null)}function px(t){if(t.propertyName==="value"&&Zc(No)){var e=[];fx(e,No,t,Tp(t)),Ky(Z1,e)}}function J1(t,e,r){t==="focusin"?(bg(),vo=e,No=r,vo.attachEvent("onpropertychange",px)):t==="focusout"&&bg()}function eL(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Zc(No)}function tL(t,e){if(t==="click")return Zc(e)}function rL(t,e){if(t==="input"||t==="change")return Zc(e)}function nL(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var vn=typeof Object.is=="function"?Object.is:nL;function Fo(t,e){if(vn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!$f.call(e,i)||!vn(t[i],e[i]))return!1}return!0}function Lg(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Ag(t,e){var r=Lg(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Lg(r)}}function mx(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?mx(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function gx(){for(var t=window,e=Vu();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=Vu(t.document)}return e}function kp(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function iL(t){var e=gx(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&mx(r.ownerDocument.documentElement,r)){if(n!==null&&kp(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!t.extend&&s>n&&(i=n,n=s,s=i),i=Ag(r,s);var a=Ag(r,n);i&&a&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>n?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var sL=ai&&"documentMode"in document&&11>=document.documentMode,Gs=null,sh=null,yo=null,ah=!1;function _g(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;ah||Gs==null||Gs!==Vu(n)||(n=Gs,"selectionStart"in n&&kp(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),yo&&Fo(yo,n)||(yo=n,n=qu(sh,"onSelect"),0<n.length&&(e=new Cp("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=Gs)))}function jl(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var zs={animationend:jl("Animation","AnimationEnd"),animationiteration:jl("Animation","AnimationIteration"),animationstart:jl("Animation","AnimationStart"),transitionend:jl("Transition","TransitionEnd")},Ud={},vx={};ai&&(vx=document.createElement("div").style,"AnimationEvent"in window||(delete zs.animationend.animation,delete zs.animationiteration.animation,delete zs.animationstart.animation),"TransitionEvent"in window||delete zs.transitionend.transition);function Qc(t){if(Ud[t])return Ud[t];if(!zs[t])return t;var e=zs[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in vx)return Ud[t]=e[r];return t}var yx=Qc("animationend"),xx=Qc("animationiteration"),Sx=Qc("animationstart"),Ex=Qc("transitionend"),Tx=new Map,Cg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function zi(t,e){Tx.set(t,e),Ls(e,[t])}for(var Bd=0;Bd<Cg.length;Bd++){var $d=Cg[Bd],aL=$d.toLowerCase(),oL=$d[0].toUpperCase()+$d.slice(1);zi(aL,"on"+oL)}zi(yx,"onAnimationEnd");zi(xx,"onAnimationIteration");zi(Sx,"onAnimationStart");zi("dblclick","onDoubleClick");zi("focusin","onFocus");zi("focusout","onBlur");zi(Ex,"onTransitionEnd");pa("onMouseEnter",["mouseout","mouseover"]);pa("onMouseLeave",["mouseout","mouseover"]);pa("onPointerEnter",["pointerout","pointerover"]);pa("onPointerLeave",["pointerout","pointerover"]);Ls("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ls("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ls("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ls("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ls("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ls("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),lL=new Set("cancel close invalid load scroll toggle".split(" ").concat(lo));function Rg(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,a1(n,e,void 0,t),t.currentTarget=null}function wx(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var a=n.length-1;0<=a;a--){var o=n[a],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;Rg(i,o,u),s=l}else for(a=0;a<n.length;a++){if(o=n[a],l=o.instance,u=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;Rg(i,o,u),s=l}}}if(zu)throw t=th,zu=!1,th=null,t}function dt(t,e){var r=e[dh];r===void 0&&(r=e[dh]=new Set);var n=t+"__bubble";r.has(n)||(bx(e,t,2,!1),r.add(n))}function jd(t,e,r){var n=0;e&&(n|=4),bx(r,t,n,e)}var Vl="_reactListening"+Math.random().toString(36).slice(2);function Uo(t){if(!t[Vl]){t[Vl]=!0,ky.forEach(function(r){r!=="selectionchange"&&(lL.has(r)||jd(r,!1,t),jd(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Vl]||(e[Vl]=!0,jd("selectionchange",!1,e))}}function bx(t,e,r,n){switch(ox(e)){case 1:var i=T1;break;case 4:i=w1;break;default:i=Ap}r=i.bind(null,e,r,t),i=void 0,!eh||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function Vd(t,e,r,n,i){var s=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=n.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;a=a.return}for(;o!==null;){if(a=rs(o),a===null)return;if(l=a.tag,l===5||l===6){n=s=a;continue e}o=o.parentNode}}n=n.return}Ky(function(){var u=s,c=Tp(r),d=[];e:{var f=Tx.get(t);if(f!==void 0){var m=Cp,h=t;switch(t){case"keypress":if(gu(r)===0)break e;case"keydown":case"keyup":m=U1;break;case"focusin":h="focus",m=Md;break;case"focusout":h="blur",m=Md;break;case"beforeblur":case"afterblur":m=Md;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=vg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=A1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=j1;break;case yx:case xx:case Sx:m=R1;break;case Ex:m=G1;break;case"scroll":m=b1;break;case"wheel":m=H1;break;case"copy":case"cut":case"paste":m=k1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=xg}var p=(e&4)!==0,v=!p&&t==="scroll",g=p?f!==null?f+"Capture":null:f;p=[];for(var y=u,x;y!==null;){x=y;var S=x.stateNode;if(x.tag===5&&S!==null&&(x=S,g!==null&&(S=Do(y,g),S!=null&&p.push(Bo(y,S,x)))),v)break;y=y.return}0<p.length&&(f=new m(f,h,null,r,c),d.push({event:f,listeners:p}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",f&&r!==Qf&&(h=r.relatedTarget||r.fromElement)&&(rs(h)||h[oi]))break e;if((m||f)&&(f=c.window===c?c:(f=c.ownerDocument)?f.defaultView||f.parentWindow:window,m?(h=r.relatedTarget||r.toElement,m=u,h=h?rs(h):null,h!==null&&(v=As(h),h!==v||h.tag!==5&&h.tag!==6)&&(h=null)):(m=null,h=u),m!==h)){if(p=vg,S="onMouseLeave",g="onMouseEnter",y="mouse",(t==="pointerout"||t==="pointerover")&&(p=xg,S="onPointerLeave",g="onPointerEnter",y="pointer"),v=m==null?f:Hs(m),x=h==null?f:Hs(h),f=new p(S,y+"leave",m,r,c),f.target=v,f.relatedTarget=x,S=null,rs(c)===u&&(p=new p(g,y+"enter",h,r,c),p.target=x,p.relatedTarget=v,S=p),v=S,m&&h)t:{for(p=m,g=h,y=0,x=p;x;x=ks(x))y++;for(x=0,S=g;S;S=ks(S))x++;for(;0<y-x;)p=ks(p),y--;for(;0<x-y;)g=ks(g),x--;for(;y--;){if(p===g||g!==null&&p===g.alternate)break t;p=ks(p),g=ks(g)}p=null}else p=null;m!==null&&Ig(d,f,m,p,!1),h!==null&&v!==null&&Ig(d,v,h,p,!0)}}e:{if(f=u?Hs(u):window,m=f.nodeName&&f.nodeName.toLowerCase(),m==="select"||m==="input"&&f.type==="file")var T=Q1;else if(Tg(f))if(hx)T=rL;else{T=eL;var C=J1}else(m=f.nodeName)&&m.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(T=tL);if(T&&(T=T(t,u))){fx(d,T,r,c);break e}C&&C(t,f,u),t==="focusout"&&(C=f._wrapperState)&&C.controlled&&f.type==="number"&&Kf(f,"number",f.value)}switch(C=u?Hs(u):window,t){case"focusin":(Tg(C)||C.contentEditable==="true")&&(Gs=C,sh=u,yo=null);break;case"focusout":yo=sh=Gs=null;break;case"mousedown":ah=!0;break;case"contextmenu":case"mouseup":case"dragend":ah=!1,_g(d,r,c);break;case"selectionchange":if(sL)break;case"keydown":case"keyup":_g(d,r,c)}var _;if(Ip)e:{switch(t){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Vs?cx(t,r)&&(b="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(b="onCompositionStart");b&&(ux&&r.locale!=="ko"&&(Vs||b!=="onCompositionStart"?b==="onCompositionEnd"&&Vs&&(_=lx()):(_i=c,_p="value"in _i?_i.value:_i.textContent,Vs=!0)),C=qu(u,b),0<C.length&&(b=new yg(b,t,null,r,c),d.push({event:b,listeners:C}),_?b.data=_:(_=dx(r),_!==null&&(b.data=_)))),(_=K1?Y1(t,r):q1(t,r))&&(u=qu(u,"onBeforeInput"),0<u.length&&(c=new yg("onBeforeInput","beforeinput",null,r,c),d.push({event:c,listeners:u}),c.data=_))}wx(d,e)})}function Bo(t,e,r){return{instance:t,listener:e,currentTarget:r}}function qu(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Do(t,r),s!=null&&n.unshift(Bo(t,s,i)),s=Do(t,e),s!=null&&n.push(Bo(t,s,i))),t=t.return}return n}function ks(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Ig(t,e,r,n,i){for(var s=e._reactName,a=[];r!==null&&r!==n;){var o=r,l=o.alternate,u=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&u!==null&&(o=u,i?(l=Do(r,s),l!=null&&a.unshift(Bo(r,l,o))):i||(l=Do(r,s),l!=null&&a.push(Bo(r,l,o)))),r=r.return}a.length!==0&&t.push({event:e,listeners:a})}var uL=/\r\n?/g,cL=/\u0000|\uFFFD/g;function kg(t){return(typeof t=="string"?t:""+t).replace(uL,`
`).replace(cL,"")}function Gl(t,e,r){if(e=kg(e),kg(t)!==e&&r)throw Error(Q(425))}function Xu(){}var oh=null,lh=null;function uh(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var ch=typeof setTimeout=="function"?setTimeout:void 0,dL=typeof clearTimeout=="function"?clearTimeout:void 0,Dg=typeof Promise=="function"?Promise:void 0,fL=typeof queueMicrotask=="function"?queueMicrotask:typeof Dg<"u"?function(t){return Dg.resolve(null).then(t).catch(hL)}:ch;function hL(t){setTimeout(function(){throw t})}function Gd(t,e){var r=e,n=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){t.removeChild(i),Mo(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);Mo(e)}function Pi(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Pg(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var Ma=Math.random().toString(36).slice(2),An="__reactFiber$"+Ma,$o="__reactProps$"+Ma,oi="__reactContainer$"+Ma,dh="__reactEvents$"+Ma,pL="__reactListeners$"+Ma,mL="__reactHandles$"+Ma;function rs(t){var e=t[An];if(e)return e;for(var r=t.parentNode;r;){if(e=r[oi]||r[An]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=Pg(t);t!==null;){if(r=t[An])return r;t=Pg(t)}return e}t=r,r=t.parentNode}return null}function yl(t){return t=t[An]||t[oi],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Hs(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Q(33))}function Jc(t){return t[$o]||null}var fh=[],Ws=-1;function Hi(t){return{current:t}}function ft(t){0>Ws||(t.current=fh[Ws],fh[Ws]=null,Ws--)}function lt(t,e){Ws++,fh[Ws]=t.current,t.current=e}var Bi={},er=Hi(Bi),Sr=Hi(!1),ps=Bi;function ma(t,e){var r=t.type.contextTypes;if(!r)return Bi;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=e[s];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Er(t){return t=t.childContextTypes,t!=null}function Zu(){ft(Sr),ft(er)}function Og(t,e,r){if(er.current!==Bi)throw Error(Q(168));lt(er,e),lt(Sr,r)}function Lx(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(Q(108,Jb(t)||"Unknown",i));return Et({},r,n)}function Qu(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Bi,ps=er.current,lt(er,t),lt(Sr,Sr.current),!0}function Mg(t,e,r){var n=t.stateNode;if(!n)throw Error(Q(169));r?(t=Lx(t,e,ps),n.__reactInternalMemoizedMergedChildContext=t,ft(Sr),ft(er),lt(er,t)):ft(Sr),lt(Sr,r)}var Jn=null,ed=!1,zd=!1;function Ax(t){Jn===null?Jn=[t]:Jn.push(t)}function gL(t){ed=!0,Ax(t)}function Wi(){if(!zd&&Jn!==null){zd=!0;var t=0,e=et;try{var r=Jn;for(et=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}Jn=null,ed=!1}catch(i){throw Jn!==null&&(Jn=Jn.slice(t+1)),Zy(wp,Wi),i}finally{et=e,zd=!1}}return null}var Ks=[],Ys=0,Ju=null,ec=0,Kr=[],Yr=0,ms=null,ei=1,ti="";function Qi(t,e){Ks[Ys++]=ec,Ks[Ys++]=Ju,Ju=t,ec=e}function _x(t,e,r){Kr[Yr++]=ei,Kr[Yr++]=ti,Kr[Yr++]=ms,ms=t;var n=ei;t=ti;var i=32-pn(n)-1;n&=~(1<<i),r+=1;var s=32-pn(e)+i;if(30<s){var a=i-i%5;s=(n&(1<<a)-1).toString(32),n>>=a,i-=a,ei=1<<32-pn(e)+i|r<<i|n,ti=s+t}else ei=1<<s|r<<i|n,ti=t}function Dp(t){t.return!==null&&(Qi(t,1),_x(t,1,0))}function Pp(t){for(;t===Ju;)Ju=Ks[--Ys],Ks[Ys]=null,ec=Ks[--Ys],Ks[Ys]=null;for(;t===ms;)ms=Kr[--Yr],Kr[Yr]=null,ti=Kr[--Yr],Kr[Yr]=null,ei=Kr[--Yr],Kr[Yr]=null}var Or=null,Dr=null,pt=!1,cn=null;function Cx(t,e){var r=qr(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function Ng(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Or=t,Dr=Pi(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Or=t,Dr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=ms!==null?{id:ei,overflow:ti}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=qr(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,Or=t,Dr=null,!0):!1;default:return!1}}function hh(t){return(t.mode&1)!==0&&(t.flags&128)===0}function ph(t){if(pt){var e=Dr;if(e){var r=e;if(!Ng(t,e)){if(hh(t))throw Error(Q(418));e=Pi(r.nextSibling);var n=Or;e&&Ng(t,e)?Cx(n,r):(t.flags=t.flags&-4097|2,pt=!1,Or=t)}}else{if(hh(t))throw Error(Q(418));t.flags=t.flags&-4097|2,pt=!1,Or=t}}}function Fg(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Or=t}function zl(t){if(t!==Or)return!1;if(!pt)return Fg(t),pt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!uh(t.type,t.memoizedProps)),e&&(e=Dr)){if(hh(t))throw Rx(),Error(Q(418));for(;e;)Cx(t,e),e=Pi(e.nextSibling)}if(Fg(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Q(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Dr=Pi(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Dr=null}}else Dr=Or?Pi(t.stateNode.nextSibling):null;return!0}function Rx(){for(var t=Dr;t;)t=Pi(t.nextSibling)}function ga(){Dr=Or=null,pt=!1}function Op(t){cn===null?cn=[t]:cn.push(t)}var vL=fi.ReactCurrentBatchConfig;function Ya(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Q(309));var n=r.stateNode}if(!n)throw Error(Q(147,t));var i=n,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var o=i.refs;a===null?delete o[s]:o[s]=a},e._stringRef=s,e)}if(typeof t!="string")throw Error(Q(284));if(!r._owner)throw Error(Q(290,t))}return t}function Hl(t,e){throw t=Object.prototype.toString.call(e),Error(Q(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Ug(t){var e=t._init;return e(t._payload)}function Ix(t){function e(g,y){if(t){var x=g.deletions;x===null?(g.deletions=[y],g.flags|=16):x.push(y)}}function r(g,y){if(!t)return null;for(;y!==null;)e(g,y),y=y.sibling;return null}function n(g,y){for(g=new Map;y!==null;)y.key!==null?g.set(y.key,y):g.set(y.index,y),y=y.sibling;return g}function i(g,y){return g=Fi(g,y),g.index=0,g.sibling=null,g}function s(g,y,x){return g.index=x,t?(x=g.alternate,x!==null?(x=x.index,x<y?(g.flags|=2,y):x):(g.flags|=2,y)):(g.flags|=1048576,y)}function a(g){return t&&g.alternate===null&&(g.flags|=2),g}function o(g,y,x,S){return y===null||y.tag!==6?(y=Zd(x,g.mode,S),y.return=g,y):(y=i(y,x),y.return=g,y)}function l(g,y,x,S){var T=x.type;return T===js?c(g,y,x.props.children,S,x.key):y!==null&&(y.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===Si&&Ug(T)===y.type)?(S=i(y,x.props),S.ref=Ya(g,y,x),S.return=g,S):(S=wu(x.type,x.key,x.props,null,g.mode,S),S.ref=Ya(g,y,x),S.return=g,S)}function u(g,y,x,S){return y===null||y.tag!==4||y.stateNode.containerInfo!==x.containerInfo||y.stateNode.implementation!==x.implementation?(y=Qd(x,g.mode,S),y.return=g,y):(y=i(y,x.children||[]),y.return=g,y)}function c(g,y,x,S,T){return y===null||y.tag!==7?(y=us(x,g.mode,S,T),y.return=g,y):(y=i(y,x),y.return=g,y)}function d(g,y,x){if(typeof y=="string"&&y!==""||typeof y=="number")return y=Zd(""+y,g.mode,x),y.return=g,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Ol:return x=wu(y.type,y.key,y.props,null,g.mode,x),x.ref=Ya(g,null,y),x.return=g,x;case $s:return y=Qd(y,g.mode,x),y.return=g,y;case Si:var S=y._init;return d(g,S(y._payload),x)}if(ao(y)||Ga(y))return y=us(y,g.mode,x,null),y.return=g,y;Hl(g,y)}return null}function f(g,y,x,S){var T=y!==null?y.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return T!==null?null:o(g,y,""+x,S);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Ol:return x.key===T?l(g,y,x,S):null;case $s:return x.key===T?u(g,y,x,S):null;case Si:return T=x._init,f(g,y,T(x._payload),S)}if(ao(x)||Ga(x))return T!==null?null:c(g,y,x,S,null);Hl(g,x)}return null}function m(g,y,x,S,T){if(typeof S=="string"&&S!==""||typeof S=="number")return g=g.get(x)||null,o(y,g,""+S,T);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Ol:return g=g.get(S.key===null?x:S.key)||null,l(y,g,S,T);case $s:return g=g.get(S.key===null?x:S.key)||null,u(y,g,S,T);case Si:var C=S._init;return m(g,y,x,C(S._payload),T)}if(ao(S)||Ga(S))return g=g.get(x)||null,c(y,g,S,T,null);Hl(y,S)}return null}function h(g,y,x,S){for(var T=null,C=null,_=y,b=y=0,I=null;_!==null&&b<x.length;b++){_.index>b?(I=_,_=null):I=_.sibling;var A=f(g,_,x[b],S);if(A===null){_===null&&(_=I);break}t&&_&&A.alternate===null&&e(g,_),y=s(A,y,b),C===null?T=A:C.sibling=A,C=A,_=I}if(b===x.length)return r(g,_),pt&&Qi(g,b),T;if(_===null){for(;b<x.length;b++)_=d(g,x[b],S),_!==null&&(y=s(_,y,b),C===null?T=_:C.sibling=_,C=_);return pt&&Qi(g,b),T}for(_=n(g,_);b<x.length;b++)I=m(_,g,b,x[b],S),I!==null&&(t&&I.alternate!==null&&_.delete(I.key===null?b:I.key),y=s(I,y,b),C===null?T=I:C.sibling=I,C=I);return t&&_.forEach(function(k){return e(g,k)}),pt&&Qi(g,b),T}function p(g,y,x,S){var T=Ga(x);if(typeof T!="function")throw Error(Q(150));if(x=T.call(x),x==null)throw Error(Q(151));for(var C=T=null,_=y,b=y=0,I=null,A=x.next();_!==null&&!A.done;b++,A=x.next()){_.index>b?(I=_,_=null):I=_.sibling;var k=f(g,_,A.value,S);if(k===null){_===null&&(_=I);break}t&&_&&k.alternate===null&&e(g,_),y=s(k,y,b),C===null?T=k:C.sibling=k,C=k,_=I}if(A.done)return r(g,_),pt&&Qi(g,b),T;if(_===null){for(;!A.done;b++,A=x.next())A=d(g,A.value,S),A!==null&&(y=s(A,y,b),C===null?T=A:C.sibling=A,C=A);return pt&&Qi(g,b),T}for(_=n(g,_);!A.done;b++,A=x.next())A=m(_,g,b,A.value,S),A!==null&&(t&&A.alternate!==null&&_.delete(A.key===null?b:A.key),y=s(A,y,b),C===null?T=A:C.sibling=A,C=A);return t&&_.forEach(function(O){return e(g,O)}),pt&&Qi(g,b),T}function v(g,y,x,S){if(typeof x=="object"&&x!==null&&x.type===js&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case Ol:e:{for(var T=x.key,C=y;C!==null;){if(C.key===T){if(T=x.type,T===js){if(C.tag===7){r(g,C.sibling),y=i(C,x.props.children),y.return=g,g=y;break e}}else if(C.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===Si&&Ug(T)===C.type){r(g,C.sibling),y=i(C,x.props),y.ref=Ya(g,C,x),y.return=g,g=y;break e}r(g,C);break}else e(g,C);C=C.sibling}x.type===js?(y=us(x.props.children,g.mode,S,x.key),y.return=g,g=y):(S=wu(x.type,x.key,x.props,null,g.mode,S),S.ref=Ya(g,y,x),S.return=g,g=S)}return a(g);case $s:e:{for(C=x.key;y!==null;){if(y.key===C)if(y.tag===4&&y.stateNode.containerInfo===x.containerInfo&&y.stateNode.implementation===x.implementation){r(g,y.sibling),y=i(y,x.children||[]),y.return=g,g=y;break e}else{r(g,y);break}else e(g,y);y=y.sibling}y=Qd(x,g.mode,S),y.return=g,g=y}return a(g);case Si:return C=x._init,v(g,y,C(x._payload),S)}if(ao(x))return h(g,y,x,S);if(Ga(x))return p(g,y,x,S);Hl(g,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,y!==null&&y.tag===6?(r(g,y.sibling),y=i(y,x),y.return=g,g=y):(r(g,y),y=Zd(x,g.mode,S),y.return=g,g=y),a(g)):r(g,y)}return v}var va=Ix(!0),kx=Ix(!1),tc=Hi(null),rc=null,qs=null,Mp=null;function Np(){Mp=qs=rc=null}function Fp(t){var e=tc.current;ft(tc),t._currentValue=e}function mh(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function aa(t,e){rc=t,Mp=qs=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(xr=!0),t.firstContext=null)}function Zr(t){var e=t._currentValue;if(Mp!==t)if(t={context:t,memoizedValue:e,next:null},qs===null){if(rc===null)throw Error(Q(308));qs=t,rc.dependencies={lanes:0,firstContext:t}}else qs=qs.next=t;return e}var ns=null;function Up(t){ns===null?ns=[t]:ns.push(t)}function Dx(t,e,r,n){var i=e.interleaved;return i===null?(r.next=r,Up(e)):(r.next=i.next,i.next=r),e.interleaved=r,li(t,n)}function li(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var Ei=!1;function Bp(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Px(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ii(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Oi(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,Ye&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,li(t,r)}return i=n.interleaved,i===null?(e.next=e,Up(n)):(e.next=i.next,i.next=e),n.interleaved=e,li(t,r)}function vu(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,bp(t,r)}}function Bg(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=a:s=s.next=a,r=r.next}while(r!==null);s===null?i=s=e:s=s.next=e}else i=s=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function nc(t,e,r,n){var i=t.updateQueue;Ei=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,u=l.next;l.next=null,a===null?s=u:a.next=u,a=l;var c=t.alternate;c!==null&&(c=c.updateQueue,o=c.lastBaseUpdate,o!==a&&(o===null?c.firstBaseUpdate=u:o.next=u,c.lastBaseUpdate=l))}if(s!==null){var d=i.baseState;a=0,c=u=l=null,o=s;do{var f=o.lane,m=o.eventTime;if((n&f)===f){c!==null&&(c=c.next={eventTime:m,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var h=t,p=o;switch(f=e,m=r,p.tag){case 1:if(h=p.payload,typeof h=="function"){d=h.call(m,d,f);break e}d=h;break e;case 3:h.flags=h.flags&-65537|128;case 0:if(h=p.payload,f=typeof h=="function"?h.call(m,d,f):h,f==null)break e;d=Et({},d,f);break e;case 2:Ei=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,f=i.effects,f===null?i.effects=[o]:f.push(o))}else m={eventTime:m,lane:f,tag:o.tag,payload:o.payload,callback:o.callback,next:null},c===null?(u=c=m,l=d):c=c.next=m,a|=f;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;f=o,o=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(!0);if(c===null&&(l=d),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=c,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);vs|=a,t.lanes=a,t.memoizedState=d}}function $g(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(Q(191,i));i.call(n)}}}var xl={},On=Hi(xl),jo=Hi(xl),Vo=Hi(xl);function is(t){if(t===xl)throw Error(Q(174));return t}function $p(t,e){switch(lt(Vo,e),lt(jo,t),lt(On,xl),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:qf(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=qf(e,t)}ft(On),lt(On,e)}function ya(){ft(On),ft(jo),ft(Vo)}function Ox(t){is(Vo.current);var e=is(On.current),r=qf(e,t.type);e!==r&&(lt(jo,t),lt(On,r))}function jp(t){jo.current===t&&(ft(On),ft(jo))}var xt=Hi(0);function ic(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Hd=[];function Vp(){for(var t=0;t<Hd.length;t++)Hd[t]._workInProgressVersionPrimary=null;Hd.length=0}var yu=fi.ReactCurrentDispatcher,Wd=fi.ReactCurrentBatchConfig,gs=0,St=null,Pt=null,Ut=null,sc=!1,xo=!1,Go=0,yL=0;function Kt(){throw Error(Q(321))}function Gp(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!vn(t[r],e[r]))return!1;return!0}function zp(t,e,r,n,i,s){if(gs=s,St=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,yu.current=t===null||t.memoizedState===null?TL:wL,t=r(n,i),xo){s=0;do{if(xo=!1,Go=0,25<=s)throw Error(Q(301));s+=1,Ut=Pt=null,e.updateQueue=null,yu.current=bL,t=r(n,i)}while(xo)}if(yu.current=ac,e=Pt!==null&&Pt.next!==null,gs=0,Ut=Pt=St=null,sc=!1,e)throw Error(Q(300));return t}function Hp(){var t=Go!==0;return Go=0,t}function wn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ut===null?St.memoizedState=Ut=t:Ut=Ut.next=t,Ut}function Qr(){if(Pt===null){var t=St.alternate;t=t!==null?t.memoizedState:null}else t=Pt.next;var e=Ut===null?St.memoizedState:Ut.next;if(e!==null)Ut=e,Pt=t;else{if(t===null)throw Error(Q(310));Pt=t,t={memoizedState:Pt.memoizedState,baseState:Pt.baseState,baseQueue:Pt.baseQueue,queue:Pt.queue,next:null},Ut===null?St.memoizedState=Ut=t:Ut=Ut.next=t}return Ut}function zo(t,e){return typeof e=="function"?e(t):e}function Kd(t){var e=Qr(),r=e.queue;if(r===null)throw Error(Q(311));r.lastRenderedReducer=t;var n=Pt,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var o=a=null,l=null,u=s;do{var c=u.lane;if((gs&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:t(n,u.action);else{var d={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=d,a=n):l=l.next=d,St.lanes|=c,vs|=c}u=u.next}while(u!==null&&u!==s);l===null?a=n:l.next=o,vn(n,e.memoizedState)||(xr=!0),e.memoizedState=n,e.baseState=a,e.baseQueue=l,r.lastRenderedState=n}if(t=r.interleaved,t!==null){i=t;do s=i.lane,St.lanes|=s,vs|=s,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function Yd(t){var e=Qr(),r=e.queue;if(r===null)throw Error(Q(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,s=e.memoizedState;if(i!==null){r.pending=null;var a=i=i.next;do s=t(s,a.action),a=a.next;while(a!==i);vn(s,e.memoizedState)||(xr=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),r.lastRenderedState=s}return[s,n]}function Mx(){}function Nx(t,e){var r=St,n=Qr(),i=e(),s=!vn(n.memoizedState,i);if(s&&(n.memoizedState=i,xr=!0),n=n.queue,Wp(Bx.bind(null,r,n,t),[t]),n.getSnapshot!==e||s||Ut!==null&&Ut.memoizedState.tag&1){if(r.flags|=2048,Ho(9,Ux.bind(null,r,n,i,e),void 0,null),$t===null)throw Error(Q(349));gs&30||Fx(r,e,i)}return i}function Fx(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=St.updateQueue,e===null?(e={lastEffect:null,stores:null},St.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function Ux(t,e,r,n){e.value=r,e.getSnapshot=n,$x(e)&&jx(t)}function Bx(t,e,r){return r(function(){$x(e)&&jx(t)})}function $x(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!vn(t,r)}catch{return!0}}function jx(t){var e=li(t,1);e!==null&&mn(e,t,1,-1)}function jg(t){var e=wn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:zo,lastRenderedState:t},e.queue=t,t=t.dispatch=EL.bind(null,St,t),[e.memoizedState,t]}function Ho(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=St.updateQueue,e===null?(e={lastEffect:null,stores:null},St.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function Vx(){return Qr().memoizedState}function xu(t,e,r,n){var i=wn();St.flags|=t,i.memoizedState=Ho(1|e,r,void 0,n===void 0?null:n)}function td(t,e,r,n){var i=Qr();n=n===void 0?null:n;var s=void 0;if(Pt!==null){var a=Pt.memoizedState;if(s=a.destroy,n!==null&&Gp(n,a.deps)){i.memoizedState=Ho(e,r,s,n);return}}St.flags|=t,i.memoizedState=Ho(1|e,r,s,n)}function Vg(t,e){return xu(8390656,8,t,e)}function Wp(t,e){return td(2048,8,t,e)}function Gx(t,e){return td(4,2,t,e)}function zx(t,e){return td(4,4,t,e)}function Hx(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Wx(t,e,r){return r=r!=null?r.concat([t]):null,td(4,4,Hx.bind(null,e,t),r)}function Kp(){}function Kx(t,e){var r=Qr();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Gp(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function Yx(t,e){var r=Qr();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Gp(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function qx(t,e,r){return gs&21?(vn(r,e)||(r=ex(),St.lanes|=r,vs|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,xr=!0),t.memoizedState=r)}function xL(t,e){var r=et;et=r!==0&&4>r?r:4,t(!0);var n=Wd.transition;Wd.transition={};try{t(!1),e()}finally{et=r,Wd.transition=n}}function Xx(){return Qr().memoizedState}function SL(t,e,r){var n=Ni(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Zx(t))Qx(e,r);else if(r=Dx(t,e,r,n),r!==null){var i=lr();mn(r,t,n,i),Jx(r,e,n)}}function EL(t,e,r){var n=Ni(t),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Zx(t))Qx(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,o=s(a,r);if(i.hasEagerState=!0,i.eagerState=o,vn(o,a)){var l=e.interleaved;l===null?(i.next=i,Up(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}r=Dx(t,e,i,n),r!==null&&(i=lr(),mn(r,t,n,i),Jx(r,e,n))}}function Zx(t){var e=t.alternate;return t===St||e!==null&&e===St}function Qx(t,e){xo=sc=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function Jx(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,bp(t,r)}}var ac={readContext:Zr,useCallback:Kt,useContext:Kt,useEffect:Kt,useImperativeHandle:Kt,useInsertionEffect:Kt,useLayoutEffect:Kt,useMemo:Kt,useReducer:Kt,useRef:Kt,useState:Kt,useDebugValue:Kt,useDeferredValue:Kt,useTransition:Kt,useMutableSource:Kt,useSyncExternalStore:Kt,useId:Kt,unstable_isNewReconciler:!1},TL={readContext:Zr,useCallback:function(t,e){return wn().memoizedState=[t,e===void 0?null:e],t},useContext:Zr,useEffect:Vg,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,xu(4194308,4,Hx.bind(null,e,t),r)},useLayoutEffect:function(t,e){return xu(4194308,4,t,e)},useInsertionEffect:function(t,e){return xu(4,2,t,e)},useMemo:function(t,e){var r=wn();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=wn();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=SL.bind(null,St,t),[n.memoizedState,t]},useRef:function(t){var e=wn();return t={current:t},e.memoizedState=t},useState:jg,useDebugValue:Kp,useDeferredValue:function(t){return wn().memoizedState=t},useTransition:function(){var t=jg(!1),e=t[0];return t=xL.bind(null,t[1]),wn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=St,i=wn();if(pt){if(r===void 0)throw Error(Q(407));r=r()}else{if(r=e(),$t===null)throw Error(Q(349));gs&30||Fx(n,e,r)}i.memoizedState=r;var s={value:r,getSnapshot:e};return i.queue=s,Vg(Bx.bind(null,n,s,t),[t]),n.flags|=2048,Ho(9,Ux.bind(null,n,s,r,e),void 0,null),r},useId:function(){var t=wn(),e=$t.identifierPrefix;if(pt){var r=ti,n=ei;r=(n&~(1<<32-pn(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=Go++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=yL++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},wL={readContext:Zr,useCallback:Kx,useContext:Zr,useEffect:Wp,useImperativeHandle:Wx,useInsertionEffect:Gx,useLayoutEffect:zx,useMemo:Yx,useReducer:Kd,useRef:Vx,useState:function(){return Kd(zo)},useDebugValue:Kp,useDeferredValue:function(t){var e=Qr();return qx(e,Pt.memoizedState,t)},useTransition:function(){var t=Kd(zo)[0],e=Qr().memoizedState;return[t,e]},useMutableSource:Mx,useSyncExternalStore:Nx,useId:Xx,unstable_isNewReconciler:!1},bL={readContext:Zr,useCallback:Kx,useContext:Zr,useEffect:Wp,useImperativeHandle:Wx,useInsertionEffect:Gx,useLayoutEffect:zx,useMemo:Yx,useReducer:Yd,useRef:Vx,useState:function(){return Yd(zo)},useDebugValue:Kp,useDeferredValue:function(t){var e=Qr();return Pt===null?e.memoizedState=t:qx(e,Pt.memoizedState,t)},useTransition:function(){var t=Yd(zo)[0],e=Qr().memoizedState;return[t,e]},useMutableSource:Mx,useSyncExternalStore:Nx,useId:Xx,unstable_isNewReconciler:!1};function on(t,e){if(t&&t.defaultProps){e=Et({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function gh(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:Et({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var rd={isMounted:function(t){return(t=t._reactInternals)?As(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=lr(),i=Ni(t),s=ii(n,i);s.payload=e,r!=null&&(s.callback=r),e=Oi(t,s,i),e!==null&&(mn(e,t,i,n),vu(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=lr(),i=Ni(t),s=ii(n,i);s.tag=1,s.payload=e,r!=null&&(s.callback=r),e=Oi(t,s,i),e!==null&&(mn(e,t,i,n),vu(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=lr(),n=Ni(t),i=ii(r,n);i.tag=2,e!=null&&(i.callback=e),e=Oi(t,i,n),e!==null&&(mn(e,t,n,r),vu(e,t,n))}};function Gg(t,e,r,n,i,s,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,s,a):e.prototype&&e.prototype.isPureReactComponent?!Fo(r,n)||!Fo(i,s):!0}function eS(t,e,r){var n=!1,i=Bi,s=e.contextType;return typeof s=="object"&&s!==null?s=Zr(s):(i=Er(e)?ps:er.current,n=e.contextTypes,s=(n=n!=null)?ma(t,i):Bi),e=new e(r,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=rd,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function zg(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&rd.enqueueReplaceState(e,e.state,null)}function vh(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs={},Bp(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Zr(s):(s=Er(e)?ps:er.current,i.context=ma(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(gh(t,e,s,r),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&rd.enqueueReplaceState(i,i.state,null),nc(t,r,i,n),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function xa(t,e){try{var r="",n=e;do r+=Qb(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function qd(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function yh(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var LL=typeof WeakMap=="function"?WeakMap:Map;function tS(t,e,r){r=ii(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){lc||(lc=!0,Ch=n),yh(t,e)},r}function rS(t,e,r){r=ii(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;r.payload=function(){return n(i)},r.callback=function(){yh(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){yh(t,e),typeof n!="function"&&(Mi===null?Mi=new Set([this]):Mi.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),r}function Hg(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new LL;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(i.add(r),t=BL.bind(null,t,e,r),e.then(t,t))}function Wg(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Kg(t,e,r,n,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=ii(-1,1),e.tag=2,Oi(r,e,1))),r.lanes|=1),t)}var AL=fi.ReactCurrentOwner,xr=!1;function sr(t,e,r,n){e.child=t===null?kx(e,null,r,n):va(e,t.child,r,n)}function Yg(t,e,r,n,i){r=r.render;var s=e.ref;return aa(e,i),n=zp(t,e,r,n,s,i),r=Hp(),t!==null&&!xr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,ui(t,e,i)):(pt&&r&&Dp(e),e.flags|=1,sr(t,e,n,i),e.child)}function qg(t,e,r,n,i){if(t===null){var s=r.type;return typeof s=="function"&&!tm(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=s,nS(t,e,s,n,i)):(t=wu(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var a=s.memoizedProps;if(r=r.compare,r=r!==null?r:Fo,r(a,n)&&t.ref===e.ref)return ui(t,e,i)}return e.flags|=1,t=Fi(s,n),t.ref=e.ref,t.return=e,e.child=t}function nS(t,e,r,n,i){if(t!==null){var s=t.memoizedProps;if(Fo(s,n)&&t.ref===e.ref)if(xr=!1,e.pendingProps=n=s,(t.lanes&i)!==0)t.flags&131072&&(xr=!0);else return e.lanes=t.lanes,ui(t,e,i)}return xh(t,e,r,n,i)}function iS(t,e,r){var n=e.pendingProps,i=n.children,s=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},lt(Zs,Cr),Cr|=r;else{if(!(r&1073741824))return t=s!==null?s.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,lt(Zs,Cr),Cr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,lt(Zs,Cr),Cr|=n}else s!==null?(n=s.baseLanes|r,e.memoizedState=null):n=r,lt(Zs,Cr),Cr|=n;return sr(t,e,i,r),e.child}function sS(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function xh(t,e,r,n,i){var s=Er(r)?ps:er.current;return s=ma(e,s),aa(e,i),r=zp(t,e,r,n,s,i),n=Hp(),t!==null&&!xr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,ui(t,e,i)):(pt&&n&&Dp(e),e.flags|=1,sr(t,e,r,i),e.child)}function Xg(t,e,r,n,i){if(Er(r)){var s=!0;Qu(e)}else s=!1;if(aa(e,i),e.stateNode===null)Su(t,e),eS(e,r,n),vh(e,r,n,i),n=!0;else if(t===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,u=r.contextType;typeof u=="object"&&u!==null?u=Zr(u):(u=Er(r)?ps:er.current,u=ma(e,u));var c=r.getDerivedStateFromProps,d=typeof c=="function"||typeof a.getSnapshotBeforeUpdate=="function";d||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||l!==u)&&zg(e,a,n,u),Ei=!1;var f=e.memoizedState;a.state=f,nc(e,n,a,i),l=e.memoizedState,o!==n||f!==l||Sr.current||Ei?(typeof c=="function"&&(gh(e,r,c,n),l=e.memoizedState),(o=Ei||Gg(e,r,o,n,f,l,u))?(d||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),a.props=n,a.state=l,a.context=u,n=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{a=e.stateNode,Px(t,e),o=e.memoizedProps,u=e.type===e.elementType?o:on(e.type,o),a.props=u,d=e.pendingProps,f=a.context,l=r.contextType,typeof l=="object"&&l!==null?l=Zr(l):(l=Er(r)?ps:er.current,l=ma(e,l));var m=r.getDerivedStateFromProps;(c=typeof m=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==d||f!==l)&&zg(e,a,n,l),Ei=!1,f=e.memoizedState,a.state=f,nc(e,n,a,i);var h=e.memoizedState;o!==d||f!==h||Sr.current||Ei?(typeof m=="function"&&(gh(e,r,m,n),h=e.memoizedState),(u=Ei||Gg(e,r,u,n,f,h,l)||!1)?(c||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,h,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,h,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=h),a.props=n,a.state=h,a.context=l,n=u):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),n=!1)}return Sh(t,e,r,n,s,i)}function Sh(t,e,r,n,i,s){sS(t,e);var a=(e.flags&128)!==0;if(!n&&!a)return i&&Mg(e,r,!1),ui(t,e,s);n=e.stateNode,AL.current=e;var o=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&a?(e.child=va(e,t.child,null,s),e.child=va(e,null,o,s)):sr(t,e,o,s),e.memoizedState=n.state,i&&Mg(e,r,!0),e.child}function aS(t){var e=t.stateNode;e.pendingContext?Og(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Og(t,e.context,!1),$p(t,e.containerInfo)}function Zg(t,e,r,n,i){return ga(),Op(i),e.flags|=256,sr(t,e,r,n),e.child}var Eh={dehydrated:null,treeContext:null,retryLane:0};function Th(t){return{baseLanes:t,cachePool:null,transitions:null}}function oS(t,e,r){var n=e.pendingProps,i=xt.current,s=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=t!==null&&t.memoizedState===null?!1:(i&2)!==0),o?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),lt(xt,i&1),t===null)return ph(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=n.children,t=n.fallback,s?(n=e.mode,s=e.child,a={mode:"hidden",children:a},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=sd(a,n,0,null),t=us(t,n,r,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Th(r),e.memoizedState=Eh,t):Yp(e,a));if(i=t.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return _L(t,e,a,n,o,i,r);if(s){s=n.fallback,a=e.mode,i=t.child,o=i.sibling;var l={mode:"hidden",children:n.children};return!(a&1)&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=Fi(i,l),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=Fi(o,s):(s=us(s,a,r,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,a=t.child.memoizedState,a=a===null?Th(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=t.childLanes&~r,e.memoizedState=Eh,n}return s=t.child,t=s.sibling,n=Fi(s,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function Yp(t,e){return e=sd({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Wl(t,e,r,n){return n!==null&&Op(n),va(e,t.child,null,r),t=Yp(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function _L(t,e,r,n,i,s,a){if(r)return e.flags&256?(e.flags&=-257,n=qd(Error(Q(422))),Wl(t,e,a,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=n.fallback,i=e.mode,n=sd({mode:"visible",children:n.children},i,0,null),s=us(s,i,a,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,e.mode&1&&va(e,t.child,null,a),e.child.memoizedState=Th(a),e.memoizedState=Eh,s);if(!(e.mode&1))return Wl(t,e,a,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(Q(419)),n=qd(s,n,void 0),Wl(t,e,a,n)}if(o=(a&t.childLanes)!==0,xr||o){if(n=$t,n!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,li(t,i),mn(n,t,i,-1))}return em(),n=qd(Error(Q(421))),Wl(t,e,a,n)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=$L.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Dr=Pi(i.nextSibling),Or=e,pt=!0,cn=null,t!==null&&(Kr[Yr++]=ei,Kr[Yr++]=ti,Kr[Yr++]=ms,ei=t.id,ti=t.overflow,ms=e),e=Yp(e,n.children),e.flags|=4096,e)}function Qg(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),mh(t.return,e,r)}function Xd(t,e,r,n,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function lS(t,e,r){var n=e.pendingProps,i=n.revealOrder,s=n.tail;if(sr(t,e,n.children,r),n=xt.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Qg(t,r,e);else if(t.tag===19)Qg(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(lt(xt,n),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&ic(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),Xd(e,!1,i,r,s);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&ic(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}Xd(e,!0,r,null,s);break;case"together":Xd(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Su(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function ui(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),vs|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Q(153));if(e.child!==null){for(t=e.child,r=Fi(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=Fi(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function CL(t,e,r){switch(e.tag){case 3:aS(e),ga();break;case 5:Ox(e);break;case 1:Er(e.type)&&Qu(e);break;case 4:$p(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;lt(tc,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(lt(xt,xt.current&1),e.flags|=128,null):r&e.child.childLanes?oS(t,e,r):(lt(xt,xt.current&1),t=ui(t,e,r),t!==null?t.sibling:null);lt(xt,xt.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return lS(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),lt(xt,xt.current),n)break;return null;case 22:case 23:return e.lanes=0,iS(t,e,r)}return ui(t,e,r)}var uS,wh,cS,dS;uS=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};wh=function(){};cS=function(t,e,r,n){var i=t.memoizedProps;if(i!==n){t=e.stateNode,is(On.current);var s=null;switch(r){case"input":i=Hf(t,i),n=Hf(t,n),s=[];break;case"select":i=Et({},i,{value:void 0}),n=Et({},n,{value:void 0}),s=[];break;case"textarea":i=Yf(t,i),n=Yf(t,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=Xu)}Xf(r,n);var a;r=null;for(u in i)if(!n.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var o=i[u];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Io.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var l=n[u];if(o=i!=null?i[u]:void 0,n.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(r||(r={}),r[a]=l[a])}else r||(s||(s=[]),s.push(u,r)),r=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Io.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&dt("scroll",t),s||o===l||(s=[])):(s=s||[]).push(u,l))}r&&(s=s||[]).push("style",r);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};dS=function(t,e,r,n){r!==n&&(e.flags|=4)};function qa(t,e){if(!pt)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function Yt(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function RL(t,e,r){var n=e.pendingProps;switch(Pp(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Yt(e),null;case 1:return Er(e.type)&&Zu(),Yt(e),null;case 3:return n=e.stateNode,ya(),ft(Sr),ft(er),Vp(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(zl(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,cn!==null&&(kh(cn),cn=null))),wh(t,e),Yt(e),null;case 5:jp(e);var i=is(Vo.current);if(r=e.type,t!==null&&e.stateNode!=null)cS(t,e,r,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(Q(166));return Yt(e),null}if(t=is(On.current),zl(e)){n=e.stateNode,r=e.type;var s=e.memoizedProps;switch(n[An]=e,n[$o]=s,t=(e.mode&1)!==0,r){case"dialog":dt("cancel",n),dt("close",n);break;case"iframe":case"object":case"embed":dt("load",n);break;case"video":case"audio":for(i=0;i<lo.length;i++)dt(lo[i],n);break;case"source":dt("error",n);break;case"img":case"image":case"link":dt("error",n),dt("load",n);break;case"details":dt("toggle",n);break;case"input":og(n,s),dt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},dt("invalid",n);break;case"textarea":ug(n,s),dt("invalid",n)}Xf(r,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&Gl(n.textContent,o,t),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&Gl(n.textContent,o,t),i=["children",""+o]):Io.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&dt("scroll",n)}switch(r){case"input":Ml(n),lg(n,s,!0);break;case"textarea":Ml(n),cg(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Xu)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=By(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=a.createElement(r,{is:n.is}):(t=a.createElement(r),r==="select"&&(a=t,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):t=a.createElementNS(t,r),t[An]=e,t[$o]=n,uS(t,e,!1,!1),e.stateNode=t;e:{switch(a=Zf(r,n),r){case"dialog":dt("cancel",t),dt("close",t),i=n;break;case"iframe":case"object":case"embed":dt("load",t),i=n;break;case"video":case"audio":for(i=0;i<lo.length;i++)dt(lo[i],t);i=n;break;case"source":dt("error",t),i=n;break;case"img":case"image":case"link":dt("error",t),dt("load",t),i=n;break;case"details":dt("toggle",t),i=n;break;case"input":og(t,n),i=Hf(t,n),dt("invalid",t);break;case"option":i=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},i=Et({},n,{value:void 0}),dt("invalid",t);break;case"textarea":ug(t,n),i=Yf(t,n),dt("invalid",t);break;default:i=n}Xf(r,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?Vy(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&$y(t,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&ko(t,l):typeof l=="number"&&ko(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Io.hasOwnProperty(s)?l!=null&&s==="onScroll"&&dt("scroll",t):l!=null&&yp(t,s,l,a))}switch(r){case"input":Ml(t),lg(t,n,!1);break;case"textarea":Ml(t),cg(t);break;case"option":n.value!=null&&t.setAttribute("value",""+Ui(n.value));break;case"select":t.multiple=!!n.multiple,s=n.value,s!=null?ra(t,!!n.multiple,s,!1):n.defaultValue!=null&&ra(t,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Xu)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Yt(e),null;case 6:if(t&&e.stateNode!=null)dS(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(Q(166));if(r=is(Vo.current),is(On.current),zl(e)){if(n=e.stateNode,r=e.memoizedProps,n[An]=e,(s=n.nodeValue!==r)&&(t=Or,t!==null))switch(t.tag){case 3:Gl(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Gl(n.nodeValue,r,(t.mode&1)!==0)}s&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[An]=e,e.stateNode=n}return Yt(e),null;case 13:if(ft(xt),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(pt&&Dr!==null&&e.mode&1&&!(e.flags&128))Rx(),ga(),e.flags|=98560,s=!1;else if(s=zl(e),n!==null&&n.dehydrated!==null){if(t===null){if(!s)throw Error(Q(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Q(317));s[An]=e}else ga(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Yt(e),s=!1}else cn!==null&&(kh(cn),cn=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||xt.current&1?Ot===0&&(Ot=3):em())),e.updateQueue!==null&&(e.flags|=4),Yt(e),null);case 4:return ya(),wh(t,e),t===null&&Uo(e.stateNode.containerInfo),Yt(e),null;case 10:return Fp(e.type._context),Yt(e),null;case 17:return Er(e.type)&&Zu(),Yt(e),null;case 19:if(ft(xt),s=e.memoizedState,s===null)return Yt(e),null;if(n=(e.flags&128)!==0,a=s.rendering,a===null)if(n)qa(s,!1);else{if(Ot!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=ic(t),a!==null){for(e.flags|=128,qa(s,!1),n=a.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)s=r,t=n,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,t=a.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return lt(xt,xt.current&1|2),e.child}t=t.sibling}s.tail!==null&&Lt()>Sa&&(e.flags|=128,n=!0,qa(s,!1),e.lanes=4194304)}else{if(!n)if(t=ic(a),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),qa(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!pt)return Yt(e),null}else 2*Lt()-s.renderingStartTime>Sa&&r!==1073741824&&(e.flags|=128,n=!0,qa(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(r=s.last,r!==null?r.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Lt(),e.sibling=null,r=xt.current,lt(xt,n?r&1|2:r&1),e):(Yt(e),null);case 22:case 23:return Jp(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?Cr&1073741824&&(Yt(e),e.subtreeFlags&6&&(e.flags|=8192)):Yt(e),null;case 24:return null;case 25:return null}throw Error(Q(156,e.tag))}function IL(t,e){switch(Pp(e),e.tag){case 1:return Er(e.type)&&Zu(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return ya(),ft(Sr),ft(er),Vp(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return jp(e),null;case 13:if(ft(xt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Q(340));ga()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return ft(xt),null;case 4:return ya(),null;case 10:return Fp(e.type._context),null;case 22:case 23:return Jp(),null;case 24:return null;default:return null}}var Kl=!1,Qt=!1,kL=typeof WeakSet=="function"?WeakSet:Set,he=null;function Xs(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){wt(t,e,n)}else r.current=null}function bh(t,e,r){try{r()}catch(n){wt(t,e,n)}}var Jg=!1;function DL(t,e){if(oh=Ku,t=gx(),kp(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var a=0,o=-1,l=-1,u=0,c=0,d=t,f=null;t:for(;;){for(var m;d!==r||i!==0&&d.nodeType!==3||(o=a+i),d!==s||n!==0&&d.nodeType!==3||(l=a+n),d.nodeType===3&&(a+=d.nodeValue.length),(m=d.firstChild)!==null;)f=d,d=m;for(;;){if(d===t)break t;if(f===r&&++u===i&&(o=a),f===s&&++c===n&&(l=a),(m=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=m}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(lh={focusedElem:t,selectionRange:r},Ku=!1,he=e;he!==null;)if(e=he,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,he=t;else for(;he!==null;){e=he;try{var h=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(h!==null){var p=h.memoizedProps,v=h.memoizedState,g=e.stateNode,y=g.getSnapshotBeforeUpdate(e.elementType===e.type?p:on(e.type,p),v);g.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var x=e.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Q(163))}}catch(S){wt(e,e.return,S)}if(t=e.sibling,t!==null){t.return=e.return,he=t;break}he=e.return}return h=Jg,Jg=!1,h}function So(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&bh(e,r,s)}i=i.next}while(i!==n)}}function nd(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function Lh(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function fS(t){var e=t.alternate;e!==null&&(t.alternate=null,fS(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[An],delete e[$o],delete e[dh],delete e[pL],delete e[mL])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function hS(t){return t.tag===5||t.tag===3||t.tag===4}function e0(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||hS(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Ah(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=Xu));else if(n!==4&&(t=t.child,t!==null))for(Ah(t,e,r),t=t.sibling;t!==null;)Ah(t,e,r),t=t.sibling}function _h(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(_h(t,e,r),t=t.sibling;t!==null;)_h(t,e,r),t=t.sibling}var Gt=null,ln=!1;function mi(t,e,r){for(r=r.child;r!==null;)pS(t,e,r),r=r.sibling}function pS(t,e,r){if(Pn&&typeof Pn.onCommitFiberUnmount=="function")try{Pn.onCommitFiberUnmount(qc,r)}catch{}switch(r.tag){case 5:Qt||Xs(r,e);case 6:var n=Gt,i=ln;Gt=null,mi(t,e,r),Gt=n,ln=i,Gt!==null&&(ln?(t=Gt,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):Gt.removeChild(r.stateNode));break;case 18:Gt!==null&&(ln?(t=Gt,r=r.stateNode,t.nodeType===8?Gd(t.parentNode,r):t.nodeType===1&&Gd(t,r),Mo(t)):Gd(Gt,r.stateNode));break;case 4:n=Gt,i=ln,Gt=r.stateNode.containerInfo,ln=!0,mi(t,e,r),Gt=n,ln=i;break;case 0:case 11:case 14:case 15:if(!Qt&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&bh(r,e,a),i=i.next}while(i!==n)}mi(t,e,r);break;case 1:if(!Qt&&(Xs(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){wt(r,e,o)}mi(t,e,r);break;case 21:mi(t,e,r);break;case 22:r.mode&1?(Qt=(n=Qt)||r.memoizedState!==null,mi(t,e,r),Qt=n):mi(t,e,r);break;default:mi(t,e,r)}}function t0(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new kL),e.forEach(function(n){var i=jL.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}}function nn(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=t,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:Gt=o.stateNode,ln=!1;break e;case 3:Gt=o.stateNode.containerInfo,ln=!0;break e;case 4:Gt=o.stateNode.containerInfo,ln=!0;break e}o=o.return}if(Gt===null)throw Error(Q(160));pS(s,a,i),Gt=null,ln=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){wt(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)mS(e,t),e=e.sibling}function mS(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(nn(e,t),En(t),n&4){try{So(3,t,t.return),nd(3,t)}catch(p){wt(t,t.return,p)}try{So(5,t,t.return)}catch(p){wt(t,t.return,p)}}break;case 1:nn(e,t),En(t),n&512&&r!==null&&Xs(r,r.return);break;case 5:if(nn(e,t),En(t),n&512&&r!==null&&Xs(r,r.return),t.flags&32){var i=t.stateNode;try{ko(i,"")}catch(p){wt(t,t.return,p)}}if(n&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,a=r!==null?r.memoizedProps:s,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&Fy(i,s),Zf(o,a);var u=Zf(o,s);for(a=0;a<l.length;a+=2){var c=l[a],d=l[a+1];c==="style"?Vy(i,d):c==="dangerouslySetInnerHTML"?$y(i,d):c==="children"?ko(i,d):yp(i,c,d,u)}switch(o){case"input":Wf(i,s);break;case"textarea":Uy(i,s);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var m=s.value;m!=null?ra(i,!!s.multiple,m,!1):f!==!!s.multiple&&(s.defaultValue!=null?ra(i,!!s.multiple,s.defaultValue,!0):ra(i,!!s.multiple,s.multiple?[]:"",!1))}i[$o]=s}catch(p){wt(t,t.return,p)}}break;case 6:if(nn(e,t),En(t),n&4){if(t.stateNode===null)throw Error(Q(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(p){wt(t,t.return,p)}}break;case 3:if(nn(e,t),En(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Mo(e.containerInfo)}catch(p){wt(t,t.return,p)}break;case 4:nn(e,t),En(t);break;case 13:nn(e,t),En(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Zp=Lt())),n&4&&t0(t);break;case 22:if(c=r!==null&&r.memoizedState!==null,t.mode&1?(Qt=(u=Qt)||c,nn(e,t),Qt=u):nn(e,t),En(t),n&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!c&&t.mode&1)for(he=t,c=t.child;c!==null;){for(d=he=c;he!==null;){switch(f=he,m=f.child,f.tag){case 0:case 11:case 14:case 15:So(4,f,f.return);break;case 1:Xs(f,f.return);var h=f.stateNode;if(typeof h.componentWillUnmount=="function"){n=f,r=f.return;try{e=n,h.props=e.memoizedProps,h.state=e.memoizedState,h.componentWillUnmount()}catch(p){wt(n,r,p)}}break;case 5:Xs(f,f.return);break;case 22:if(f.memoizedState!==null){n0(d);continue}}m!==null?(m.return=f,he=m):n0(d)}c=c.sibling}e:for(c=null,d=t;;){if(d.tag===5){if(c===null){c=d;try{i=d.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=d.stateNode,l=d.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=jy("display",a))}catch(p){wt(t,t.return,p)}}}else if(d.tag===6){if(c===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(p){wt(t,t.return,p)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;c===d&&(c=null),d=d.return}c===d&&(c=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:nn(e,t),En(t),n&4&&t0(t);break;case 21:break;default:nn(e,t),En(t)}}function En(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(hS(r)){var n=r;break e}r=r.return}throw Error(Q(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(ko(i,""),n.flags&=-33);var s=e0(t);_h(t,s,i);break;case 3:case 4:var a=n.stateNode.containerInfo,o=e0(t);Ah(t,o,a);break;default:throw Error(Q(161))}}catch(l){wt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function PL(t,e,r){he=t,gS(t)}function gS(t,e,r){for(var n=(t.mode&1)!==0;he!==null;){var i=he,s=i.child;if(i.tag===22&&n){var a=i.memoizedState!==null||Kl;if(!a){var o=i.alternate,l=o!==null&&o.memoizedState!==null||Qt;o=Kl;var u=Qt;if(Kl=a,(Qt=l)&&!u)for(he=i;he!==null;)a=he,l=a.child,a.tag===22&&a.memoizedState!==null?i0(i):l!==null?(l.return=a,he=l):i0(i);for(;s!==null;)he=s,gS(s),s=s.sibling;he=i,Kl=o,Qt=u}r0(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,he=s):r0(t)}}function r0(t){for(;he!==null;){var e=he;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Qt||nd(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!Qt)if(r===null)n.componentDidMount();else{var i=e.elementType===e.type?r.memoizedProps:on(e.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&$g(e,s,n);break;case 3:var a=e.updateQueue;if(a!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}$g(e,a,r)}break;case 5:var o=e.stateNode;if(r===null&&e.flags&4){r=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var d=c.dehydrated;d!==null&&Mo(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Q(163))}Qt||e.flags&512&&Lh(e)}catch(f){wt(e,e.return,f)}}if(e===t){he=null;break}if(r=e.sibling,r!==null){r.return=e.return,he=r;break}he=e.return}}function n0(t){for(;he!==null;){var e=he;if(e===t){he=null;break}var r=e.sibling;if(r!==null){r.return=e.return,he=r;break}he=e.return}}function i0(t){for(;he!==null;){var e=he;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{nd(4,e)}catch(l){wt(e,r,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(l){wt(e,i,l)}}var s=e.return;try{Lh(e)}catch(l){wt(e,s,l)}break;case 5:var a=e.return;try{Lh(e)}catch(l){wt(e,a,l)}}}catch(l){wt(e,e.return,l)}if(e===t){he=null;break}var o=e.sibling;if(o!==null){o.return=e.return,he=o;break}he=e.return}}var OL=Math.ceil,oc=fi.ReactCurrentDispatcher,qp=fi.ReactCurrentOwner,Xr=fi.ReactCurrentBatchConfig,Ye=0,$t=null,Ct=null,Ht=0,Cr=0,Zs=Hi(0),Ot=0,Wo=null,vs=0,id=0,Xp=0,Eo=null,vr=null,Zp=0,Sa=1/0,Xn=null,lc=!1,Ch=null,Mi=null,Yl=!1,Ci=null,uc=0,To=0,Rh=null,Eu=-1,Tu=0;function lr(){return Ye&6?Lt():Eu!==-1?Eu:Eu=Lt()}function Ni(t){return t.mode&1?Ye&2&&Ht!==0?Ht&-Ht:vL.transition!==null?(Tu===0&&(Tu=ex()),Tu):(t=et,t!==0||(t=window.event,t=t===void 0?16:ox(t.type)),t):1}function mn(t,e,r,n){if(50<To)throw To=0,Rh=null,Error(Q(185));gl(t,r,n),(!(Ye&2)||t!==$t)&&(t===$t&&(!(Ye&2)&&(id|=r),Ot===4&&bi(t,Ht)),Tr(t,n),r===1&&Ye===0&&!(e.mode&1)&&(Sa=Lt()+500,ed&&Wi()))}function Tr(t,e){var r=t.callbackNode;v1(t,e);var n=Wu(t,t===$t?Ht:0);if(n===0)r!==null&&hg(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&hg(r),e===1)t.tag===0?gL(s0.bind(null,t)):Ax(s0.bind(null,t)),fL(function(){!(Ye&6)&&Wi()}),r=null;else{switch(tx(n)){case 1:r=wp;break;case 4:r=Qy;break;case 16:r=Hu;break;case 536870912:r=Jy;break;default:r=Hu}r=bS(r,vS.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function vS(t,e){if(Eu=-1,Tu=0,Ye&6)throw Error(Q(327));var r=t.callbackNode;if(oa()&&t.callbackNode!==r)return null;var n=Wu(t,t===$t?Ht:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=cc(t,n);else{e=n;var i=Ye;Ye|=2;var s=xS();($t!==t||Ht!==e)&&(Xn=null,Sa=Lt()+500,ls(t,e));do try{FL();break}catch(o){yS(t,o)}while(!0);Np(),oc.current=s,Ye=i,Ct!==null?e=0:($t=null,Ht=0,e=Ot)}if(e!==0){if(e===2&&(i=rh(t),i!==0&&(n=i,e=Ih(t,i))),e===1)throw r=Wo,ls(t,0),bi(t,n),Tr(t,Lt()),r;if(e===6)bi(t,n);else{if(i=t.current.alternate,!(n&30)&&!ML(i)&&(e=cc(t,n),e===2&&(s=rh(t),s!==0&&(n=s,e=Ih(t,s))),e===1))throw r=Wo,ls(t,0),bi(t,n),Tr(t,Lt()),r;switch(t.finishedWork=i,t.finishedLanes=n,e){case 0:case 1:throw Error(Q(345));case 2:Ji(t,vr,Xn);break;case 3:if(bi(t,n),(n&130023424)===n&&(e=Zp+500-Lt(),10<e)){if(Wu(t,0)!==0)break;if(i=t.suspendedLanes,(i&n)!==n){lr(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=ch(Ji.bind(null,t,vr,Xn),e);break}Ji(t,vr,Xn);break;case 4:if(bi(t,n),(n&4194240)===n)break;for(e=t.eventTimes,i=-1;0<n;){var a=31-pn(n);s=1<<a,a=e[a],a>i&&(i=a),n&=~s}if(n=i,n=Lt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*OL(n/1960))-n,10<n){t.timeoutHandle=ch(Ji.bind(null,t,vr,Xn),n);break}Ji(t,vr,Xn);break;case 5:Ji(t,vr,Xn);break;default:throw Error(Q(329))}}}return Tr(t,Lt()),t.callbackNode===r?vS.bind(null,t):null}function Ih(t,e){var r=Eo;return t.current.memoizedState.isDehydrated&&(ls(t,e).flags|=256),t=cc(t,e),t!==2&&(e=vr,vr=r,e!==null&&kh(e)),t}function kh(t){vr===null?vr=t:vr.push.apply(vr,t)}function ML(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!vn(s(),i))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function bi(t,e){for(e&=~Xp,e&=~id,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-pn(e),n=1<<r;t[r]=-1,e&=~n}}function s0(t){if(Ye&6)throw Error(Q(327));oa();var e=Wu(t,0);if(!(e&1))return Tr(t,Lt()),null;var r=cc(t,e);if(t.tag!==0&&r===2){var n=rh(t);n!==0&&(e=n,r=Ih(t,n))}if(r===1)throw r=Wo,ls(t,0),bi(t,e),Tr(t,Lt()),r;if(r===6)throw Error(Q(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ji(t,vr,Xn),Tr(t,Lt()),null}function Qp(t,e){var r=Ye;Ye|=1;try{return t(e)}finally{Ye=r,Ye===0&&(Sa=Lt()+500,ed&&Wi())}}function ys(t){Ci!==null&&Ci.tag===0&&!(Ye&6)&&oa();var e=Ye;Ye|=1;var r=Xr.transition,n=et;try{if(Xr.transition=null,et=1,t)return t()}finally{et=n,Xr.transition=r,Ye=e,!(Ye&6)&&Wi()}}function Jp(){Cr=Zs.current,ft(Zs)}function ls(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,dL(r)),Ct!==null)for(r=Ct.return;r!==null;){var n=r;switch(Pp(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Zu();break;case 3:ya(),ft(Sr),ft(er),Vp();break;case 5:jp(n);break;case 4:ya();break;case 13:ft(xt);break;case 19:ft(xt);break;case 10:Fp(n.type._context);break;case 22:case 23:Jp()}r=r.return}if($t=t,Ct=t=Fi(t.current,null),Ht=Cr=e,Ot=0,Wo=null,Xp=id=vs=0,vr=Eo=null,ns!==null){for(e=0;e<ns.length;e++)if(r=ns[e],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var a=s.next;s.next=i,n.next=a}r.pending=n}ns=null}return t}function yS(t,e){do{var r=Ct;try{if(Np(),yu.current=ac,sc){for(var n=St.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}sc=!1}if(gs=0,Ut=Pt=St=null,xo=!1,Go=0,qp.current=null,r===null||r.return===null){Ot=1,Wo=e,Ct=null;break}e:{var s=t,a=r.return,o=r,l=e;if(e=Ht,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=o,d=c.tag;if(!(c.mode&1)&&(d===0||d===11||d===15)){var f=c.alternate;f?(c.updateQueue=f.updateQueue,c.memoizedState=f.memoizedState,c.lanes=f.lanes):(c.updateQueue=null,c.memoizedState=null)}var m=Wg(a);if(m!==null){m.flags&=-257,Kg(m,a,o,s,e),m.mode&1&&Hg(s,u,e),e=m,l=u;var h=e.updateQueue;if(h===null){var p=new Set;p.add(l),e.updateQueue=p}else h.add(l);break e}else{if(!(e&1)){Hg(s,u,e),em();break e}l=Error(Q(426))}}else if(pt&&o.mode&1){var v=Wg(a);if(v!==null){!(v.flags&65536)&&(v.flags|=256),Kg(v,a,o,s,e),Op(xa(l,o));break e}}s=l=xa(l,o),Ot!==4&&(Ot=2),Eo===null?Eo=[s]:Eo.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var g=tS(s,l,e);Bg(s,g);break e;case 1:o=l;var y=s.type,x=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(Mi===null||!Mi.has(x)))){s.flags|=65536,e&=-e,s.lanes|=e;var S=rS(s,o,e);Bg(s,S);break e}}s=s.return}while(s!==null)}ES(r)}catch(T){e=T,Ct===r&&r!==null&&(Ct=r=r.return);continue}break}while(!0)}function xS(){var t=oc.current;return oc.current=ac,t===null?ac:t}function em(){(Ot===0||Ot===3||Ot===2)&&(Ot=4),$t===null||!(vs&268435455)&&!(id&268435455)||bi($t,Ht)}function cc(t,e){var r=Ye;Ye|=2;var n=xS();($t!==t||Ht!==e)&&(Xn=null,ls(t,e));do try{NL();break}catch(i){yS(t,i)}while(!0);if(Np(),Ye=r,oc.current=n,Ct!==null)throw Error(Q(261));return $t=null,Ht=0,Ot}function NL(){for(;Ct!==null;)SS(Ct)}function FL(){for(;Ct!==null&&!l1();)SS(Ct)}function SS(t){var e=wS(t.alternate,t,Cr);t.memoizedProps=t.pendingProps,e===null?ES(t):Ct=e,qp.current=null}function ES(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=IL(r,e),r!==null){r.flags&=32767,Ct=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Ot=6,Ct=null;return}}else if(r=RL(r,e,Cr),r!==null){Ct=r;return}if(e=e.sibling,e!==null){Ct=e;return}Ct=e=t}while(e!==null);Ot===0&&(Ot=5)}function Ji(t,e,r){var n=et,i=Xr.transition;try{Xr.transition=null,et=1,UL(t,e,r,n)}finally{Xr.transition=i,et=n}return null}function UL(t,e,r,n){do oa();while(Ci!==null);if(Ye&6)throw Error(Q(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(Q(177));t.callbackNode=null,t.callbackPriority=0;var s=r.lanes|r.childLanes;if(y1(t,s),t===$t&&(Ct=$t=null,Ht=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Yl||(Yl=!0,bS(Hu,function(){return oa(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Xr.transition,Xr.transition=null;var a=et;et=1;var o=Ye;Ye|=4,qp.current=null,DL(t,r),mS(r,t),iL(lh),Ku=!!oh,lh=oh=null,t.current=r,PL(r),u1(),Ye=o,et=a,Xr.transition=s}else t.current=r;if(Yl&&(Yl=!1,Ci=t,uc=i),s=t.pendingLanes,s===0&&(Mi=null),f1(r.stateNode),Tr(t,Lt()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)i=e[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(lc)throw lc=!1,t=Ch,Ch=null,t;return uc&1&&t.tag!==0&&oa(),s=t.pendingLanes,s&1?t===Rh?To++:(To=0,Rh=t):To=0,Wi(),null}function oa(){if(Ci!==null){var t=tx(uc),e=Xr.transition,r=et;try{if(Xr.transition=null,et=16>t?16:t,Ci===null)var n=!1;else{if(t=Ci,Ci=null,uc=0,Ye&6)throw Error(Q(331));var i=Ye;for(Ye|=4,he=t.current;he!==null;){var s=he,a=s.child;if(he.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(he=u;he!==null;){var c=he;switch(c.tag){case 0:case 11:case 15:So(8,c,s)}var d=c.child;if(d!==null)d.return=c,he=d;else for(;he!==null;){c=he;var f=c.sibling,m=c.return;if(fS(c),c===u){he=null;break}if(f!==null){f.return=m,he=f;break}he=m}}}var h=s.alternate;if(h!==null){var p=h.child;if(p!==null){h.child=null;do{var v=p.sibling;p.sibling=null,p=v}while(p!==null)}}he=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,he=a;else e:for(;he!==null;){if(s=he,s.flags&2048)switch(s.tag){case 0:case 11:case 15:So(9,s,s.return)}var g=s.sibling;if(g!==null){g.return=s.return,he=g;break e}he=s.return}}var y=t.current;for(he=y;he!==null;){a=he;var x=a.child;if(a.subtreeFlags&2064&&x!==null)x.return=a,he=x;else e:for(a=y;he!==null;){if(o=he,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:nd(9,o)}}catch(T){wt(o,o.return,T)}if(o===a){he=null;break e}var S=o.sibling;if(S!==null){S.return=o.return,he=S;break e}he=o.return}}if(Ye=i,Wi(),Pn&&typeof Pn.onPostCommitFiberRoot=="function")try{Pn.onPostCommitFiberRoot(qc,t)}catch{}n=!0}return n}finally{et=r,Xr.transition=e}}return!1}function a0(t,e,r){e=xa(r,e),e=tS(t,e,1),t=Oi(t,e,1),e=lr(),t!==null&&(gl(t,1,e),Tr(t,e))}function wt(t,e,r){if(t.tag===3)a0(t,t,r);else for(;e!==null;){if(e.tag===3){a0(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Mi===null||!Mi.has(n))){t=xa(r,t),t=rS(e,t,1),e=Oi(e,t,1),t=lr(),e!==null&&(gl(e,1,t),Tr(e,t));break}}e=e.return}}function BL(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=lr(),t.pingedLanes|=t.suspendedLanes&r,$t===t&&(Ht&r)===r&&(Ot===4||Ot===3&&(Ht&130023424)===Ht&&500>Lt()-Zp?ls(t,0):Xp|=r),Tr(t,e)}function TS(t,e){e===0&&(t.mode&1?(e=Ul,Ul<<=1,!(Ul&130023424)&&(Ul=4194304)):e=1);var r=lr();t=li(t,e),t!==null&&(gl(t,e,r),Tr(t,r))}function $L(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),TS(t,r)}function jL(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(Q(314))}n!==null&&n.delete(e),TS(t,r)}var wS;wS=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Sr.current)xr=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return xr=!1,CL(t,e,r);xr=!!(t.flags&131072)}else xr=!1,pt&&e.flags&1048576&&_x(e,ec,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;Su(t,e),t=e.pendingProps;var i=ma(e,er.current);aa(e,r),i=zp(null,e,n,t,i,r);var s=Hp();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Er(n)?(s=!0,Qu(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Bp(e),i.updater=rd,e.stateNode=i,i._reactInternals=e,vh(e,n,t,r),e=Sh(null,e,n,!0,s,r)):(e.tag=0,pt&&s&&Dp(e),sr(null,e,i,r),e=e.child),e;case 16:n=e.elementType;e:{switch(Su(t,e),t=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=GL(n),t=on(n,t),i){case 0:e=xh(null,e,n,t,r);break e;case 1:e=Xg(null,e,n,t,r);break e;case 11:e=Yg(null,e,n,t,r);break e;case 14:e=qg(null,e,n,on(n.type,t),r);break e}throw Error(Q(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:on(n,i),xh(t,e,n,i,r);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:on(n,i),Xg(t,e,n,i,r);case 3:e:{if(aS(e),t===null)throw Error(Q(387));n=e.pendingProps,s=e.memoizedState,i=s.element,Px(t,e),nc(e,n,null,r);var a=e.memoizedState;if(n=a.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=xa(Error(Q(423)),e),e=Zg(t,e,n,r,i);break e}else if(n!==i){i=xa(Error(Q(424)),e),e=Zg(t,e,n,r,i);break e}else for(Dr=Pi(e.stateNode.containerInfo.firstChild),Or=e,pt=!0,cn=null,r=kx(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(ga(),n===i){e=ui(t,e,r);break e}sr(t,e,n,r)}e=e.child}return e;case 5:return Ox(e),t===null&&ph(e),n=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,a=i.children,uh(n,i)?a=null:s!==null&&uh(n,s)&&(e.flags|=32),sS(t,e),sr(t,e,a,r),e.child;case 6:return t===null&&ph(e),null;case 13:return oS(t,e,r);case 4:return $p(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=va(e,null,n,r):sr(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:on(n,i),Yg(t,e,n,i,r);case 7:return sr(t,e,e.pendingProps,r),e.child;case 8:return sr(t,e,e.pendingProps.children,r),e.child;case 12:return sr(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,s=e.memoizedProps,a=i.value,lt(tc,n._currentValue),n._currentValue=a,s!==null)if(vn(s.value,a)){if(s.children===i.children&&!Sr.current){e=ui(t,e,r);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=ii(-1,r&-r),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),mh(s.return,r,e),o.lanes|=r;break}l=l.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(Q(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),mh(a,r,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}sr(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,aa(e,r),i=Zr(i),n=n(i),e.flags|=1,sr(t,e,n,r),e.child;case 14:return n=e.type,i=on(n,e.pendingProps),i=on(n.type,i),qg(t,e,n,i,r);case 15:return nS(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:on(n,i),Su(t,e),e.tag=1,Er(n)?(t=!0,Qu(e)):t=!1,aa(e,r),eS(e,n,i),vh(e,n,i,r),Sh(null,e,n,!0,t,r);case 19:return lS(t,e,r);case 22:return iS(t,e,r)}throw Error(Q(156,e.tag))};function bS(t,e){return Zy(t,e)}function VL(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function qr(t,e,r,n){return new VL(t,e,r,n)}function tm(t){return t=t.prototype,!(!t||!t.isReactComponent)}function GL(t){if(typeof t=="function")return tm(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Sp)return 11;if(t===Ep)return 14}return 2}function Fi(t,e){var r=t.alternate;return r===null?(r=qr(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function wu(t,e,r,n,i,s){var a=2;if(n=t,typeof t=="function")tm(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case js:return us(r.children,i,s,e);case xp:a=8,i|=8;break;case jf:return t=qr(12,r,e,i|2),t.elementType=jf,t.lanes=s,t;case Vf:return t=qr(13,r,e,i),t.elementType=Vf,t.lanes=s,t;case Gf:return t=qr(19,r,e,i),t.elementType=Gf,t.lanes=s,t;case Oy:return sd(r,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Dy:a=10;break e;case Py:a=9;break e;case Sp:a=11;break e;case Ep:a=14;break e;case Si:a=16,n=null;break e}throw Error(Q(130,t==null?t:typeof t,""))}return e=qr(a,r,e,i),e.elementType=t,e.type=n,e.lanes=s,e}function us(t,e,r,n){return t=qr(7,t,n,e),t.lanes=r,t}function sd(t,e,r,n){return t=qr(22,t,n,e),t.elementType=Oy,t.lanes=r,t.stateNode={isHidden:!1},t}function Zd(t,e,r){return t=qr(6,t,null,e),t.lanes=r,t}function Qd(t,e,r){return e=qr(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function zL(t,e,r,n,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Dd(0),this.expirationTimes=Dd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Dd(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function rm(t,e,r,n,i,s,a,o,l){return t=new zL(t,e,r,o,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=qr(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Bp(s),t}function HL(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:$s,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function LS(t){if(!t)return Bi;t=t._reactInternals;e:{if(As(t)!==t||t.tag!==1)throw Error(Q(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Er(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Q(171))}if(t.tag===1){var r=t.type;if(Er(r))return Lx(t,r,e)}return e}function AS(t,e,r,n,i,s,a,o,l){return t=rm(r,n,!0,t,i,s,a,o,l),t.context=LS(null),r=t.current,n=lr(),i=Ni(r),s=ii(n,i),s.callback=e??null,Oi(r,s,i),t.current.lanes=i,gl(t,i,n),Tr(t,n),t}function ad(t,e,r,n){var i=e.current,s=lr(),a=Ni(i);return r=LS(r),e.context===null?e.context=r:e.pendingContext=r,e=ii(s,a),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=Oi(i,e,a),t!==null&&(mn(t,i,a,s),vu(t,i,a)),a}function dc(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function o0(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function nm(t,e){o0(t,e),(t=t.alternate)&&o0(t,e)}function WL(){return null}var _S=typeof reportError=="function"?reportError:function(t){console.error(t)};function im(t){this._internalRoot=t}od.prototype.render=im.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Q(409));ad(t,e,null,null)};od.prototype.unmount=im.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;ys(function(){ad(null,t,null,null)}),e[oi]=null}};function od(t){this._internalRoot=t}od.prototype.unstable_scheduleHydration=function(t){if(t){var e=ix();t={blockedOn:null,target:t,priority:e};for(var r=0;r<wi.length&&e!==0&&e<wi[r].priority;r++);wi.splice(r,0,t),r===0&&ax(t)}};function sm(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function ld(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function l0(){}function KL(t,e,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var u=dc(a);s.call(u)}}var a=AS(e,n,t,0,null,!1,!1,"",l0);return t._reactRootContainer=a,t[oi]=a.current,Uo(t.nodeType===8?t.parentNode:t),ys(),a}for(;i=t.lastChild;)t.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var u=dc(l);o.call(u)}}var l=rm(t,0,!1,null,null,!1,!1,"",l0);return t._reactRootContainer=l,t[oi]=l.current,Uo(t.nodeType===8?t.parentNode:t),ys(function(){ad(e,l,r,n)}),l}function ud(t,e,r,n,i){var s=r._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var l=dc(a);o.call(l)}}ad(e,a,t,i)}else a=KL(r,e,t,i,n);return dc(a)}rx=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=oo(e.pendingLanes);r!==0&&(bp(e,r|1),Tr(e,Lt()),!(Ye&6)&&(Sa=Lt()+500,Wi()))}break;case 13:ys(function(){var n=li(t,1);if(n!==null){var i=lr();mn(n,t,1,i)}}),nm(t,1)}};Lp=function(t){if(t.tag===13){var e=li(t,134217728);if(e!==null){var r=lr();mn(e,t,134217728,r)}nm(t,134217728)}};nx=function(t){if(t.tag===13){var e=Ni(t),r=li(t,e);if(r!==null){var n=lr();mn(r,t,e,n)}nm(t,e)}};ix=function(){return et};sx=function(t,e){var r=et;try{return et=t,e()}finally{et=r}};Jf=function(t,e,r){switch(e){case"input":if(Wf(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=Jc(n);if(!i)throw Error(Q(90));Ny(n),Wf(n,i)}}}break;case"textarea":Uy(t,r);break;case"select":e=r.value,e!=null&&ra(t,!!r.multiple,e,!1)}};Hy=Qp;Wy=ys;var YL={usingClientEntryPoint:!1,Events:[yl,Hs,Jc,Gy,zy,Qp]},Xa={findFiberByHostInstance:rs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},qL={bundleType:Xa.bundleType,version:Xa.version,rendererPackageName:Xa.rendererPackageName,rendererConfig:Xa.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:fi.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=qy(t),t===null?null:t.stateNode},findFiberByHostInstance:Xa.findFiberByHostInstance||WL,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ql=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ql.isDisabled&&ql.supportsFiber)try{qc=ql.inject(qL),Pn=ql}catch{}}Fr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=YL;Fr.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!sm(e))throw Error(Q(200));return HL(t,e,null,r)};Fr.createRoot=function(t,e){if(!sm(t))throw Error(Q(299));var r=!1,n="",i=_S;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=rm(t,1,!1,null,null,r,!1,n,i),t[oi]=e.current,Uo(t.nodeType===8?t.parentNode:t),new im(e)};Fr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Q(188)):(t=Object.keys(t).join(","),Error(Q(268,t)));return t=qy(e),t=t===null?null:t.stateNode,t};Fr.flushSync=function(t){return ys(t)};Fr.hydrate=function(t,e,r){if(!ld(e))throw Error(Q(200));return ud(null,t,e,!0,r)};Fr.hydrateRoot=function(t,e,r){if(!sm(t))throw Error(Q(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",a=_S;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),e=AS(e,null,t,1,r??null,i,!1,s,a),t[oi]=e.current,Uo(t),n)for(t=0;t<n.length;t++)r=n[t],i=r._getVersion,i=i(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,i]:e.mutableSourceEagerHydrationData.push(r,i);return new od(e)};Fr.render=function(t,e,r){if(!ld(e))throw Error(Q(200));return ud(null,t,e,!1,r)};Fr.unmountComponentAtNode=function(t){if(!ld(t))throw Error(Q(40));return t._reactRootContainer?(ys(function(){ud(null,null,t,!1,function(){t._reactRootContainer=null,t[oi]=null})}),!0):!1};Fr.unstable_batchedUpdates=Qp;Fr.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!ld(r))throw Error(Q(200));if(t==null||t._reactInternals===void 0)throw Error(Q(38));return ud(t,e,r,!1,n)};Fr.version="18.3.1-next-f1338f8080-20240426";function CS(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(CS)}catch(t){console.error(t)}}CS(),Cy.exports=Fr;var am=Cy.exports;const XL=dp(am),ZL=gy({__proto__:null,default:XL},[am]);var RS,u0=am;RS=u0.createRoot,u0.hydrateRoot;/**
 * @remix-run/router v1.19.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function yt(){return yt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},yt.apply(this,arguments)}var _t;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(_t||(_t={}));const c0="popstate";function QL(t){t===void 0&&(t={});function e(n,i){let{pathname:s,search:a,hash:o}=n.location;return Ko("",{pathname:s,search:a,hash:o},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(n,i){return typeof i=="string"?i:xs(i)}return eA(e,r,null,t)}function $e(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Ea(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function JL(){return Math.random().toString(36).substr(2,8)}function d0(t,e){return{usr:t.state,key:t.key,idx:e}}function Ko(t,e,r,n){return r===void 0&&(r=null),yt({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Ki(e):e,{state:r,key:e&&e.key||n||JL()})}function xs(t){let{pathname:e="/",search:r="",hash:n=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function Ki(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function eA(t,e,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:s=!1}=n,a=i.history,o=_t.Pop,l=null,u=c();u==null&&(u=0,a.replaceState(yt({},a.state,{idx:u}),""));function c(){return(a.state||{idx:null}).idx}function d(){o=_t.Pop;let v=c(),g=v==null?null:v-u;u=v,l&&l({action:o,location:p.location,delta:g})}function f(v,g){o=_t.Push;let y=Ko(p.location,v,g);u=c()+1;let x=d0(y,u),S=p.createHref(y);try{a.pushState(x,"",S)}catch(T){if(T instanceof DOMException&&T.name==="DataCloneError")throw T;i.location.assign(S)}s&&l&&l({action:o,location:p.location,delta:1})}function m(v,g){o=_t.Replace;let y=Ko(p.location,v,g);u=c();let x=d0(y,u),S=p.createHref(y);a.replaceState(x,"",S),s&&l&&l({action:o,location:p.location,delta:0})}function h(v){let g=i.location.origin!=="null"?i.location.origin:i.location.href,y=typeof v=="string"?v:xs(v);return y=y.replace(/ $/,"%20"),$e(g,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,g)}let p={get action(){return o},get location(){return t(i,a)},listen(v){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(c0,d),l=v,()=>{i.removeEventListener(c0,d),l=null}},createHref(v){return e(i,v)},createURL:h,encodeLocation(v){let g=h(v);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:f,replace:m,go(v){return a.go(v)}};return p}var rt;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(rt||(rt={}));const tA=new Set(["lazy","caseSensitive","path","id","index","children"]);function rA(t){return t.index===!0}function Yo(t,e,r,n){return r===void 0&&(r=[]),n===void 0&&(n={}),t.map((i,s)=>{let a=[...r,String(s)],o=typeof i.id=="string"?i.id:a.join("-");if($e(i.index!==!0||!i.children,"Cannot specify children on an index route"),$e(!n[o],'Found a route id collision on id "'+o+`".  Route id's must be globally unique within Data Router usages`),rA(i)){let l=yt({},i,e(i),{id:o});return n[o]=l,l}else{let l=yt({},i,e(i),{id:o,children:void 0});return n[o]=l,i.children&&(l.children=Yo(i.children,e,a,n)),l}})}function ts(t,e,r){return r===void 0&&(r="/"),bu(t,e,r,!1)}function bu(t,e,r,n){let i=typeof e=="string"?Ki(e):e,s=ci(i.pathname||"/",r);if(s==null)return null;let a=IS(t);iA(a);let o=null;for(let l=0;o==null&&l<a.length;++l){let u=mA(s);o=hA(a[l],u,n)}return o}function nA(t,e){let{route:r,pathname:n,params:i}=t;return{id:r.id,pathname:n,params:i,data:e[r.id],handle:r.handle}}function IS(t,e,r,n){e===void 0&&(e=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(s,a,o)=>{let l={relativePath:o===void 0?s.path||"":o,caseSensitive:s.caseSensitive===!0,childrenIndex:a,route:s};l.relativePath.startsWith("/")&&($e(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let u=si([n,l.relativePath]),c=r.concat(l);s.children&&s.children.length>0&&($e(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),IS(s.children,e,c,u)),!(s.path==null&&!s.index)&&e.push({path:u,score:dA(u,s.index),routesMeta:c})};return t.forEach((s,a)=>{var o;if(s.path===""||!((o=s.path)!=null&&o.includes("?")))i(s,a);else for(let l of kS(s.path))i(s,a,l)}),e}function kS(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,i=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return i?[s,""]:[s];let a=kS(n.join("/")),o=[];return o.push(...a.map(l=>l===""?s:[s,l].join("/"))),i&&o.push(...a),o.map(l=>t.startsWith("/")&&l===""?"/":l)}function iA(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:fA(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const sA=/^:[\w-]+$/,aA=3,oA=2,lA=1,uA=10,cA=-2,f0=t=>t==="*";function dA(t,e){let r=t.split("/"),n=r.length;return r.some(f0)&&(n+=cA),e&&(n+=oA),r.filter(i=>!f0(i)).reduce((i,s)=>i+(sA.test(s)?aA:s===""?lA:uA),n)}function fA(t,e){return t.length===e.length&&t.slice(0,-1).every((n,i)=>n===e[i])?t[t.length-1]-e[e.length-1]:0}function hA(t,e,r){r===void 0&&(r=!1);let{routesMeta:n}=t,i={},s="/",a=[];for(let o=0;o<n.length;++o){let l=n[o],u=o===n.length-1,c=s==="/"?e:e.slice(s.length)||"/",d=fc({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},c),f=l.route;if(!d&&u&&r&&!n[n.length-1].route.index&&(d=fc({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},c)),!d)return null;Object.assign(i,d.params),a.push({params:i,pathname:si([s,d.pathname]),pathnameBase:yA(si([s,d.pathnameBase])),route:f}),d.pathnameBase!=="/"&&(s=si([s,d.pathnameBase]))}return a}function fc(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=pA(t.path,t.caseSensitive,t.end),i=e.match(r);if(!i)return null;let s=i[0],a=s.replace(/(.)\/+$/,"$1"),o=i.slice(1);return{params:n.reduce((u,c,d)=>{let{paramName:f,isOptional:m}=c;if(f==="*"){let p=o[d]||"";a=s.slice(0,s.length-p.length).replace(/(.)\/+$/,"$1")}const h=o[d];return m&&!h?u[f]=void 0:u[f]=(h||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:a,pattern:t}}function pA(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),Ea(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,o,l)=>(n.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),n]}function mA(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Ea(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function ci(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function gA(t,e){e===void 0&&(e="/");let{pathname:r,search:n="",hash:i=""}=typeof t=="string"?Ki(t):t;return{pathname:r?r.startsWith("/")?r:vA(r,e):e,search:xA(n),hash:SA(i)}}function vA(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function Jd(t,e,r,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function DS(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function cd(t,e){let r=DS(t);return e?r.map((n,i)=>i===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function dd(t,e,r,n){n===void 0&&(n=!1);let i;typeof t=="string"?i=Ki(t):(i=yt({},t),$e(!i.pathname||!i.pathname.includes("?"),Jd("?","pathname","search",i)),$e(!i.pathname||!i.pathname.includes("#"),Jd("#","pathname","hash",i)),$e(!i.search||!i.search.includes("#"),Jd("#","search","hash",i)));let s=t===""||i.pathname==="",a=s?"/":i.pathname,o;if(a==null)o=r;else{let d=e.length-1;if(!n&&a.startsWith("..")){let f=a.split("/");for(;f[0]==="..";)f.shift(),d-=1;i.pathname=f.join("/")}o=d>=0?e[d]:"/"}let l=gA(i,o),u=a&&a!=="/"&&a.endsWith("/"),c=(s||a===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(u||c)&&(l.pathname+="/"),l}const si=t=>t.join("/").replace(/\/\/+/g,"/"),yA=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),xA=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,SA=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;class hc{constructor(e,r,n,i){i===void 0&&(i=!1),this.status=e,this.statusText=r||"",this.internal=i,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}}function fd(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const PS=["post","put","patch","delete"],EA=new Set(PS),TA=["get",...PS],wA=new Set(TA),bA=new Set([301,302,303,307,308]),LA=new Set([307,308]),ef={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},AA={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Za={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},om=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,_A=t=>({hasErrorBoundary:!!t.hasErrorBoundary}),OS="remix-router-transitions";function CA(t){const e=t.window?t.window:typeof window<"u"?window:void 0,r=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",n=!r;$e(t.routes.length>0,"You must provide a non-empty routes array to createRouter");let i;if(t.mapRouteProperties)i=t.mapRouteProperties;else if(t.detectErrorBoundary){let D=t.detectErrorBoundary;i=M=>({hasErrorBoundary:D(M)})}else i=_A;let s={},a=Yo(t.routes,i,void 0,s),o,l=t.basename||"/",u=t.unstable_dataStrategy||PA,c=t.unstable_patchRoutesOnNavigation,d=yt({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,v7_skipActionErrorRevalidation:!1},t.future),f=null,m=new Set,h=1e3,p=new Set,v=null,g=null,y=null,x=t.hydrationData!=null,S=ts(a,t.history.location,l),T=null;if(S==null&&!c){let D=ir(404,{pathname:t.history.location.pathname}),{matches:M,route:V}=T0(a);S=M,T={[V.id]:D}}S&&!t.hydrationData&&Cl(S,a,t.history.location.pathname).active&&(S=null);let C;if(S)if(S.some(D=>D.route.lazy))C=!1;else if(!S.some(D=>D.route.loader))C=!0;else if(d.v7_partialHydration){let D=t.hydrationData?t.hydrationData.loaderData:null,M=t.hydrationData?t.hydrationData.errors:null,V=q=>q.route.loader?typeof q.route.loader=="function"&&q.route.loader.hydrate===!0?!1:D&&D[q.route.id]!==void 0||M&&M[q.route.id]!==void 0:!0;if(M){let q=S.findIndex(de=>M[de.route.id]!==void 0);C=S.slice(0,q+1).every(V)}else C=S.every(V)}else C=t.hydrationData!=null;else if(C=!1,S=[],d.v7_partialHydration){let D=Cl(null,a,t.history.location.pathname);D.active&&D.matches&&(S=D.matches)}let _,b={historyAction:t.history.action,location:t.history.location,matches:S,initialized:C,navigation:ef,restoreScrollPosition:t.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:t.hydrationData&&t.hydrationData.loaderData||{},actionData:t.hydrationData&&t.hydrationData.actionData||null,errors:t.hydrationData&&t.hydrationData.errors||T,fetchers:new Map,blockers:new Map},I=_t.Pop,A=!1,k,O=!1,P=new Map,G=null,K=!1,H=!1,se=[],W=new Set,F=new Map,j=0,te=-1,ee=new Map,fe=new Set,ye=new Map,Re=new Map,Ee=new Set,Fe=new Map,st=new Map,br=new Map,tn=!1;function jn(){if(f=t.history.listen(D=>{let{action:M,location:V,delta:q}=D;if(tn){tn=!1;return}Ea(st.size===0||q!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let de=Xm({currentLocation:b.location,nextLocation:V,historyAction:M});if(de&&q!=null){tn=!0,t.history.go(q*-1),Al(de,{state:"blocked",location:V,proceed(){Al(de,{state:"proceeding",proceed:void 0,reset:void 0,location:V}),t.history.go(q)},reset(){let ve=new Map(b.blockers);ve.set(de,Za),nt({blockers:ve})}});return}return R(M,V)}),r){WA(e,P);let D=()=>KA(e,P);e.addEventListener("pagehide",D),G=()=>e.removeEventListener("pagehide",D)}return b.initialized||R(_t.Pop,b.location,{initialHydration:!0}),_}function rn(){f&&f(),G&&G(),m.clear(),k&&k.abort(),b.fetchers.forEach((D,M)=>Nt(M)),b.blockers.forEach((D,M)=>qm(M))}function xn(D){return m.add(D),()=>m.delete(D)}function nt(D,M){M===void 0&&(M={}),b=yt({},b,D);let V=[],q=[];d.v7_fetcherPersist&&b.fetchers.forEach((de,ve)=>{de.state==="idle"&&(Ee.has(ve)?q.push(ve):V.push(ve))}),[...m].forEach(de=>de(b,{deletedFetchers:q,unstable_viewTransitionOpts:M.viewTransitionOpts,unstable_flushSync:M.flushSync===!0})),d.v7_fetcherPersist&&(V.forEach(de=>b.fetchers.delete(de)),q.forEach(de=>Nt(de)))}function Gr(D,M,V){var q,de;let{flushSync:ve}=V===void 0?{}:V,ke=b.actionData!=null&&b.navigation.formMethod!=null&&un(b.navigation.formMethod)&&b.navigation.state==="loading"&&((q=D.state)==null?void 0:q._isRedirect)!==!0,ae;M.actionData?Object.keys(M.actionData).length>0?ae=M.actionData:ae=null:ke?ae=b.actionData:ae=null;let Me=M.loaderData?S0(b.loaderData,M.loaderData,M.matches||[],M.errors):b.loaderData,be=b.blockers;be.size>0&&(be=new Map(be),be.forEach((Qe,it)=>be.set(it,Za)));let Ue=A===!0||b.navigation.formMethod!=null&&un(b.navigation.formMethod)&&((de=D.state)==null?void 0:de._isRedirect)!==!0;o&&(a=o,o=void 0),K||I===_t.Pop||(I===_t.Push?t.history.push(D,D.state):I===_t.Replace&&t.history.replace(D,D.state));let tt;if(I===_t.Pop){let Qe=P.get(b.location.pathname);Qe&&Qe.has(D.pathname)?tt={currentLocation:b.location,nextLocation:D}:P.has(D.pathname)&&(tt={currentLocation:D,nextLocation:b.location})}else if(O){let Qe=P.get(b.location.pathname);Qe?Qe.add(D.pathname):(Qe=new Set([D.pathname]),P.set(b.location.pathname,Qe)),tt={currentLocation:b.location,nextLocation:D}}nt(yt({},M,{actionData:ae,loaderData:Me,historyAction:I,location:D,initialized:!0,navigation:ef,revalidation:"idle",restoreScrollPosition:Qm(D,M.matches||b.matches),preventScrollReset:Ue,blockers:be}),{viewTransitionOpts:tt,flushSync:ve===!0}),I=_t.Pop,A=!1,O=!1,K=!1,H=!1,se=[]}async function Ae(D,M){if(typeof D=="number"){t.history.go(D);return}let V=Dh(b.location,b.matches,l,d.v7_prependBasename,D,d.v7_relativeSplatPath,M==null?void 0:M.fromRouteId,M==null?void 0:M.relative),{path:q,submission:de,error:ve}=h0(d.v7_normalizeFormMethod,!1,V,M),ke=b.location,ae=Ko(b.location,q,M&&M.state);ae=yt({},ae,t.history.encodeLocation(ae));let Me=M&&M.replace!=null?M.replace:void 0,be=_t.Push;Me===!0?be=_t.Replace:Me===!1||de!=null&&un(de.formMethod)&&de.formAction===b.location.pathname+b.location.search&&(be=_t.Replace);let Ue=M&&"preventScrollReset"in M?M.preventScrollReset===!0:void 0,tt=(M&&M.unstable_flushSync)===!0,Qe=Xm({currentLocation:ke,nextLocation:ae,historyAction:be});if(Qe){Al(Qe,{state:"blocked",location:ae,proceed(){Al(Qe,{state:"proceeding",proceed:void 0,reset:void 0,location:ae}),Ae(D,M)},reset(){let it=new Map(b.blockers);it.set(Qe,Za),nt({blockers:it})}});return}return await R(be,ae,{submission:de,pendingError:ve,preventScrollReset:Ue,replace:M&&M.replace,enableViewTransition:M&&M.unstable_viewTransition,flushSync:tt})}function qe(){if(nr(),nt({revalidation:"loading"}),b.navigation.state!=="submitting"){if(b.navigation.state==="idle"){R(b.historyAction,b.location,{startUninterruptedRevalidation:!0});return}R(I||b.historyAction,b.navigation.location,{overrideNavigation:b.navigation})}}async function R(D,M,V){k&&k.abort(),k=null,I=D,K=(V&&V.startUninterruptedRevalidation)===!0,xb(b.location,b.matches),A=(V&&V.preventScrollReset)===!0,O=(V&&V.enableViewTransition)===!0;let q=o||a,de=V&&V.overrideNavigation,ve=ts(q,M,l),ke=(V&&V.flushSync)===!0,ae=Cl(ve,q,M.pathname);if(ae.active&&ae.matches&&(ve=ae.matches),!ve){let{error:Xe,notFoundMatches:Vt,route:At}=Ld(M.pathname);Gr(M,{matches:Vt,loaderData:{},errors:{[At.id]:Xe}},{flushSync:ke});return}if(b.initialized&&!H&&BA(b.location,M)&&!(V&&V.submission&&un(V.submission.formMethod))){Gr(M,{matches:ve},{flushSync:ke});return}k=new AbortController;let Me=Ds(t.history,M,k.signal,V&&V.submission),be;if(V&&V.pendingError)be=[Qs(ve).route.id,{type:rt.error,error:V.pendingError}];else if(V&&V.submission&&un(V.submission.formMethod)){let Xe=await N(Me,M,V.submission,ve,ae.active,{replace:V.replace,flushSync:ke});if(Xe.shortCircuited)return;if(Xe.pendingActionResult){let[Vt,At]=Xe.pendingActionResult;if(Rr(At)&&fd(At.error)&&At.error.status===404){k=null,Gr(M,{matches:Xe.matches,loaderData:{},errors:{[Vt]:At.error}});return}}ve=Xe.matches||ve,be=Xe.pendingActionResult,de=tf(M,V.submission),ke=!1,ae.active=!1,Me=Ds(t.history,Me.url,Me.signal)}let{shortCircuited:Ue,matches:tt,loaderData:Qe,errors:it}=await $(Me,M,ve,ae.active,de,V&&V.submission,V&&V.fetcherSubmission,V&&V.replace,V&&V.initialHydration===!0,ke,be);Ue||(k=null,Gr(M,yt({matches:tt||ve},E0(be),{loaderData:Qe,errors:it})))}async function N(D,M,V,q,de,ve){ve===void 0&&(ve={}),nr();let ke=zA(M,V);if(nt({navigation:ke},{flushSync:ve.flushSync===!0}),de){let be=await Rl(q,M.pathname,D.signal);if(be.type==="aborted")return{shortCircuited:!0};if(be.type==="error"){let{boundaryId:Ue,error:tt}=_l(M.pathname,be);return{matches:be.partialMatches,pendingActionResult:[Ue,{type:rt.error,error:tt}]}}else if(be.matches)q=be.matches;else{let{notFoundMatches:Ue,error:tt,route:Qe}=Ld(M.pathname);return{matches:Ue,pendingActionResult:[Qe.id,{type:rt.error,error:tt}]}}}let ae,Me=uo(q,M);if(!Me.route.action&&!Me.route.lazy)ae={type:rt.error,error:ir(405,{method:D.method,pathname:M.pathname,routeId:Me.route.id})};else if(ae=(await ce("action",D,[Me],q))[0],D.signal.aborted)return{shortCircuited:!0};if(as(ae)){let be;return ve&&ve.replace!=null?be=ve.replace:be=v0(ae.response.headers.get("Location"),new URL(D.url),l)===b.location.pathname+b.location.search,await xe(D,ae,{submission:V,replace:be}),{shortCircuited:!0}}if(ss(ae))throw ir(400,{type:"defer-action"});if(Rr(ae)){let be=Qs(q,Me.route.id);return(ve&&ve.replace)!==!0&&(I=_t.Push),{matches:q,pendingActionResult:[be.route.id,ae]}}return{matches:q,pendingActionResult:[Me.route.id,ae]}}async function $(D,M,V,q,de,ve,ke,ae,Me,be,Ue){let tt=de||tf(M,ve),Qe=ve||ke||A0(tt),it=!K&&(!d.v7_partialHydration||!Me);if(q){if(it){let Tt=re(Ue);nt(yt({navigation:tt},Tt!==void 0?{actionData:Tt}:{}),{flushSync:be})}let je=await Rl(V,M.pathname,D.signal);if(je.type==="aborted")return{shortCircuited:!0};if(je.type==="error"){let{boundaryId:Tt,error:Lr}=_l(M.pathname,je);return{matches:je.partialMatches,loaderData:{},errors:{[Tt]:Lr}}}else if(je.matches)V=je.matches;else{let{error:Tt,notFoundMatches:Lr,route:ht}=Ld(M.pathname);return{matches:Lr,loaderData:{},errors:{[ht.id]:Tt}}}}let Xe=o||a,[Vt,At]=p0(t.history,b,V,Qe,M,d.v7_partialHydration&&Me===!0,d.v7_skipActionErrorRevalidation,H,se,W,Ee,ye,fe,Xe,l,Ue);if(Ad(je=>!(V&&V.some(Tt=>Tt.route.id===je))||Vt&&Vt.some(Tt=>Tt.route.id===je)),te=++j,Vt.length===0&&At.length===0){let je=Km();return Gr(M,yt({matches:V,loaderData:{},errors:Ue&&Rr(Ue[1])?{[Ue[0]]:Ue[1].error}:null},E0(Ue),je?{fetchers:new Map(b.fetchers)}:{}),{flushSync:be}),{shortCircuited:!0}}if(it){let je={};if(!q){je.navigation=tt;let Tt=re(Ue);Tt!==void 0&&(je.actionData=Tt)}At.length>0&&(je.fetchers=Z(At)),nt(je,{flushSync:be})}At.forEach(je=>{F.has(je.key)&&hr(je.key),je.controller&&F.set(je.key,je.controller)});let Va=()=>At.forEach(je=>hr(je.key));k&&k.signal.addEventListener("abort",Va);let{loaderResults:pi,fetcherResults:Cs}=await Ge(b.matches,V,Vt,At,D);if(D.signal.aborted)return{shortCircuited:!0};k&&k.signal.removeEventListener("abort",Va),At.forEach(je=>F.delete(je.key));let Rs=w0([...pi,...Cs]);if(Rs){if(Rs.idx>=Vt.length){let je=At[Rs.idx-Vt.length].key;fe.add(je)}return await xe(D,Rs.result,{replace:ae}),{shortCircuited:!0}}let{loaderData:Is,errors:Sn}=x0(b,V,Vt,pi,Ue,At,Cs,Fe);Fe.forEach((je,Tt)=>{je.subscribe(Lr=>{(Lr||je.done)&&Fe.delete(Tt)})}),d.v7_partialHydration&&Me&&b.errors&&Object.entries(b.errors).filter(je=>{let[Tt]=je;return!Vt.some(Lr=>Lr.route.id===Tt)}).forEach(je=>{let[Tt,Lr]=je;Sn=Object.assign(Sn||{},{[Tt]:Lr})});let Il=Km(),kl=Ym(te),Dl=Il||kl||At.length>0;return yt({matches:V,loaderData:Is,errors:Sn},Dl?{fetchers:new Map(b.fetchers)}:{})}function re(D){if(D&&!Rr(D[1]))return{[D[0]]:D[1].data};if(b.actionData)return Object.keys(b.actionData).length===0?null:b.actionData}function Z(D){return D.forEach(M=>{let V=b.fetchers.get(M.key),q=Qa(void 0,V?V.data:void 0);b.fetchers.set(M.key,q)}),new Map(b.fetchers)}function X(D,M,V,q){if(n)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");F.has(D)&&hr(D);let de=(q&&q.unstable_flushSync)===!0,ve=o||a,ke=Dh(b.location,b.matches,l,d.v7_prependBasename,V,d.v7_relativeSplatPath,M,q==null?void 0:q.relative),ae=ts(ve,ke,l),Me=Cl(ae,ve,ke);if(Me.active&&Me.matches&&(ae=Me.matches),!ae){Pe(D,M,ir(404,{pathname:ke}),{flushSync:de});return}let{path:be,submission:Ue,error:tt}=h0(d.v7_normalizeFormMethod,!0,ke,q);if(tt){Pe(D,M,tt,{flushSync:de});return}let Qe=uo(ae,be);if(A=(q&&q.preventScrollReset)===!0,Ue&&un(Ue.formMethod)){ge(D,M,be,Qe,ae,Me.active,de,Ue);return}ye.set(D,{routeId:M,path:be}),oe(D,M,be,Qe,ae,Me.active,de,Ue)}async function ge(D,M,V,q,de,ve,ke,ae){nr(),ye.delete(D);function Me(ht){if(!ht.route.action&&!ht.route.lazy){let Vn=ir(405,{method:ae.formMethod,pathname:V,routeId:M});return Pe(D,M,Vn,{flushSync:ke}),!0}return!1}if(!ve&&Me(q))return;let be=b.fetchers.get(D);mt(D,HA(ae,be),{flushSync:ke});let Ue=new AbortController,tt=Ds(t.history,V,Ue.signal,ae);if(ve){let ht=await Rl(de,V,tt.signal);if(ht.type==="aborted")return;if(ht.type==="error"){let{error:Vn}=_l(V,ht);Pe(D,M,Vn,{flushSync:ke});return}else if(ht.matches){if(de=ht.matches,q=uo(de,V),Me(q))return}else{Pe(D,M,ir(404,{pathname:V}),{flushSync:ke});return}}F.set(D,Ue);let Qe=j,Xe=(await ce("action",tt,[q],de))[0];if(tt.signal.aborted){F.get(D)===Ue&&F.delete(D);return}if(d.v7_fetcherPersist&&Ee.has(D)){if(as(Xe)||Rr(Xe)){mt(D,xi(void 0));return}}else{if(as(Xe))if(F.delete(D),te>Qe){mt(D,xi(void 0));return}else return fe.add(D),mt(D,Qa(ae)),xe(tt,Xe,{fetcherSubmission:ae});if(Rr(Xe)){Pe(D,M,Xe.error);return}}if(ss(Xe))throw ir(400,{type:"defer-action"});let Vt=b.navigation.location||b.location,At=Ds(t.history,Vt,Ue.signal),Va=o||a,pi=b.navigation.state!=="idle"?ts(Va,b.navigation.location,l):b.matches;$e(pi,"Didn't find any matches after fetcher action");let Cs=++j;ee.set(D,Cs);let Rs=Qa(ae,Xe.data);b.fetchers.set(D,Rs);let[Is,Sn]=p0(t.history,b,pi,ae,Vt,!1,d.v7_skipActionErrorRevalidation,H,se,W,Ee,ye,fe,Va,l,[q.route.id,Xe]);Sn.filter(ht=>ht.key!==D).forEach(ht=>{let Vn=ht.key,eg=b.fetchers.get(Vn),Tb=Qa(void 0,eg?eg.data:void 0);b.fetchers.set(Vn,Tb),F.has(Vn)&&hr(Vn),ht.controller&&F.set(Vn,ht.controller)}),nt({fetchers:new Map(b.fetchers)});let Il=()=>Sn.forEach(ht=>hr(ht.key));Ue.signal.addEventListener("abort",Il);let{loaderResults:kl,fetcherResults:Dl}=await Ge(b.matches,pi,Is,Sn,At);if(Ue.signal.aborted)return;Ue.signal.removeEventListener("abort",Il),ee.delete(D),F.delete(D),Sn.forEach(ht=>F.delete(ht.key));let je=w0([...kl,...Dl]);if(je){if(je.idx>=Is.length){let ht=Sn[je.idx-Is.length].key;fe.add(ht)}return xe(At,je.result)}let{loaderData:Tt,errors:Lr}=x0(b,b.matches,Is,kl,void 0,Sn,Dl,Fe);if(b.fetchers.has(D)){let ht=xi(Xe.data);b.fetchers.set(D,ht)}Ym(Cs),b.navigation.state==="loading"&&Cs>te?($e(I,"Expected pending action"),k&&k.abort(),Gr(b.navigation.location,{matches:pi,loaderData:Tt,errors:Lr,fetchers:new Map(b.fetchers)})):(nt({errors:Lr,loaderData:S0(b.loaderData,Tt,pi,Lr),fetchers:new Map(b.fetchers)}),H=!1)}async function oe(D,M,V,q,de,ve,ke,ae){let Me=b.fetchers.get(D);mt(D,Qa(ae,Me?Me.data:void 0),{flushSync:ke});let be=new AbortController,Ue=Ds(t.history,V,be.signal);if(ve){let Xe=await Rl(de,V,Ue.signal);if(Xe.type==="aborted")return;if(Xe.type==="error"){let{error:Vt}=_l(V,Xe);Pe(D,M,Vt,{flushSync:ke});return}else if(Xe.matches)de=Xe.matches,q=uo(de,V);else{Pe(D,M,ir(404,{pathname:V}),{flushSync:ke});return}}F.set(D,be);let tt=j,it=(await ce("loader",Ue,[q],de))[0];if(ss(it)&&(it=await BS(it,Ue.signal,!0)||it),F.get(D)===be&&F.delete(D),!Ue.signal.aborted){if(Ee.has(D)){mt(D,xi(void 0));return}if(as(it))if(te>tt){mt(D,xi(void 0));return}else{fe.add(D),await xe(Ue,it);return}if(Rr(it)){Pe(D,M,it.error);return}$e(!ss(it),"Unhandled fetcher deferred data"),mt(D,xi(it.data))}}async function xe(D,M,V){let{submission:q,fetcherSubmission:de,replace:ve}=V===void 0?{}:V;M.response.headers.has("X-Remix-Revalidate")&&(H=!0);let ke=M.response.headers.get("Location");$e(ke,"Expected a Location header on the redirect Response"),ke=v0(ke,new URL(D.url),l);let ae=Ko(b.location,ke,{_isRedirect:!0});if(r){let it=!1;if(M.response.headers.has("X-Remix-Reload-Document"))it=!0;else if(om.test(ke)){const Xe=t.history.createURL(ke);it=Xe.origin!==e.location.origin||ci(Xe.pathname,l)==null}if(it){ve?e.location.replace(ke):e.location.assign(ke);return}}k=null;let Me=ve===!0||M.response.headers.has("X-Remix-Replace")?_t.Replace:_t.Push,{formMethod:be,formAction:Ue,formEncType:tt}=b.navigation;!q&&!de&&be&&Ue&&tt&&(q=A0(b.navigation));let Qe=q||de;if(LA.has(M.response.status)&&Qe&&un(Qe.formMethod))await R(Me,ae,{submission:yt({},Qe,{formAction:ke}),preventScrollReset:A});else{let it=tf(ae,q);await R(Me,ae,{overrideNavigation:it,fetcherSubmission:de,preventScrollReset:A})}}async function ce(D,M,V,q){try{let de=await OA(u,D,M,V,q,s,i);return await Promise.all(de.map((ve,ke)=>{if(jA(ve)){let ae=ve.result;return{type:rt.redirect,response:FA(ae,M,V[ke].route.id,q,l,d.v7_relativeSplatPath)}}return NA(ve)}))}catch(de){return V.map(()=>({type:rt.error,error:de}))}}async function Ge(D,M,V,q,de){let[ve,...ke]=await Promise.all([V.length?ce("loader",de,V,M):[],...q.map(ae=>{if(ae.matches&&ae.match&&ae.controller){let Me=Ds(t.history,ae.path,ae.controller.signal);return ce("loader",Me,[ae.match],ae.matches).then(be=>be[0])}else return Promise.resolve({type:rt.error,error:ir(404,{pathname:ae.path})})})]);return await Promise.all([L0(D,V,ve,ve.map(()=>de.signal),!1,b.loaderData),L0(D,q.map(ae=>ae.match),ke,q.map(ae=>ae.controller?ae.controller.signal:null),!0)]),{loaderResults:ve,fetcherResults:ke}}function nr(){H=!0,se.push(...Ad()),ye.forEach((D,M)=>{F.has(M)&&(W.add(M),hr(M))})}function mt(D,M,V){V===void 0&&(V={}),b.fetchers.set(D,M),nt({fetchers:new Map(b.fetchers)},{flushSync:(V&&V.flushSync)===!0})}function Pe(D,M,V,q){q===void 0&&(q={});let de=Qs(b.matches,M);Nt(D),nt({errors:{[de.route.id]:V},fetchers:new Map(b.fetchers)},{flushSync:(q&&q.flushSync)===!0})}function Le(D){return d.v7_fetcherPersist&&(Re.set(D,(Re.get(D)||0)+1),Ee.has(D)&&Ee.delete(D)),b.fetchers.get(D)||AA}function Nt(D){let M=b.fetchers.get(D);F.has(D)&&!(M&&M.state==="loading"&&ee.has(D))&&hr(D),ye.delete(D),ee.delete(D),fe.delete(D),Ee.delete(D),W.delete(D),b.fetchers.delete(D)}function Xi(D){if(d.v7_fetcherPersist){let M=(Re.get(D)||0)-1;M<=0?(Re.delete(D),Ee.add(D)):Re.set(D,M)}else Nt(D);nt({fetchers:new Map(b.fetchers)})}function hr(D){let M=F.get(D);$e(M,"Expected fetch controller: "+D),M.abort(),F.delete(D)}function Wm(D){for(let M of D){let V=Le(M),q=xi(V.data);b.fetchers.set(M,q)}}function Km(){let D=[],M=!1;for(let V of fe){let q=b.fetchers.get(V);$e(q,"Expected fetcher: "+V),q.state==="loading"&&(fe.delete(V),D.push(V),M=!0)}return Wm(D),M}function Ym(D){let M=[];for(let[V,q]of ee)if(q<D){let de=b.fetchers.get(V);$e(de,"Expected fetcher: "+V),de.state==="loading"&&(hr(V),ee.delete(V),M.push(V))}return Wm(M),M.length>0}function vb(D,M){let V=b.blockers.get(D)||Za;return st.get(D)!==M&&st.set(D,M),V}function qm(D){b.blockers.delete(D),st.delete(D)}function Al(D,M){let V=b.blockers.get(D)||Za;$e(V.state==="unblocked"&&M.state==="blocked"||V.state==="blocked"&&M.state==="blocked"||V.state==="blocked"&&M.state==="proceeding"||V.state==="blocked"&&M.state==="unblocked"||V.state==="proceeding"&&M.state==="unblocked","Invalid blocker state transition: "+V.state+" -> "+M.state);let q=new Map(b.blockers);q.set(D,M),nt({blockers:q})}function Xm(D){let{currentLocation:M,nextLocation:V,historyAction:q}=D;if(st.size===0)return;st.size>1&&Ea(!1,"A router only supports one blocker at a time");let de=Array.from(st.entries()),[ve,ke]=de[de.length-1],ae=b.blockers.get(ve);if(!(ae&&ae.state==="proceeding")&&ke({currentLocation:M,nextLocation:V,historyAction:q}))return ve}function Ld(D){let M=ir(404,{pathname:D}),V=o||a,{matches:q,route:de}=T0(V);return Ad(),{notFoundMatches:q,route:de,error:M}}function _l(D,M){return{boundaryId:Qs(M.partialMatches).route.id,error:ir(400,{type:"route-discovery",pathname:D,message:M.error!=null&&"message"in M.error?M.error:String(M.error)})}}function Ad(D){let M=[];return Fe.forEach((V,q)=>{(!D||D(q))&&(V.cancel(),M.push(q),Fe.delete(q))}),M}function yb(D,M,V){if(v=D,y=M,g=V||null,!x&&b.navigation===ef){x=!0;let q=Qm(b.location,b.matches);q!=null&&nt({restoreScrollPosition:q})}return()=>{v=null,y=null,g=null}}function Zm(D,M){return g&&g(D,M.map(q=>nA(q,b.loaderData)))||D.key}function xb(D,M){if(v&&y){let V=Zm(D,M);v[V]=y()}}function Qm(D,M){if(v){let V=Zm(D,M),q=v[V];if(typeof q=="number")return q}return null}function Cl(D,M,V){if(c){if(p.has(V))return{active:!1,matches:D};if(D){if(Object.keys(D[0].params).length>0)return{active:!0,matches:bu(M,V,l,!0)}}else return{active:!0,matches:bu(M,V,l,!0)||[]}}return{active:!1,matches:null}}async function Rl(D,M,V){let q=D;for(;;){let de=o==null,ve=o||a;try{await DA(c,M,q,ve,s,i,br,V)}catch(Me){return{type:"error",error:Me,partialMatches:q}}finally{de&&(a=[...a])}if(V.aborted)return{type:"aborted"};let ke=ts(ve,M,l);if(ke)return Jm(M,p),{type:"success",matches:ke};let ae=bu(ve,M,l,!0);if(!ae||q.length===ae.length&&q.every((Me,be)=>Me.route.id===ae[be].route.id))return Jm(M,p),{type:"success",matches:null};q=ae}}function Jm(D,M){if(M.size>=h){let V=M.values().next().value;M.delete(V)}M.add(D)}function Sb(D){s={},o=Yo(D,i,void 0,s)}function Eb(D,M){let V=o==null;NS(D,M,o||a,s,i),V&&(a=[...a],nt({}))}return _={get basename(){return l},get future(){return d},get state(){return b},get routes(){return a},get window(){return e},initialize:jn,subscribe:xn,enableScrollRestoration:yb,navigate:Ae,fetch:X,revalidate:qe,createHref:D=>t.history.createHref(D),encodeLocation:D=>t.history.encodeLocation(D),getFetcher:Le,deleteFetcher:Xi,dispose:rn,getBlocker:vb,deleteBlocker:qm,patchRoutes:Eb,_internalFetchControllers:F,_internalActiveDeferreds:Fe,_internalSetRoutes:Sb},_}function RA(t){return t!=null&&("formData"in t&&t.formData!=null||"body"in t&&t.body!==void 0)}function Dh(t,e,r,n,i,s,a,o){let l,u;if(a){l=[];for(let d of e)if(l.push(d),d.route.id===a){u=d;break}}else l=e,u=e[e.length-1];let c=dd(i||".",cd(l,s),ci(t.pathname,r)||t.pathname,o==="path");return i==null&&(c.search=t.search,c.hash=t.hash),(i==null||i===""||i===".")&&u&&u.route.index&&!lm(c.search)&&(c.search=c.search?c.search.replace(/^\?/,"?index&"):"?index"),n&&r!=="/"&&(c.pathname=c.pathname==="/"?r:si([r,c.pathname])),xs(c)}function h0(t,e,r,n){if(!n||!RA(n))return{path:r};if(n.formMethod&&!GA(n.formMethod))return{path:r,error:ir(405,{method:n.formMethod})};let i=()=>({path:r,error:ir(400,{type:"invalid-body"})}),s=n.formMethod||"get",a=t?s.toUpperCase():s.toLowerCase(),o=FS(r);if(n.body!==void 0){if(n.formEncType==="text/plain"){if(!un(a))return i();let f=typeof n.body=="string"?n.body:n.body instanceof FormData||n.body instanceof URLSearchParams?Array.from(n.body.entries()).reduce((m,h)=>{let[p,v]=h;return""+m+p+"="+v+`
`},""):String(n.body);return{path:r,submission:{formMethod:a,formAction:o,formEncType:n.formEncType,formData:void 0,json:void 0,text:f}}}else if(n.formEncType==="application/json"){if(!un(a))return i();try{let f=typeof n.body=="string"?JSON.parse(n.body):n.body;return{path:r,submission:{formMethod:a,formAction:o,formEncType:n.formEncType,formData:void 0,json:f,text:void 0}}}catch{return i()}}}$e(typeof FormData=="function","FormData is not available in this environment");let l,u;if(n.formData)l=Ph(n.formData),u=n.formData;else if(n.body instanceof FormData)l=Ph(n.body),u=n.body;else if(n.body instanceof URLSearchParams)l=n.body,u=y0(l);else if(n.body==null)l=new URLSearchParams,u=new FormData;else try{l=new URLSearchParams(n.body),u=y0(l)}catch{return i()}let c={formMethod:a,formAction:o,formEncType:n&&n.formEncType||"application/x-www-form-urlencoded",formData:u,json:void 0,text:void 0};if(un(c.formMethod))return{path:r,submission:c};let d=Ki(r);return e&&d.search&&lm(d.search)&&l.append("index",""),d.search="?"+l,{path:xs(d),submission:c}}function IA(t,e){let r=t;if(e){let n=t.findIndex(i=>i.route.id===e);n>=0&&(r=t.slice(0,n))}return r}function p0(t,e,r,n,i,s,a,o,l,u,c,d,f,m,h,p){let v=p?Rr(p[1])?p[1].error:p[1].data:void 0,g=t.createURL(e.location),y=t.createURL(i),x=p&&Rr(p[1])?p[0]:void 0,S=x?IA(r,x):r,T=p?p[1].statusCode:void 0,C=a&&T&&T>=400,_=S.filter((I,A)=>{let{route:k}=I;if(k.lazy)return!0;if(k.loader==null)return!1;if(s)return typeof k.loader!="function"||k.loader.hydrate?!0:e.loaderData[k.id]===void 0&&(!e.errors||e.errors[k.id]===void 0);if(kA(e.loaderData,e.matches[A],I)||l.some(G=>G===I.route.id))return!0;let O=e.matches[A],P=I;return m0(I,yt({currentUrl:g,currentParams:O.params,nextUrl:y,nextParams:P.params},n,{actionResult:v,actionStatus:T,defaultShouldRevalidate:C?!1:o||g.pathname+g.search===y.pathname+y.search||g.search!==y.search||MS(O,P)}))}),b=[];return d.forEach((I,A)=>{if(s||!r.some(K=>K.route.id===I.routeId)||c.has(A))return;let k=ts(m,I.path,h);if(!k){b.push({key:A,routeId:I.routeId,path:I.path,matches:null,match:null,controller:null});return}let O=e.fetchers.get(A),P=uo(k,I.path),G=!1;f.has(A)?G=!1:u.has(A)?(u.delete(A),G=!0):O&&O.state!=="idle"&&O.data===void 0?G=o:G=m0(P,yt({currentUrl:g,currentParams:e.matches[e.matches.length-1].params,nextUrl:y,nextParams:r[r.length-1].params},n,{actionResult:v,actionStatus:T,defaultShouldRevalidate:C?!1:o})),G&&b.push({key:A,routeId:I.routeId,path:I.path,matches:k,match:P,controller:new AbortController})}),[_,b]}function kA(t,e,r){let n=!e||r.route.id!==e.route.id,i=t[r.route.id]===void 0;return n||i}function MS(t,e){let r=t.route.path;return t.pathname!==e.pathname||r!=null&&r.endsWith("*")&&t.params["*"]!==e.params["*"]}function m0(t,e){if(t.route.shouldRevalidate){let r=t.route.shouldRevalidate(e);if(typeof r=="boolean")return r}return e.defaultShouldRevalidate}async function DA(t,e,r,n,i,s,a,o){let l=[e,...r.map(u=>u.route.id)].join("-");try{let u=a.get(l);u||(u=t({path:e,matches:r,patch:(c,d)=>{o.aborted||NS(c,d,n,i,s)}}),a.set(l,u)),u&&$A(u)&&await u}finally{a.delete(l)}}function NS(t,e,r,n,i){if(t){var s;let a=n[t];$e(a,"No route found to patch children into: routeId = "+t);let o=Yo(e,i,[t,"patch",String(((s=a.children)==null?void 0:s.length)||"0")],n);a.children?a.children.push(...o):a.children=o}else{let a=Yo(e,i,["patch",String(r.length||"0")],n);r.push(...a)}}async function g0(t,e,r){if(!t.lazy)return;let n=await t.lazy();if(!t.lazy)return;let i=r[t.id];$e(i,"No route found in manifest");let s={};for(let a in n){let l=i[a]!==void 0&&a!=="hasErrorBoundary";Ea(!l,'Route "'+i.id+'" has a static property "'+a+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+a+'" will be ignored.')),!l&&!tA.has(a)&&(s[a]=n[a])}Object.assign(i,s),Object.assign(i,yt({},e(i),{lazy:void 0}))}function PA(t){return Promise.all(t.matches.map(e=>e.resolve()))}async function OA(t,e,r,n,i,s,a,o){let l=n.reduce((d,f)=>d.add(f.route.id),new Set),u=new Set,c=await t({matches:i.map(d=>{let f=l.has(d.route.id);return yt({},d,{shouldLoad:f,resolve:h=>(u.add(d.route.id),f?MA(e,r,d,s,a,h,o):Promise.resolve({type:rt.data,result:void 0}))})}),request:r,params:i[0].params,context:o});return i.forEach(d=>$e(u.has(d.route.id),'`match.resolve()` was not called for route id "'+d.route.id+'". You must call `match.resolve()` on every match passed to `dataStrategy` to ensure all routes are properly loaded.')),c.filter((d,f)=>l.has(i[f].route.id))}async function MA(t,e,r,n,i,s,a){let o,l,u=c=>{let d,f=new Promise((p,v)=>d=v);l=()=>d(),e.signal.addEventListener("abort",l);let m=p=>typeof c!="function"?Promise.reject(new Error("You cannot call the handler for a route which defines a boolean "+('"'+t+'" [routeId: '+r.route.id+"]"))):c({request:e,params:r.params,context:a},...p!==void 0?[p]:[]),h;return s?h=s(p=>m(p)):h=(async()=>{try{return{type:"data",result:await m()}}catch(p){return{type:"error",result:p}}})(),Promise.race([h,f])};try{let c=r.route[t];if(r.route.lazy)if(c){let d,[f]=await Promise.all([u(c).catch(m=>{d=m}),g0(r.route,i,n)]);if(d!==void 0)throw d;o=f}else if(await g0(r.route,i,n),c=r.route[t],c)o=await u(c);else if(t==="action"){let d=new URL(e.url),f=d.pathname+d.search;throw ir(405,{method:e.method,pathname:f,routeId:r.route.id})}else return{type:rt.data,result:void 0};else if(c)o=await u(c);else{let d=new URL(e.url),f=d.pathname+d.search;throw ir(404,{pathname:f})}$e(o.result!==void 0,"You defined "+(t==="action"?"an action":"a loader")+" for route "+('"'+r.route.id+"\" but didn't return anything from your `"+t+"` ")+"function. Please return a value or `null`.")}catch(c){return{type:rt.error,result:c}}finally{l&&e.signal.removeEventListener("abort",l)}return o}async function NA(t){let{result:e,type:r}=t;if(US(e)){let u;try{let c=e.headers.get("Content-Type");c&&/\bapplication\/json\b/.test(c)?e.body==null?u=null:u=await e.json():u=await e.text()}catch(c){return{type:rt.error,error:c}}return r===rt.error?{type:rt.error,error:new hc(e.status,e.statusText,u),statusCode:e.status,headers:e.headers}:{type:rt.data,data:u,statusCode:e.status,headers:e.headers}}if(r===rt.error){if(b0(e)){var n;if(e.data instanceof Error){var i;return{type:rt.error,error:e.data,statusCode:(i=e.init)==null?void 0:i.status}}e=new hc(((n=e.init)==null?void 0:n.status)||500,void 0,e.data)}return{type:rt.error,error:e,statusCode:fd(e)?e.status:void 0}}if(VA(e)){var s,a;return{type:rt.deferred,deferredData:e,statusCode:(s=e.init)==null?void 0:s.status,headers:((a=e.init)==null?void 0:a.headers)&&new Headers(e.init.headers)}}if(b0(e)){var o,l;return{type:rt.data,data:e.data,statusCode:(o=e.init)==null?void 0:o.status,headers:(l=e.init)!=null&&l.headers?new Headers(e.init.headers):void 0}}return{type:rt.data,data:e}}function FA(t,e,r,n,i,s){let a=t.headers.get("Location");if($e(a,"Redirects returned/thrown from loaders/actions must have a Location header"),!om.test(a)){let o=n.slice(0,n.findIndex(l=>l.route.id===r)+1);a=Dh(new URL(e.url),o,i,!0,a,s),t.headers.set("Location",a)}return t}function v0(t,e,r){if(om.test(t)){let n=t,i=n.startsWith("//")?new URL(e.protocol+n):new URL(n),s=ci(i.pathname,r)!=null;if(i.origin===e.origin&&s)return i.pathname+i.search+i.hash}return t}function Ds(t,e,r,n){let i=t.createURL(FS(e)).toString(),s={signal:r};if(n&&un(n.formMethod)){let{formMethod:a,formEncType:o}=n;s.method=a.toUpperCase(),o==="application/json"?(s.headers=new Headers({"Content-Type":o}),s.body=JSON.stringify(n.json)):o==="text/plain"?s.body=n.text:o==="application/x-www-form-urlencoded"&&n.formData?s.body=Ph(n.formData):s.body=n.formData}return new Request(i,s)}function Ph(t){let e=new URLSearchParams;for(let[r,n]of t.entries())e.append(r,typeof n=="string"?n:n.name);return e}function y0(t){let e=new FormData;for(let[r,n]of t.entries())e.append(r,n);return e}function UA(t,e,r,n,i,s){let a={},o=null,l,u=!1,c={},d=n&&Rr(n[1])?n[1].error:void 0;return r.forEach((f,m)=>{let h=e[m].route.id;if($e(!as(f),"Cannot handle redirect results in processLoaderData"),Rr(f)){let p=f.error;d!==void 0&&(p=d,d=void 0),o=o||{};{let v=Qs(t,h);o[v.route.id]==null&&(o[v.route.id]=p)}a[h]=void 0,u||(u=!0,l=fd(f.error)?f.error.status:500),f.headers&&(c[h]=f.headers)}else ss(f)?(i.set(h,f.deferredData),a[h]=f.deferredData.data,f.statusCode!=null&&f.statusCode!==200&&!u&&(l=f.statusCode),f.headers&&(c[h]=f.headers)):(a[h]=f.data,f.statusCode&&f.statusCode!==200&&!u&&(l=f.statusCode),f.headers&&(c[h]=f.headers))}),d!==void 0&&n&&(o={[n[0]]:d},a[n[0]]=void 0),{loaderData:a,errors:o,statusCode:l||200,loaderHeaders:c}}function x0(t,e,r,n,i,s,a,o){let{loaderData:l,errors:u}=UA(e,r,n,i,o);for(let c=0;c<s.length;c++){let{key:d,match:f,controller:m}=s[c];$e(a!==void 0&&a[c]!==void 0,"Did not find corresponding fetcher result");let h=a[c];if(!(m&&m.signal.aborted))if(Rr(h)){let p=Qs(t.matches,f==null?void 0:f.route.id);u&&u[p.route.id]||(u=yt({},u,{[p.route.id]:h.error})),t.fetchers.delete(d)}else if(as(h))$e(!1,"Unhandled fetcher revalidation redirect");else if(ss(h))$e(!1,"Unhandled fetcher deferred data");else{let p=xi(h.data);t.fetchers.set(d,p)}}return{loaderData:l,errors:u}}function S0(t,e,r,n){let i=yt({},e);for(let s of r){let a=s.route.id;if(e.hasOwnProperty(a)?e[a]!==void 0&&(i[a]=e[a]):t[a]!==void 0&&s.route.loader&&(i[a]=t[a]),n&&n.hasOwnProperty(a))break}return i}function E0(t){return t?Rr(t[1])?{actionData:{}}:{actionData:{[t[0]]:t[1].data}}:{}}function Qs(t,e){return(e?t.slice(0,t.findIndex(n=>n.route.id===e)+1):[...t]).reverse().find(n=>n.route.hasErrorBoundary===!0)||t[0]}function T0(t){let e=t.length===1?t[0]:t.find(r=>r.index||!r.path||r.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function ir(t,e){let{pathname:r,routeId:n,method:i,type:s,message:a}=e===void 0?{}:e,o="Unknown Server Error",l="Unknown @remix-run/router error";return t===400?(o="Bad Request",s==="route-discovery"?l='Unable to match URL "'+r+'" - the `unstable_patchRoutesOnNavigation()` '+(`function threw the following error:
`+a):i&&r&&n?l="You made a "+i+' request to "'+r+'" but '+('did not provide a `loader` for route "'+n+'", ')+"so there is no way to handle the request.":s==="defer-action"?l="defer() is not supported in actions":s==="invalid-body"&&(l="Unable to encode submission body")):t===403?(o="Forbidden",l='Route "'+n+'" does not match URL "'+r+'"'):t===404?(o="Not Found",l='No route matches URL "'+r+'"'):t===405&&(o="Method Not Allowed",i&&r&&n?l="You made a "+i.toUpperCase()+' request to "'+r+'" but '+('did not provide an `action` for route "'+n+'", ')+"so there is no way to handle the request.":i&&(l='Invalid request method "'+i.toUpperCase()+'"')),new hc(t||500,o,new Error(l),!0)}function w0(t){for(let e=t.length-1;e>=0;e--){let r=t[e];if(as(r))return{result:r,idx:e}}}function FS(t){let e=typeof t=="string"?Ki(t):t;return xs(yt({},e,{hash:""}))}function BA(t,e){return t.pathname!==e.pathname||t.search!==e.search?!1:t.hash===""?e.hash!=="":t.hash===e.hash?!0:e.hash!==""}function $A(t){return typeof t=="object"&&t!=null&&"then"in t}function jA(t){return US(t.result)&&bA.has(t.result.status)}function ss(t){return t.type===rt.deferred}function Rr(t){return t.type===rt.error}function as(t){return(t&&t.type)===rt.redirect}function b0(t){return typeof t=="object"&&t!=null&&"type"in t&&"data"in t&&"init"in t&&t.type==="DataWithResponseInit"}function VA(t){let e=t;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function US(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.headers=="object"&&typeof t.body<"u"}function GA(t){return wA.has(t.toLowerCase())}function un(t){return EA.has(t.toLowerCase())}async function L0(t,e,r,n,i,s){for(let a=0;a<r.length;a++){let o=r[a],l=e[a];if(!l)continue;let u=t.find(d=>d.route.id===l.route.id),c=u!=null&&!MS(u,l)&&(s&&s[l.route.id])!==void 0;if(ss(o)&&(i||c)){let d=n[a];$e(d,"Expected an AbortSignal for revalidating fetcher deferred result"),await BS(o,d,i).then(f=>{f&&(r[a]=f||r[a])})}}}async function BS(t,e,r){if(r===void 0&&(r=!1),!await t.deferredData.resolveData(e)){if(r)try{return{type:rt.data,data:t.deferredData.unwrappedData}}catch(i){return{type:rt.error,error:i}}return{type:rt.data,data:t.deferredData.data}}}function lm(t){return new URLSearchParams(t).getAll("index").some(e=>e==="")}function uo(t,e){let r=typeof e=="string"?Ki(e).search:e.search;if(t[t.length-1].route.index&&lm(r||""))return t[t.length-1];let n=DS(t);return n[n.length-1]}function A0(t){let{formMethod:e,formAction:r,formEncType:n,text:i,formData:s,json:a}=t;if(!(!e||!r||!n)){if(i!=null)return{formMethod:e,formAction:r,formEncType:n,formData:void 0,json:void 0,text:i};if(s!=null)return{formMethod:e,formAction:r,formEncType:n,formData:s,json:void 0,text:void 0};if(a!==void 0)return{formMethod:e,formAction:r,formEncType:n,formData:void 0,json:a,text:void 0}}}function tf(t,e){return e?{state:"loading",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:t,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function zA(t,e){return{state:"submitting",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function Qa(t,e){return t?{state:"loading",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function HA(t,e){return{state:"submitting",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e?e.data:void 0}}function xi(t){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function WA(t,e){try{let r=t.sessionStorage.getItem(OS);if(r){let n=JSON.parse(r);for(let[i,s]of Object.entries(n||{}))s&&Array.isArray(s)&&e.set(i,new Set(s||[]))}}catch{}}function KA(t,e){if(e.size>0){let r={};for(let[n,i]of e)r[n]=[...i];try{t.sessionStorage.setItem(OS,JSON.stringify(r))}catch(n){Ea(!1,"Failed to save applied view transitions in sessionStorage ("+n+").")}}}/**
 * React Router v6.26.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function pc(){return pc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},pc.apply(this,arguments)}const Sl=L.createContext(null),um=L.createContext(null),hi=L.createContext(null),cm=L.createContext(null),$n=L.createContext({outlet:null,matches:[],isDataRoute:!1}),$S=L.createContext(null);function YA(t,e){let{relative:r}=e===void 0?{}:e;Na()||$e(!1);let{basename:n,navigator:i}=L.useContext(hi),{hash:s,pathname:a,search:o}=hd(t,{relative:r}),l=a;return n!=="/"&&(l=a==="/"?n:si([n,a])),i.createHref({pathname:l,search:o,hash:s})}function Na(){return L.useContext(cm)!=null}function Fa(){return Na()||$e(!1),L.useContext(cm).location}function jS(t){L.useContext(hi).static||L.useLayoutEffect(t)}function Br(){let{isDataRoute:t}=L.useContext($n);return t?l_():qA()}function qA(){Na()||$e(!1);let t=L.useContext(Sl),{basename:e,future:r,navigator:n}=L.useContext(hi),{matches:i}=L.useContext($n),{pathname:s}=Fa(),a=JSON.stringify(cd(i,r.v7_relativeSplatPath)),o=L.useRef(!1);return jS(()=>{o.current=!0}),L.useCallback(function(u,c){if(c===void 0&&(c={}),!o.current)return;if(typeof u=="number"){n.go(u);return}let d=dd(u,JSON.parse(a),s,c.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:si([e,d.pathname])),(c.replace?n.replace:n.push)(d,c.state,c)},[e,n,a,s,t])}const XA=L.createContext(null);function ZA(t){let e=L.useContext($n).outlet;return e&&L.createElement(XA.Provider,{value:t},e)}function VS(){let{matches:t}=L.useContext($n),e=t[t.length-1];return e?e.params:{}}function hd(t,e){let{relative:r}=e===void 0?{}:e,{future:n}=L.useContext(hi),{matches:i}=L.useContext($n),{pathname:s}=Fa(),a=JSON.stringify(cd(i,n.v7_relativeSplatPath));return L.useMemo(()=>dd(t,JSON.parse(a),s,r==="path"),[t,a,s,r])}function QA(t,e,r,n){Na()||$e(!1);let{navigator:i}=L.useContext(hi),{matches:s}=L.useContext($n),a=s[s.length-1],o=a?a.params:{};a&&a.pathname;let l=a?a.pathnameBase:"/";a&&a.route;let u=Fa(),c;c=u;let d=c.pathname||"/",f=d;if(l!=="/"){let p=l.replace(/^\//,"").split("/");f="/"+d.replace(/^\//,"").split("/").slice(p.length).join("/")}let m=ts(t,{pathname:f});return n_(m&&m.map(p=>Object.assign({},p,{params:Object.assign({},o,p.params),pathname:si([l,i.encodeLocation?i.encodeLocation(p.pathname).pathname:p.pathname]),pathnameBase:p.pathnameBase==="/"?l:si([l,i.encodeLocation?i.encodeLocation(p.pathnameBase).pathname:p.pathnameBase])})),s,r,n)}function JA(){let t=o_(),e=fd(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return L.createElement(L.Fragment,null,L.createElement("h2",null,"Unexpected Application Error!"),L.createElement("h3",{style:{fontStyle:"italic"}},e),r?L.createElement("pre",{style:i},r):null,null)}const e_=L.createElement(JA,null);class t_ extends L.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?L.createElement($n.Provider,{value:this.props.routeContext},L.createElement($S.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function r_(t){let{routeContext:e,match:r,children:n}=t,i=L.useContext(Sl);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),L.createElement($n.Provider,{value:e},n)}function n_(t,e,r,n){var i;if(e===void 0&&(e=[]),r===void 0&&(r=null),n===void 0&&(n=null),t==null){var s;if(!r)return null;if(r.errors)t=r.matches;else if((s=n)!=null&&s.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let a=t,o=(i=r)==null?void 0:i.errors;if(o!=null){let c=a.findIndex(d=>d.route.id&&(o==null?void 0:o[d.route.id])!==void 0);c>=0||$e(!1),a=a.slice(0,Math.min(a.length,c+1))}let l=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let c=0;c<a.length;c++){let d=a[c];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(u=c),d.route.id){let{loaderData:f,errors:m}=r,h=d.route.loader&&f[d.route.id]===void 0&&(!m||m[d.route.id]===void 0);if(d.route.lazy||h){l=!0,u>=0?a=a.slice(0,u+1):a=[a[0]];break}}}return a.reduceRight((c,d,f)=>{let m,h=!1,p=null,v=null;r&&(m=o&&d.route.id?o[d.route.id]:void 0,p=d.route.errorElement||e_,l&&(u<0&&f===0?(h=!0,v=null):u===f&&(h=!0,v=d.route.hydrateFallbackElement||null)));let g=e.concat(a.slice(0,f+1)),y=()=>{let x;return m?x=p:h?x=v:d.route.Component?x=L.createElement(d.route.Component,null):d.route.element?x=d.route.element:x=c,L.createElement(r_,{match:d,routeContext:{outlet:c,matches:g,isDataRoute:r!=null},children:x})};return r&&(d.route.ErrorBoundary||d.route.errorElement||f===0)?L.createElement(t_,{location:r.location,revalidation:r.revalidation,component:p,error:m,children:y(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):y()},null)}var GS=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(GS||{}),mc=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(mc||{});function i_(t){let e=L.useContext(Sl);return e||$e(!1),e}function s_(t){let e=L.useContext(um);return e||$e(!1),e}function a_(t){let e=L.useContext($n);return e||$e(!1),e}function zS(t){let e=a_(),r=e.matches[e.matches.length-1];return r.route.id||$e(!1),r.route.id}function o_(){var t;let e=L.useContext($S),r=s_(mc.UseRouteError),n=zS(mc.UseRouteError);return e!==void 0?e:(t=r.errors)==null?void 0:t[n]}function l_(){let{router:t}=i_(GS.UseNavigateStable),e=zS(mc.UseNavigateStable),r=L.useRef(!1);return jS(()=>{r.current=!0}),L.useCallback(function(i,s){s===void 0&&(s={}),r.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,pc({fromRouteId:e},s)))},[t,e])}function HS(t){let{to:e,replace:r,state:n,relative:i}=t;Na()||$e(!1);let{future:s,static:a}=L.useContext(hi),{matches:o}=L.useContext($n),{pathname:l}=Fa(),u=Br(),c=dd(e,cd(o,s.v7_relativeSplatPath),l,i==="path"),d=JSON.stringify(c);return L.useEffect(()=>u(JSON.parse(d),{replace:r,state:n,relative:i}),[u,d,i,r,n]),null}function _0(t){return ZA(t.context)}function u_(t){let{basename:e="/",children:r=null,location:n,navigationType:i=_t.Pop,navigator:s,static:a=!1,future:o}=t;Na()&&$e(!1);let l=e.replace(/^\/*/,"/"),u=L.useMemo(()=>({basename:l,navigator:s,static:a,future:pc({v7_relativeSplatPath:!1},o)}),[l,o,s,a]);typeof n=="string"&&(n=Ki(n));let{pathname:c="/",search:d="",hash:f="",state:m=null,key:h="default"}=n,p=L.useMemo(()=>{let v=ci(c,l);return v==null?null:{location:{pathname:v,search:d,hash:f,state:m,key:h},navigationType:i}},[l,c,d,f,m,h,i]);return p==null?null:L.createElement(hi.Provider,{value:u},L.createElement(cm.Provider,{children:r,value:p}))}new Promise(()=>{});function c_(t){let e={hasErrorBoundary:t.ErrorBoundary!=null||t.errorElement!=null};return t.Component&&Object.assign(e,{element:L.createElement(t.Component),Component:void 0}),t.HydrateFallback&&Object.assign(e,{hydrateFallbackElement:L.createElement(t.HydrateFallback),HydrateFallback:void 0}),t.ErrorBoundary&&Object.assign(e,{errorElement:L.createElement(t.ErrorBoundary),ErrorBoundary:void 0}),e}/**
 * React Router DOM v6.26.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ta(){return Ta=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Ta.apply(this,arguments)}function WS(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,s;for(s=0;s<n.length;s++)i=n[s],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function d_(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function f_(t,e){return t.button===0&&(!e||e==="_self")&&!d_(t)}const h_=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],p_=["aria-current","caseSensitive","className","end","style","to","unstable_viewTransition","children"],m_="6";try{window.__reactRouterVersion=m_}catch{}function g_(t,e){return CA({basename:void 0,future:Ta({},void 0,{v7_prependBasename:!0}),history:QL({window:void 0}),hydrationData:v_(),routes:t,mapRouteProperties:c_,unstable_dataStrategy:void 0,unstable_patchRoutesOnNavigation:void 0,window:void 0}).initialize()}function v_(){var t;let e=(t=window)==null?void 0:t.__staticRouterHydrationData;return e&&e.errors&&(e=Ta({},e,{errors:y_(e.errors)})),e}function y_(t){if(!t)return null;let e=Object.entries(t),r={};for(let[n,i]of e)if(i&&i.__type==="RouteErrorResponse")r[n]=new hc(i.status,i.statusText,i.data,i.internal===!0);else if(i&&i.__type==="Error"){if(i.__subType){let s=window[i.__subType];if(typeof s=="function")try{let a=new s(i.message);a.stack="",r[n]=a}catch{}}if(r[n]==null){let s=new Error(i.message);s.stack="",r[n]=s}}else r[n]=i;return r}const KS=L.createContext({isTransitioning:!1}),x_=L.createContext(new Map),S_="startTransition",C0=Bb[S_],E_="flushSync",R0=ZL[E_];function T_(t){C0?C0(t):t()}function Ja(t){R0?R0(t):t()}class w_{constructor(){this.status="pending",this.promise=new Promise((e,r)=>{this.resolve=n=>{this.status==="pending"&&(this.status="resolved",e(n))},this.reject=n=>{this.status==="pending"&&(this.status="rejected",r(n))}})}}function b_(t){let{fallbackElement:e,router:r,future:n}=t,[i,s]=L.useState(r.state),[a,o]=L.useState(),[l,u]=L.useState({isTransitioning:!1}),[c,d]=L.useState(),[f,m]=L.useState(),[h,p]=L.useState(),v=L.useRef(new Map),{v7_startTransition:g}=n||{},y=L.useCallback(b=>{g?T_(b):b()},[g]),x=L.useCallback((b,I)=>{let{deletedFetchers:A,unstable_flushSync:k,unstable_viewTransitionOpts:O}=I;A.forEach(G=>v.current.delete(G)),b.fetchers.forEach((G,K)=>{G.data!==void 0&&v.current.set(K,G.data)});let P=r.window==null||r.window.document==null||typeof r.window.document.startViewTransition!="function";if(!O||P){k?Ja(()=>s(b)):y(()=>s(b));return}if(k){Ja(()=>{f&&(c&&c.resolve(),f.skipTransition()),u({isTransitioning:!0,flushSync:!0,currentLocation:O.currentLocation,nextLocation:O.nextLocation})});let G=r.window.document.startViewTransition(()=>{Ja(()=>s(b))});G.finished.finally(()=>{Ja(()=>{d(void 0),m(void 0),o(void 0),u({isTransitioning:!1})})}),Ja(()=>m(G));return}f?(c&&c.resolve(),f.skipTransition(),p({state:b,currentLocation:O.currentLocation,nextLocation:O.nextLocation})):(o(b),u({isTransitioning:!0,flushSync:!1,currentLocation:O.currentLocation,nextLocation:O.nextLocation}))},[r.window,f,c,v,y]);L.useLayoutEffect(()=>r.subscribe(x),[r,x]),L.useEffect(()=>{l.isTransitioning&&!l.flushSync&&d(new w_)},[l]),L.useEffect(()=>{if(c&&a&&r.window){let b=a,I=c.promise,A=r.window.document.startViewTransition(async()=>{y(()=>s(b)),await I});A.finished.finally(()=>{d(void 0),m(void 0),o(void 0),u({isTransitioning:!1})}),m(A)}},[y,a,c,r.window]),L.useEffect(()=>{c&&a&&i.location.key===a.location.key&&c.resolve()},[c,f,i.location,a]),L.useEffect(()=>{!l.isTransitioning&&h&&(o(h.state),u({isTransitioning:!0,flushSync:!1,currentLocation:h.currentLocation,nextLocation:h.nextLocation}),p(void 0))},[l.isTransitioning,h]),L.useEffect(()=>{},[]);let S=L.useMemo(()=>({createHref:r.createHref,encodeLocation:r.encodeLocation,go:b=>r.navigate(b),push:(b,I,A)=>r.navigate(b,{state:I,preventScrollReset:A==null?void 0:A.preventScrollReset}),replace:(b,I,A)=>r.navigate(b,{replace:!0,state:I,preventScrollReset:A==null?void 0:A.preventScrollReset})}),[r]),T=r.basename||"/",C=L.useMemo(()=>({router:r,navigator:S,static:!1,basename:T}),[r,S,T]),_=L.useMemo(()=>({v7_relativeSplatPath:r.future.v7_relativeSplatPath}),[r.future.v7_relativeSplatPath]);return L.createElement(L.Fragment,null,L.createElement(Sl.Provider,{value:C},L.createElement(um.Provider,{value:i},L.createElement(x_.Provider,{value:v.current},L.createElement(KS.Provider,{value:l},L.createElement(u_,{basename:T,location:i.location,navigationType:i.historyAction,navigator:S,future:_},i.initialized||r.future.v7_partialHydration?L.createElement(L_,{routes:r.routes,future:r.future,state:i}):e))))),null)}const L_=L.memo(A_);function A_(t){let{routes:e,future:r,state:n}=t;return QA(e,void 0,n,r)}const __=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",C_=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Lu=L.forwardRef(function(e,r){let{onClick:n,relative:i,reloadDocument:s,replace:a,state:o,target:l,to:u,preventScrollReset:c,unstable_viewTransition:d}=e,f=WS(e,h_),{basename:m}=L.useContext(hi),h,p=!1;if(typeof u=="string"&&C_.test(u)&&(h=u,__))try{let x=new URL(window.location.href),S=u.startsWith("//")?new URL(x.protocol+u):new URL(u),T=ci(S.pathname,m);S.origin===x.origin&&T!=null?u=T+S.search+S.hash:p=!0}catch{}let v=YA(u,{relative:i}),g=I_(u,{replace:a,state:o,target:l,preventScrollReset:c,relative:i,unstable_viewTransition:d});function y(x){n&&n(x),x.defaultPrevented||g(x)}return L.createElement("a",Ta({},f,{href:h||v,onClick:p||s?n:y,ref:r,target:l}))}),qt=L.forwardRef(function(e,r){let{"aria-current":n="page",caseSensitive:i=!1,className:s="",end:a=!1,style:o,to:l,unstable_viewTransition:u,children:c}=e,d=WS(e,p_),f=hd(l,{relative:d.relative}),m=Fa(),h=L.useContext(um),{navigator:p,basename:v}=L.useContext(hi),g=h!=null&&k_(f)&&u===!0,y=p.encodeLocation?p.encodeLocation(f).pathname:f.pathname,x=m.pathname,S=h&&h.navigation&&h.navigation.location?h.navigation.location.pathname:null;i||(x=x.toLowerCase(),S=S?S.toLowerCase():null,y=y.toLowerCase()),S&&v&&(S=ci(S,v)||S);const T=y!=="/"&&y.endsWith("/")?y.length-1:y.length;let C=x===y||!a&&x.startsWith(y)&&x.charAt(T)==="/",_=S!=null&&(S===y||!a&&S.startsWith(y)&&S.charAt(y.length)==="/"),b={isActive:C,isPending:_,isTransitioning:g},I=C?n:void 0,A;typeof s=="function"?A=s(b):A=[s,C?"active":null,_?"pending":null,g?"transitioning":null].filter(Boolean).join(" ");let k=typeof o=="function"?o(b):o;return L.createElement(Lu,Ta({},d,{"aria-current":I,className:A,ref:r,style:k,to:l,unstable_viewTransition:u}),typeof c=="function"?c(b):c)});var Oh;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Oh||(Oh={}));var I0;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(I0||(I0={}));function R_(t){let e=L.useContext(Sl);return e||$e(!1),e}function I_(t,e){let{target:r,replace:n,state:i,preventScrollReset:s,relative:a,unstable_viewTransition:o}=e===void 0?{}:e,l=Br(),u=Fa(),c=hd(t,{relative:a});return L.useCallback(d=>{if(f_(d,r)){d.preventDefault();let f=n!==void 0?n:xs(u)===xs(c);l(t,{replace:f,state:i,preventScrollReset:s,relative:a,unstable_viewTransition:o})}},[u,l,c,n,i,r,t,s,a,o])}function k_(t,e){e===void 0&&(e={});let r=L.useContext(KS);r==null&&$e(!1);let{basename:n}=R_(Oh.useViewTransitionState),i=hd(t,{relative:e.relative});if(!r.isTransitioning)return!1;let s=ci(r.currentLocation.pathname,n)||r.currentLocation.pathname,a=ci(r.nextLocation.pathname,n)||r.nextLocation.pathname;return fc(i.pathname,a)!=null||fc(i.pathname,s)!=null}function YS(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(r=YS(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function ri(){for(var t,e,r=0,n="",i=arguments.length;r<i;r++)(t=arguments[r])&&(e=YS(t))&&(n&&(n+=" "),n+=e);return n}const qo=t=>typeof t=="number"&&!isNaN(t),cs=t=>typeof t=="string",Pr=t=>typeof t=="function",Au=t=>cs(t)||Pr(t)?t:null,Mh=t=>L.isValidElement(t)||cs(t)||Pr(t)||qo(t);function D_(t,e,r){r===void 0&&(r=300);const{scrollHeight:n,style:i}=t;requestAnimationFrame(()=>{i.minHeight="initial",i.height=n+"px",i.transition=`all ${r}ms`,requestAnimationFrame(()=>{i.height="0",i.padding="0",i.margin="0",setTimeout(e,r)})})}function pd(t){let{enter:e,exit:r,appendPosition:n=!1,collapse:i=!0,collapseDuration:s=300}=t;return function(a){let{children:o,position:l,preventExitTransition:u,done:c,nodeRef:d,isIn:f,playToast:m}=a;const h=n?`${e}--${l}`:e,p=n?`${r}--${l}`:r,v=L.useRef(0);return L.useLayoutEffect(()=>{const g=d.current,y=h.split(" "),x=S=>{S.target===d.current&&(m(),g.removeEventListener("animationend",x),g.removeEventListener("animationcancel",x),v.current===0&&S.type!=="animationcancel"&&g.classList.remove(...y))};g.classList.add(...y),g.addEventListener("animationend",x),g.addEventListener("animationcancel",x)},[]),L.useEffect(()=>{const g=d.current,y=()=>{g.removeEventListener("animationend",y),i?D_(g,c,s):c()};f||(u?y():(v.current=1,g.className+=` ${p}`,g.addEventListener("animationend",y)))},[f]),ne.createElement(ne.Fragment,null,o)}}function k0(t,e){return t!=null?{content:t.content,containerId:t.props.containerId,id:t.props.toastId,theme:t.props.theme,type:t.props.type,data:t.props.data||{},isLoading:t.props.isLoading,icon:t.props.icon,status:e}:{}}const or=new Map;let Xo=[];const Nh=new Set,P_=t=>Nh.forEach(e=>e(t)),qS=()=>or.size>0;function XS(t,e){var r;if(e)return!((r=or.get(e))==null||!r.isToastActive(t));let n=!1;return or.forEach(i=>{i.isToastActive(t)&&(n=!0)}),n}function ZS(t,e){Mh(t)&&(qS()||Xo.push({content:t,options:e}),or.forEach(r=>{r.buildToast(t,e)}))}function D0(t,e){or.forEach(r=>{e!=null&&e!=null&&e.containerId?(e==null?void 0:e.containerId)===r.id&&r.toggle(t,e==null?void 0:e.id):r.toggle(t,e==null?void 0:e.id)})}function O_(t){const{subscribe:e,getSnapshot:r,setProps:n}=L.useRef(function(s){const a=s.containerId||1;return{subscribe(o){const l=function(c,d,f){let m=1,h=0,p=[],v=[],g=[],y=d;const x=new Map,S=new Set,T=()=>{g=Array.from(x.values()),S.forEach(b=>b())},C=b=>{v=b==null?[]:v.filter(I=>I!==b),T()},_=b=>{const{toastId:I,onOpen:A,updateId:k,children:O}=b.props,P=k==null;b.staleId&&x.delete(b.staleId),x.set(I,b),v=[...v,b.props.toastId].filter(G=>G!==b.staleId),T(),f(k0(b,P?"added":"updated")),P&&Pr(A)&&A(L.isValidElement(O)&&O.props)};return{id:c,props:y,observe:b=>(S.add(b),()=>S.delete(b)),toggle:(b,I)=>{x.forEach(A=>{I!=null&&I!==A.props.toastId||Pr(A.toggle)&&A.toggle(b)})},removeToast:C,toasts:x,clearQueue:()=>{h-=p.length,p=[]},buildToast:(b,I)=>{if((ee=>{let{containerId:fe,toastId:ye,updateId:Re}=ee;const Ee=fe?fe!==c:c!==1,Fe=x.has(ye)&&Re==null;return Ee||Fe})(I))return;const{toastId:A,updateId:k,data:O,staleId:P,delay:G}=I,K=()=>{C(A)},H=k==null;H&&h++;const se={...y,style:y.toastStyle,key:m++,...Object.fromEntries(Object.entries(I).filter(ee=>{let[fe,ye]=ee;return ye!=null})),toastId:A,updateId:k,data:O,closeToast:K,isIn:!1,className:Au(I.className||y.toastClassName),bodyClassName:Au(I.bodyClassName||y.bodyClassName),progressClassName:Au(I.progressClassName||y.progressClassName),autoClose:!I.isLoading&&(W=I.autoClose,F=y.autoClose,W===!1||qo(W)&&W>0?W:F),deleteToast(){const ee=x.get(A),{onClose:fe,children:ye}=ee.props;Pr(fe)&&fe(L.isValidElement(ye)&&ye.props),f(k0(ee,"removed")),x.delete(A),h--,h<0&&(h=0),p.length>0?_(p.shift()):T()}};var W,F;se.closeButton=y.closeButton,I.closeButton===!1||Mh(I.closeButton)?se.closeButton=I.closeButton:I.closeButton===!0&&(se.closeButton=!Mh(y.closeButton)||y.closeButton);let j=b;L.isValidElement(b)&&!cs(b.type)?j=L.cloneElement(b,{closeToast:K,toastProps:se,data:O}):Pr(b)&&(j=b({closeToast:K,toastProps:se,data:O}));const te={content:j,props:se,staleId:P};y.limit&&y.limit>0&&h>y.limit&&H?p.push(te):qo(G)?setTimeout(()=>{_(te)},G):_(te)},setProps(b){y=b},setToggle:(b,I)=>{x.get(b).toggle=I},isToastActive:b=>v.some(I=>I===b),getSnapshot:()=>y.newestOnTop?g.reverse():g}}(a,s,P_);or.set(a,l);const u=l.observe(o);return Xo.forEach(c=>ZS(c.content,c.options)),Xo=[],()=>{u(),or.delete(a)}},setProps(o){var l;(l=or.get(a))==null||l.setProps(o)},getSnapshot(){var o;return(o=or.get(a))==null?void 0:o.getSnapshot()}}}(t)).current;n(t);const i=L.useSyncExternalStore(e,r,r);return{getToastToRender:function(s){if(!i)return[];const a=new Map;return i.forEach(o=>{const{position:l}=o.props;a.has(l)||a.set(l,[]),a.get(l).push(o)}),Array.from(a,o=>s(o[0],o[1]))},isToastActive:XS,count:i==null?void 0:i.length}}function M_(t){const[e,r]=L.useState(!1),[n,i]=L.useState(!1),s=L.useRef(null),a=L.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:o,pauseOnHover:l,closeToast:u,onClick:c,closeOnClick:d}=t;var f,m;function h(){r(!0)}function p(){r(!1)}function v(x){const S=s.current;a.canDrag&&S&&(a.didMove=!0,e&&p(),a.delta=t.draggableDirection==="x"?x.clientX-a.start:x.clientY-a.start,a.start!==x.clientX&&(a.canCloseOnClick=!1),S.style.transform=`translate3d(${t.draggableDirection==="x"?`${a.delta}px, var(--y)`:`0, calc(${a.delta}px + var(--y))`},0)`,S.style.opacity=""+(1-Math.abs(a.delta/a.removalDistance)))}function g(){document.removeEventListener("pointermove",v),document.removeEventListener("pointerup",g);const x=s.current;if(a.canDrag&&a.didMove&&x){if(a.canDrag=!1,Math.abs(a.delta)>a.removalDistance)return i(!0),t.closeToast(),void t.collapseAll();x.style.transition="transform 0.2s, opacity 0.2s",x.style.removeProperty("transform"),x.style.removeProperty("opacity")}}(m=or.get((f={id:t.toastId,containerId:t.containerId,fn:r}).containerId||1))==null||m.setToggle(f.id,f.fn),L.useEffect(()=>{if(t.pauseOnFocusLoss)return document.hasFocus()||p(),window.addEventListener("focus",h),window.addEventListener("blur",p),()=>{window.removeEventListener("focus",h),window.removeEventListener("blur",p)}},[t.pauseOnFocusLoss]);const y={onPointerDown:function(x){if(t.draggable===!0||t.draggable===x.pointerType){a.didMove=!1,document.addEventListener("pointermove",v),document.addEventListener("pointerup",g);const S=s.current;a.canCloseOnClick=!0,a.canDrag=!0,S.style.transition="none",t.draggableDirection==="x"?(a.start=x.clientX,a.removalDistance=S.offsetWidth*(t.draggablePercent/100)):(a.start=x.clientY,a.removalDistance=S.offsetHeight*(t.draggablePercent===80?1.5*t.draggablePercent:t.draggablePercent)/100)}},onPointerUp:function(x){const{top:S,bottom:T,left:C,right:_}=s.current.getBoundingClientRect();x.nativeEvent.type!=="touchend"&&t.pauseOnHover&&x.clientX>=C&&x.clientX<=_&&x.clientY>=S&&x.clientY<=T?p():h()}};return o&&l&&(y.onMouseEnter=p,t.stacked||(y.onMouseLeave=h)),d&&(y.onClick=x=>{c&&c(x),a.canCloseOnClick&&u()}),{playToast:h,pauseToast:p,isRunning:e,preventExitTransition:n,toastRef:s,eventHandlers:y}}function N_(t){let{delay:e,isRunning:r,closeToast:n,type:i="default",hide:s,className:a,style:o,controlledProgress:l,progress:u,rtl:c,isIn:d,theme:f}=t;const m=s||l&&u===0,h={...o,animationDuration:`${e}ms`,animationPlayState:r?"running":"paused"};l&&(h.transform=`scaleX(${u})`);const p=ri("Toastify__progress-bar",l?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${f}`,`Toastify__progress-bar--${i}`,{"Toastify__progress-bar--rtl":c}),v=Pr(a)?a({rtl:c,type:i,defaultClassName:p}):ri(p,a),g={[l&&u>=1?"onTransitionEnd":"onAnimationEnd"]:l&&u<1?null:()=>{d&&n()}};return ne.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":m},ne.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${f} Toastify__progress-bar--${i}`}),ne.createElement("div",{role:"progressbar","aria-hidden":m?"true":"false","aria-label":"notification timer",className:v,style:h,...g}))}let F_=1;const QS=()=>""+F_++;function U_(t){return t&&(cs(t.toastId)||qo(t.toastId))?t.toastId:QS()}function wo(t,e){return ZS(t,e),e.toastId}function gc(t,e){return{...e,type:e&&e.type||t,toastId:U_(e)}}function Xl(t){return(e,r)=>wo(e,gc(t,r))}function Ke(t,e){return wo(t,gc("default",e))}Ke.loading=(t,e)=>wo(t,gc("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...e})),Ke.promise=function(t,e,r){let n,{pending:i,error:s,success:a}=e;i&&(n=cs(i)?Ke.loading(i,r):Ke.loading(i.render,{...r,...i}));const o={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},l=(c,d,f)=>{if(d==null)return void Ke.dismiss(n);const m={type:c,...o,...r,data:f},h=cs(d)?{render:d}:d;return n?Ke.update(n,{...m,...h}):Ke(h.render,{...m,...h}),f},u=Pr(t)?t():t;return u.then(c=>l("success",a,c)).catch(c=>l("error",s,c)),u},Ke.success=Xl("success"),Ke.info=Xl("info"),Ke.error=Xl("error"),Ke.warning=Xl("warning"),Ke.warn=Ke.warning,Ke.dark=(t,e)=>wo(t,gc("default",{theme:"dark",...e})),Ke.dismiss=function(t){(function(e){var r;if(qS()){if(e==null||cs(r=e)||qo(r))or.forEach(n=>{n.removeToast(e)});else if(e&&("containerId"in e||"id"in e)){const n=or.get(e.containerId);n?n.removeToast(e.id):or.forEach(i=>{i.removeToast(e.id)})}}else Xo=Xo.filter(n=>e!=null&&n.options.toastId!==e)})(t)},Ke.clearWaitingQueue=function(t){t===void 0&&(t={}),or.forEach(e=>{!e.props.limit||t.containerId&&e.id!==t.containerId||e.clearQueue()})},Ke.isActive=XS,Ke.update=function(t,e){e===void 0&&(e={});const r=((n,i)=>{var s;let{containerId:a}=i;return(s=or.get(a||1))==null?void 0:s.toasts.get(n)})(t,e);if(r){const{props:n,content:i}=r,s={delay:100,...n,...e,toastId:e.toastId||t,updateId:QS()};s.toastId!==t&&(s.staleId=t);const a=s.render||i;delete s.render,wo(a,s)}},Ke.done=t=>{Ke.update(t,{progress:1})},Ke.onChange=function(t){return Nh.add(t),()=>{Nh.delete(t)}},Ke.play=t=>D0(!0,t),Ke.pause=t=>D0(!1,t);const B_=typeof window<"u"?L.useLayoutEffect:L.useEffect,Zl=t=>{let{theme:e,type:r,isLoading:n,...i}=t;return ne.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:e==="colored"?"currentColor":`var(--toastify-icon-color-${r})`,...i})},rf={info:function(t){return ne.createElement(Zl,{...t},ne.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))},warning:function(t){return ne.createElement(Zl,{...t},ne.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))},success:function(t){return ne.createElement(Zl,{...t},ne.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))},error:function(t){return ne.createElement(Zl,{...t},ne.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))},spinner:function(){return ne.createElement("div",{className:"Toastify__spinner"})}},$_=t=>{const{isRunning:e,preventExitTransition:r,toastRef:n,eventHandlers:i,playToast:s}=M_(t),{closeButton:a,children:o,autoClose:l,onClick:u,type:c,hideProgressBar:d,closeToast:f,transition:m,position:h,className:p,style:v,bodyClassName:g,bodyStyle:y,progressClassName:x,progressStyle:S,updateId:T,role:C,progress:_,rtl:b,toastId:I,deleteToast:A,isIn:k,isLoading:O,closeOnClick:P,theme:G}=t,K=ri("Toastify__toast",`Toastify__toast-theme--${G}`,`Toastify__toast--${c}`,{"Toastify__toast--rtl":b},{"Toastify__toast--close-on-click":P}),H=Pr(p)?p({rtl:b,position:h,type:c,defaultClassName:K}):ri(K,p),se=function(te){let{theme:ee,type:fe,isLoading:ye,icon:Re}=te,Ee=null;const Fe={theme:ee,type:fe};return Re===!1||(Pr(Re)?Ee=Re({...Fe,isLoading:ye}):L.isValidElement(Re)?Ee=L.cloneElement(Re,Fe):ye?Ee=rf.spinner():(st=>st in rf)(fe)&&(Ee=rf[fe](Fe))),Ee}(t),W=!!_||!l,F={closeToast:f,type:c,theme:G};let j=null;return a===!1||(j=Pr(a)?a(F):L.isValidElement(a)?L.cloneElement(a,F):function(te){let{closeToast:ee,theme:fe,ariaLabel:ye="close"}=te;return ne.createElement("button",{className:`Toastify__close-button Toastify__close-button--${fe}`,type:"button",onClick:Re=>{Re.stopPropagation(),ee(Re)},"aria-label":ye},ne.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},ne.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}(F)),ne.createElement(m,{isIn:k,done:A,position:h,preventExitTransition:r,nodeRef:n,playToast:s},ne.createElement("div",{id:I,onClick:u,"data-in":k,className:H,...i,style:v,ref:n},ne.createElement("div",{...k&&{role:C},className:Pr(g)?g({type:c}):ri("Toastify__toast-body",g),style:y},se!=null&&ne.createElement("div",{className:ri("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!O})},se),ne.createElement("div",null,o)),j,ne.createElement(N_,{...T&&!W?{key:`pb-${T}`}:{},rtl:b,theme:G,delay:l,isRunning:e,isIn:k,closeToast:f,hide:d,type:c,style:S,className:x,controlledProgress:W,progress:_||0})))},md=function(t,e){return e===void 0&&(e=!1),{enter:`Toastify--animate Toastify__${t}-enter`,exit:`Toastify--animate Toastify__${t}-exit`,appendPosition:e}},j_=pd(md("bounce",!0));pd(md("slide",!0));pd(md("zoom"));pd(md("flip"));const V_={position:"top-right",transition:j_,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light"};function G_(t){let e={...V_,...t};const r=t.stacked,[n,i]=L.useState(!0),s=L.useRef(null),{getToastToRender:a,isToastActive:o,count:l}=O_(e),{className:u,style:c,rtl:d,containerId:f}=e;function m(p){const v=ri("Toastify__toast-container",`Toastify__toast-container--${p}`,{"Toastify__toast-container--rtl":d});return Pr(u)?u({position:p,rtl:d,defaultClassName:v}):ri(v,Au(u))}function h(){r&&(i(!0),Ke.play())}return B_(()=>{if(r){var p;const v=s.current.querySelectorAll('[data-in="true"]'),g=12,y=(p=e.position)==null?void 0:p.includes("top");let x=0,S=0;Array.from(v).reverse().forEach((T,C)=>{const _=T;_.classList.add("Toastify__toast--stacked"),C>0&&(_.dataset.collapsed=`${n}`),_.dataset.pos||(_.dataset.pos=y?"top":"bot");const b=x*(n?.2:1)+(n?0:g*C);_.style.setProperty("--y",`${y?b:-1*b}px`),_.style.setProperty("--g",`${g}`),_.style.setProperty("--s",""+(1-(n?S:0))),x+=_.offsetHeight,S+=.025})}},[n,l,r]),ne.createElement("div",{ref:s,className:"Toastify",id:f,onMouseEnter:()=>{r&&(i(!1),Ke.pause())},onMouseLeave:h},a((p,v)=>{const g=v.length?{...c}:{...c,pointerEvents:"none"};return ne.createElement("div",{className:m(p),style:g,key:`container-${p}`},v.map(y=>{let{content:x,props:S}=y;return ne.createElement($_,{...S,stacked:r,collapseAll:h,isIn:o(S.toastId,S.containerId),style:S.style,key:`toast-${S.key}`},x)}))}))}const z_={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_API_URL:""},P0=t=>{let e;const r=new Set,n=(c,d)=>{const f=typeof c=="function"?c(e):c;if(!Object.is(f,e)){const m=e;e=d??(typeof f!="object"||f===null)?f:Object.assign({},e,f),r.forEach(h=>h(e,m))}},i=()=>e,l={setState:n,getState:i,getInitialState:()=>u,subscribe:c=>(r.add(c),()=>r.delete(c)),destroy:()=>{(z_?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},u=e=t(n,i,l);return l},H_=t=>t?P0(t):P0;var JS={exports:{}},eE={},tE={exports:{}},rE={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wa=L;function W_(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var K_=typeof Object.is=="function"?Object.is:W_,Y_=wa.useState,q_=wa.useEffect,X_=wa.useLayoutEffect,Z_=wa.useDebugValue;function Q_(t,e){var r=e(),n=Y_({inst:{value:r,getSnapshot:e}}),i=n[0].inst,s=n[1];return X_(function(){i.value=r,i.getSnapshot=e,nf(i)&&s({inst:i})},[t,r,e]),q_(function(){return nf(i)&&s({inst:i}),t(function(){nf(i)&&s({inst:i})})},[t]),Z_(r),r}function nf(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!K_(t,r)}catch{return!0}}function J_(t,e){return e()}var eC=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?J_:Q_;rE.useSyncExternalStore=wa.useSyncExternalStore!==void 0?wa.useSyncExternalStore:eC;tE.exports=rE;var tC=tE.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gd=L,rC=tC;function nC(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var iC=typeof Object.is=="function"?Object.is:nC,sC=rC.useSyncExternalStore,aC=gd.useRef,oC=gd.useEffect,lC=gd.useMemo,uC=gd.useDebugValue;eE.useSyncExternalStoreWithSelector=function(t,e,r,n,i){var s=aC(null);if(s.current===null){var a={hasValue:!1,value:null};s.current=a}else a=s.current;s=lC(function(){function l(m){if(!u){if(u=!0,c=m,m=n(m),i!==void 0&&a.hasValue){var h=a.value;if(i(h,m))return d=h}return d=m}if(h=d,iC(c,m))return h;var p=n(m);return i!==void 0&&i(h,p)?h:(c=m,d=p)}var u=!1,c,d,f=r===void 0?null:r;return[function(){return l(e())},f===null?void 0:function(){return l(f())}]},[e,r,n,i]);var o=sC(t,s[0],s[1]);return oC(function(){a.hasValue=!0,a.value=o},[o]),uC(o),o};JS.exports=eE;var cC=JS.exports;const dC=dp(cC),nE={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_API_URL:""},{useDebugValue:fC}=ne,{useSyncExternalStoreWithSelector:hC}=dC;let O0=!1;const pC=t=>t;function mC(t,e=pC,r){(nE?"production":void 0)!=="production"&&r&&!O0&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),O0=!0);const n=hC(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,r);return fC(n),n}const gC=t=>{(nE?"production":void 0)!=="production"&&typeof t!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof t=="function"?H_(t):t,r=(n,i)=>mC(e,n,i);return Object.assign(r,e),r},vC=t=>gC,yC={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_API_URL:""};function xC(t,e){let r;try{r=t()}catch{return}return{getItem:i=>{var s;const a=l=>l===null?null:JSON.parse(l,void 0),o=(s=r.getItem(i))!=null?s:null;return o instanceof Promise?o.then(a):a(o)},setItem:(i,s)=>r.setItem(i,JSON.stringify(s,void 0)),removeItem:i=>r.removeItem(i)}}const Zo=t=>e=>{try{const r=t(e);return r instanceof Promise?r:{then(n){return Zo(n)(r)},catch(n){return this}}}catch(r){return{then(n){return this},catch(n){return Zo(n)(r)}}}},SC=(t,e)=>(r,n,i)=>{let s={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:v=>v,version:0,merge:(v,g)=>({...g,...v}),...e},a=!1;const o=new Set,l=new Set;let u;try{u=s.getStorage()}catch{}if(!u)return t((...v)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),r(...v)},n,i);const c=Zo(s.serialize),d=()=>{const v=s.partialize({...n()});let g;const y=c({state:v,version:s.version}).then(x=>u.setItem(s.name,x)).catch(x=>{g=x});if(g)throw g;return y},f=i.setState;i.setState=(v,g)=>{f(v,g),d()};const m=t((...v)=>{r(...v),d()},n,i);let h;const p=()=>{var v;if(!u)return;a=!1,o.forEach(y=>y(n()));const g=((v=s.onRehydrateStorage)==null?void 0:v.call(s,n()))||void 0;return Zo(u.getItem.bind(u))(s.name).then(y=>{if(y)return s.deserialize(y)}).then(y=>{if(y)if(typeof y.version=="number"&&y.version!==s.version){if(s.migrate)return s.migrate(y.state,y.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return y.state}).then(y=>{var x;return h=s.merge(y,(x=n())!=null?x:m),r(h,!0),d()}).then(()=>{g==null||g(h,void 0),a=!0,l.forEach(y=>y(h))}).catch(y=>{g==null||g(void 0,y)})};return i.persist={setOptions:v=>{s={...s,...v},v.getStorage&&(u=v.getStorage())},clearStorage:()=>{u==null||u.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>p(),hasHydrated:()=>a,onHydrate:v=>(o.add(v),()=>{o.delete(v)}),onFinishHydration:v=>(l.add(v),()=>{l.delete(v)})},p(),h||m},EC=(t,e)=>(r,n,i)=>{let s={storage:xC(()=>localStorage),partialize:p=>p,version:0,merge:(p,v)=>({...v,...p}),...e},a=!1;const o=new Set,l=new Set;let u=s.storage;if(!u)return t((...p)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),r(...p)},n,i);const c=()=>{const p=s.partialize({...n()});return u.setItem(s.name,{state:p,version:s.version})},d=i.setState;i.setState=(p,v)=>{d(p,v),c()};const f=t((...p)=>{r(...p),c()},n,i);i.getInitialState=()=>f;let m;const h=()=>{var p,v;if(!u)return;a=!1,o.forEach(y=>{var x;return y((x=n())!=null?x:f)});const g=((v=s.onRehydrateStorage)==null?void 0:v.call(s,(p=n())!=null?p:f))||void 0;return Zo(u.getItem.bind(u))(s.name).then(y=>{if(y)if(typeof y.version=="number"&&y.version!==s.version){if(s.migrate)return[!0,s.migrate(y.state,y.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,y.state];return[!1,void 0]}).then(y=>{var x;const[S,T]=y;if(m=s.merge(T,(x=n())!=null?x:f),r(m,!0),S)return c()}).then(()=>{g==null||g(m,void 0),m=n(),a=!0,l.forEach(y=>y(m))}).catch(y=>{g==null||g(void 0,y)})};return i.persist={setOptions:p=>{s={...s,...p},p.storage&&(u=p.storage)},clearStorage:()=>{u==null||u.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>h(),hasHydrated:()=>a,onHydrate:p=>(o.add(p),()=>{o.delete(p)}),onFinishHydration:p=>(l.add(p),()=>{l.delete(p)})},s.skipHydration||h(),m||f},TC=(t,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((yC?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),SC(t,e)):EC(t,e),wC=TC,Ua=vC()(wC(t=>({access_token:localStorage.getItem("access_token")||"",refresh_token:localStorage.getItem("refresh_token")||"",profileData:null,isLoggedIn:!1,updateAccessToken:e=>{t({access_token:e})},updateProfileData:e=>{t({profileData:e})},login:(e,r,n)=>{localStorage.setItem("access_token",e),localStorage.setItem("refresh_token",r),t({access_token:e,refresh_token:r,profileData:n,isLoggedIn:!0})},logout:()=>{localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),t({access_token:"",refresh_token:"",profileData:null,isLoggedIn:!1})}}),{name:"login-storage",getStorage:()=>localStorage})),ur=(t,e="")=>{const[r,n]=L.useState(null),[i,s]=L.useState(!0),[a,o]=L.useState(null),l=L.useRef(null),{updateProfileData:u,updateAccessToken:c,logout:d}=Ua(),f=Br(),m=L.useCallback(async()=>{var g;if(t===""){s(!1);return}t.startsWith("/")||(t=`/${t}`),t.startsWith("http")&&(e=""),e||(e="");let p;const v=new AbortController;l.current=v;try{p=await fetch(`${e}${t}`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`},signal:v.signal});let y;try{y=await p.json()}catch{y=await p.text(),y=JSON.parse(y)}if(y.error&&y.message==="INVALID_TOKEN")throw new Error(JSON.stringify(y));n(y),s(!1),o(null)}catch(y){if((g=l.current)!=null&&g.signal.aborted)return;if(p=JSON.parse(y.message),p.message==="INVALID_TOKEN"){const S=await(await fetch(`${e}/api/auth/refresh`,{method:"POST",body:JSON.stringify({refresh_token:localStorage.getItem("refresh_token")}),headers:{"Content-Type":"application/json"}})).json();if(S.error){d(),f("/login"),s(!1);return}else{localStorage.setItem("access_token",S.data.access_token),c(S.data.access_token),u(S.data.user),m();return}}o(p),s(!1),n(null)}},[t]);return L.useEffect(()=>{s(!0),m()},[m]),{data:r,loading:i,error:a,fetchData:m,interupt:()=>{var p;(p=l.current)==null||p.abort()}}};function Ss(){const[t,e]=L.useState(null),[r,n]=L.useState(!1),[i,s]=L.useState(null),[a,o]=L.useState(null),{access_token:l,refresh_token:u}=Ua(),c={Authorization:`Bearer ${l}`,"x-refresh-token":u};return{data:t,handleSubmit:async({e:m="",url:h,body:p=t,headers:v={...c},dispatcher:g=null,dispatch:y=x=>x})=>{m&&m.preventDefault(),n(!0),s(null);try{const x={method:"POST",headers:{...v,...c,"Content-Type":p instanceof FormData?"multipart/form-data":"application/json"},body:p instanceof FormData?p:JSON.stringify(p)};h.startsWith("http")||(h=`${h}`);const S=await fetch(h,x);if(!S.ok)throw new Error(`Request failed with status ${S.status}`);const T=await S.json();g!==null&&y!==null?g(y(T)):(e(T),o(T)),n(!1),s(null)}catch(x){s(x.message),n(!1)}},handleChange:m=>{m.persist(),e(h=>({...h,[m.target.name]:m.target.value}))},pending:r,error:i,resMsg:a}}function iE(){const[t,e]=L.useState(null),[r,n]=L.useState(!1),[i,s]=L.useState(null),[a,o]=L.useState(null),{access_token:l,refresh_token:u}=Ua(),c={Authorization:`Bearer ${l}`,"x-refresh-token":u};return{data:t,handleSubmit:async({e:m="",url:h,body:p=t,headers:v={...c},dispatcher:g=null,dispatch:y=x=>x})=>{m&&m.preventDefault(),n(!0),s(null);try{const x={method:"DELETE",headers:{...v,...c,"Content-Type":p instanceof FormData?"multipart/form-data":"application/json"},body:p instanceof FormData?p:JSON.stringify(p)};h.startsWith("http")||(h=`${h}`);const S=await fetch(h,x);if(!S.ok)throw new Error(`Request failed with status ${S.status}`);const T=await S.json();g!==null&&y!==null?g(y(T)):(e(T),o(T)),n(!1),s(null)}catch(x){s(x.message),n(!1)}},handleChange:m=>{m.persist(),e(h=>({...h,[m.target.name]:m.target.value}))},pending:r,error:i,resMsg:a}}function sE(){const[t,e]=L.useState(null),[r,n]=L.useState(!1),[i,s]=L.useState(null),[a,o]=L.useState(null),{access_token:l,refresh_token:u}=Ua(),c={Authorization:`Bearer ${l}`,"x-refresh-token":u};return{data:t,handleSubmit:async({e:m="",url:h,body:p=t,headers:v={...c},dispatcher:g=null,dispatch:y=x=>x})=>{m&&m.preventDefault(),n(!0),s(null);try{const x={method:"PUT",headers:{...v,...c,"Content-Type":p instanceof FormData?"multipart/form-data":"application/json"},body:p instanceof FormData?p:JSON.stringify(p)};h.startsWith("http")||(h=`${h}`);const S=await fetch(h,x);if(!S.ok)throw new Error(`Request failed with status ${S.status}`);const T=await S.json();g!==null&&y!==null?g(y(T)):(e(T),o(T)),n(!1),s(null)}catch(x){s(x.message),n(!1)}},handleChange:m=>{m.persist(),e(h=>({...h,[m.target.name]:m.target.value}))},pending:r,error:i,resMsg:a}}const dm=()=>{const{login:t,logout:e,isLoggedIn:r,profileData:n,updateProfileData:i}=Ua(),{handleSubmit:s}=Ss(),a=c=>{if(c){if(c.error)throw new Error(c.error);if(c.data){const{access_token:d,refresh_token:f,user:m}=c.data;t(d,f,m)}}};return{login:async({username:c,password:d})=>{await s({url:"/api/auth/login",body:{username:c,password:d},dispatcher:a})},logout:()=>{e()},isLoggedIn:r,profileData:n,updateProfileData:c=>{i(c)}}},bC=({user:t,onClick:e})=>E.jsxs("article",{className:"flex flex-col items-center justify-center gap-2 cursor-pointer",onClick:e,children:[E.jsx("img",{className:"w-32 h-32 rounded-lg",src:`${t.profile_picture}`,alt:t.name}),E.jsx("h2",{className:"text-2xl max-w-32 text-neutral-200 overflow-hidden text-ellipsis",children:t.name})]}),LC=({selectedUser:t,isOpen:e,onClose:r,onSubmit:n})=>{const[i,s]=L.useState("");return E.jsxs(E.Fragment,{children:[E.jsx("section",{className:`fixed top-0 left-0 w-full h-full bg-black bg-opacity-0 z-50 ${e?"pointer-events-auto":"bg-opacity-0 pointer-events-none"} transition-opacity duration-300`,onClick:r})," ",E.jsxs("section",{className:`fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-neutral-900 rounded-lg p-8 z-50 ${e?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"} transition-opacity duration-300`,children:[E.jsx("input",{type:"password",placeholder:"Password",value:i,onChange:a=>s(a.target.value),className:"w-full px-4 py-2 mb-4 rounded-lg border border-neutral-300 focus:outline-none focus:ring-2 focus:ring-primary-500"}),E.jsx("button",{onClick:()=>n((t==null?void 0:t.name)||"",i),className:"w-full px-4 py-2 text-white bg-primary-500 rounded-lg hover:bg-primary-600 focus:outline-none focus:ring-2 focus:ring-primary-500",children:"Login"})]})]})},AC=()=>{const[t,e]=L.useState(!1),[r,n]=L.useState(null),{data:i,error:s}=ur("/api/auth/accounts"),{login:a}=dm(),o=Br();L.useEffect(()=>{i&&i.data.length===0&&o("/invite")},[i]),L.useEffect(()=>{s&&Ke.error(s.message)});const l=c=>{c.password_empty?u(c.name,""):(n(c),e(!0))},u=async(c,d)=>{try{await a({username:c,password:d}),o("/home")}catch(f){Ke.error(f.message)}};return E.jsxs(E.Fragment,{children:[E.jsx("section",{className:"flex flex-wrap items-center justify-center content-center gap-x-16 gap-y-8 px-80 py-32 max-h-screen h-screen max-w-screen",children:i&&i.data.map(c=>E.jsx(bC,{user:c,onClick:()=>l(c)},c.id))}),E.jsx(LC,{selectedUser:r,isOpen:t,onClose:()=>{e(!1),n(null)},onSubmit:u})]})},_C=()=>{const t=Br(),{logout:e}=dm();return L.useEffect(()=>{e(),t("/login")},[]),E.jsx("div",{children:"Logging out..."})};var El=t=>t.type==="checkbox",Js=t=>t instanceof Date,ar=t=>t==null;const aE=t=>typeof t=="object";var Rt=t=>!ar(t)&&!Array.isArray(t)&&aE(t)&&!Js(t),oE=t=>Rt(t)&&t.target?El(t.target)?t.target.checked:t.target.value:t,CC=t=>t.substring(0,t.search(/\.\d+(\.|$)/))||t,lE=(t,e)=>t.has(CC(e)),RC=t=>{const e=t.constructor&&t.constructor.prototype;return Rt(e)&&e.hasOwnProperty("isPrototypeOf")},fm=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function mr(t){let e;const r=Array.isArray(t);if(t instanceof Date)e=new Date(t);else if(t instanceof Set)e=new Set(t);else if(!(fm&&(t instanceof Blob||t instanceof FileList))&&(r||Rt(t)))if(e=r?[]:{},!r&&!RC(t))e=t;else for(const n in t)t.hasOwnProperty(n)&&(e[n]=mr(t[n]));else return t;return e}var vd=t=>Array.isArray(t)?t.filter(Boolean):[],bt=t=>t===void 0,ie=(t,e,r)=>{if(!e||!Rt(t))return r;const n=vd(e.split(/[,[\].]+?/)).reduce((i,s)=>ar(i)?i:i[s],t);return bt(n)||n===t?bt(t[e])?r:t[e]:n},Wr=t=>typeof t=="boolean",hm=t=>/^\w*$/.test(t),uE=t=>vd(t.replace(/["|']|\]/g,"").split(/\.|\[/)),Ze=(t,e,r)=>{let n=-1;const i=hm(e)?[e]:uE(e),s=i.length,a=s-1;for(;++n<s;){const o=i[n];let l=r;if(n!==a){const u=t[o];l=Rt(u)||Array.isArray(u)?u:isNaN(+i[n+1])?{}:[]}if(o==="__proto__")return;t[o]=l,t=t[o]}return t};const vc={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},fn={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Gn={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},cE=ne.createContext(null),yd=()=>ne.useContext(cE),IC=t=>{const{children:e,...r}=t;return ne.createElement(cE.Provider,{value:r},e)};var dE=(t,e,r,n=!0)=>{const i={defaultValues:e._defaultValues};for(const s in t)Object.defineProperty(i,s,{get:()=>{const a=s;return e._proxyFormState[a]!==fn.all&&(e._proxyFormState[a]=!n||fn.all),r&&(r[a]=!0),t[a]}});return i},gr=t=>Rt(t)&&!Object.keys(t).length,fE=(t,e,r,n)=>{r(t);const{name:i,...s}=t;return gr(s)||Object.keys(s).length>=Object.keys(e).length||Object.keys(s).find(a=>e[a]===(!n||fn.all))},bo=t=>Array.isArray(t)?t:[t],hE=(t,e,r)=>!t||!e||t===e||bo(t).some(n=>n&&(r?n===e:n.startsWith(e)||e.startsWith(n)));function pm(t){const e=ne.useRef(t);e.current=t,ne.useEffect(()=>{const r=!t.disabled&&e.current.subject&&e.current.subject.subscribe({next:e.current.next});return()=>{r&&r.unsubscribe()}},[t.disabled])}function kC(t){const e=yd(),{control:r=e.control,disabled:n,name:i,exact:s}=t||{},[a,o]=ne.useState(r._formState),l=ne.useRef(!0),u=ne.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1}),c=ne.useRef(i);return c.current=i,pm({disabled:n,next:d=>l.current&&hE(c.current,d.name,s)&&fE(d,u.current,r._updateFormState)&&o({...r._formState,...d}),subject:r._subjects.state}),ne.useEffect(()=>(l.current=!0,u.current.isValid&&r._updateValid(!0),()=>{l.current=!1}),[r]),dE(a,r,u.current,!1)}var Cn=t=>typeof t=="string",pE=(t,e,r,n,i)=>Cn(t)?(n&&e.watch.add(t),ie(r,t,i)):Array.isArray(t)?t.map(s=>(n&&e.watch.add(s),ie(r,s))):(n&&(e.watchAll=!0),r);function DC(t){const e=yd(),{control:r=e.control,name:n,defaultValue:i,disabled:s,exact:a}=t||{},o=ne.useRef(n);o.current=n,pm({disabled:s,subject:r._subjects.values,next:c=>{hE(o.current,c.name,a)&&u(mr(pE(o.current,r._names,c.values||r._formValues,!1,i)))}});const[l,u]=ne.useState(r._getWatch(n,i));return ne.useEffect(()=>r._removeUnmounted()),l}function PC(t){const e=yd(),{name:r,disabled:n,control:i=e.control,shouldUnregister:s}=t,a=lE(i._names.array,r),o=DC({control:i,name:r,defaultValue:ie(i._formValues,r,ie(i._defaultValues,r,t.defaultValue)),exact:!0}),l=kC({control:i,name:r,exact:!0}),u=ne.useRef(i.register(r,{...t.rules,value:o,...Wr(t.disabled)?{disabled:t.disabled}:{}}));return ne.useEffect(()=>{const c=i._options.shouldUnregister||s,d=(f,m)=>{const h=ie(i._fields,f);h&&h._f&&(h._f.mount=m)};if(d(r,!0),c){const f=mr(ie(i._options.defaultValues,r));Ze(i._defaultValues,r,f),bt(ie(i._formValues,r))&&Ze(i._formValues,r,f)}return()=>{(a?c&&!i._state.action:c)?i.unregister(r):d(r,!1)}},[r,i,a,s]),ne.useEffect(()=>{ie(i._fields,r)&&i._updateDisabledField({disabled:n,fields:i._fields,name:r,value:ie(i._fields,r)._f.value})},[n,r,i]),{field:{name:r,value:o,...Wr(n)||l.disabled?{disabled:l.disabled||n}:{},onChange:ne.useCallback(c=>u.current.onChange({target:{value:oE(c),name:r},type:vc.CHANGE}),[r]),onBlur:ne.useCallback(()=>u.current.onBlur({target:{value:ie(i._formValues,r),name:r},type:vc.BLUR}),[r,i]),ref:ne.useCallback(c=>{const d=ie(i._fields,r);d&&c&&(d._f.ref={focus:()=>c.focus(),select:()=>c.select(),setCustomValidity:f=>c.setCustomValidity(f),reportValidity:()=>c.reportValidity()})},[i._fields,r])},formState:l,fieldState:Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!ie(l.errors,r)},isDirty:{enumerable:!0,get:()=>!!ie(l.dirtyFields,r)},isTouched:{enumerable:!0,get:()=>!!ie(l.touchedFields,r)},isValidating:{enumerable:!0,get:()=>!!ie(l.validatingFields,r)},error:{enumerable:!0,get:()=>ie(l.errors,r)}})}}const OC=t=>t.render(PC(t));var mE=(t,e,r,n,i)=>e?{...r[t],types:{...r[t]&&r[t].types?r[t].types:{},[n]:i||!0}}:{},M0=t=>({isOnSubmit:!t||t===fn.onSubmit,isOnBlur:t===fn.onBlur,isOnChange:t===fn.onChange,isOnAll:t===fn.all,isOnTouch:t===fn.onTouched}),N0=(t,e,r)=>!r&&(e.watchAll||e.watch.has(t)||[...e.watch].some(n=>t.startsWith(n)&&/^\.\w+/.test(t.slice(n.length))));const Lo=(t,e,r,n)=>{for(const i of r||Object.keys(t)){const s=ie(t,i);if(s){const{_f:a,...o}=s;if(a){if(a.refs&&a.refs[0]&&e(a.refs[0],i)&&!n)return!0;if(a.ref&&e(a.ref,a.name)&&!n)return!0;if(Lo(o,e))break}else if(Rt(o)&&Lo(o,e))break}}};var MC=(t,e,r)=>{const n=bo(ie(t,r));return Ze(n,"root",e[r]),Ze(t,r,n),t},mm=t=>t.type==="file",ni=t=>typeof t=="function",yc=t=>{if(!fm)return!1;const e=t?t.ownerDocument:0;return t instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},_u=t=>Cn(t),gm=t=>t.type==="radio",xc=t=>t instanceof RegExp;const F0={value:!1,isValid:!1},U0={value:!0,isValid:!0};var gE=t=>{if(Array.isArray(t)){if(t.length>1){const e=t.filter(r=>r&&r.checked&&!r.disabled).map(r=>r.value);return{value:e,isValid:!!e.length}}return t[0].checked&&!t[0].disabled?t[0].attributes&&!bt(t[0].attributes.value)?bt(t[0].value)||t[0].value===""?U0:{value:t[0].value,isValid:!0}:U0:F0}return F0};const B0={isValid:!1,value:null};var vE=t=>Array.isArray(t)?t.reduce((e,r)=>r&&r.checked&&!r.disabled?{isValid:!0,value:r.value}:e,B0):B0;function $0(t,e,r="validate"){if(_u(t)||Array.isArray(t)&&t.every(_u)||Wr(t)&&!t)return{type:r,message:_u(t)?t:"",ref:e}}var Ps=t=>Rt(t)&&!xc(t)?t:{value:t,message:""},j0=async(t,e,r,n,i)=>{const{ref:s,refs:a,required:o,maxLength:l,minLength:u,min:c,max:d,pattern:f,validate:m,name:h,valueAsNumber:p,mount:v,disabled:g}=t._f,y=ie(e,h);if(!v||g)return{};const x=a?a[0]:s,S=O=>{n&&x.reportValidity&&(x.setCustomValidity(Wr(O)?"":O||""),x.reportValidity())},T={},C=gm(s),_=El(s),b=C||_,I=(p||mm(s))&&bt(s.value)&&bt(y)||yc(s)&&s.value===""||y===""||Array.isArray(y)&&!y.length,A=mE.bind(null,h,r,T),k=(O,P,G,K=Gn.maxLength,H=Gn.minLength)=>{const se=O?P:G;T[h]={type:O?K:H,message:se,ref:s,...A(O?K:H,se)}};if(i?!Array.isArray(y)||!y.length:o&&(!b&&(I||ar(y))||Wr(y)&&!y||_&&!gE(a).isValid||C&&!vE(a).isValid)){const{value:O,message:P}=_u(o)?{value:!!o,message:o}:Ps(o);if(O&&(T[h]={type:Gn.required,message:P,ref:x,...A(Gn.required,P)},!r))return S(P),T}if(!I&&(!ar(c)||!ar(d))){let O,P;const G=Ps(d),K=Ps(c);if(!ar(y)&&!isNaN(y)){const H=s.valueAsNumber||y&&+y;ar(G.value)||(O=H>G.value),ar(K.value)||(P=H<K.value)}else{const H=s.valueAsDate||new Date(y),se=j=>new Date(new Date().toDateString()+" "+j),W=s.type=="time",F=s.type=="week";Cn(G.value)&&y&&(O=W?se(y)>se(G.value):F?y>G.value:H>new Date(G.value)),Cn(K.value)&&y&&(P=W?se(y)<se(K.value):F?y<K.value:H<new Date(K.value))}if((O||P)&&(k(!!O,G.message,K.message,Gn.max,Gn.min),!r))return S(T[h].message),T}if((l||u)&&!I&&(Cn(y)||i&&Array.isArray(y))){const O=Ps(l),P=Ps(u),G=!ar(O.value)&&y.length>+O.value,K=!ar(P.value)&&y.length<+P.value;if((G||K)&&(k(G,O.message,P.message),!r))return S(T[h].message),T}if(f&&!I&&Cn(y)){const{value:O,message:P}=Ps(f);if(xc(O)&&!y.match(O)&&(T[h]={type:Gn.pattern,message:P,ref:s,...A(Gn.pattern,P)},!r))return S(P),T}if(m){if(ni(m)){const O=await m(y,e),P=$0(O,x);if(P&&(T[h]={...P,...A(Gn.validate,P.message)},!r))return S(P.message),T}else if(Rt(m)){let O={};for(const P in m){if(!gr(O)&&!r)break;const G=$0(await m[P](y,e),x,P);G&&(O={...G,...A(P,G.message)},S(G.message),r&&(T[h]=O))}if(!gr(O)&&(T[h]={ref:x,...O},!r))return T}}return S(!0),T};function NC(t,e){const r=e.slice(0,-1).length;let n=0;for(;n<r;)t=bt(t)?n++:t[e[n++]];return t}function FC(t){for(const e in t)if(t.hasOwnProperty(e)&&!bt(t[e]))return!1;return!0}function kt(t,e){const r=Array.isArray(e)?e:hm(e)?[e]:uE(e),n=r.length===1?t:NC(t,r),i=r.length-1,s=r[i];return n&&delete n[s],i!==0&&(Rt(n)&&gr(n)||Array.isArray(n)&&FC(n))&&kt(t,r.slice(0,-1)),t}var sf=()=>{let t=[];return{get observers(){return t},next:i=>{for(const s of t)s.next&&s.next(i)},subscribe:i=>(t.push(i),{unsubscribe:()=>{t=t.filter(s=>s!==i)}}),unsubscribe:()=>{t=[]}}},Sc=t=>ar(t)||!aE(t);function Li(t,e){if(Sc(t)||Sc(e))return t===e;if(Js(t)&&Js(e))return t.getTime()===e.getTime();const r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(const i of r){const s=t[i];if(!n.includes(i))return!1;if(i!=="ref"){const a=e[i];if(Js(s)&&Js(a)||Rt(s)&&Rt(a)||Array.isArray(s)&&Array.isArray(a)?!Li(s,a):s!==a)return!1}}return!0}var yE=t=>t.type==="select-multiple",UC=t=>gm(t)||El(t),af=t=>yc(t)&&t.isConnected,xE=t=>{for(const e in t)if(ni(t[e]))return!0;return!1};function Ec(t,e={}){const r=Array.isArray(t);if(Rt(t)||r)for(const n in t)Array.isArray(t[n])||Rt(t[n])&&!xE(t[n])?(e[n]=Array.isArray(t[n])?[]:{},Ec(t[n],e[n])):ar(t[n])||(e[n]=!0);return e}function SE(t,e,r){const n=Array.isArray(t);if(Rt(t)||n)for(const i in t)Array.isArray(t[i])||Rt(t[i])&&!xE(t[i])?bt(e)||Sc(r[i])?r[i]=Array.isArray(t[i])?Ec(t[i],[]):{...Ec(t[i])}:SE(t[i],ar(e)?{}:e[i],r[i]):r[i]=!Li(t[i],e[i]);return r}var Ql=(t,e)=>SE(t,e,Ec(e)),EE=(t,{valueAsNumber:e,valueAsDate:r,setValueAs:n})=>bt(t)?t:e?t===""?NaN:t&&+t:r&&Cn(t)?new Date(t):n?n(t):t;function of(t){const e=t.ref;if(!(t.refs?t.refs.every(r=>r.disabled):e.disabled))return mm(e)?e.files:gm(e)?vE(t.refs).value:yE(e)?[...e.selectedOptions].map(({value:r})=>r):El(e)?gE(t.refs).value:EE(bt(e.value)?t.ref.value:e.value,t)}var BC=(t,e,r,n)=>{const i={};for(const s of t){const a=ie(e,s);a&&Ze(i,s,a._f)}return{criteriaMode:r,names:[...t],fields:i,shouldUseNativeValidation:n}},eo=t=>bt(t)?t:xc(t)?t.source:Rt(t)?xc(t.value)?t.value.source:t.value:t;const V0="AsyncFunction";var $C=t=>(!t||!t.validate)&&!!(ni(t.validate)&&t.validate.constructor.name===V0||Rt(t.validate)&&Object.values(t.validate).find(e=>e.constructor.name===V0)),jC=t=>t.mount&&(t.required||t.min||t.max||t.maxLength||t.minLength||t.pattern||t.validate);function G0(t,e,r){const n=ie(t,r);if(n||hm(r))return{error:n,name:r};const i=r.split(".");for(;i.length;){const s=i.join("."),a=ie(e,s),o=ie(t,s);if(a&&!Array.isArray(a)&&r!==s)return{name:r};if(o&&o.type)return{name:s,error:o};i.pop()}return{name:r}}var VC=(t,e,r,n,i)=>i.isOnAll?!1:!r&&i.isOnTouch?!(e||t):(r?n.isOnBlur:i.isOnBlur)?!t:(r?n.isOnChange:i.isOnChange)?t:!0,GC=(t,e)=>!vd(ie(t,e)).length&&kt(t,e);const zC={mode:fn.onSubmit,reValidateMode:fn.onChange,shouldFocusError:!0};function HC(t={}){let e={...zC,...t},r={submitCount:0,isDirty:!1,isLoading:ni(e.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1},n={},i=Rt(e.defaultValues)||Rt(e.values)?mr(e.defaultValues||e.values)||{}:{},s=e.shouldUnregister?{}:mr(i),a={action:!1,mount:!1,watch:!1},o={mount:new Set,unMount:new Set,array:new Set,watch:new Set},l,u=0;const c={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},d={values:sf(),array:sf(),state:sf()},f=M0(e.mode),m=M0(e.reValidateMode),h=e.criteriaMode===fn.all,p=R=>N=>{clearTimeout(u),u=setTimeout(R,N)},v=async R=>{if(c.isValid||R){const N=e.resolver?gr((await b()).errors):await A(n,!0);N!==r.isValid&&d.state.next({isValid:N})}},g=(R,N)=>{(c.isValidating||c.validatingFields)&&((R||Array.from(o.mount)).forEach($=>{$&&(N?Ze(r.validatingFields,$,N):kt(r.validatingFields,$))}),d.state.next({validatingFields:r.validatingFields,isValidating:!gr(r.validatingFields)}))},y=(R,N=[],$,re,Z=!0,X=!0)=>{if(re&&$){if(a.action=!0,X&&Array.isArray(ie(n,R))){const ge=$(ie(n,R),re.argA,re.argB);Z&&Ze(n,R,ge)}if(X&&Array.isArray(ie(r.errors,R))){const ge=$(ie(r.errors,R),re.argA,re.argB);Z&&Ze(r.errors,R,ge),GC(r.errors,R)}if(c.touchedFields&&X&&Array.isArray(ie(r.touchedFields,R))){const ge=$(ie(r.touchedFields,R),re.argA,re.argB);Z&&Ze(r.touchedFields,R,ge)}c.dirtyFields&&(r.dirtyFields=Ql(i,s)),d.state.next({name:R,isDirty:O(R,N),dirtyFields:r.dirtyFields,errors:r.errors,isValid:r.isValid})}else Ze(s,R,N)},x=(R,N)=>{Ze(r.errors,R,N),d.state.next({errors:r.errors})},S=R=>{r.errors=R,d.state.next({errors:r.errors,isValid:!1})},T=(R,N,$,re)=>{const Z=ie(n,R);if(Z){const X=ie(s,R,bt($)?ie(i,R):$);bt(X)||re&&re.defaultChecked||N?Ze(s,R,N?X:of(Z._f)):K(R,X),a.mount&&v()}},C=(R,N,$,re,Z)=>{let X=!1,ge=!1;const oe={name:R},xe=!!(ie(n,R)&&ie(n,R)._f&&ie(n,R)._f.disabled);if(!$||re){c.isDirty&&(ge=r.isDirty,r.isDirty=oe.isDirty=O(),X=ge!==oe.isDirty);const ce=xe||Li(ie(i,R),N);ge=!!(!xe&&ie(r.dirtyFields,R)),ce||xe?kt(r.dirtyFields,R):Ze(r.dirtyFields,R,!0),oe.dirtyFields=r.dirtyFields,X=X||c.dirtyFields&&ge!==!ce}if($){const ce=ie(r.touchedFields,R);ce||(Ze(r.touchedFields,R,$),oe.touchedFields=r.touchedFields,X=X||c.touchedFields&&ce!==$)}return X&&Z&&d.state.next(oe),X?oe:{}},_=(R,N,$,re)=>{const Z=ie(r.errors,R),X=c.isValid&&Wr(N)&&r.isValid!==N;if(t.delayError&&$?(l=p(()=>x(R,$)),l(t.delayError)):(clearTimeout(u),l=null,$?Ze(r.errors,R,$):kt(r.errors,R)),($?!Li(Z,$):Z)||!gr(re)||X){const ge={...re,...X&&Wr(N)?{isValid:N}:{},errors:r.errors,name:R};r={...r,...ge},d.state.next(ge)}},b=async R=>{g(R,!0);const N=await e.resolver(s,e.context,BC(R||o.mount,n,e.criteriaMode,e.shouldUseNativeValidation));return g(R),N},I=async R=>{const{errors:N}=await b(R);if(R)for(const $ of R){const re=ie(N,$);re?Ze(r.errors,$,re):kt(r.errors,$)}else r.errors=N;return N},A=async(R,N,$={valid:!0})=>{for(const re in R){const Z=R[re];if(Z){const{_f:X,...ge}=Z;if(X){const oe=o.array.has(X.name),xe=Z._f&&$C(Z._f);xe&&c.validatingFields&&g([re],!0);const ce=await j0(Z,s,h,e.shouldUseNativeValidation&&!N,oe);if(xe&&c.validatingFields&&g([re]),ce[X.name]&&($.valid=!1,N))break;!N&&(ie(ce,X.name)?oe?MC(r.errors,ce,X.name):Ze(r.errors,X.name,ce[X.name]):kt(r.errors,X.name))}!gr(ge)&&await A(ge,N,$)}}return $.valid},k=()=>{for(const R of o.unMount){const N=ie(n,R);N&&(N._f.refs?N._f.refs.every($=>!af($)):!af(N._f.ref))&&Ee(R)}o.unMount=new Set},O=(R,N)=>(R&&N&&Ze(s,R,N),!Li(te(),i)),P=(R,N,$)=>pE(R,o,{...a.mount?s:bt(N)?i:Cn(R)?{[R]:N}:N},$,N),G=R=>vd(ie(a.mount?s:i,R,t.shouldUnregister?ie(i,R,[]):[])),K=(R,N,$={})=>{const re=ie(n,R);let Z=N;if(re){const X=re._f;X&&(!X.disabled&&Ze(s,R,EE(N,X)),Z=yc(X.ref)&&ar(N)?"":N,yE(X.ref)?[...X.ref.options].forEach(ge=>ge.selected=Z.includes(ge.value)):X.refs?El(X.ref)?X.refs.length>1?X.refs.forEach(ge=>(!ge.defaultChecked||!ge.disabled)&&(ge.checked=Array.isArray(Z)?!!Z.find(oe=>oe===ge.value):Z===ge.value)):X.refs[0]&&(X.refs[0].checked=!!Z):X.refs.forEach(ge=>ge.checked=ge.value===Z):mm(X.ref)?X.ref.value="":(X.ref.value=Z,X.ref.type||d.values.next({name:R,values:{...s}})))}($.shouldDirty||$.shouldTouch)&&C(R,Z,$.shouldTouch,$.shouldDirty,!0),$.shouldValidate&&j(R)},H=(R,N,$)=>{for(const re in N){const Z=N[re],X=`${R}.${re}`,ge=ie(n,X);(o.array.has(R)||!Sc(Z)||ge&&!ge._f)&&!Js(Z)?H(X,Z,$):K(X,Z,$)}},se=(R,N,$={})=>{const re=ie(n,R),Z=o.array.has(R),X=mr(N);Ze(s,R,X),Z?(d.array.next({name:R,values:{...s}}),(c.isDirty||c.dirtyFields)&&$.shouldDirty&&d.state.next({name:R,dirtyFields:Ql(i,s),isDirty:O(R,X)})):re&&!re._f&&!ar(X)?H(R,X,$):K(R,X,$),N0(R,o)&&d.state.next({...r}),d.values.next({name:a.mount?R:void 0,values:{...s}})},W=async R=>{a.mount=!0;const N=R.target;let $=N.name,re=!0;const Z=ie(n,$),X=()=>N.type?of(Z._f):oE(R),ge=oe=>{re=Number.isNaN(oe)||Li(oe,ie(s,$,oe))};if(Z){let oe,xe;const ce=X(),Ge=R.type===vc.BLUR||R.type===vc.FOCUS_OUT,nr=!jC(Z._f)&&!e.resolver&&!ie(r.errors,$)&&!Z._f.deps||VC(Ge,ie(r.touchedFields,$),r.isSubmitted,m,f),mt=N0($,o,Ge);Ze(s,$,ce),Ge?(Z._f.onBlur&&Z._f.onBlur(R),l&&l(0)):Z._f.onChange&&Z._f.onChange(R);const Pe=C($,ce,Ge,!1),Le=!gr(Pe)||mt;if(!Ge&&d.values.next({name:$,type:R.type,values:{...s}}),nr)return c.isValid&&(t.mode==="onBlur"?Ge&&v():v()),Le&&d.state.next({name:$,...mt?{}:Pe});if(!Ge&&mt&&d.state.next({...r}),e.resolver){const{errors:Nt}=await b([$]);if(ge(ce),re){const Xi=G0(r.errors,n,$),hr=G0(Nt,n,Xi.name||$);oe=hr.error,$=hr.name,xe=gr(Nt)}}else g([$],!0),oe=(await j0(Z,s,h,e.shouldUseNativeValidation))[$],g([$]),ge(ce),re&&(oe?xe=!1:c.isValid&&(xe=await A(n,!0)));re&&(Z._f.deps&&j(Z._f.deps),_($,xe,oe,Pe))}},F=(R,N)=>{if(ie(r.errors,N)&&R.focus)return R.focus(),1},j=async(R,N={})=>{let $,re;const Z=bo(R);if(e.resolver){const X=await I(bt(R)?R:Z);$=gr(X),re=R?!Z.some(ge=>ie(X,ge)):$}else R?(re=(await Promise.all(Z.map(async X=>{const ge=ie(n,X);return await A(ge&&ge._f?{[X]:ge}:ge)}))).every(Boolean),!(!re&&!r.isValid)&&v()):re=$=await A(n);return d.state.next({...!Cn(R)||c.isValid&&$!==r.isValid?{}:{name:R},...e.resolver||!R?{isValid:$}:{},errors:r.errors}),N.shouldFocus&&!re&&Lo(n,F,R?Z:o.mount),re},te=R=>{const N={...a.mount?s:i};return bt(R)?N:Cn(R)?ie(N,R):R.map($=>ie(N,$))},ee=(R,N)=>({invalid:!!ie((N||r).errors,R),isDirty:!!ie((N||r).dirtyFields,R),error:ie((N||r).errors,R),isValidating:!!ie(r.validatingFields,R),isTouched:!!ie((N||r).touchedFields,R)}),fe=R=>{R&&bo(R).forEach(N=>kt(r.errors,N)),d.state.next({errors:R?r.errors:{}})},ye=(R,N,$)=>{const re=(ie(n,R,{_f:{}})._f||{}).ref,Z=ie(r.errors,R)||{},{ref:X,message:ge,type:oe,...xe}=Z;Ze(r.errors,R,{...xe,...N,ref:re}),d.state.next({name:R,errors:r.errors,isValid:!1}),$&&$.shouldFocus&&re&&re.focus&&re.focus()},Re=(R,N)=>ni(R)?d.values.subscribe({next:$=>R(P(void 0,N),$)}):P(R,N,!0),Ee=(R,N={})=>{for(const $ of R?bo(R):o.mount)o.mount.delete($),o.array.delete($),N.keepValue||(kt(n,$),kt(s,$)),!N.keepError&&kt(r.errors,$),!N.keepDirty&&kt(r.dirtyFields,$),!N.keepTouched&&kt(r.touchedFields,$),!N.keepIsValidating&&kt(r.validatingFields,$),!e.shouldUnregister&&!N.keepDefaultValue&&kt(i,$);d.values.next({values:{...s}}),d.state.next({...r,...N.keepDirty?{isDirty:O()}:{}}),!N.keepIsValid&&v()},Fe=({disabled:R,name:N,field:$,fields:re,value:Z})=>{if(Wr(R)&&a.mount||R){const X=R?void 0:bt(Z)?of($?$._f:ie(re,N)._f):Z;Ze(s,N,X),C(N,X,!1,!1,!0)}},st=(R,N={})=>{let $=ie(n,R);const re=Wr(N.disabled)||Wr(t.disabled);return Ze(n,R,{...$||{},_f:{...$&&$._f?$._f:{ref:{name:R}},name:R,mount:!0,...N}}),o.mount.add(R),$?Fe({field:$,disabled:Wr(N.disabled)?N.disabled:t.disabled,name:R,value:N.value}):T(R,!0,N.value),{...re?{disabled:N.disabled||t.disabled}:{},...e.progressive?{required:!!N.required,min:eo(N.min),max:eo(N.max),minLength:eo(N.minLength),maxLength:eo(N.maxLength),pattern:eo(N.pattern)}:{},name:R,onChange:W,onBlur:W,ref:Z=>{if(Z){st(R,N),$=ie(n,R);const X=bt(Z.value)&&Z.querySelectorAll&&Z.querySelectorAll("input,select,textarea")[0]||Z,ge=UC(X),oe=$._f.refs||[];if(ge?oe.find(xe=>xe===X):X===$._f.ref)return;Ze(n,R,{_f:{...$._f,...ge?{refs:[...oe.filter(af),X,...Array.isArray(ie(i,R))?[{}]:[]],ref:{type:X.type,name:R}}:{ref:X}}}),T(R,!1,void 0,X)}else $=ie(n,R,{}),$._f&&($._f.mount=!1),(e.shouldUnregister||N.shouldUnregister)&&!(lE(o.array,R)&&a.action)&&o.unMount.add(R)}}},br=()=>e.shouldFocusError&&Lo(n,F,o.mount),tn=R=>{Wr(R)&&(d.state.next({disabled:R}),Lo(n,(N,$)=>{const re=ie(n,$);re&&(N.disabled=re._f.disabled||R,Array.isArray(re._f.refs)&&re._f.refs.forEach(Z=>{Z.disabled=re._f.disabled||R}))},0,!1))},jn=(R,N)=>async $=>{let re;$&&($.preventDefault&&$.preventDefault(),$.persist&&$.persist());let Z=mr(s);if(d.state.next({isSubmitting:!0}),e.resolver){const{errors:X,values:ge}=await b();r.errors=X,Z=ge}else await A(n);if(kt(r.errors,"root"),gr(r.errors)){d.state.next({errors:{}});try{await R(Z,$)}catch(X){re=X}}else N&&await N({...r.errors},$),br(),setTimeout(br);if(d.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:gr(r.errors)&&!re,submitCount:r.submitCount+1,errors:r.errors}),re)throw re},rn=(R,N={})=>{ie(n,R)&&(bt(N.defaultValue)?se(R,mr(ie(i,R))):(se(R,N.defaultValue),Ze(i,R,mr(N.defaultValue))),N.keepTouched||kt(r.touchedFields,R),N.keepDirty||(kt(r.dirtyFields,R),r.isDirty=N.defaultValue?O(R,mr(ie(i,R))):O()),N.keepError||(kt(r.errors,R),c.isValid&&v()),d.state.next({...r}))},xn=(R,N={})=>{const $=R?mr(R):i,re=mr($),Z=gr(R),X=Z?i:re;if(N.keepDefaultValues||(i=$),!N.keepValues){if(N.keepDirtyValues)for(const ge of o.mount)ie(r.dirtyFields,ge)?Ze(X,ge,ie(s,ge)):se(ge,ie(X,ge));else{if(fm&&bt(R))for(const ge of o.mount){const oe=ie(n,ge);if(oe&&oe._f){const xe=Array.isArray(oe._f.refs)?oe._f.refs[0]:oe._f.ref;if(yc(xe)){const ce=xe.closest("form");if(ce){ce.reset();break}}}}n={}}s=t.shouldUnregister?N.keepDefaultValues?mr(i):{}:mr(X),d.array.next({values:{...X}}),d.values.next({values:{...X}})}o={mount:N.keepDirtyValues?o.mount:new Set,unMount:new Set,array:new Set,watch:new Set,watchAll:!1,focus:""},a.mount=!c.isValid||!!N.keepIsValid||!!N.keepDirtyValues,a.watch=!!t.shouldUnregister,d.state.next({submitCount:N.keepSubmitCount?r.submitCount:0,isDirty:Z?!1:N.keepDirty?r.isDirty:!!(N.keepDefaultValues&&!Li(R,i)),isSubmitted:N.keepIsSubmitted?r.isSubmitted:!1,dirtyFields:Z?{}:N.keepDirtyValues?N.keepDefaultValues&&s?Ql(i,s):r.dirtyFields:N.keepDefaultValues&&R?Ql(i,R):N.keepDirty?r.dirtyFields:{},touchedFields:N.keepTouched?r.touchedFields:{},errors:N.keepErrors?r.errors:{},isSubmitSuccessful:N.keepIsSubmitSuccessful?r.isSubmitSuccessful:!1,isSubmitting:!1})},nt=(R,N)=>xn(ni(R)?R(s):R,N);return{control:{register:st,unregister:Ee,getFieldState:ee,handleSubmit:jn,setError:ye,_executeSchema:b,_getWatch:P,_getDirty:O,_updateValid:v,_removeUnmounted:k,_updateFieldArray:y,_updateDisabledField:Fe,_getFieldArray:G,_reset:xn,_resetDefaultValues:()=>ni(e.defaultValues)&&e.defaultValues().then(R=>{nt(R,e.resetOptions),d.state.next({isLoading:!1})}),_updateFormState:R=>{r={...r,...R}},_disableForm:tn,_subjects:d,_proxyFormState:c,_setErrors:S,get _fields(){return n},get _formValues(){return s},get _state(){return a},set _state(R){a=R},get _defaultValues(){return i},get _names(){return o},set _names(R){o=R},get _formState(){return r},set _formState(R){r=R},get _options(){return e},set _options(R){e={...e,...R}}},trigger:j,register:st,handleSubmit:jn,watch:Re,setValue:se,getValues:te,reset:nt,resetField:rn,clearErrors:fe,unregister:Ee,setError:ye,setFocus:(R,N={})=>{const $=ie(n,R),re=$&&$._f;if(re){const Z=re.refs?re.refs[0]:re.ref;Z.focus&&(Z.focus(),N.shouldSelect&&Z.select())}},getFieldState:ee}}function WC(t={}){const e=ne.useRef(),r=ne.useRef(),[n,i]=ne.useState({isDirty:!1,isValidating:!1,isLoading:ni(t.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1,defaultValues:ni(t.defaultValues)?void 0:t.defaultValues});e.current||(e.current={...HC(t),formState:n});const s=e.current.control;return s._options=t,pm({subject:s._subjects.state,next:a=>{fE(a,s._proxyFormState,s._updateFormState,!0)&&i({...s._formState})}}),ne.useEffect(()=>s._disableForm(t.disabled),[s,t.disabled]),ne.useEffect(()=>{if(s._proxyFormState.isDirty){const a=s._getDirty();a!==n.isDirty&&s._subjects.state.next({isDirty:a})}},[s,n.isDirty]),ne.useEffect(()=>{t.values&&!Li(t.values,r.current)?(s._reset(t.values,s._options.resetOptions),r.current=t.values,i(a=>({...a}))):s._resetDefaultValues()},[t.values,s]),ne.useEffect(()=>{t.errors&&s._setErrors(t.errors)},[t.errors,s]),ne.useEffect(()=>{s._state.mount||(s._updateValid(),s._state.mount=!0),s._state.watch&&(s._state.watch=!1,s._subjects.state.next({...s._formState})),s._removeUnmounted()}),ne.useEffect(()=>{t.shouldUnregister&&s._subjects.values.next({values:s._getWatch()})},[t.shouldUnregister,s]),e.current.formState=dE(n,s),e.current}const z0=(t,e,r)=>{if(t&&"reportValidity"in t){const n=ie(r,e);t.setCustomValidity(n&&n.message||""),t.reportValidity()}},TE=(t,e)=>{for(const r in e.fields){const n=e.fields[r];n&&n.ref&&"reportValidity"in n.ref?z0(n.ref,r,t):n.refs&&n.refs.forEach(i=>z0(i,r,t))}},KC=(t,e)=>{e.shouldUseNativeValidation&&TE(t,e);const r={};for(const n in t){const i=ie(e.fields,n),s=Object.assign(t[n]||{},{ref:i&&i.ref});if(YC(e.names||Object.keys(t),n)){const a=Object.assign({},ie(r,n));Ze(a,"root",s),Ze(r,n,a)}else Ze(r,n,s)}return r},YC=(t,e)=>t.some(r=>r.startsWith(e+"."));var qC=function(t,e){for(var r={};t.length;){var n=t[0],i=n.code,s=n.message,a=n.path.join(".");if(!r[a])if("unionErrors"in n){var o=n.unionErrors[0].errors[0];r[a]={message:o.message,type:o.code}}else r[a]={message:s,type:i};if("unionErrors"in n&&n.unionErrors.forEach(function(c){return c.errors.forEach(function(d){return t.push(d)})}),e){var l=r[a].types,u=l&&l[n.code];r[a]=mE(a,e,r,i,u?[].concat(u,n.message):n.message)}t.shift()}return r},XC=function(t,e,r){return r===void 0&&(r={}),function(n,i,s){try{return Promise.resolve(function(a,o){try{var l=Promise.resolve(t[r.mode==="sync"?"parse":"parseAsync"](n,e)).then(function(u){return s.shouldUseNativeValidation&&TE({},s),{errors:{},values:r.raw?n:u}})}catch(u){return o(u)}return l&&l.then?l.then(void 0,o):l}(0,function(a){if(function(o){return Array.isArray(o==null?void 0:o.errors)}(a))return{values:{},errors:KC(qC(a.errors,!s.shouldUseNativeValidation&&s.criteriaMode==="all"),s)};throw a}))}catch(a){return Promise.reject(a)}}},We;(function(t){t.assertEqual=i=>i;function e(i){}t.assertIs=e;function r(i){throw new Error}t.assertNever=r,t.arrayToEnum=i=>{const s={};for(const a of i)s[a]=a;return s},t.getValidEnumValues=i=>{const s=t.objectKeys(i).filter(o=>typeof i[i[o]]!="number"),a={};for(const o of s)a[o]=i[o];return t.objectValues(a)},t.objectValues=i=>t.objectKeys(i).map(function(s){return i[s]}),t.objectKeys=typeof Object.keys=="function"?i=>Object.keys(i):i=>{const s=[];for(const a in i)Object.prototype.hasOwnProperty.call(i,a)&&s.push(a);return s},t.find=(i,s)=>{for(const a of i)if(s(a))return a},t.isInteger=typeof Number.isInteger=="function"?i=>Number.isInteger(i):i=>typeof i=="number"&&isFinite(i)&&Math.floor(i)===i;function n(i,s=" | "){return i.map(a=>typeof a=="string"?`'${a}'`:a).join(s)}t.joinValues=n,t.jsonStringifyReplacer=(i,s)=>typeof s=="bigint"?s.toString():s})(We||(We={}));var Fh;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})(Fh||(Fh={}));const ue=We.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Ai=t=>{switch(typeof t){case"undefined":return ue.undefined;case"string":return ue.string;case"number":return isNaN(t)?ue.nan:ue.number;case"boolean":return ue.boolean;case"function":return ue.function;case"bigint":return ue.bigint;case"symbol":return ue.symbol;case"object":return Array.isArray(t)?ue.array:t===null?ue.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?ue.promise:typeof Map<"u"&&t instanceof Map?ue.map:typeof Set<"u"&&t instanceof Set?ue.set:typeof Date<"u"&&t instanceof Date?ue.date:ue.object;default:return ue.unknown}},J=We.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),ZC=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:");class Mr extends Error{constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const r=e||function(s){return s.message},n={_errors:[]},i=s=>{for(const a of s.issues)if(a.code==="invalid_union")a.unionErrors.map(i);else if(a.code==="invalid_return_type")i(a.returnTypeError);else if(a.code==="invalid_arguments")i(a.argumentsError);else if(a.path.length===0)n._errors.push(r(a));else{let o=n,l=0;for(;l<a.path.length;){const u=a.path[l];l===a.path.length-1?(o[u]=o[u]||{_errors:[]},o[u]._errors.push(r(a))):o[u]=o[u]||{_errors:[]},o=o[u],l++}}};return i(this),n}static assert(e){if(!(e instanceof Mr))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,We.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){const r={},n=[];for(const i of this.issues)i.path.length>0?(r[i.path[0]]=r[i.path[0]]||[],r[i.path[0]].push(e(i))):n.push(e(i));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}}Mr.create=t=>new Mr(t);const ba=(t,e)=>{let r;switch(t.code){case J.invalid_type:t.received===ue.undefined?r="Required":r=`Expected ${t.expected}, received ${t.received}`;break;case J.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,We.jsonStringifyReplacer)}`;break;case J.unrecognized_keys:r=`Unrecognized key(s) in object: ${We.joinValues(t.keys,", ")}`;break;case J.invalid_union:r="Invalid input";break;case J.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${We.joinValues(t.options)}`;break;case J.invalid_enum_value:r=`Invalid enum value. Expected ${We.joinValues(t.options)}, received '${t.received}'`;break;case J.invalid_arguments:r="Invalid function arguments";break;case J.invalid_return_type:r="Invalid function return type";break;case J.invalid_date:r="Invalid date";break;case J.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(r=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?r=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?r=`Invalid input: must end with "${t.validation.endsWith}"`:We.assertNever(t.validation):t.validation!=="regex"?r=`Invalid ${t.validation}`:r="Invalid";break;case J.too_small:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:r="Invalid input";break;case J.too_big:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?r=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:r="Invalid input";break;case J.custom:r="Invalid input";break;case J.invalid_intersection_types:r="Intersection results could not be merged";break;case J.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case J.not_finite:r="Number must be finite";break;default:r=e.defaultError,We.assertNever(t)}return{message:r}};let wE=ba;function QC(t){wE=t}function Tc(){return wE}const wc=t=>{const{data:e,path:r,errorMaps:n,issueData:i}=t,s=[...r,...i.path||[]],a={...i,path:s};if(i.message!==void 0)return{...i,path:s,message:i.message};let o="";const l=n.filter(u=>!!u).slice().reverse();for(const u of l)o=u(a,{data:e,defaultError:o}).message;return{...i,path:s,message:o}},JC=[];function le(t,e){const r=Tc(),n=wc({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===ba?void 0:ba].filter(i=>!!i)});t.common.issues.push(n)}class tr{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,r){const n=[];for(const i of r){if(i.status==="aborted")return Ie;i.status==="dirty"&&e.dirty(),n.push(i.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,r){const n=[];for(const i of r){const s=await i.key,a=await i.value;n.push({key:s,value:a})}return tr.mergeObjectSync(e,n)}static mergeObjectSync(e,r){const n={};for(const i of r){const{key:s,value:a}=i;if(s.status==="aborted"||a.status==="aborted")return Ie;s.status==="dirty"&&e.dirty(),a.status==="dirty"&&e.dirty(),s.value!=="__proto__"&&(typeof a.value<"u"||i.alwaysSet)&&(n[s.value]=a.value)}return{status:e.value,value:n}}}const Ie=Object.freeze({status:"aborted"}),ea=t=>({status:"dirty",value:t}),cr=t=>({status:"valid",value:t}),Uh=t=>t.status==="aborted",Bh=t=>t.status==="dirty",Qo=t=>t.status==="valid",Jo=t=>typeof Promise<"u"&&t instanceof Promise;function bc(t,e,r,n){if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(t)}function bE(t,e,r,n,i){if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,r),r}var Se;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(Se||(Se={}));var co,fo;class Fn{constructor(e,r,n,i){this._cachedPath=[],this.parent=e,this.data=r,this._path=n,this._key=i}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const H0=(t,e)=>{if(Qo(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new Mr(t.common.issues);return this._error=r,this._error}}};function Ne(t){if(!t)return{};const{errorMap:e,invalid_type_error:r,required_error:n,description:i}=t;if(e&&(r||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:i}:{errorMap:(a,o)=>{var l,u;const{message:c}=t;return a.code==="invalid_enum_value"?{message:c??o.defaultError}:typeof o.data>"u"?{message:(l=c??n)!==null&&l!==void 0?l:o.defaultError}:a.code!=="invalid_type"?{message:o.defaultError}:{message:(u=c??r)!==null&&u!==void 0?u:o.defaultError}},description:i}}class Ve{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return Ai(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:Ai(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new tr,ctx:{common:e.parent.common,data:e.data,parsedType:Ai(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const r=this._parse(e);if(Jo(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(e){const r=this._parse(e);return Promise.resolve(r)}parse(e,r){const n=this.safeParse(e,r);if(n.success)return n.data;throw n.error}safeParse(e,r){var n;const i={common:{issues:[],async:(n=r==null?void 0:r.async)!==null&&n!==void 0?n:!1,contextualErrorMap:r==null?void 0:r.errorMap},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ai(e)},s=this._parseSync({data:e,path:i.path,parent:i});return H0(i,s)}async parseAsync(e,r){const n=await this.safeParseAsync(e,r);if(n.success)return n.data;throw n.error}async safeParseAsync(e,r){const n={common:{issues:[],contextualErrorMap:r==null?void 0:r.errorMap,async:!0},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ai(e)},i=this._parse({data:e,path:n.path,parent:n}),s=await(Jo(i)?i:Promise.resolve(i));return H0(n,s)}refine(e,r){const n=i=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(i):r;return this._refinement((i,s)=>{const a=e(i),o=()=>s.addIssue({code:J.custom,...n(i)});return typeof Promise<"u"&&a instanceof Promise?a.then(l=>l?!0:(o(),!1)):a?!0:(o(),!1)})}refinement(e,r){return this._refinement((n,i)=>e(n)?!0:(i.addIssue(typeof r=="function"?r(n,i):r),!1))}_refinement(e){return new yn({schema:this,typeName:Ce.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return Mn.create(this,this._def)}nullable(){return Gi.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return gn.create(this,this._def)}promise(){return Aa.create(this,this._def)}or(e){return nl.create([this,e],this._def)}and(e){return il.create(this,e,this._def)}transform(e){return new yn({...Ne(this._def),schema:this,typeName:Ce.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const r=typeof e=="function"?e:()=>e;return new ul({...Ne(this._def),innerType:this,defaultValue:r,typeName:Ce.ZodDefault})}brand(){return new vm({typeName:Ce.ZodBranded,type:this,...Ne(this._def)})}catch(e){const r=typeof e=="function"?e:()=>e;return new cl({...Ne(this._def),innerType:this,catchValue:r,typeName:Ce.ZodCatch})}describe(e){const r=this.constructor;return new r({...this._def,description:e})}pipe(e){return Tl.create(this,e)}readonly(){return dl.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const eR=/^c[^\s-]{8,}$/i,tR=/^[0-9a-z]+$/,rR=/^[0-9A-HJKMNP-TV-Z]{26}$/,nR=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,iR=/^[a-z0-9_-]{21}$/i,sR=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,aR=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,oR="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let lf;const lR=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,uR=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,cR=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,LE="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",dR=new RegExp(`^${LE}$`);function AE(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`),e}function fR(t){return new RegExp(`^${AE(t)}$`)}function _E(t){let e=`${LE}T${AE(t)}`;const r=[];return r.push(t.local?"Z?":"Z"),t.offset&&r.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${r.join("|")})`,new RegExp(`^${e}$`)}function hR(t,e){return!!((e==="v4"||!e)&&lR.test(t)||(e==="v6"||!e)&&uR.test(t))}class hn extends Ve{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==ue.string){const s=this._getOrReturnCtx(e);return le(s,{code:J.invalid_type,expected:ue.string,received:s.parsedType}),Ie}const n=new tr;let i;for(const s of this._def.checks)if(s.kind==="min")e.data.length<s.value&&(i=this._getOrReturnCtx(e,i),le(i,{code:J.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),n.dirty());else if(s.kind==="max")e.data.length>s.value&&(i=this._getOrReturnCtx(e,i),le(i,{code:J.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),n.dirty());else if(s.kind==="length"){const a=e.data.length>s.value,o=e.data.length<s.value;(a||o)&&(i=this._getOrReturnCtx(e,i),a?le(i,{code:J.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}):o&&le(i,{code:J.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}),n.dirty())}else if(s.kind==="email")aR.test(e.data)||(i=this._getOrReturnCtx(e,i),le(i,{validation:"email",code:J.invalid_string,message:s.message}),n.dirty());else if(s.kind==="emoji")lf||(lf=new RegExp(oR,"u")),lf.test(e.data)||(i=this._getOrReturnCtx(e,i),le(i,{validation:"emoji",code:J.invalid_string,message:s.message}),n.dirty());else if(s.kind==="uuid")nR.test(e.data)||(i=this._getOrReturnCtx(e,i),le(i,{validation:"uuid",code:J.invalid_string,message:s.message}),n.dirty());else if(s.kind==="nanoid")iR.test(e.data)||(i=this._getOrReturnCtx(e,i),le(i,{validation:"nanoid",code:J.invalid_string,message:s.message}),n.dirty());else if(s.kind==="cuid")eR.test(e.data)||(i=this._getOrReturnCtx(e,i),le(i,{validation:"cuid",code:J.invalid_string,message:s.message}),n.dirty());else if(s.kind==="cuid2")tR.test(e.data)||(i=this._getOrReturnCtx(e,i),le(i,{validation:"cuid2",code:J.invalid_string,message:s.message}),n.dirty());else if(s.kind==="ulid")rR.test(e.data)||(i=this._getOrReturnCtx(e,i),le(i,{validation:"ulid",code:J.invalid_string,message:s.message}),n.dirty());else if(s.kind==="url")try{new URL(e.data)}catch{i=this._getOrReturnCtx(e,i),le(i,{validation:"url",code:J.invalid_string,message:s.message}),n.dirty()}else s.kind==="regex"?(s.regex.lastIndex=0,s.regex.test(e.data)||(i=this._getOrReturnCtx(e,i),le(i,{validation:"regex",code:J.invalid_string,message:s.message}),n.dirty())):s.kind==="trim"?e.data=e.data.trim():s.kind==="includes"?e.data.includes(s.value,s.position)||(i=this._getOrReturnCtx(e,i),le(i,{code:J.invalid_string,validation:{includes:s.value,position:s.position},message:s.message}),n.dirty()):s.kind==="toLowerCase"?e.data=e.data.toLowerCase():s.kind==="toUpperCase"?e.data=e.data.toUpperCase():s.kind==="startsWith"?e.data.startsWith(s.value)||(i=this._getOrReturnCtx(e,i),le(i,{code:J.invalid_string,validation:{startsWith:s.value},message:s.message}),n.dirty()):s.kind==="endsWith"?e.data.endsWith(s.value)||(i=this._getOrReturnCtx(e,i),le(i,{code:J.invalid_string,validation:{endsWith:s.value},message:s.message}),n.dirty()):s.kind==="datetime"?_E(s).test(e.data)||(i=this._getOrReturnCtx(e,i),le(i,{code:J.invalid_string,validation:"datetime",message:s.message}),n.dirty()):s.kind==="date"?dR.test(e.data)||(i=this._getOrReturnCtx(e,i),le(i,{code:J.invalid_string,validation:"date",message:s.message}),n.dirty()):s.kind==="time"?fR(s).test(e.data)||(i=this._getOrReturnCtx(e,i),le(i,{code:J.invalid_string,validation:"time",message:s.message}),n.dirty()):s.kind==="duration"?sR.test(e.data)||(i=this._getOrReturnCtx(e,i),le(i,{validation:"duration",code:J.invalid_string,message:s.message}),n.dirty()):s.kind==="ip"?hR(e.data,s.version)||(i=this._getOrReturnCtx(e,i),le(i,{validation:"ip",code:J.invalid_string,message:s.message}),n.dirty()):s.kind==="base64"?cR.test(e.data)||(i=this._getOrReturnCtx(e,i),le(i,{validation:"base64",code:J.invalid_string,message:s.message}),n.dirty()):We.assertNever(s);return{status:n.value,value:e.data}}_regex(e,r,n){return this.refinement(i=>e.test(i),{validation:r,code:J.invalid_string,...Se.errToObj(n)})}_addCheck(e){return new hn({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...Se.errToObj(e)})}url(e){return this._addCheck({kind:"url",...Se.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...Se.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...Se.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...Se.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...Se.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...Se.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...Se.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...Se.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...Se.errToObj(e)})}datetime(e){var r,n;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(r=e==null?void 0:e.offset)!==null&&r!==void 0?r:!1,local:(n=e==null?void 0:e.local)!==null&&n!==void 0?n:!1,...Se.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...Se.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...Se.errToObj(e)})}regex(e,r){return this._addCheck({kind:"regex",regex:e,...Se.errToObj(r)})}includes(e,r){return this._addCheck({kind:"includes",value:e,position:r==null?void 0:r.position,...Se.errToObj(r==null?void 0:r.message)})}startsWith(e,r){return this._addCheck({kind:"startsWith",value:e,...Se.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:"endsWith",value:e,...Se.errToObj(r)})}min(e,r){return this._addCheck({kind:"min",value:e,...Se.errToObj(r)})}max(e,r){return this._addCheck({kind:"max",value:e,...Se.errToObj(r)})}length(e,r){return this._addCheck({kind:"length",value:e,...Se.errToObj(r)})}nonempty(e){return this.min(1,Se.errToObj(e))}trim(){return new hn({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new hn({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new hn({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get minLength(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}}hn.create=t=>{var e;return new hn({checks:[],typeName:Ce.ZodString,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...Ne(t)})};function pR(t,e){const r=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,i=r>n?r:n,s=parseInt(t.toFixed(i).replace(".","")),a=parseInt(e.toFixed(i).replace(".",""));return s%a/Math.pow(10,i)}class $i extends Ve{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==ue.number){const s=this._getOrReturnCtx(e);return le(s,{code:J.invalid_type,expected:ue.number,received:s.parsedType}),Ie}let n;const i=new tr;for(const s of this._def.checks)s.kind==="int"?We.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),le(n,{code:J.invalid_type,expected:"integer",received:"float",message:s.message}),i.dirty()):s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(n=this._getOrReturnCtx(e,n),le(n,{code:J.too_small,minimum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),i.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(n=this._getOrReturnCtx(e,n),le(n,{code:J.too_big,maximum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),i.dirty()):s.kind==="multipleOf"?pR(e.data,s.value)!==0&&(n=this._getOrReturnCtx(e,n),le(n,{code:J.not_multiple_of,multipleOf:s.value,message:s.message}),i.dirty()):s.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),le(n,{code:J.not_finite,message:s.message}),i.dirty()):We.assertNever(s);return{status:i.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,Se.toString(r))}gt(e,r){return this.setLimit("min",e,!1,Se.toString(r))}lte(e,r){return this.setLimit("max",e,!0,Se.toString(r))}lt(e,r){return this.setLimit("max",e,!1,Se.toString(r))}setLimit(e,r,n,i){return new $i({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:Se.toString(i)}]})}_addCheck(e){return new $i({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:Se.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Se.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Se.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Se.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Se.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:Se.toString(r)})}finite(e){return this._addCheck({kind:"finite",message:Se.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Se.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Se.toString(e)})}get minValue(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&We.isInteger(e.value))}get isFinite(){let e=null,r=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(r===null||n.value>r)&&(r=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(r)&&Number.isFinite(e)}}$i.create=t=>new $i({checks:[],typeName:Ce.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...Ne(t)});class ji extends Ve{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==ue.bigint){const s=this._getOrReturnCtx(e);return le(s,{code:J.invalid_type,expected:ue.bigint,received:s.parsedType}),Ie}let n;const i=new tr;for(const s of this._def.checks)s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(n=this._getOrReturnCtx(e,n),le(n,{code:J.too_small,type:"bigint",minimum:s.value,inclusive:s.inclusive,message:s.message}),i.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(n=this._getOrReturnCtx(e,n),le(n,{code:J.too_big,type:"bigint",maximum:s.value,inclusive:s.inclusive,message:s.message}),i.dirty()):s.kind==="multipleOf"?e.data%s.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),le(n,{code:J.not_multiple_of,multipleOf:s.value,message:s.message}),i.dirty()):We.assertNever(s);return{status:i.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,Se.toString(r))}gt(e,r){return this.setLimit("min",e,!1,Se.toString(r))}lte(e,r){return this.setLimit("max",e,!0,Se.toString(r))}lt(e,r){return this.setLimit("max",e,!1,Se.toString(r))}setLimit(e,r,n,i){return new ji({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:Se.toString(i)}]})}_addCheck(e){return new ji({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Se.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Se.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Se.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Se.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:Se.toString(r)})}get minValue(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}}ji.create=t=>{var e;return new ji({checks:[],typeName:Ce.ZodBigInt,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...Ne(t)})};class el extends Ve{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==ue.boolean){const n=this._getOrReturnCtx(e);return le(n,{code:J.invalid_type,expected:ue.boolean,received:n.parsedType}),Ie}return cr(e.data)}}el.create=t=>new el({typeName:Ce.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...Ne(t)});class Es extends Ve{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==ue.date){const s=this._getOrReturnCtx(e);return le(s,{code:J.invalid_type,expected:ue.date,received:s.parsedType}),Ie}if(isNaN(e.data.getTime())){const s=this._getOrReturnCtx(e);return le(s,{code:J.invalid_date}),Ie}const n=new tr;let i;for(const s of this._def.checks)s.kind==="min"?e.data.getTime()<s.value&&(i=this._getOrReturnCtx(e,i),le(i,{code:J.too_small,message:s.message,inclusive:!0,exact:!1,minimum:s.value,type:"date"}),n.dirty()):s.kind==="max"?e.data.getTime()>s.value&&(i=this._getOrReturnCtx(e,i),le(i,{code:J.too_big,message:s.message,inclusive:!0,exact:!1,maximum:s.value,type:"date"}),n.dirty()):We.assertNever(s);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Es({...this._def,checks:[...this._def.checks,e]})}min(e,r){return this._addCheck({kind:"min",value:e.getTime(),message:Se.toString(r)})}max(e,r){return this._addCheck({kind:"max",value:e.getTime(),message:Se.toString(r)})}get minDate(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e!=null?new Date(e):null}}Es.create=t=>new Es({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:Ce.ZodDate,...Ne(t)});class Lc extends Ve{_parse(e){if(this._getType(e)!==ue.symbol){const n=this._getOrReturnCtx(e);return le(n,{code:J.invalid_type,expected:ue.symbol,received:n.parsedType}),Ie}return cr(e.data)}}Lc.create=t=>new Lc({typeName:Ce.ZodSymbol,...Ne(t)});class tl extends Ve{_parse(e){if(this._getType(e)!==ue.undefined){const n=this._getOrReturnCtx(e);return le(n,{code:J.invalid_type,expected:ue.undefined,received:n.parsedType}),Ie}return cr(e.data)}}tl.create=t=>new tl({typeName:Ce.ZodUndefined,...Ne(t)});class rl extends Ve{_parse(e){if(this._getType(e)!==ue.null){const n=this._getOrReturnCtx(e);return le(n,{code:J.invalid_type,expected:ue.null,received:n.parsedType}),Ie}return cr(e.data)}}rl.create=t=>new rl({typeName:Ce.ZodNull,...Ne(t)});class La extends Ve{constructor(){super(...arguments),this._any=!0}_parse(e){return cr(e.data)}}La.create=t=>new La({typeName:Ce.ZodAny,...Ne(t)});class ds extends Ve{constructor(){super(...arguments),this._unknown=!0}_parse(e){return cr(e.data)}}ds.create=t=>new ds({typeName:Ce.ZodUnknown,...Ne(t)});class di extends Ve{_parse(e){const r=this._getOrReturnCtx(e);return le(r,{code:J.invalid_type,expected:ue.never,received:r.parsedType}),Ie}}di.create=t=>new di({typeName:Ce.ZodNever,...Ne(t)});class Ac extends Ve{_parse(e){if(this._getType(e)!==ue.undefined){const n=this._getOrReturnCtx(e);return le(n,{code:J.invalid_type,expected:ue.void,received:n.parsedType}),Ie}return cr(e.data)}}Ac.create=t=>new Ac({typeName:Ce.ZodVoid,...Ne(t)});class gn extends Ve{_parse(e){const{ctx:r,status:n}=this._processInputParams(e),i=this._def;if(r.parsedType!==ue.array)return le(r,{code:J.invalid_type,expected:ue.array,received:r.parsedType}),Ie;if(i.exactLength!==null){const a=r.data.length>i.exactLength.value,o=r.data.length<i.exactLength.value;(a||o)&&(le(r,{code:a?J.too_big:J.too_small,minimum:o?i.exactLength.value:void 0,maximum:a?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),n.dirty())}if(i.minLength!==null&&r.data.length<i.minLength.value&&(le(r,{code:J.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),n.dirty()),i.maxLength!==null&&r.data.length>i.maxLength.value&&(le(r,{code:J.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),n.dirty()),r.common.async)return Promise.all([...r.data].map((a,o)=>i.type._parseAsync(new Fn(r,a,r.path,o)))).then(a=>tr.mergeArray(n,a));const s=[...r.data].map((a,o)=>i.type._parseSync(new Fn(r,a,r.path,o)));return tr.mergeArray(n,s)}get element(){return this._def.type}min(e,r){return new gn({...this._def,minLength:{value:e,message:Se.toString(r)}})}max(e,r){return new gn({...this._def,maxLength:{value:e,message:Se.toString(r)}})}length(e,r){return new gn({...this._def,exactLength:{value:e,message:Se.toString(r)}})}nonempty(e){return this.min(1,e)}}gn.create=(t,e)=>new gn({type:t,minLength:null,maxLength:null,exactLength:null,typeName:Ce.ZodArray,...Ne(e)});function Bs(t){if(t instanceof vt){const e={};for(const r in t.shape){const n=t.shape[r];e[r]=Mn.create(Bs(n))}return new vt({...t._def,shape:()=>e})}else return t instanceof gn?new gn({...t._def,type:Bs(t.element)}):t instanceof Mn?Mn.create(Bs(t.unwrap())):t instanceof Gi?Gi.create(Bs(t.unwrap())):t instanceof Un?Un.create(t.items.map(e=>Bs(e))):t}class vt extends Ve{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),r=We.objectKeys(e);return this._cached={shape:e,keys:r}}_parse(e){if(this._getType(e)!==ue.object){const u=this._getOrReturnCtx(e);return le(u,{code:J.invalid_type,expected:ue.object,received:u.parsedType}),Ie}const{status:n,ctx:i}=this._processInputParams(e),{shape:s,keys:a}=this._getCached(),o=[];if(!(this._def.catchall instanceof di&&this._def.unknownKeys==="strip"))for(const u in i.data)a.includes(u)||o.push(u);const l=[];for(const u of a){const c=s[u],d=i.data[u];l.push({key:{status:"valid",value:u},value:c._parse(new Fn(i,d,i.path,u)),alwaysSet:u in i.data})}if(this._def.catchall instanceof di){const u=this._def.unknownKeys;if(u==="passthrough")for(const c of o)l.push({key:{status:"valid",value:c},value:{status:"valid",value:i.data[c]}});else if(u==="strict")o.length>0&&(le(i,{code:J.unrecognized_keys,keys:o}),n.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const u=this._def.catchall;for(const c of o){const d=i.data[c];l.push({key:{status:"valid",value:c},value:u._parse(new Fn(i,d,i.path,c)),alwaysSet:c in i.data})}}return i.common.async?Promise.resolve().then(async()=>{const u=[];for(const c of l){const d=await c.key,f=await c.value;u.push({key:d,value:f,alwaysSet:c.alwaysSet})}return u}).then(u=>tr.mergeObjectSync(n,u)):tr.mergeObjectSync(n,l)}get shape(){return this._def.shape()}strict(e){return Se.errToObj,new vt({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(r,n)=>{var i,s,a,o;const l=(a=(s=(i=this._def).errorMap)===null||s===void 0?void 0:s.call(i,r,n).message)!==null&&a!==void 0?a:n.defaultError;return r.code==="unrecognized_keys"?{message:(o=Se.errToObj(e).message)!==null&&o!==void 0?o:l}:{message:l}}}:{}})}strip(){return new vt({...this._def,unknownKeys:"strip"})}passthrough(){return new vt({...this._def,unknownKeys:"passthrough"})}extend(e){return new vt({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new vt({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:Ce.ZodObject})}setKey(e,r){return this.augment({[e]:r})}catchall(e){return new vt({...this._def,catchall:e})}pick(e){const r={};return We.objectKeys(e).forEach(n=>{e[n]&&this.shape[n]&&(r[n]=this.shape[n])}),new vt({...this._def,shape:()=>r})}omit(e){const r={};return We.objectKeys(this.shape).forEach(n=>{e[n]||(r[n]=this.shape[n])}),new vt({...this._def,shape:()=>r})}deepPartial(){return Bs(this)}partial(e){const r={};return We.objectKeys(this.shape).forEach(n=>{const i=this.shape[n];e&&!e[n]?r[n]=i:r[n]=i.optional()}),new vt({...this._def,shape:()=>r})}required(e){const r={};return We.objectKeys(this.shape).forEach(n=>{if(e&&!e[n])r[n]=this.shape[n];else{let s=this.shape[n];for(;s instanceof Mn;)s=s._def.innerType;r[n]=s}}),new vt({...this._def,shape:()=>r})}keyof(){return CE(We.objectKeys(this.shape))}}vt.create=(t,e)=>new vt({shape:()=>t,unknownKeys:"strip",catchall:di.create(),typeName:Ce.ZodObject,...Ne(e)});vt.strictCreate=(t,e)=>new vt({shape:()=>t,unknownKeys:"strict",catchall:di.create(),typeName:Ce.ZodObject,...Ne(e)});vt.lazycreate=(t,e)=>new vt({shape:t,unknownKeys:"strip",catchall:di.create(),typeName:Ce.ZodObject,...Ne(e)});class nl extends Ve{_parse(e){const{ctx:r}=this._processInputParams(e),n=this._def.options;function i(s){for(const o of s)if(o.result.status==="valid")return o.result;for(const o of s)if(o.result.status==="dirty")return r.common.issues.push(...o.ctx.common.issues),o.result;const a=s.map(o=>new Mr(o.ctx.common.issues));return le(r,{code:J.invalid_union,unionErrors:a}),Ie}if(r.common.async)return Promise.all(n.map(async s=>{const a={...r,common:{...r.common,issues:[]},parent:null};return{result:await s._parseAsync({data:r.data,path:r.path,parent:a}),ctx:a}})).then(i);{let s;const a=[];for(const l of n){const u={...r,common:{...r.common,issues:[]},parent:null},c=l._parseSync({data:r.data,path:r.path,parent:u});if(c.status==="valid")return c;c.status==="dirty"&&!s&&(s={result:c,ctx:u}),u.common.issues.length&&a.push(u.common.issues)}if(s)return r.common.issues.push(...s.ctx.common.issues),s.result;const o=a.map(l=>new Mr(l));return le(r,{code:J.invalid_union,unionErrors:o}),Ie}}get options(){return this._def.options}}nl.create=(t,e)=>new nl({options:t,typeName:Ce.ZodUnion,...Ne(e)});const Yn=t=>t instanceof al?Yn(t.schema):t instanceof yn?Yn(t.innerType()):t instanceof ol?[t.value]:t instanceof Vi?t.options:t instanceof ll?We.objectValues(t.enum):t instanceof ul?Yn(t._def.innerType):t instanceof tl?[void 0]:t instanceof rl?[null]:t instanceof Mn?[void 0,...Yn(t.unwrap())]:t instanceof Gi?[null,...Yn(t.unwrap())]:t instanceof vm||t instanceof dl?Yn(t.unwrap()):t instanceof cl?Yn(t._def.innerType):[];class xd extends Ve{_parse(e){const{ctx:r}=this._processInputParams(e);if(r.parsedType!==ue.object)return le(r,{code:J.invalid_type,expected:ue.object,received:r.parsedType}),Ie;const n=this.discriminator,i=r.data[n],s=this.optionsMap.get(i);return s?r.common.async?s._parseAsync({data:r.data,path:r.path,parent:r}):s._parseSync({data:r.data,path:r.path,parent:r}):(le(r,{code:J.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),Ie)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,r,n){const i=new Map;for(const s of r){const a=Yn(s.shape[e]);if(!a.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const o of a){if(i.has(o))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(o)}`);i.set(o,s)}}return new xd({typeName:Ce.ZodDiscriminatedUnion,discriminator:e,options:r,optionsMap:i,...Ne(n)})}}function $h(t,e){const r=Ai(t),n=Ai(e);if(t===e)return{valid:!0,data:t};if(r===ue.object&&n===ue.object){const i=We.objectKeys(e),s=We.objectKeys(t).filter(o=>i.indexOf(o)!==-1),a={...t,...e};for(const o of s){const l=$h(t[o],e[o]);if(!l.valid)return{valid:!1};a[o]=l.data}return{valid:!0,data:a}}else if(r===ue.array&&n===ue.array){if(t.length!==e.length)return{valid:!1};const i=[];for(let s=0;s<t.length;s++){const a=t[s],o=e[s],l=$h(a,o);if(!l.valid)return{valid:!1};i.push(l.data)}return{valid:!0,data:i}}else return r===ue.date&&n===ue.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class il extends Ve{_parse(e){const{status:r,ctx:n}=this._processInputParams(e),i=(s,a)=>{if(Uh(s)||Uh(a))return Ie;const o=$h(s.value,a.value);return o.valid?((Bh(s)||Bh(a))&&r.dirty(),{status:r.value,value:o.data}):(le(n,{code:J.invalid_intersection_types}),Ie)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([s,a])=>i(s,a)):i(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}il.create=(t,e,r)=>new il({left:t,right:e,typeName:Ce.ZodIntersection,...Ne(r)});class Un extends Ve{_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==ue.array)return le(n,{code:J.invalid_type,expected:ue.array,received:n.parsedType}),Ie;if(n.data.length<this._def.items.length)return le(n,{code:J.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Ie;!this._def.rest&&n.data.length>this._def.items.length&&(le(n,{code:J.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const s=[...n.data].map((a,o)=>{const l=this._def.items[o]||this._def.rest;return l?l._parse(new Fn(n,a,n.path,o)):null}).filter(a=>!!a);return n.common.async?Promise.all(s).then(a=>tr.mergeArray(r,a)):tr.mergeArray(r,s)}get items(){return this._def.items}rest(e){return new Un({...this._def,rest:e})}}Un.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Un({items:t,typeName:Ce.ZodTuple,rest:null,...Ne(e)})};class sl extends Ve{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==ue.object)return le(n,{code:J.invalid_type,expected:ue.object,received:n.parsedType}),Ie;const i=[],s=this._def.keyType,a=this._def.valueType;for(const o in n.data)i.push({key:s._parse(new Fn(n,o,n.path,o)),value:a._parse(new Fn(n,n.data[o],n.path,o)),alwaysSet:o in n.data});return n.common.async?tr.mergeObjectAsync(r,i):tr.mergeObjectSync(r,i)}get element(){return this._def.valueType}static create(e,r,n){return r instanceof Ve?new sl({keyType:e,valueType:r,typeName:Ce.ZodRecord,...Ne(n)}):new sl({keyType:hn.create(),valueType:e,typeName:Ce.ZodRecord,...Ne(r)})}}class _c extends Ve{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==ue.map)return le(n,{code:J.invalid_type,expected:ue.map,received:n.parsedType}),Ie;const i=this._def.keyType,s=this._def.valueType,a=[...n.data.entries()].map(([o,l],u)=>({key:i._parse(new Fn(n,o,n.path,[u,"key"])),value:s._parse(new Fn(n,l,n.path,[u,"value"]))}));if(n.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const l of a){const u=await l.key,c=await l.value;if(u.status==="aborted"||c.status==="aborted")return Ie;(u.status==="dirty"||c.status==="dirty")&&r.dirty(),o.set(u.value,c.value)}return{status:r.value,value:o}})}else{const o=new Map;for(const l of a){const u=l.key,c=l.value;if(u.status==="aborted"||c.status==="aborted")return Ie;(u.status==="dirty"||c.status==="dirty")&&r.dirty(),o.set(u.value,c.value)}return{status:r.value,value:o}}}}_c.create=(t,e,r)=>new _c({valueType:e,keyType:t,typeName:Ce.ZodMap,...Ne(r)});class Ts extends Ve{_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==ue.set)return le(n,{code:J.invalid_type,expected:ue.set,received:n.parsedType}),Ie;const i=this._def;i.minSize!==null&&n.data.size<i.minSize.value&&(le(n,{code:J.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),r.dirty()),i.maxSize!==null&&n.data.size>i.maxSize.value&&(le(n,{code:J.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),r.dirty());const s=this._def.valueType;function a(l){const u=new Set;for(const c of l){if(c.status==="aborted")return Ie;c.status==="dirty"&&r.dirty(),u.add(c.value)}return{status:r.value,value:u}}const o=[...n.data.values()].map((l,u)=>s._parse(new Fn(n,l,n.path,u)));return n.common.async?Promise.all(o).then(l=>a(l)):a(o)}min(e,r){return new Ts({...this._def,minSize:{value:e,message:Se.toString(r)}})}max(e,r){return new Ts({...this._def,maxSize:{value:e,message:Se.toString(r)}})}size(e,r){return this.min(e,r).max(e,r)}nonempty(e){return this.min(1,e)}}Ts.create=(t,e)=>new Ts({valueType:t,minSize:null,maxSize:null,typeName:Ce.ZodSet,...Ne(e)});class la extends Ve{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:r}=this._processInputParams(e);if(r.parsedType!==ue.function)return le(r,{code:J.invalid_type,expected:ue.function,received:r.parsedType}),Ie;function n(o,l){return wc({data:o,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Tc(),ba].filter(u=>!!u),issueData:{code:J.invalid_arguments,argumentsError:l}})}function i(o,l){return wc({data:o,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Tc(),ba].filter(u=>!!u),issueData:{code:J.invalid_return_type,returnTypeError:l}})}const s={errorMap:r.common.contextualErrorMap},a=r.data;if(this._def.returns instanceof Aa){const o=this;return cr(async function(...l){const u=new Mr([]),c=await o._def.args.parseAsync(l,s).catch(m=>{throw u.addIssue(n(l,m)),u}),d=await Reflect.apply(a,this,c);return await o._def.returns._def.type.parseAsync(d,s).catch(m=>{throw u.addIssue(i(d,m)),u})})}else{const o=this;return cr(function(...l){const u=o._def.args.safeParse(l,s);if(!u.success)throw new Mr([n(l,u.error)]);const c=Reflect.apply(a,this,u.data),d=o._def.returns.safeParse(c,s);if(!d.success)throw new Mr([i(c,d.error)]);return d.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new la({...this._def,args:Un.create(e).rest(ds.create())})}returns(e){return new la({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,r,n){return new la({args:e||Un.create([]).rest(ds.create()),returns:r||ds.create(),typeName:Ce.ZodFunction,...Ne(n)})}}class al extends Ve{get schema(){return this._def.getter()}_parse(e){const{ctx:r}=this._processInputParams(e);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}al.create=(t,e)=>new al({getter:t,typeName:Ce.ZodLazy,...Ne(e)});class ol extends Ve{_parse(e){if(e.data!==this._def.value){const r=this._getOrReturnCtx(e);return le(r,{received:r.data,code:J.invalid_literal,expected:this._def.value}),Ie}return{status:"valid",value:e.data}}get value(){return this._def.value}}ol.create=(t,e)=>new ol({value:t,typeName:Ce.ZodLiteral,...Ne(e)});function CE(t,e){return new Vi({values:t,typeName:Ce.ZodEnum,...Ne(e)})}class Vi extends Ve{constructor(){super(...arguments),co.set(this,void 0)}_parse(e){if(typeof e.data!="string"){const r=this._getOrReturnCtx(e),n=this._def.values;return le(r,{expected:We.joinValues(n),received:r.parsedType,code:J.invalid_type}),Ie}if(bc(this,co)||bE(this,co,new Set(this._def.values)),!bc(this,co).has(e.data)){const r=this._getOrReturnCtx(e),n=this._def.values;return le(r,{received:r.data,code:J.invalid_enum_value,options:n}),Ie}return cr(e.data)}get options(){return this._def.values}get enum(){const e={};for(const r of this._def.values)e[r]=r;return e}get Values(){const e={};for(const r of this._def.values)e[r]=r;return e}get Enum(){const e={};for(const r of this._def.values)e[r]=r;return e}extract(e,r=this._def){return Vi.create(e,{...this._def,...r})}exclude(e,r=this._def){return Vi.create(this.options.filter(n=>!e.includes(n)),{...this._def,...r})}}co=new WeakMap;Vi.create=CE;class ll extends Ve{constructor(){super(...arguments),fo.set(this,void 0)}_parse(e){const r=We.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==ue.string&&n.parsedType!==ue.number){const i=We.objectValues(r);return le(n,{expected:We.joinValues(i),received:n.parsedType,code:J.invalid_type}),Ie}if(bc(this,fo)||bE(this,fo,new Set(We.getValidEnumValues(this._def.values))),!bc(this,fo).has(e.data)){const i=We.objectValues(r);return le(n,{received:n.data,code:J.invalid_enum_value,options:i}),Ie}return cr(e.data)}get enum(){return this._def.values}}fo=new WeakMap;ll.create=(t,e)=>new ll({values:t,typeName:Ce.ZodNativeEnum,...Ne(e)});class Aa extends Ve{unwrap(){return this._def.type}_parse(e){const{ctx:r}=this._processInputParams(e);if(r.parsedType!==ue.promise&&r.common.async===!1)return le(r,{code:J.invalid_type,expected:ue.promise,received:r.parsedType}),Ie;const n=r.parsedType===ue.promise?r.data:Promise.resolve(r.data);return cr(n.then(i=>this._def.type.parseAsync(i,{path:r.path,errorMap:r.common.contextualErrorMap})))}}Aa.create=(t,e)=>new Aa({type:t,typeName:Ce.ZodPromise,...Ne(e)});class yn extends Ve{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Ce.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:r,ctx:n}=this._processInputParams(e),i=this._def.effect||null,s={addIssue:a=>{le(n,a),a.fatal?r.abort():r.dirty()},get path(){return n.path}};if(s.addIssue=s.addIssue.bind(s),i.type==="preprocess"){const a=i.transform(n.data,s);if(n.common.async)return Promise.resolve(a).then(async o=>{if(r.value==="aborted")return Ie;const l=await this._def.schema._parseAsync({data:o,path:n.path,parent:n});return l.status==="aborted"?Ie:l.status==="dirty"||r.value==="dirty"?ea(l.value):l});{if(r.value==="aborted")return Ie;const o=this._def.schema._parseSync({data:a,path:n.path,parent:n});return o.status==="aborted"?Ie:o.status==="dirty"||r.value==="dirty"?ea(o.value):o}}if(i.type==="refinement"){const a=o=>{const l=i.refinement(o,s);if(n.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(n.common.async===!1){const o=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return o.status==="aborted"?Ie:(o.status==="dirty"&&r.dirty(),a(o.value),{status:r.value,value:o.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(o=>o.status==="aborted"?Ie:(o.status==="dirty"&&r.dirty(),a(o.value).then(()=>({status:r.value,value:o.value}))))}if(i.type==="transform")if(n.common.async===!1){const a=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!Qo(a))return a;const o=i.transform(a.value,s);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:o}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(a=>Qo(a)?Promise.resolve(i.transform(a.value,s)).then(o=>({status:r.value,value:o})):a);We.assertNever(i)}}yn.create=(t,e,r)=>new yn({schema:t,typeName:Ce.ZodEffects,effect:e,...Ne(r)});yn.createWithPreprocess=(t,e,r)=>new yn({schema:e,effect:{type:"preprocess",transform:t},typeName:Ce.ZodEffects,...Ne(r)});class Mn extends Ve{_parse(e){return this._getType(e)===ue.undefined?cr(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Mn.create=(t,e)=>new Mn({innerType:t,typeName:Ce.ZodOptional,...Ne(e)});class Gi extends Ve{_parse(e){return this._getType(e)===ue.null?cr(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Gi.create=(t,e)=>new Gi({innerType:t,typeName:Ce.ZodNullable,...Ne(e)});class ul extends Ve{_parse(e){const{ctx:r}=this._processInputParams(e);let n=r.data;return r.parsedType===ue.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}ul.create=(t,e)=>new ul({innerType:t,typeName:Ce.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Ne(e)});class cl extends Ve{_parse(e){const{ctx:r}=this._processInputParams(e),n={...r,common:{...r.common,issues:[]}},i=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return Jo(i)?i.then(s=>({status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Mr(n.common.issues)},input:n.data})})):{status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Mr(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}cl.create=(t,e)=>new cl({innerType:t,typeName:Ce.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Ne(e)});class Cc extends Ve{_parse(e){if(this._getType(e)!==ue.nan){const n=this._getOrReturnCtx(e);return le(n,{code:J.invalid_type,expected:ue.nan,received:n.parsedType}),Ie}return{status:"valid",value:e.data}}}Cc.create=t=>new Cc({typeName:Ce.ZodNaN,...Ne(t)});const mR=Symbol("zod_brand");class vm extends Ve{_parse(e){const{ctx:r}=this._processInputParams(e),n=r.data;return this._def.type._parse({data:n,path:r.path,parent:r})}unwrap(){return this._def.type}}class Tl extends Ve{_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{const s=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return s.status==="aborted"?Ie:s.status==="dirty"?(r.dirty(),ea(s.value)):this._def.out._parseAsync({data:s.value,path:n.path,parent:n})})();{const i=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return i.status==="aborted"?Ie:i.status==="dirty"?(r.dirty(),{status:"dirty",value:i.value}):this._def.out._parseSync({data:i.value,path:n.path,parent:n})}}static create(e,r){return new Tl({in:e,out:r,typeName:Ce.ZodPipeline})}}class dl extends Ve{_parse(e){const r=this._def.innerType._parse(e),n=i=>(Qo(i)&&(i.value=Object.freeze(i.value)),i);return Jo(r)?r.then(i=>n(i)):n(r)}unwrap(){return this._def.innerType}}dl.create=(t,e)=>new dl({innerType:t,typeName:Ce.ZodReadonly,...Ne(e)});function RE(t,e={},r){return t?La.create().superRefine((n,i)=>{var s,a;if(!t(n)){const o=typeof e=="function"?e(n):typeof e=="string"?{message:e}:e,l=(a=(s=o.fatal)!==null&&s!==void 0?s:r)!==null&&a!==void 0?a:!0,u=typeof o=="string"?{message:o}:o;i.addIssue({code:"custom",...u,fatal:l})}}):La.create()}const gR={object:vt.lazycreate};var Ce;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(Ce||(Ce={}));const vR=(t,e={message:`Input not instance of ${t.name}`})=>RE(r=>r instanceof t,e),IE=hn.create,kE=$i.create,yR=Cc.create,xR=ji.create,DE=el.create,SR=Es.create,ER=Lc.create,TR=tl.create,wR=rl.create,bR=La.create,LR=ds.create,AR=di.create,_R=Ac.create,CR=gn.create,RR=vt.create,IR=vt.strictCreate,kR=nl.create,DR=xd.create,PR=il.create,OR=Un.create,MR=sl.create,NR=_c.create,FR=Ts.create,UR=la.create,BR=al.create,$R=ol.create,jR=Vi.create,VR=ll.create,GR=Aa.create,W0=yn.create,zR=Mn.create,HR=Gi.create,WR=yn.createWithPreprocess,KR=Tl.create,YR=()=>IE().optional(),qR=()=>kE().optional(),XR=()=>DE().optional(),ZR={string:t=>hn.create({...t,coerce:!0}),number:t=>$i.create({...t,coerce:!0}),boolean:t=>el.create({...t,coerce:!0}),bigint:t=>ji.create({...t,coerce:!0}),date:t=>Es.create({...t,coerce:!0})},QR=Ie;var to=Object.freeze({__proto__:null,defaultErrorMap:ba,setErrorMap:QC,getErrorMap:Tc,makeIssue:wc,EMPTY_PATH:JC,addIssueToContext:le,ParseStatus:tr,INVALID:Ie,DIRTY:ea,OK:cr,isAborted:Uh,isDirty:Bh,isValid:Qo,isAsync:Jo,get util(){return We},get objectUtil(){return Fh},ZodParsedType:ue,getParsedType:Ai,ZodType:Ve,datetimeRegex:_E,ZodString:hn,ZodNumber:$i,ZodBigInt:ji,ZodBoolean:el,ZodDate:Es,ZodSymbol:Lc,ZodUndefined:tl,ZodNull:rl,ZodAny:La,ZodUnknown:ds,ZodNever:di,ZodVoid:Ac,ZodArray:gn,ZodObject:vt,ZodUnion:nl,ZodDiscriminatedUnion:xd,ZodIntersection:il,ZodTuple:Un,ZodRecord:sl,ZodMap:_c,ZodSet:Ts,ZodFunction:la,ZodLazy:al,ZodLiteral:ol,ZodEnum:Vi,ZodNativeEnum:ll,ZodPromise:Aa,ZodEffects:yn,ZodTransformer:yn,ZodOptional:Mn,ZodNullable:Gi,ZodDefault:ul,ZodCatch:cl,ZodNaN:Cc,BRAND:mR,ZodBranded:vm,ZodPipeline:Tl,ZodReadonly:dl,custom:RE,Schema:Ve,ZodSchema:Ve,late:gR,get ZodFirstPartyTypeKind(){return Ce},coerce:ZR,any:bR,array:CR,bigint:xR,boolean:DE,date:SR,discriminatedUnion:DR,effect:W0,enum:jR,function:UR,instanceof:vR,intersection:PR,lazy:BR,literal:$R,map:NR,nan:yR,nativeEnum:VR,never:AR,null:wR,nullable:HR,number:kE,object:RR,oboolean:XR,onumber:qR,optional:zR,ostring:YR,pipeline:KR,preprocess:WR,promise:GR,record:MR,set:FR,strictObject:IR,string:IE,symbol:ER,transformer:W0,tuple:OR,undefined:TR,union:kR,unknown:LR,void:_R,NEVER:QR,ZodIssueCode:J,quotelessJson:ZC,ZodError:Mr});function JR(t,e){typeof t=="function"?t(e):t!=null&&(t.current=e)}function eI(...t){return e=>t.forEach(r=>JR(r,e))}var Sd=L.forwardRef((t,e)=>{const{children:r,...n}=t,i=L.Children.toArray(r),s=i.find(rI);if(s){const a=s.props.children,o=i.map(l=>l===s?L.Children.count(a)>1?L.Children.only(null):L.isValidElement(a)?a.props.children:null:l);return E.jsx(jh,{...n,ref:e,children:L.isValidElement(a)?L.cloneElement(a,void 0,o):null})}return E.jsx(jh,{...n,ref:e,children:r})});Sd.displayName="Slot";var jh=L.forwardRef((t,e)=>{const{children:r,...n}=t;if(L.isValidElement(r)){const i=iI(r);return L.cloneElement(r,{...nI(n,r.props),ref:e?eI(e,i):i})}return L.Children.count(r)>1?L.Children.only(null):null});jh.displayName="SlotClone";var tI=({children:t})=>E.jsx(E.Fragment,{children:t});function rI(t){return L.isValidElement(t)&&t.type===tI}function nI(t,e){const r={...e};for(const n in e){const i=t[n],s=e[n];/^on[A-Z]/.test(n)?i&&s?r[n]=(...o)=>{s(...o),i(...o)}:i&&(r[n]=i):n==="style"?r[n]={...i,...s}:n==="className"&&(r[n]=[i,s].filter(Boolean).join(" "))}return{...t,...r}}function iI(t){var n,i;let e=(n=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:n.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=(i=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:i.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}function PE(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(r=PE(t[e]))&&(n&&(n+=" "),n+=r);else for(e in t)t[e]&&(n&&(n+=" "),n+=e);return n}function sI(){for(var t,e,r=0,n="";r<arguments.length;)(t=arguments[r++])&&(e=PE(t))&&(n&&(n+=" "),n+=e);return n}const K0=t=>typeof t=="boolean"?"".concat(t):t===0?"0":t,Y0=sI,OE=(t,e)=>r=>{var n;if((e==null?void 0:e.variants)==null)return Y0(t,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:i,defaultVariants:s}=e,a=Object.keys(i).map(u=>{const c=r==null?void 0:r[u],d=s==null?void 0:s[u];if(c===null)return null;const f=K0(c)||K0(d);return i[u][f]}),o=r&&Object.entries(r).reduce((u,c)=>{let[d,f]=c;return f===void 0||(u[d]=f),u},{}),l=e==null||(n=e.compoundVariants)===null||n===void 0?void 0:n.reduce((u,c)=>{let{class:d,className:f,...m}=c;return Object.entries(m).every(h=>{let[p,v]=h;return Array.isArray(v)?v.includes({...s,...o}[p]):{...s,...o}[p]===v})?[...u,d,f]:u},[]);return Y0(t,a,l,r==null?void 0:r.class,r==null?void 0:r.className)},ym="-",aI=t=>{const e=lI(t),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=t;return{getClassGroupId:a=>{const o=a.split(ym);return o[0]===""&&o.length!==1&&o.shift(),ME(o,e)||oI(a)},getConflictingClassGroupIds:(a,o)=>{const l=r[a]||[];return o&&n[a]?[...l,...n[a]]:l}}},ME=(t,e)=>{var a;if(t.length===0)return e.classGroupId;const r=t[0],n=e.nextPart.get(r),i=n?ME(t.slice(1),n):void 0;if(i)return i;if(e.validators.length===0)return;const s=t.join(ym);return(a=e.validators.find(({validator:o})=>o(s)))==null?void 0:a.classGroupId},q0=/^\[(.+)\]$/,oI=t=>{if(q0.test(t)){const e=q0.exec(t)[1],r=e==null?void 0:e.substring(0,e.indexOf(":"));if(r)return"arbitrary.."+r}},lI=t=>{const{theme:e,prefix:r}=t,n={nextPart:new Map,validators:[]};return cI(Object.entries(t.classGroups),r).forEach(([s,a])=>{Vh(a,n,s,e)}),n},Vh=(t,e,r,n)=>{t.forEach(i=>{if(typeof i=="string"){const s=i===""?e:X0(e,i);s.classGroupId=r;return}if(typeof i=="function"){if(uI(i)){Vh(i(n),e,r,n);return}e.validators.push({validator:i,classGroupId:r});return}Object.entries(i).forEach(([s,a])=>{Vh(a,X0(e,s),r,n)})})},X0=(t,e)=>{let r=t;return e.split(ym).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},uI=t=>t.isThemeGetter,cI=(t,e)=>e?t.map(([r,n])=>{const i=n.map(s=>typeof s=="string"?e+s:typeof s=="object"?Object.fromEntries(Object.entries(s).map(([a,o])=>[e+a,o])):s);return[r,i]}):t,dI=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,r=new Map,n=new Map;const i=(s,a)=>{r.set(s,a),e++,e>t&&(e=0,n=r,r=new Map)};return{get(s){let a=r.get(s);if(a!==void 0)return a;if((a=n.get(s))!==void 0)return i(s,a),a},set(s,a){r.has(s)?r.set(s,a):i(s,a)}}},NE="!",fI=t=>{const{separator:e,experimentalParseClassName:r}=t,n=e.length===1,i=e[0],s=e.length,a=o=>{const l=[];let u=0,c=0,d;for(let v=0;v<o.length;v++){let g=o[v];if(u===0){if(g===i&&(n||o.slice(v,v+s)===e)){l.push(o.slice(c,v)),c=v+s;continue}if(g==="/"){d=v;continue}}g==="["?u++:g==="]"&&u--}const f=l.length===0?o:o.substring(c),m=f.startsWith(NE),h=m?f.substring(1):f,p=d&&d>c?d-c:void 0;return{modifiers:l,hasImportantModifier:m,baseClassName:h,maybePostfixModifierPosition:p}};return r?o=>r({className:o,parseClassName:a}):a},hI=t=>{if(t.length<=1)return t;const e=[];let r=[];return t.forEach(n=>{n[0]==="["?(e.push(...r.sort(),n),r=[]):r.push(n)}),e.push(...r.sort()),e},pI=t=>({cache:dI(t.cacheSize),parseClassName:fI(t),...aI(t)}),mI=/\s+/,gI=(t,e)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:i}=e,s=[],a=t.trim().split(mI);let o="";for(let l=a.length-1;l>=0;l-=1){const u=a[l],{modifiers:c,hasImportantModifier:d,baseClassName:f,maybePostfixModifierPosition:m}=r(u);let h=!!m,p=n(h?f.substring(0,m):f);if(!p){if(!h){o=u+(o.length>0?" "+o:o);continue}if(p=n(f),!p){o=u+(o.length>0?" "+o:o);continue}h=!1}const v=hI(c).join(":"),g=d?v+NE:v,y=g+p;if(s.includes(y))continue;s.push(y);const x=i(p,h);for(let S=0;S<x.length;++S){const T=x[S];s.push(g+T)}o=u+(o.length>0?" "+o:o)}return o};function vI(){let t=0,e,r,n="";for(;t<arguments.length;)(e=arguments[t++])&&(r=FE(e))&&(n&&(n+=" "),n+=r);return n}const FE=t=>{if(typeof t=="string")return t;let e,r="";for(let n=0;n<t.length;n++)t[n]&&(e=FE(t[n]))&&(r&&(r+=" "),r+=e);return r};function yI(t,...e){let r,n,i,s=a;function a(l){const u=e.reduce((c,d)=>d(c),t());return r=pI(u),n=r.cache.get,i=r.cache.set,s=o,o(l)}function o(l){const u=n(l);if(u)return u;const c=gI(l,r);return i(l,c),c}return function(){return s(vI.apply(null,arguments))}}const ct=t=>{const e=r=>r[t]||[];return e.isThemeGetter=!0,e},UE=/^\[(?:([a-z-]+):)?(.+)\]$/i,xI=/^\d+\/\d+$/,SI=new Set(["px","full","screen"]),EI=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,TI=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,wI=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,bI=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,LI=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,zn=t=>ua(t)||SI.has(t)||xI.test(t),gi=t=>Ba(t,"length",PI),ua=t=>!!t&&!Number.isNaN(Number(t)),uf=t=>Ba(t,"number",ua),ro=t=>!!t&&Number.isInteger(Number(t)),AI=t=>t.endsWith("%")&&ua(t.slice(0,-1)),Be=t=>UE.test(t),vi=t=>EI.test(t),_I=new Set(["length","size","percentage"]),CI=t=>Ba(t,_I,BE),RI=t=>Ba(t,"position",BE),II=new Set(["image","url"]),kI=t=>Ba(t,II,MI),DI=t=>Ba(t,"",OI),no=()=>!0,Ba=(t,e,r)=>{const n=UE.exec(t);return n?n[1]?typeof e=="string"?n[1]===e:e.has(n[1]):r(n[2]):!1},PI=t=>TI.test(t)&&!wI.test(t),BE=()=>!1,OI=t=>bI.test(t),MI=t=>LI.test(t),NI=()=>{const t=ct("colors"),e=ct("spacing"),r=ct("blur"),n=ct("brightness"),i=ct("borderColor"),s=ct("borderRadius"),a=ct("borderSpacing"),o=ct("borderWidth"),l=ct("contrast"),u=ct("grayscale"),c=ct("hueRotate"),d=ct("invert"),f=ct("gap"),m=ct("gradientColorStops"),h=ct("gradientColorStopPositions"),p=ct("inset"),v=ct("margin"),g=ct("opacity"),y=ct("padding"),x=ct("saturate"),S=ct("scale"),T=ct("sepia"),C=ct("skew"),_=ct("space"),b=ct("translate"),I=()=>["auto","contain","none"],A=()=>["auto","hidden","clip","visible","scroll"],k=()=>["auto",Be,e],O=()=>[Be,e],P=()=>["",zn,gi],G=()=>["auto",ua,Be],K=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],H=()=>["solid","dashed","dotted","double","none"],se=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],W=()=>["start","end","center","between","around","evenly","stretch"],F=()=>["","0",Be],j=()=>["auto","avoid","all","avoid-page","page","left","right","column"],te=()=>[ua,Be];return{cacheSize:500,separator:":",theme:{colors:[no],spacing:[zn,gi],blur:["none","",vi,Be],brightness:te(),borderColor:[t],borderRadius:["none","","full",vi,Be],borderSpacing:O(),borderWidth:P(),contrast:te(),grayscale:F(),hueRotate:te(),invert:F(),gap:O(),gradientColorStops:[t],gradientColorStopPositions:[AI,gi],inset:k(),margin:k(),opacity:te(),padding:O(),saturate:te(),scale:te(),sepia:F(),skew:te(),space:O(),translate:O()},classGroups:{aspect:[{aspect:["auto","square","video",Be]}],container:["container"],columns:[{columns:[vi]}],"break-after":[{"break-after":j()}],"break-before":[{"break-before":j()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...K(),Be]}],overflow:[{overflow:A()}],"overflow-x":[{"overflow-x":A()}],"overflow-y":[{"overflow-y":A()}],overscroll:[{overscroll:I()}],"overscroll-x":[{"overscroll-x":I()}],"overscroll-y":[{"overscroll-y":I()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[p]}],"inset-x":[{"inset-x":[p]}],"inset-y":[{"inset-y":[p]}],start:[{start:[p]}],end:[{end:[p]}],top:[{top:[p]}],right:[{right:[p]}],bottom:[{bottom:[p]}],left:[{left:[p]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",ro,Be]}],basis:[{basis:k()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Be]}],grow:[{grow:F()}],shrink:[{shrink:F()}],order:[{order:["first","last","none",ro,Be]}],"grid-cols":[{"grid-cols":[no]}],"col-start-end":[{col:["auto",{span:["full",ro,Be]},Be]}],"col-start":[{"col-start":G()}],"col-end":[{"col-end":G()}],"grid-rows":[{"grid-rows":[no]}],"row-start-end":[{row:["auto",{span:[ro,Be]},Be]}],"row-start":[{"row-start":G()}],"row-end":[{"row-end":G()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Be]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Be]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...W()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...W(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...W(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[y]}],px:[{px:[y]}],py:[{py:[y]}],ps:[{ps:[y]}],pe:[{pe:[y]}],pt:[{pt:[y]}],pr:[{pr:[y]}],pb:[{pb:[y]}],pl:[{pl:[y]}],m:[{m:[v]}],mx:[{mx:[v]}],my:[{my:[v]}],ms:[{ms:[v]}],me:[{me:[v]}],mt:[{mt:[v]}],mr:[{mr:[v]}],mb:[{mb:[v]}],ml:[{ml:[v]}],"space-x":[{"space-x":[_]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[_]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Be,e]}],"min-w":[{"min-w":[Be,e,"min","max","fit"]}],"max-w":[{"max-w":[Be,e,"none","full","min","max","fit","prose",{screen:[vi]},vi]}],h:[{h:[Be,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Be,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Be,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Be,e,"auto","min","max","fit"]}],"font-size":[{text:["base",vi,gi]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",uf]}],"font-family":[{font:[no]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Be]}],"line-clamp":[{"line-clamp":["none",ua,uf]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",zn,Be]}],"list-image":[{"list-image":["none",Be]}],"list-style-type":[{list:["none","disc","decimal",Be]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[g]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[g]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...H(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",zn,gi]}],"underline-offset":[{"underline-offset":["auto",zn,Be]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:O()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Be]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Be]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[g]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...K(),RI]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",CI]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},kI]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[h]}],"gradient-via-pos":[{via:[h]}],"gradient-to-pos":[{to:[h]}],"gradient-from":[{from:[m]}],"gradient-via":[{via:[m]}],"gradient-to":[{to:[m]}],rounded:[{rounded:[s]}],"rounded-s":[{"rounded-s":[s]}],"rounded-e":[{"rounded-e":[s]}],"rounded-t":[{"rounded-t":[s]}],"rounded-r":[{"rounded-r":[s]}],"rounded-b":[{"rounded-b":[s]}],"rounded-l":[{"rounded-l":[s]}],"rounded-ss":[{"rounded-ss":[s]}],"rounded-se":[{"rounded-se":[s]}],"rounded-ee":[{"rounded-ee":[s]}],"rounded-es":[{"rounded-es":[s]}],"rounded-tl":[{"rounded-tl":[s]}],"rounded-tr":[{"rounded-tr":[s]}],"rounded-br":[{"rounded-br":[s]}],"rounded-bl":[{"rounded-bl":[s]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[g]}],"border-style":[{border:[...H(),"hidden"]}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[g]}],"divide-style":[{divide:H()}],"border-color":[{border:[i]}],"border-color-x":[{"border-x":[i]}],"border-color-y":[{"border-y":[i]}],"border-color-s":[{"border-s":[i]}],"border-color-e":[{"border-e":[i]}],"border-color-t":[{"border-t":[i]}],"border-color-r":[{"border-r":[i]}],"border-color-b":[{"border-b":[i]}],"border-color-l":[{"border-l":[i]}],"divide-color":[{divide:[i]}],"outline-style":[{outline:["",...H()]}],"outline-offset":[{"outline-offset":[zn,Be]}],"outline-w":[{outline:[zn,gi]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:P()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[g]}],"ring-offset-w":[{"ring-offset":[zn,gi]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",vi,DI]}],"shadow-color":[{shadow:[no]}],opacity:[{opacity:[g]}],"mix-blend":[{"mix-blend":[...se(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":se()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",vi,Be]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[c]}],invert:[{invert:[d]}],saturate:[{saturate:[x]}],sepia:[{sepia:[T]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[c]}],"backdrop-invert":[{"backdrop-invert":[d]}],"backdrop-opacity":[{"backdrop-opacity":[g]}],"backdrop-saturate":[{"backdrop-saturate":[x]}],"backdrop-sepia":[{"backdrop-sepia":[T]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[a]}],"border-spacing-x":[{"border-spacing-x":[a]}],"border-spacing-y":[{"border-spacing-y":[a]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Be]}],duration:[{duration:te()}],ease:[{ease:["linear","in","out","in-out",Be]}],delay:[{delay:te()}],animate:[{animate:["none","spin","ping","pulse","bounce",Be]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[S]}],"scale-x":[{"scale-x":[S]}],"scale-y":[{"scale-y":[S]}],rotate:[{rotate:[ro,Be]}],"translate-x":[{"translate-x":[b]}],"translate-y":[{"translate-y":[b]}],"skew-x":[{"skew-x":[C]}],"skew-y":[{"skew-y":[C]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Be]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Be]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":O()}],"scroll-mx":[{"scroll-mx":O()}],"scroll-my":[{"scroll-my":O()}],"scroll-ms":[{"scroll-ms":O()}],"scroll-me":[{"scroll-me":O()}],"scroll-mt":[{"scroll-mt":O()}],"scroll-mr":[{"scroll-mr":O()}],"scroll-mb":[{"scroll-mb":O()}],"scroll-ml":[{"scroll-ml":O()}],"scroll-p":[{"scroll-p":O()}],"scroll-px":[{"scroll-px":O()}],"scroll-py":[{"scroll-py":O()}],"scroll-ps":[{"scroll-ps":O()}],"scroll-pe":[{"scroll-pe":O()}],"scroll-pt":[{"scroll-pt":O()}],"scroll-pr":[{"scroll-pr":O()}],"scroll-pb":[{"scroll-pb":O()}],"scroll-pl":[{"scroll-pl":O()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Be]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[zn,gi,uf]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},FI=yI(NI);function $r(...t){return FI(ri(t))}const UI=OE("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),xm=L.forwardRef(({className:t,variant:e,size:r,asChild:n=!1,...i},s)=>{const a=n?Sd:"button";return E.jsx(a,{className:$r(UI({variant:e,size:r,className:t})),ref:s,...i})});xm.displayName="Button";const Sm=L.forwardRef(({className:t,...e},r)=>E.jsx("div",{ref:r,className:$r("rounded-lg border bg-card text-card-foreground shadow-sm",t),...e}));Sm.displayName="Card";const Em=L.forwardRef(({className:t,...e},r)=>E.jsx("div",{ref:r,className:$r("flex flex-col space-y-1.5 p-6",t),...e}));Em.displayName="CardHeader";const Tm=L.forwardRef(({className:t,...e},r)=>E.jsx("h3",{ref:r,className:$r("text-2xl font-semibold leading-none tracking-tight",t),...e}));Tm.displayName="CardTitle";const BI=L.forwardRef(({className:t,...e},r)=>E.jsx("p",{ref:r,className:$r("text-sm text-muted-foreground",t),...e}));BI.displayName="CardDescription";const $E=L.forwardRef(({className:t,...e},r)=>E.jsx("div",{ref:r,className:$r("p-6 pt-0",t),...e}));$E.displayName="CardContent";const jE=L.forwardRef(({className:t,...e},r)=>E.jsx("div",{ref:r,className:$r("flex items-center p-6 pt-0",t),...e}));jE.displayName="CardFooter";var $I=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],jI=$I.reduce((t,e)=>{const r=L.forwardRef((n,i)=>{const{asChild:s,...a}=n,o=s?Sd:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),E.jsx(o,{...a,ref:i})});return r.displayName=`Primitive.${e}`,{...t,[e]:r}},{}),VI="Label",VE=L.forwardRef((t,e)=>E.jsx(jI.label,{...t,ref:e,onMouseDown:r=>{var i;r.target.closest("button, input, select, textarea")||((i=t.onMouseDown)==null||i.call(t,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));VE.displayName=VI;var GE=VE;const GI=OE("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Ao=L.forwardRef(({className:t,...e},r)=>E.jsx(GE,{ref:r,className:$r(GI(),t),...e}));Ao.displayName=GE.displayName;const zI=IC,zE=L.createContext({}),cf=({...t})=>E.jsx(zE.Provider,{value:{name:t.name},children:E.jsx(OC,{...t})}),Ed=()=>{const t=L.useContext(zE),e=L.useContext(HE),{getFieldState:r,formState:n}=yd(),i=r(t.name,n);if(!t)throw new Error("useFormField should be used within <FormField>");const{id:s}=e;return{id:s,name:t.name,formItemId:`${s}-form-item`,formDescriptionId:`${s}-form-item-description`,formMessageId:`${s}-form-item-message`,...i}},HE=L.createContext({}),Cu=L.forwardRef(({className:t,...e},r)=>{const n=L.useId();return E.jsx(HE.Provider,{value:{id:n},children:E.jsx("div",{ref:r,className:$r("space-y-2",t),...e})})});Cu.displayName="FormItem";const Ru=L.forwardRef(({className:t,...e},r)=>{const{error:n,formItemId:i}=Ed();return E.jsx(Ao,{ref:r,className:$r(n&&"text-destructive",t),htmlFor:i,...e})});Ru.displayName="FormLabel";const Iu=L.forwardRef(({...t},e)=>{const{error:r,formItemId:n,formDescriptionId:i,formMessageId:s}=Ed();return E.jsx(Sd,{ref:e,id:n,"aria-describedby":r?`${i} ${s}`:`${i}`,"aria-invalid":!!r,...t})});Iu.displayName="FormControl";const HI=L.forwardRef(({className:t,...e},r)=>{const{formDescriptionId:n}=Ed();return E.jsx("p",{ref:r,id:n,className:$r("text-sm text-muted-foreground",t),...e})});HI.displayName="FormDescription";const ku=L.forwardRef(({className:t,children:e,...r},n)=>{const{error:i,formMessageId:s}=Ed(),a=i?String(i==null?void 0:i.message):e;return a?E.jsx("p",{ref:n,id:s,className:$r("text-sm font-medium text-destructive",t),...r,children:a}):null});ku.displayName="FormMessage";const fs=L.forwardRef(({className:t,type:e,...r},n)=>E.jsx("input",{type:e,className:$r("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:n,...r}));fs.displayName="Input";const WI=to.object({username:to.string().min(4,"Username must be at least 4 characters long").max(20,"Username must be at most 20 characters long"),password:to.string().min(8,"Password must be at least 8 characters long").max(64,"Password must be at most 64 characters long").refine(t=>/[A-Z]/.test(t),{message:"Password must contain at least one uppercase letter"}).refine(t=>/[a-z]/.test(t),{message:"Password must contain at least one lowercase letter"}).refine(t=>/[0-9]/.test(t),{message:"Password must contain at least one number"}).refine(t=>/[!@#$%^&*()_+[\]{};':"\\|,.<>/?`~\\-]/.test(t),{message:"Password must contain at least one special character"}),confirmPassword:to.string(),type:to.enum(["admin","user"])}).refine(t=>t.password===t.confirmPassword,{message:"Passwords do not match",path:["confirmPassword"]}),KI=()=>{const t=WC({resolver:XC(WI),defaultValues:{username:"",password:"",confirmPassword:"",type:"user"}}),e=Br(),{handleSubmit:r,data:n,pending:i}=Ss(),s=async a=>{console.log(a);try{await r({url:"/api/auth/signup",body:{...a,code:window.location.search.includes("code")}}),Ke.success("Registration successful"),e("/sign-in")}catch(o){Ke.error(o.message)}};return L.useEffect(()=>{n&&(n.code===200?Ke.success("Sign up successful"):Ke.error("Sign up failed"))},[n]),E.jsx("section",{className:"h-screen w-screen flex items-center justify-center",children:E.jsxs(Sm,{className:"w-1/4 py-2 px-4 pb-8",children:[E.jsx(Em,{children:E.jsx(Tm,{children:"Sign Up"})}),E.jsx(zI,{...t,children:E.jsxs("form",{onSubmit:t.handleSubmit(s),className:"flex flex-col gap-6",children:[E.jsx(cf,{control:t.control,name:"username",render:({field:a})=>E.jsxs(Cu,{children:[E.jsx(Ru,{htmlFor:"username",children:"Username"}),E.jsx(Iu,{children:E.jsx(fs,{...a,placeholder:"Username",autoComplete:"given-name"})}),E.jsx(ku,{})]})}),E.jsx(cf,{control:t.control,name:"password",render:({field:a})=>E.jsxs(Cu,{children:[E.jsx(Ru,{htmlFor:"password",children:"Password"}),E.jsx(Iu,{children:E.jsx(fs,{...a,type:"password",placeholder:"Password",autoComplete:"new-password"})}),E.jsx(ku,{})]})}),E.jsx(cf,{control:t.control,name:"confirmPassword",render:({field:a})=>E.jsxs(Cu,{children:[E.jsx(Ru,{htmlFor:"confirmPassword",children:"Confirm Password"}),E.jsx(Iu,{children:E.jsx(fs,{...a,type:"password",placeholder:"Confirm Password",autoComplete:"new-password"})}),E.jsx(ku,{})]})}),E.jsx(xm,{variant:"default",children:i?"Signing up...":"Sign Up"})]})})]})})},_s=t=>E.jsx("section",{...t,children:E.jsx("div",{className:"flex justify-center items-center h-full",children:E.jsx("img",{src:"loader.gif",alt:"Loading...",className:"w-1/4"})})}),Rn=({state:t,iconBefore:e,iconAfter:r,to:n,onClick:i,className:s="",children:a,...o})=>{const l="flex items-center justify-center gap-2 py-2 px-4 rounded-md font-medium",f=t==="primary"?"bg-neutral-200 text-neutral-900 hover:bg-neutral-300":t==="secondary"?"bg-neutral-900 text-neutral-200 hover:bg-neutral-800":"bg-red-500 text-white hover:bg-red-600",m=Br(),h=()=>{n?m(n):i&&i()};return E.jsxs("button",{onClick:h,className:`${l} ${f} ${s} transition-colors duration-300`,...o,children:[e&&E.jsx("span",{children:e}),a,r&&E.jsx("span",{children:r})]})};var WE={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Z0=ne.createContext&&ne.createContext(WE),YI=["attr","size","title"];function qI(t,e){if(t==null)return{};var r=XI(t,e),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function XI(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function Rc(){return Rc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Rc.apply(this,arguments)}function Q0(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Ic(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Q0(Object(r),!0).forEach(function(n){ZI(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Q0(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ZI(t,e,r){return e=QI(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function QI(t){var e=JI(t,"string");return typeof e=="symbol"?e:e+""}function JI(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function KE(t){return t&&t.map((e,r)=>ne.createElement(e.tag,Ic({key:r},e.attr),KE(e.child)))}function Mt(t){return e=>ne.createElement(ek,Rc({attr:Ic({},t.attr)},e),KE(t.child))}function ek(t){var e=r=>{var{attr:n,size:i,title:s}=t,a=qI(t,YI),o=i||r.size||"1em",l;return r.className&&(l=r.className),t.className&&(l=(l?l+" ":"")+t.className),ne.createElement("svg",Rc({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,n,a,{className:l,style:Ic(Ic({color:t.color||r.color},r.style),t.style),height:o,width:o,xmlns:"http://www.w3.org/2000/svg"}),s&&ne.createElement("title",null,s),t.children)};return Z0!==void 0?ne.createElement(Z0.Consumer,null,r=>e(r)):e(WE)}function tk(t){return Mt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M9.5 15.584V8.416a.5.5 0 0 1 .77-.42l5.576 3.583a.5.5 0 0 1 0 .842l-5.576 3.584a.5.5 0 0 1-.77-.42Z"},child:[]},{tag:"path",attr:{d:"M1 12C1 5.925 5.925 1 12 1s11 4.925 11 11-4.925 11-11 11S1 18.075 1 12Zm11-9.5A9.5 9.5 0 0 0 2.5 12a9.5 9.5 0 0 0 9.5 9.5 9.5 9.5 0 0 0 9.5-9.5A9.5 9.5 0 0 0 12 2.5Z"},child:[]}]})(t)}const _a=({media:t})=>t?E.jsx("section",{className:"h-[85dvh] bg-cover bg-center flex items-end",style:{backgroundImage:`linear-gradient(hsl(var(--background)), transparent, hsl(var(--background))), linear-gradient(90deg, hsl(var(--background)) 5%, transparent), url(/api/medias/images/banner/${t.type}/${t.banner_id})`},children:E.jsxs("section",{className:"px-4 flex flex-col gap-4 w-3/4",children:[t.have_logo?E.jsx("img",{src:t.images.logo,alt:t.title,className:"h-48 object-contain rounded-md w-fit"}):E.jsx("h1",{className:"text-5xl font-bold",children:t.serie_title??t.title}),E.jsx("p",{children:t.description}),E.jsx("section",{className:"flex gap-4",children:E.jsx(Rn,{to:`/watch/${t.type}/${t.id}`,iconBefore:E.jsx(tk,{}),state:"primary",children:"Watch Now"})})]})}):null;function J0(t){return t!==null&&typeof t=="object"&&"constructor"in t&&t.constructor===Object}function wm(t,e){t===void 0&&(t={}),e===void 0&&(e={}),Object.keys(e).forEach(r=>{typeof t[r]>"u"?t[r]=e[r]:J0(e[r])&&J0(t[r])&&Object.keys(e[r]).length>0&&wm(t[r],e[r])})}const YE={body:{},addEventListener(){},removeEventListener(){},activeElement:{blur(){},nodeName:""},querySelector(){return null},querySelectorAll(){return[]},getElementById(){return null},createEvent(){return{initEvent(){}}},createElement(){return{children:[],childNodes:[],style:{},setAttribute(){},getElementsByTagName(){return[]}}},createElementNS(){return{}},importNode(){return null},location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""}};function $a(){const t=typeof document<"u"?document:{};return wm(t,YE),t}const rk={document:YE,navigator:{userAgent:""},location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""},history:{replaceState(){},pushState(){},go(){},back(){}},CustomEvent:function(){return this},addEventListener(){},removeEventListener(){},getComputedStyle(){return{getPropertyValue(){return""}}},Image(){},Date(){},screen:{},setTimeout(){},clearTimeout(){},matchMedia(){return{}},requestAnimationFrame(t){return typeof setTimeout>"u"?(t(),null):setTimeout(t,0)},cancelAnimationFrame(t){typeof setTimeout>"u"||clearTimeout(t)}};function jr(){const t=typeof window<"u"?window:{};return wm(t,rk),t}function nk(t){return t===void 0&&(t=""),t.trim().split(" ").filter(e=>!!e.trim())}function ik(t){const e=t;Object.keys(e).forEach(r=>{try{e[r]=null}catch{}try{delete e[r]}catch{}})}function Gh(t,e){return e===void 0&&(e=0),setTimeout(t,e)}function kc(){return Date.now()}function sk(t){const e=jr();let r;return e.getComputedStyle&&(r=e.getComputedStyle(t,null)),!r&&t.currentStyle&&(r=t.currentStyle),r||(r=t.style),r}function ak(t,e){e===void 0&&(e="x");const r=jr();let n,i,s;const a=sk(t);return r.WebKitCSSMatrix?(i=a.transform||a.webkitTransform,i.split(",").length>6&&(i=i.split(", ").map(o=>o.replace(",",".")).join(", ")),s=new r.WebKitCSSMatrix(i==="none"?"":i)):(s=a.MozTransform||a.OTransform||a.MsTransform||a.msTransform||a.transform||a.getPropertyValue("transform").replace("translate(","matrix(1, 0, 0, 1,"),n=s.toString().split(",")),e==="x"&&(r.WebKitCSSMatrix?i=s.m41:n.length===16?i=parseFloat(n[12]):i=parseFloat(n[4])),e==="y"&&(r.WebKitCSSMatrix?i=s.m42:n.length===16?i=parseFloat(n[13]):i=parseFloat(n[5])),i||0}function Jl(t){return typeof t=="object"&&t!==null&&t.constructor&&Object.prototype.toString.call(t).slice(8,-1)==="Object"}function ok(t){return typeof window<"u"&&typeof window.HTMLElement<"u"?t instanceof HTMLElement:t&&(t.nodeType===1||t.nodeType===11)}function Ir(){const t=Object(arguments.length<=0?void 0:arguments[0]),e=["__proto__","constructor","prototype"];for(let r=1;r<arguments.length;r+=1){const n=r<0||arguments.length<=r?void 0:arguments[r];if(n!=null&&!ok(n)){const i=Object.keys(Object(n)).filter(s=>e.indexOf(s)<0);for(let s=0,a=i.length;s<a;s+=1){const o=i[s],l=Object.getOwnPropertyDescriptor(n,o);l!==void 0&&l.enumerable&&(Jl(t[o])&&Jl(n[o])?n[o].__swiper__?t[o]=n[o]:Ir(t[o],n[o]):!Jl(t[o])&&Jl(n[o])?(t[o]={},n[o].__swiper__?t[o]=n[o]:Ir(t[o],n[o])):t[o]=n[o])}}}return t}function eu(t,e,r){t.style.setProperty(e,r)}function qE(t){let{swiper:e,targetPosition:r,side:n}=t;const i=jr(),s=-e.translate;let a=null,o;const l=e.params.speed;e.wrapperEl.style.scrollSnapType="none",i.cancelAnimationFrame(e.cssModeFrameID);const u=r>s?"next":"prev",c=(f,m)=>u==="next"&&f>=m||u==="prev"&&f<=m,d=()=>{o=new Date().getTime(),a===null&&(a=o);const f=Math.max(Math.min((o-a)/l,1),0),m=.5-Math.cos(f*Math.PI)/2;let h=s+m*(r-s);if(c(h,r)&&(h=r),e.wrapperEl.scrollTo({[n]:h}),c(h,r)){e.wrapperEl.style.overflow="hidden",e.wrapperEl.style.scrollSnapType="",setTimeout(()=>{e.wrapperEl.style.overflow="",e.wrapperEl.scrollTo({[n]:h})}),i.cancelAnimationFrame(e.cssModeFrameID);return}e.cssModeFrameID=i.requestAnimationFrame(d)};d()}function In(t,e){e===void 0&&(e="");const r=[...t.children];return t instanceof HTMLSlotElement&&r.push(...t.assignedElements()),e?r.filter(n=>n.matches(e)):r}function lk(t,e){const r=e.contains(t);return!r&&e instanceof HTMLSlotElement?[...e.assignedElements()].includes(t):r}function Dc(t){try{console.warn(t);return}catch{}}function Pc(t,e){e===void 0&&(e=[]);const r=document.createElement(t);return r.classList.add(...Array.isArray(e)?e:nk(e)),r}function uk(t,e){const r=[];for(;t.previousElementSibling;){const n=t.previousElementSibling;e?n.matches(e)&&r.push(n):r.push(n),t=n}return r}function ck(t,e){const r=[];for(;t.nextElementSibling;){const n=t.nextElementSibling;e?n.matches(e)&&r.push(n):r.push(n),t=n}return r}function Ri(t,e){return jr().getComputedStyle(t,null).getPropertyValue(e)}function ev(t){let e=t,r;if(e){for(r=0;(e=e.previousSibling)!==null;)e.nodeType===1&&(r+=1);return r}}function dk(t,e){const r=[];let n=t.parentElement;for(;n;)r.push(n),n=n.parentElement;return r}function tv(t,e,r){const n=jr();return t[e==="width"?"offsetWidth":"offsetHeight"]+parseFloat(n.getComputedStyle(t,null).getPropertyValue(e==="width"?"margin-right":"margin-top"))+parseFloat(n.getComputedStyle(t,null).getPropertyValue(e==="width"?"margin-left":"margin-bottom"))}function Hn(t){return(Array.isArray(t)?t:[t]).filter(e=>!!e)}let df;function fk(){const t=jr(),e=$a();return{smoothScroll:e.documentElement&&e.documentElement.style&&"scrollBehavior"in e.documentElement.style,touch:!!("ontouchstart"in t||t.DocumentTouch&&e instanceof t.DocumentTouch)}}function XE(){return df||(df=fk()),df}let ff;function hk(t){let{userAgent:e}=t===void 0?{}:t;const r=XE(),n=jr(),i=n.navigator.platform,s=e||n.navigator.userAgent,a={ios:!1,android:!1},o=n.screen.width,l=n.screen.height,u=s.match(/(Android);?[\s\/]+([\d.]+)?/);let c=s.match(/(iPad).*OS\s([\d_]+)/);const d=s.match(/(iPod)(.*OS\s([\d_]+))?/),f=!c&&s.match(/(iPhone\sOS|iOS)\s([\d_]+)/),m=i==="Win32";let h=i==="MacIntel";const p=["1024x1366","1366x1024","834x1194","1194x834","834x1112","1112x834","768x1024","1024x768","820x1180","1180x820","810x1080","1080x810"];return!c&&h&&r.touch&&p.indexOf(`${o}x${l}`)>=0&&(c=s.match(/(Version)\/([\d.]+)/),c||(c=[0,1,"13_0_0"]),h=!1),u&&!m&&(a.os="android",a.android=!0),(c||f||d)&&(a.os="ios",a.ios=!0),a}function ZE(t){return t===void 0&&(t={}),ff||(ff=hk(t)),ff}let hf;function pk(){const t=jr(),e=ZE();let r=!1;function n(){const o=t.navigator.userAgent.toLowerCase();return o.indexOf("safari")>=0&&o.indexOf("chrome")<0&&o.indexOf("android")<0}if(n()){const o=String(t.navigator.userAgent);if(o.includes("Version/")){const[l,u]=o.split("Version/")[1].split(" ")[0].split(".").map(c=>Number(c));r=l<16||l===16&&u<2}}const i=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(t.navigator.userAgent),s=n(),a=s||i&&e.ios;return{isSafari:r||s,needPerspectiveFix:r,need3dFix:a,isWebView:i}}function mk(){return hf||(hf=pk()),hf}function gk(t){let{swiper:e,on:r,emit:n}=t;const i=jr();let s=null,a=null;const o=()=>{!e||e.destroyed||!e.initialized||(n("beforeResize"),n("resize"))},l=()=>{!e||e.destroyed||!e.initialized||(s=new ResizeObserver(d=>{a=i.requestAnimationFrame(()=>{const{width:f,height:m}=e;let h=f,p=m;d.forEach(v=>{let{contentBoxSize:g,contentRect:y,target:x}=v;x&&x!==e.el||(h=y?y.width:(g[0]||g).inlineSize,p=y?y.height:(g[0]||g).blockSize)}),(h!==f||p!==m)&&o()})}),s.observe(e.el))},u=()=>{a&&i.cancelAnimationFrame(a),s&&s.unobserve&&e.el&&(s.unobserve(e.el),s=null)},c=()=>{!e||e.destroyed||!e.initialized||n("orientationchange")};r("init",()=>{if(e.params.resizeObserver&&typeof i.ResizeObserver<"u"){l();return}i.addEventListener("resize",o),i.addEventListener("orientationchange",c)}),r("destroy",()=>{u(),i.removeEventListener("resize",o),i.removeEventListener("orientationchange",c)})}function vk(t){let{swiper:e,extendParams:r,on:n,emit:i}=t;const s=[],a=jr(),o=function(c,d){d===void 0&&(d={});const f=a.MutationObserver||a.WebkitMutationObserver,m=new f(h=>{if(e.__preventObserver__)return;if(h.length===1){i("observerUpdate",h[0]);return}const p=function(){i("observerUpdate",h[0])};a.requestAnimationFrame?a.requestAnimationFrame(p):a.setTimeout(p,0)});m.observe(c,{attributes:typeof d.attributes>"u"?!0:d.attributes,childList:e.isElement||(typeof d.childList>"u"?!0:d).childList,characterData:typeof d.characterData>"u"?!0:d.characterData}),s.push(m)},l=()=>{if(e.params.observer){if(e.params.observeParents){const c=dk(e.hostEl);for(let d=0;d<c.length;d+=1)o(c[d])}o(e.hostEl,{childList:e.params.observeSlideChildren}),o(e.wrapperEl,{attributes:!1})}},u=()=>{s.forEach(c=>{c.disconnect()}),s.splice(0,s.length)};r({observer:!1,observeParents:!1,observeSlideChildren:!1}),n("init",l),n("destroy",u)}var yk={on(t,e,r){const n=this;if(!n.eventsListeners||n.destroyed||typeof e!="function")return n;const i=r?"unshift":"push";return t.split(" ").forEach(s=>{n.eventsListeners[s]||(n.eventsListeners[s]=[]),n.eventsListeners[s][i](e)}),n},once(t,e,r){const n=this;if(!n.eventsListeners||n.destroyed||typeof e!="function")return n;function i(){n.off(t,i),i.__emitterProxy&&delete i.__emitterProxy;for(var s=arguments.length,a=new Array(s),o=0;o<s;o++)a[o]=arguments[o];e.apply(n,a)}return i.__emitterProxy=e,n.on(t,i,r)},onAny(t,e){const r=this;if(!r.eventsListeners||r.destroyed||typeof t!="function")return r;const n=e?"unshift":"push";return r.eventsAnyListeners.indexOf(t)<0&&r.eventsAnyListeners[n](t),r},offAny(t){const e=this;if(!e.eventsListeners||e.destroyed||!e.eventsAnyListeners)return e;const r=e.eventsAnyListeners.indexOf(t);return r>=0&&e.eventsAnyListeners.splice(r,1),e},off(t,e){const r=this;return!r.eventsListeners||r.destroyed||!r.eventsListeners||t.split(" ").forEach(n=>{typeof e>"u"?r.eventsListeners[n]=[]:r.eventsListeners[n]&&r.eventsListeners[n].forEach((i,s)=>{(i===e||i.__emitterProxy&&i.__emitterProxy===e)&&r.eventsListeners[n].splice(s,1)})}),r},emit(){const t=this;if(!t.eventsListeners||t.destroyed||!t.eventsListeners)return t;let e,r,n;for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return typeof s[0]=="string"||Array.isArray(s[0])?(e=s[0],r=s.slice(1,s.length),n=t):(e=s[0].events,r=s[0].data,n=s[0].context||t),r.unshift(n),(Array.isArray(e)?e:e.split(" ")).forEach(l=>{t.eventsAnyListeners&&t.eventsAnyListeners.length&&t.eventsAnyListeners.forEach(u=>{u.apply(n,[l,...r])}),t.eventsListeners&&t.eventsListeners[l]&&t.eventsListeners[l].forEach(u=>{u.apply(n,r)})}),t}};function xk(){const t=this;let e,r;const n=t.el;typeof t.params.width<"u"&&t.params.width!==null?e=t.params.width:e=n.clientWidth,typeof t.params.height<"u"&&t.params.height!==null?r=t.params.height:r=n.clientHeight,!(e===0&&t.isHorizontal()||r===0&&t.isVertical())&&(e=e-parseInt(Ri(n,"padding-left")||0,10)-parseInt(Ri(n,"padding-right")||0,10),r=r-parseInt(Ri(n,"padding-top")||0,10)-parseInt(Ri(n,"padding-bottom")||0,10),Number.isNaN(e)&&(e=0),Number.isNaN(r)&&(r=0),Object.assign(t,{width:e,height:r,size:t.isHorizontal()?e:r}))}function Sk(){const t=this;function e(A,k){return parseFloat(A.getPropertyValue(t.getDirectionLabel(k))||0)}const r=t.params,{wrapperEl:n,slidesEl:i,size:s,rtlTranslate:a,wrongRTL:o}=t,l=t.virtual&&r.virtual.enabled,u=l?t.virtual.slides.length:t.slides.length,c=In(i,`.${t.params.slideClass}, swiper-slide`),d=l?t.virtual.slides.length:c.length;let f=[];const m=[],h=[];let p=r.slidesOffsetBefore;typeof p=="function"&&(p=r.slidesOffsetBefore.call(t));let v=r.slidesOffsetAfter;typeof v=="function"&&(v=r.slidesOffsetAfter.call(t));const g=t.snapGrid.length,y=t.slidesGrid.length;let x=r.spaceBetween,S=-p,T=0,C=0;if(typeof s>"u")return;typeof x=="string"&&x.indexOf("%")>=0?x=parseFloat(x.replace("%",""))/100*s:typeof x=="string"&&(x=parseFloat(x)),t.virtualSize=-x,c.forEach(A=>{a?A.style.marginLeft="":A.style.marginRight="",A.style.marginBottom="",A.style.marginTop=""}),r.centeredSlides&&r.cssMode&&(eu(n,"--swiper-centered-offset-before",""),eu(n,"--swiper-centered-offset-after",""));const _=r.grid&&r.grid.rows>1&&t.grid;_?t.grid.initSlides(c):t.grid&&t.grid.unsetSlides();let b;const I=r.slidesPerView==="auto"&&r.breakpoints&&Object.keys(r.breakpoints).filter(A=>typeof r.breakpoints[A].slidesPerView<"u").length>0;for(let A=0;A<d;A+=1){b=0;let k;if(c[A]&&(k=c[A]),_&&t.grid.updateSlide(A,k,c),!(c[A]&&Ri(k,"display")==="none")){if(r.slidesPerView==="auto"){I&&(c[A].style[t.getDirectionLabel("width")]="");const O=getComputedStyle(k),P=k.style.transform,G=k.style.webkitTransform;if(P&&(k.style.transform="none"),G&&(k.style.webkitTransform="none"),r.roundLengths)b=t.isHorizontal()?tv(k,"width"):tv(k,"height");else{const K=e(O,"width"),H=e(O,"padding-left"),se=e(O,"padding-right"),W=e(O,"margin-left"),F=e(O,"margin-right"),j=O.getPropertyValue("box-sizing");if(j&&j==="border-box")b=K+W+F;else{const{clientWidth:te,offsetWidth:ee}=k;b=K+H+se+W+F+(ee-te)}}P&&(k.style.transform=P),G&&(k.style.webkitTransform=G),r.roundLengths&&(b=Math.floor(b))}else b=(s-(r.slidesPerView-1)*x)/r.slidesPerView,r.roundLengths&&(b=Math.floor(b)),c[A]&&(c[A].style[t.getDirectionLabel("width")]=`${b}px`);c[A]&&(c[A].swiperSlideSize=b),h.push(b),r.centeredSlides?(S=S+b/2+T/2+x,T===0&&A!==0&&(S=S-s/2-x),A===0&&(S=S-s/2-x),Math.abs(S)<1/1e3&&(S=0),r.roundLengths&&(S=Math.floor(S)),C%r.slidesPerGroup===0&&f.push(S),m.push(S)):(r.roundLengths&&(S=Math.floor(S)),(C-Math.min(t.params.slidesPerGroupSkip,C))%t.params.slidesPerGroup===0&&f.push(S),m.push(S),S=S+b+x),t.virtualSize+=b+x,T=b,C+=1}}if(t.virtualSize=Math.max(t.virtualSize,s)+v,a&&o&&(r.effect==="slide"||r.effect==="coverflow")&&(n.style.width=`${t.virtualSize+x}px`),r.setWrapperSize&&(n.style[t.getDirectionLabel("width")]=`${t.virtualSize+x}px`),_&&t.grid.updateWrapperSize(b,f),!r.centeredSlides){const A=[];for(let k=0;k<f.length;k+=1){let O=f[k];r.roundLengths&&(O=Math.floor(O)),f[k]<=t.virtualSize-s&&A.push(O)}f=A,Math.floor(t.virtualSize-s)-Math.floor(f[f.length-1])>1&&f.push(t.virtualSize-s)}if(l&&r.loop){const A=h[0]+x;if(r.slidesPerGroup>1){const k=Math.ceil((t.virtual.slidesBefore+t.virtual.slidesAfter)/r.slidesPerGroup),O=A*r.slidesPerGroup;for(let P=0;P<k;P+=1)f.push(f[f.length-1]+O)}for(let k=0;k<t.virtual.slidesBefore+t.virtual.slidesAfter;k+=1)r.slidesPerGroup===1&&f.push(f[f.length-1]+A),m.push(m[m.length-1]+A),t.virtualSize+=A}if(f.length===0&&(f=[0]),x!==0){const A=t.isHorizontal()&&a?"marginLeft":t.getDirectionLabel("marginRight");c.filter((k,O)=>!r.cssMode||r.loop?!0:O!==c.length-1).forEach(k=>{k.style[A]=`${x}px`})}if(r.centeredSlides&&r.centeredSlidesBounds){let A=0;h.forEach(O=>{A+=O+(x||0)}),A-=x;const k=A-s;f=f.map(O=>O<=0?-p:O>k?k+v:O)}if(r.centerInsufficientSlides){let A=0;h.forEach(O=>{A+=O+(x||0)}),A-=x;const k=(r.slidesOffsetBefore||0)+(r.slidesOffsetAfter||0);if(A+k<s){const O=(s-A-k)/2;f.forEach((P,G)=>{f[G]=P-O}),m.forEach((P,G)=>{m[G]=P+O})}}if(Object.assign(t,{slides:c,snapGrid:f,slidesGrid:m,slidesSizesGrid:h}),r.centeredSlides&&r.cssMode&&!r.centeredSlidesBounds){eu(n,"--swiper-centered-offset-before",`${-f[0]}px`),eu(n,"--swiper-centered-offset-after",`${t.size/2-h[h.length-1]/2}px`);const A=-t.snapGrid[0],k=-t.slidesGrid[0];t.snapGrid=t.snapGrid.map(O=>O+A),t.slidesGrid=t.slidesGrid.map(O=>O+k)}if(d!==u&&t.emit("slidesLengthChange"),f.length!==g&&(t.params.watchOverflow&&t.checkOverflow(),t.emit("snapGridLengthChange")),m.length!==y&&t.emit("slidesGridLengthChange"),r.watchSlidesProgress&&t.updateSlidesOffset(),t.emit("slidesUpdated"),!l&&!r.cssMode&&(r.effect==="slide"||r.effect==="fade")){const A=`${r.containerModifierClass}backface-hidden`,k=t.el.classList.contains(A);d<=r.maxBackfaceHiddenSlides?k||t.el.classList.add(A):k&&t.el.classList.remove(A)}}function Ek(t){const e=this,r=[],n=e.virtual&&e.params.virtual.enabled;let i=0,s;typeof t=="number"?e.setTransition(t):t===!0&&e.setTransition(e.params.speed);const a=o=>n?e.slides[e.getSlideIndexByData(o)]:e.slides[o];if(e.params.slidesPerView!=="auto"&&e.params.slidesPerView>1)if(e.params.centeredSlides)(e.visibleSlides||[]).forEach(o=>{r.push(o)});else for(s=0;s<Math.ceil(e.params.slidesPerView);s+=1){const o=e.activeIndex+s;if(o>e.slides.length&&!n)break;r.push(a(o))}else r.push(a(e.activeIndex));for(s=0;s<r.length;s+=1)if(typeof r[s]<"u"){const o=r[s].offsetHeight;i=o>i?o:i}(i||i===0)&&(e.wrapperEl.style.height=`${i}px`)}function Tk(){const t=this,e=t.slides,r=t.isElement?t.isHorizontal()?t.wrapperEl.offsetLeft:t.wrapperEl.offsetTop:0;for(let n=0;n<e.length;n+=1)e[n].swiperSlideOffset=(t.isHorizontal()?e[n].offsetLeft:e[n].offsetTop)-r-t.cssOverflowAdjustment()}const rv=(t,e,r)=>{e&&!t.classList.contains(r)?t.classList.add(r):!e&&t.classList.contains(r)&&t.classList.remove(r)};function wk(t){t===void 0&&(t=this&&this.translate||0);const e=this,r=e.params,{slides:n,rtlTranslate:i,snapGrid:s}=e;if(n.length===0)return;typeof n[0].swiperSlideOffset>"u"&&e.updateSlidesOffset();let a=-t;i&&(a=t),e.visibleSlidesIndexes=[],e.visibleSlides=[];let o=r.spaceBetween;typeof o=="string"&&o.indexOf("%")>=0?o=parseFloat(o.replace("%",""))/100*e.size:typeof o=="string"&&(o=parseFloat(o));for(let l=0;l<n.length;l+=1){const u=n[l];let c=u.swiperSlideOffset;r.cssMode&&r.centeredSlides&&(c-=n[0].swiperSlideOffset);const d=(a+(r.centeredSlides?e.minTranslate():0)-c)/(u.swiperSlideSize+o),f=(a-s[0]+(r.centeredSlides?e.minTranslate():0)-c)/(u.swiperSlideSize+o),m=-(a-c),h=m+e.slidesSizesGrid[l],p=m>=0&&m<=e.size-e.slidesSizesGrid[l],v=m>=0&&m<e.size-1||h>1&&h<=e.size||m<=0&&h>=e.size;v&&(e.visibleSlides.push(u),e.visibleSlidesIndexes.push(l)),rv(u,v,r.slideVisibleClass),rv(u,p,r.slideFullyVisibleClass),u.progress=i?-d:d,u.originalProgress=i?-f:f}}function bk(t){const e=this;if(typeof t>"u"){const c=e.rtlTranslate?-1:1;t=e&&e.translate&&e.translate*c||0}const r=e.params,n=e.maxTranslate()-e.minTranslate();let{progress:i,isBeginning:s,isEnd:a,progressLoop:o}=e;const l=s,u=a;if(n===0)i=0,s=!0,a=!0;else{i=(t-e.minTranslate())/n;const c=Math.abs(t-e.minTranslate())<1,d=Math.abs(t-e.maxTranslate())<1;s=c||i<=0,a=d||i>=1,c&&(i=0),d&&(i=1)}if(r.loop){const c=e.getSlideIndexByData(0),d=e.getSlideIndexByData(e.slides.length-1),f=e.slidesGrid[c],m=e.slidesGrid[d],h=e.slidesGrid[e.slidesGrid.length-1],p=Math.abs(t);p>=f?o=(p-f)/h:o=(p+h-m)/h,o>1&&(o-=1)}Object.assign(e,{progress:i,progressLoop:o,isBeginning:s,isEnd:a}),(r.watchSlidesProgress||r.centeredSlides&&r.autoHeight)&&e.updateSlidesProgress(t),s&&!l&&e.emit("reachBeginning toEdge"),a&&!u&&e.emit("reachEnd toEdge"),(l&&!s||u&&!a)&&e.emit("fromEdge"),e.emit("progress",i)}const pf=(t,e,r)=>{e&&!t.classList.contains(r)?t.classList.add(r):!e&&t.classList.contains(r)&&t.classList.remove(r)};function Lk(){const t=this,{slides:e,params:r,slidesEl:n,activeIndex:i}=t,s=t.virtual&&r.virtual.enabled,a=t.grid&&r.grid&&r.grid.rows>1,o=d=>In(n,`.${r.slideClass}${d}, swiper-slide${d}`)[0];let l,u,c;if(s)if(r.loop){let d=i-t.virtual.slidesBefore;d<0&&(d=t.virtual.slides.length+d),d>=t.virtual.slides.length&&(d-=t.virtual.slides.length),l=o(`[data-swiper-slide-index="${d}"]`)}else l=o(`[data-swiper-slide-index="${i}"]`);else a?(l=e.filter(d=>d.column===i)[0],c=e.filter(d=>d.column===i+1)[0],u=e.filter(d=>d.column===i-1)[0]):l=e[i];l&&(a||(c=ck(l,`.${r.slideClass}, swiper-slide`)[0],r.loop&&!c&&(c=e[0]),u=uk(l,`.${r.slideClass}, swiper-slide`)[0],r.loop&&!u===0&&(u=e[e.length-1]))),e.forEach(d=>{pf(d,d===l,r.slideActiveClass),pf(d,d===c,r.slideNextClass),pf(d,d===u,r.slidePrevClass)}),t.emitSlidesClasses()}const Du=(t,e)=>{if(!t||t.destroyed||!t.params)return;const r=()=>t.isElement?"swiper-slide":`.${t.params.slideClass}`,n=e.closest(r());if(n){let i=n.querySelector(`.${t.params.lazyPreloaderClass}`);!i&&t.isElement&&(n.shadowRoot?i=n.shadowRoot.querySelector(`.${t.params.lazyPreloaderClass}`):requestAnimationFrame(()=>{n.shadowRoot&&(i=n.shadowRoot.querySelector(`.${t.params.lazyPreloaderClass}`),i&&i.remove())})),i&&i.remove()}},mf=(t,e)=>{if(!t.slides[e])return;const r=t.slides[e].querySelector('[loading="lazy"]');r&&r.removeAttribute("loading")},zh=t=>{if(!t||t.destroyed||!t.params)return;let e=t.params.lazyPreloadPrevNext;const r=t.slides.length;if(!r||!e||e<0)return;e=Math.min(e,r);const n=t.params.slidesPerView==="auto"?t.slidesPerViewDynamic():Math.ceil(t.params.slidesPerView),i=t.activeIndex;if(t.params.grid&&t.params.grid.rows>1){const a=i,o=[a-e];o.push(...Array.from({length:e}).map((l,u)=>a+n+u)),t.slides.forEach((l,u)=>{o.includes(l.column)&&mf(t,u)});return}const s=i+n-1;if(t.params.rewind||t.params.loop)for(let a=i-e;a<=s+e;a+=1){const o=(a%r+r)%r;(o<i||o>s)&&mf(t,o)}else for(let a=Math.max(i-e,0);a<=Math.min(s+e,r-1);a+=1)a!==i&&(a>s||a<i)&&mf(t,a)};function Ak(t){const{slidesGrid:e,params:r}=t,n=t.rtlTranslate?t.translate:-t.translate;let i;for(let s=0;s<e.length;s+=1)typeof e[s+1]<"u"?n>=e[s]&&n<e[s+1]-(e[s+1]-e[s])/2?i=s:n>=e[s]&&n<e[s+1]&&(i=s+1):n>=e[s]&&(i=s);return r.normalizeSlideIndex&&(i<0||typeof i>"u")&&(i=0),i}function _k(t){const e=this,r=e.rtlTranslate?e.translate:-e.translate,{snapGrid:n,params:i,activeIndex:s,realIndex:a,snapIndex:o}=e;let l=t,u;const c=m=>{let h=m-e.virtual.slidesBefore;return h<0&&(h=e.virtual.slides.length+h),h>=e.virtual.slides.length&&(h-=e.virtual.slides.length),h};if(typeof l>"u"&&(l=Ak(e)),n.indexOf(r)>=0)u=n.indexOf(r);else{const m=Math.min(i.slidesPerGroupSkip,l);u=m+Math.floor((l-m)/i.slidesPerGroup)}if(u>=n.length&&(u=n.length-1),l===s&&!e.params.loop){u!==o&&(e.snapIndex=u,e.emit("snapIndexChange"));return}if(l===s&&e.params.loop&&e.virtual&&e.params.virtual.enabled){e.realIndex=c(l);return}const d=e.grid&&i.grid&&i.grid.rows>1;let f;if(e.virtual&&i.virtual.enabled&&i.loop)f=c(l);else if(d){const m=e.slides.filter(p=>p.column===l)[0];let h=parseInt(m.getAttribute("data-swiper-slide-index"),10);Number.isNaN(h)&&(h=Math.max(e.slides.indexOf(m),0)),f=Math.floor(h/i.grid.rows)}else if(e.slides[l]){const m=e.slides[l].getAttribute("data-swiper-slide-index");m?f=parseInt(m,10):f=l}else f=l;Object.assign(e,{previousSnapIndex:o,snapIndex:u,previousRealIndex:a,realIndex:f,previousIndex:s,activeIndex:l}),e.initialized&&zh(e),e.emit("activeIndexChange"),e.emit("snapIndexChange"),(e.initialized||e.params.runCallbacksOnInit)&&(a!==f&&e.emit("realIndexChange"),e.emit("slideChange"))}function Ck(t,e){const r=this,n=r.params;let i=t.closest(`.${n.slideClass}, swiper-slide`);!i&&r.isElement&&e&&e.length>1&&e.includes(t)&&[...e.slice(e.indexOf(t)+1,e.length)].forEach(o=>{!i&&o.matches&&o.matches(`.${n.slideClass}, swiper-slide`)&&(i=o)});let s=!1,a;if(i){for(let o=0;o<r.slides.length;o+=1)if(r.slides[o]===i){s=!0,a=o;break}}if(i&&s)r.clickedSlide=i,r.virtual&&r.params.virtual.enabled?r.clickedIndex=parseInt(i.getAttribute("data-swiper-slide-index"),10):r.clickedIndex=a;else{r.clickedSlide=void 0,r.clickedIndex=void 0;return}n.slideToClickedSlide&&r.clickedIndex!==void 0&&r.clickedIndex!==r.activeIndex&&r.slideToClickedSlide()}var Rk={updateSize:xk,updateSlides:Sk,updateAutoHeight:Ek,updateSlidesOffset:Tk,updateSlidesProgress:wk,updateProgress:bk,updateSlidesClasses:Lk,updateActiveIndex:_k,updateClickedSlide:Ck};function Ik(t){t===void 0&&(t=this.isHorizontal()?"x":"y");const e=this,{params:r,rtlTranslate:n,translate:i,wrapperEl:s}=e;if(r.virtualTranslate)return n?-i:i;if(r.cssMode)return i;let a=ak(s,t);return a+=e.cssOverflowAdjustment(),n&&(a=-a),a||0}function kk(t,e){const r=this,{rtlTranslate:n,params:i,wrapperEl:s,progress:a}=r;let o=0,l=0;const u=0;r.isHorizontal()?o=n?-t:t:l=t,i.roundLengths&&(o=Math.floor(o),l=Math.floor(l)),r.previousTranslate=r.translate,r.translate=r.isHorizontal()?o:l,i.cssMode?s[r.isHorizontal()?"scrollLeft":"scrollTop"]=r.isHorizontal()?-o:-l:i.virtualTranslate||(r.isHorizontal()?o-=r.cssOverflowAdjustment():l-=r.cssOverflowAdjustment(),s.style.transform=`translate3d(${o}px, ${l}px, ${u}px)`);let c;const d=r.maxTranslate()-r.minTranslate();d===0?c=0:c=(t-r.minTranslate())/d,c!==a&&r.updateProgress(t),r.emit("setTranslate",r.translate,e)}function Dk(){return-this.snapGrid[0]}function Pk(){return-this.snapGrid[this.snapGrid.length-1]}function Ok(t,e,r,n,i){t===void 0&&(t=0),e===void 0&&(e=this.params.speed),r===void 0&&(r=!0),n===void 0&&(n=!0);const s=this,{params:a,wrapperEl:o}=s;if(s.animating&&a.preventInteractionOnTransition)return!1;const l=s.minTranslate(),u=s.maxTranslate();let c;if(n&&t>l?c=l:n&&t<u?c=u:c=t,s.updateProgress(c),a.cssMode){const d=s.isHorizontal();if(e===0)o[d?"scrollLeft":"scrollTop"]=-c;else{if(!s.support.smoothScroll)return qE({swiper:s,targetPosition:-c,side:d?"left":"top"}),!0;o.scrollTo({[d?"left":"top"]:-c,behavior:"smooth"})}return!0}return e===0?(s.setTransition(0),s.setTranslate(c),r&&(s.emit("beforeTransitionStart",e,i),s.emit("transitionEnd"))):(s.setTransition(e),s.setTranslate(c),r&&(s.emit("beforeTransitionStart",e,i),s.emit("transitionStart")),s.animating||(s.animating=!0,s.onTranslateToWrapperTransitionEnd||(s.onTranslateToWrapperTransitionEnd=function(f){!s||s.destroyed||f.target===this&&(s.wrapperEl.removeEventListener("transitionend",s.onTranslateToWrapperTransitionEnd),s.onTranslateToWrapperTransitionEnd=null,delete s.onTranslateToWrapperTransitionEnd,s.animating=!1,r&&s.emit("transitionEnd"))}),s.wrapperEl.addEventListener("transitionend",s.onTranslateToWrapperTransitionEnd))),!0}var Mk={getTranslate:Ik,setTranslate:kk,minTranslate:Dk,maxTranslate:Pk,translateTo:Ok};function Nk(t,e){const r=this;r.params.cssMode||(r.wrapperEl.style.transitionDuration=`${t}ms`,r.wrapperEl.style.transitionDelay=t===0?"0ms":""),r.emit("setTransition",t,e)}function QE(t){let{swiper:e,runCallbacks:r,direction:n,step:i}=t;const{activeIndex:s,previousIndex:a}=e;let o=n;if(o||(s>a?o="next":s<a?o="prev":o="reset"),e.emit(`transition${i}`),r&&s!==a){if(o==="reset"){e.emit(`slideResetTransition${i}`);return}e.emit(`slideChangeTransition${i}`),o==="next"?e.emit(`slideNextTransition${i}`):e.emit(`slidePrevTransition${i}`)}}function Fk(t,e){t===void 0&&(t=!0);const r=this,{params:n}=r;n.cssMode||(n.autoHeight&&r.updateAutoHeight(),QE({swiper:r,runCallbacks:t,direction:e,step:"Start"}))}function Uk(t,e){t===void 0&&(t=!0);const r=this,{params:n}=r;r.animating=!1,!n.cssMode&&(r.setTransition(0),QE({swiper:r,runCallbacks:t,direction:e,step:"End"}))}var Bk={setTransition:Nk,transitionStart:Fk,transitionEnd:Uk};function $k(t,e,r,n,i){t===void 0&&(t=0),r===void 0&&(r=!0),typeof t=="string"&&(t=parseInt(t,10));const s=this;let a=t;a<0&&(a=0);const{params:o,snapGrid:l,slidesGrid:u,previousIndex:c,activeIndex:d,rtlTranslate:f,wrapperEl:m,enabled:h}=s;if(!h&&!n&&!i||s.destroyed||s.animating&&o.preventInteractionOnTransition)return!1;typeof e>"u"&&(e=s.params.speed);const p=Math.min(s.params.slidesPerGroupSkip,a);let v=p+Math.floor((a-p)/s.params.slidesPerGroup);v>=l.length&&(v=l.length-1);const g=-l[v];if(o.normalizeSlideIndex)for(let x=0;x<u.length;x+=1){const S=-Math.floor(g*100),T=Math.floor(u[x]*100),C=Math.floor(u[x+1]*100);typeof u[x+1]<"u"?S>=T&&S<C-(C-T)/2?a=x:S>=T&&S<C&&(a=x+1):S>=T&&(a=x)}if(s.initialized&&a!==d&&(!s.allowSlideNext&&(f?g>s.translate&&g>s.minTranslate():g<s.translate&&g<s.minTranslate())||!s.allowSlidePrev&&g>s.translate&&g>s.maxTranslate()&&(d||0)!==a))return!1;a!==(c||0)&&r&&s.emit("beforeSlideChangeStart"),s.updateProgress(g);let y;if(a>d?y="next":a<d?y="prev":y="reset",f&&-g===s.translate||!f&&g===s.translate)return s.updateActiveIndex(a),o.autoHeight&&s.updateAutoHeight(),s.updateSlidesClasses(),o.effect!=="slide"&&s.setTranslate(g),y!=="reset"&&(s.transitionStart(r,y),s.transitionEnd(r,y)),!1;if(o.cssMode){const x=s.isHorizontal(),S=f?g:-g;if(e===0){const T=s.virtual&&s.params.virtual.enabled;T&&(s.wrapperEl.style.scrollSnapType="none",s._immediateVirtual=!0),T&&!s._cssModeVirtualInitialSet&&s.params.initialSlide>0?(s._cssModeVirtualInitialSet=!0,requestAnimationFrame(()=>{m[x?"scrollLeft":"scrollTop"]=S})):m[x?"scrollLeft":"scrollTop"]=S,T&&requestAnimationFrame(()=>{s.wrapperEl.style.scrollSnapType="",s._immediateVirtual=!1})}else{if(!s.support.smoothScroll)return qE({swiper:s,targetPosition:S,side:x?"left":"top"}),!0;m.scrollTo({[x?"left":"top"]:S,behavior:"smooth"})}return!0}return s.setTransition(e),s.setTranslate(g),s.updateActiveIndex(a),s.updateSlidesClasses(),s.emit("beforeTransitionStart",e,n),s.transitionStart(r,y),e===0?s.transitionEnd(r,y):s.animating||(s.animating=!0,s.onSlideToWrapperTransitionEnd||(s.onSlideToWrapperTransitionEnd=function(S){!s||s.destroyed||S.target===this&&(s.wrapperEl.removeEventListener("transitionend",s.onSlideToWrapperTransitionEnd),s.onSlideToWrapperTransitionEnd=null,delete s.onSlideToWrapperTransitionEnd,s.transitionEnd(r,y))}),s.wrapperEl.addEventListener("transitionend",s.onSlideToWrapperTransitionEnd)),!0}function jk(t,e,r,n){t===void 0&&(t=0),r===void 0&&(r=!0),typeof t=="string"&&(t=parseInt(t,10));const i=this;if(i.destroyed)return;typeof e>"u"&&(e=i.params.speed);const s=i.grid&&i.params.grid&&i.params.grid.rows>1;let a=t;if(i.params.loop)if(i.virtual&&i.params.virtual.enabled)a=a+i.virtual.slidesBefore;else{let o;if(s){const f=a*i.params.grid.rows;o=i.slides.filter(m=>m.getAttribute("data-swiper-slide-index")*1===f)[0].column}else o=i.getSlideIndexByData(a);const l=s?Math.ceil(i.slides.length/i.params.grid.rows):i.slides.length,{centeredSlides:u}=i.params;let c=i.params.slidesPerView;c==="auto"?c=i.slidesPerViewDynamic():(c=Math.ceil(parseFloat(i.params.slidesPerView,10)),u&&c%2===0&&(c=c+1));let d=l-o<c;if(u&&(d=d||o<Math.ceil(c/2)),n&&u&&i.params.slidesPerView!=="auto"&&!s&&(d=!1),d){const f=u?o<i.activeIndex?"prev":"next":o-i.activeIndex-1<i.params.slidesPerView?"next":"prev";i.loopFix({direction:f,slideTo:!0,activeSlideIndex:f==="next"?o+1:o-l+1,slideRealIndex:f==="next"?i.realIndex:void 0})}if(s){const f=a*i.params.grid.rows;a=i.slides.filter(m=>m.getAttribute("data-swiper-slide-index")*1===f)[0].column}else a=i.getSlideIndexByData(a)}return requestAnimationFrame(()=>{i.slideTo(a,e,r,n)}),i}function Vk(t,e,r){e===void 0&&(e=!0);const n=this,{enabled:i,params:s,animating:a}=n;if(!i||n.destroyed)return n;typeof t>"u"&&(t=n.params.speed);let o=s.slidesPerGroup;s.slidesPerView==="auto"&&s.slidesPerGroup===1&&s.slidesPerGroupAuto&&(o=Math.max(n.slidesPerViewDynamic("current",!0),1));const l=n.activeIndex<s.slidesPerGroupSkip?1:o,u=n.virtual&&s.virtual.enabled;if(s.loop){if(a&&!u&&s.loopPreventsSliding)return!1;if(n.loopFix({direction:"next"}),n._clientLeft=n.wrapperEl.clientLeft,n.activeIndex===n.slides.length-1&&s.cssMode)return requestAnimationFrame(()=>{n.slideTo(n.activeIndex+l,t,e,r)}),!0}return s.rewind&&n.isEnd?n.slideTo(0,t,e,r):n.slideTo(n.activeIndex+l,t,e,r)}function Gk(t,e,r){e===void 0&&(e=!0);const n=this,{params:i,snapGrid:s,slidesGrid:a,rtlTranslate:o,enabled:l,animating:u}=n;if(!l||n.destroyed)return n;typeof t>"u"&&(t=n.params.speed);const c=n.virtual&&i.virtual.enabled;if(i.loop){if(u&&!c&&i.loopPreventsSliding)return!1;n.loopFix({direction:"prev"}),n._clientLeft=n.wrapperEl.clientLeft}const d=o?n.translate:-n.translate;function f(g){return g<0?-Math.floor(Math.abs(g)):Math.floor(g)}const m=f(d),h=s.map(g=>f(g));let p=s[h.indexOf(m)-1];if(typeof p>"u"&&i.cssMode){let g;s.forEach((y,x)=>{m>=y&&(g=x)}),typeof g<"u"&&(p=s[g>0?g-1:g])}let v=0;if(typeof p<"u"&&(v=a.indexOf(p),v<0&&(v=n.activeIndex-1),i.slidesPerView==="auto"&&i.slidesPerGroup===1&&i.slidesPerGroupAuto&&(v=v-n.slidesPerViewDynamic("previous",!0)+1,v=Math.max(v,0))),i.rewind&&n.isBeginning){const g=n.params.virtual&&n.params.virtual.enabled&&n.virtual?n.virtual.slides.length-1:n.slides.length-1;return n.slideTo(g,t,e,r)}else if(i.loop&&n.activeIndex===0&&i.cssMode)return requestAnimationFrame(()=>{n.slideTo(v,t,e,r)}),!0;return n.slideTo(v,t,e,r)}function zk(t,e,r){e===void 0&&(e=!0);const n=this;if(!n.destroyed)return typeof t>"u"&&(t=n.params.speed),n.slideTo(n.activeIndex,t,e,r)}function Hk(t,e,r,n){e===void 0&&(e=!0),n===void 0&&(n=.5);const i=this;if(i.destroyed)return;typeof t>"u"&&(t=i.params.speed);let s=i.activeIndex;const a=Math.min(i.params.slidesPerGroupSkip,s),o=a+Math.floor((s-a)/i.params.slidesPerGroup),l=i.rtlTranslate?i.translate:-i.translate;if(l>=i.snapGrid[o]){const u=i.snapGrid[o],c=i.snapGrid[o+1];l-u>(c-u)*n&&(s+=i.params.slidesPerGroup)}else{const u=i.snapGrid[o-1],c=i.snapGrid[o];l-u<=(c-u)*n&&(s-=i.params.slidesPerGroup)}return s=Math.max(s,0),s=Math.min(s,i.slidesGrid.length-1),i.slideTo(s,t,e,r)}function Wk(){const t=this;if(t.destroyed)return;const{params:e,slidesEl:r}=t,n=e.slidesPerView==="auto"?t.slidesPerViewDynamic():e.slidesPerView;let i=t.clickedIndex,s;const a=t.isElement?"swiper-slide":`.${e.slideClass}`;if(e.loop){if(t.animating)return;s=parseInt(t.clickedSlide.getAttribute("data-swiper-slide-index"),10),e.centeredSlides?i<t.loopedSlides-n/2||i>t.slides.length-t.loopedSlides+n/2?(t.loopFix(),i=t.getSlideIndex(In(r,`${a}[data-swiper-slide-index="${s}"]`)[0]),Gh(()=>{t.slideTo(i)})):t.slideTo(i):i>t.slides.length-n?(t.loopFix(),i=t.getSlideIndex(In(r,`${a}[data-swiper-slide-index="${s}"]`)[0]),Gh(()=>{t.slideTo(i)})):t.slideTo(i)}else t.slideTo(i)}var Kk={slideTo:$k,slideToLoop:jk,slideNext:Vk,slidePrev:Gk,slideReset:zk,slideToClosest:Hk,slideToClickedSlide:Wk};function Yk(t){const e=this,{params:r,slidesEl:n}=e;if(!r.loop||e.virtual&&e.params.virtual.enabled)return;const i=()=>{In(n,`.${r.slideClass}, swiper-slide`).forEach((d,f)=>{d.setAttribute("data-swiper-slide-index",f)})},s=e.grid&&r.grid&&r.grid.rows>1,a=r.slidesPerGroup*(s?r.grid.rows:1),o=e.slides.length%a!==0,l=s&&e.slides.length%r.grid.rows!==0,u=c=>{for(let d=0;d<c;d+=1){const f=e.isElement?Pc("swiper-slide",[r.slideBlankClass]):Pc("div",[r.slideClass,r.slideBlankClass]);e.slidesEl.append(f)}};if(o){if(r.loopAddBlankSlides){const c=a-e.slides.length%a;u(c),e.recalcSlides(),e.updateSlides()}else Dc("Swiper Loop Warning: The number of slides is not even to slidesPerGroup, loop mode may not function properly. You need to add more slides (or make duplicates, or empty slides)");i()}else if(l){if(r.loopAddBlankSlides){const c=r.grid.rows-e.slides.length%r.grid.rows;u(c),e.recalcSlides(),e.updateSlides()}else Dc("Swiper Loop Warning: The number of slides is not even to grid.rows, loop mode may not function properly. You need to add more slides (or make duplicates, or empty slides)");i()}else i();e.loopFix({slideRealIndex:t,direction:r.centeredSlides?void 0:"next"})}function qk(t){let{slideRealIndex:e,slideTo:r=!0,direction:n,setTranslate:i,activeSlideIndex:s,byController:a,byMousewheel:o}=t===void 0?{}:t;const l=this;if(!l.params.loop)return;l.emit("beforeLoopFix");const{slides:u,allowSlidePrev:c,allowSlideNext:d,slidesEl:f,params:m}=l,{centeredSlides:h}=m;if(l.allowSlidePrev=!0,l.allowSlideNext=!0,l.virtual&&m.virtual.enabled){r&&(!m.centeredSlides&&l.snapIndex===0?l.slideTo(l.virtual.slides.length,0,!1,!0):m.centeredSlides&&l.snapIndex<m.slidesPerView?l.slideTo(l.virtual.slides.length+l.snapIndex,0,!1,!0):l.snapIndex===l.snapGrid.length-1&&l.slideTo(l.virtual.slidesBefore,0,!1,!0)),l.allowSlidePrev=c,l.allowSlideNext=d,l.emit("loopFix");return}let p=m.slidesPerView;p==="auto"?p=l.slidesPerViewDynamic():(p=Math.ceil(parseFloat(m.slidesPerView,10)),h&&p%2===0&&(p=p+1));const v=m.slidesPerGroupAuto?p:m.slidesPerGroup;let g=v;g%v!==0&&(g+=v-g%v),g+=m.loopAdditionalSlides,l.loopedSlides=g;const y=l.grid&&m.grid&&m.grid.rows>1;u.length<p+g?Dc("Swiper Loop Warning: The number of slides is not enough for loop mode, it will be disabled and not function properly. You need to add more slides (or make duplicates) or lower the values of slidesPerView and slidesPerGroup parameters"):y&&m.grid.fill==="row"&&Dc("Swiper Loop Warning: Loop mode is not compatible with grid.fill = `row`");const x=[],S=[];let T=l.activeIndex;typeof s>"u"?s=l.getSlideIndex(u.filter(P=>P.classList.contains(m.slideActiveClass))[0]):T=s;const C=n==="next"||!n,_=n==="prev"||!n;let b=0,I=0;const A=y?Math.ceil(u.length/m.grid.rows):u.length,O=(y?u[s].column:s)+(h&&typeof i>"u"?-p/2+.5:0);if(O<g){b=Math.max(g-O,v);for(let P=0;P<g-O;P+=1){const G=P-Math.floor(P/A)*A;if(y){const K=A-G-1;for(let H=u.length-1;H>=0;H-=1)u[H].column===K&&x.push(H)}else x.push(A-G-1)}}else if(O+p>A-g){I=Math.max(O-(A-g*2),v);for(let P=0;P<I;P+=1){const G=P-Math.floor(P/A)*A;y?u.forEach((K,H)=>{K.column===G&&S.push(H)}):S.push(G)}}if(l.__preventObserver__=!0,requestAnimationFrame(()=>{l.__preventObserver__=!1}),_&&x.forEach(P=>{u[P].swiperLoopMoveDOM=!0,f.prepend(u[P]),u[P].swiperLoopMoveDOM=!1}),C&&S.forEach(P=>{u[P].swiperLoopMoveDOM=!0,f.append(u[P]),u[P].swiperLoopMoveDOM=!1}),l.recalcSlides(),m.slidesPerView==="auto"?l.updateSlides():y&&(x.length>0&&_||S.length>0&&C)&&l.slides.forEach((P,G)=>{l.grid.updateSlide(G,P,l.slides)}),m.watchSlidesProgress&&l.updateSlidesOffset(),r){if(x.length>0&&_){if(typeof e>"u"){const P=l.slidesGrid[T],K=l.slidesGrid[T+b]-P;o?l.setTranslate(l.translate-K):(l.slideTo(T+Math.ceil(b),0,!1,!0),i&&(l.touchEventsData.startTranslate=l.touchEventsData.startTranslate-K,l.touchEventsData.currentTranslate=l.touchEventsData.currentTranslate-K))}else if(i){const P=y?x.length/m.grid.rows:x.length;l.slideTo(l.activeIndex+P,0,!1,!0),l.touchEventsData.currentTranslate=l.translate}}else if(S.length>0&&C)if(typeof e>"u"){const P=l.slidesGrid[T],K=l.slidesGrid[T-I]-P;o?l.setTranslate(l.translate-K):(l.slideTo(T-I,0,!1,!0),i&&(l.touchEventsData.startTranslate=l.touchEventsData.startTranslate-K,l.touchEventsData.currentTranslate=l.touchEventsData.currentTranslate-K))}else{const P=y?S.length/m.grid.rows:S.length;l.slideTo(l.activeIndex-P,0,!1,!0)}}if(l.allowSlidePrev=c,l.allowSlideNext=d,l.controller&&l.controller.control&&!a){const P={slideRealIndex:e,direction:n,setTranslate:i,activeSlideIndex:s,byController:!0};Array.isArray(l.controller.control)?l.controller.control.forEach(G=>{!G.destroyed&&G.params.loop&&G.loopFix({...P,slideTo:G.params.slidesPerView===m.slidesPerView?r:!1})}):l.controller.control instanceof l.constructor&&l.controller.control.params.loop&&l.controller.control.loopFix({...P,slideTo:l.controller.control.params.slidesPerView===m.slidesPerView?r:!1})}l.emit("loopFix")}function Xk(){const t=this,{params:e,slidesEl:r}=t;if(!e.loop||t.virtual&&t.params.virtual.enabled)return;t.recalcSlides();const n=[];t.slides.forEach(i=>{const s=typeof i.swiperSlideIndex>"u"?i.getAttribute("data-swiper-slide-index")*1:i.swiperSlideIndex;n[s]=i}),t.slides.forEach(i=>{i.removeAttribute("data-swiper-slide-index")}),n.forEach(i=>{r.append(i)}),t.recalcSlides(),t.slideTo(t.realIndex,0)}var Zk={loopCreate:Yk,loopFix:qk,loopDestroy:Xk};function Qk(t){const e=this;if(!e.params.simulateTouch||e.params.watchOverflow&&e.isLocked||e.params.cssMode)return;const r=e.params.touchEventsTarget==="container"?e.el:e.wrapperEl;e.isElement&&(e.__preventObserver__=!0),r.style.cursor="move",r.style.cursor=t?"grabbing":"grab",e.isElement&&requestAnimationFrame(()=>{e.__preventObserver__=!1})}function Jk(){const t=this;t.params.watchOverflow&&t.isLocked||t.params.cssMode||(t.isElement&&(t.__preventObserver__=!0),t[t.params.touchEventsTarget==="container"?"el":"wrapperEl"].style.cursor="",t.isElement&&requestAnimationFrame(()=>{t.__preventObserver__=!1}))}var eD={setGrabCursor:Qk,unsetGrabCursor:Jk};function tD(t,e){e===void 0&&(e=this);function r(n){if(!n||n===$a()||n===jr())return null;n.assignedSlot&&(n=n.assignedSlot);const i=n.closest(t);return!i&&!n.getRootNode?null:i||r(n.getRootNode().host)}return r(e)}function nv(t,e,r){const n=jr(),{params:i}=t,s=i.edgeSwipeDetection,a=i.edgeSwipeThreshold;return s&&(r<=a||r>=n.innerWidth-a)?s==="prevent"?(e.preventDefault(),!0):!1:!0}function rD(t){const e=this,r=$a();let n=t;n.originalEvent&&(n=n.originalEvent);const i=e.touchEventsData;if(n.type==="pointerdown"){if(i.pointerId!==null&&i.pointerId!==n.pointerId)return;i.pointerId=n.pointerId}else n.type==="touchstart"&&n.targetTouches.length===1&&(i.touchId=n.targetTouches[0].identifier);if(n.type==="touchstart"){nv(e,n,n.targetTouches[0].pageX);return}const{params:s,touches:a,enabled:o}=e;if(!o||!s.simulateTouch&&n.pointerType==="mouse"||e.animating&&s.preventInteractionOnTransition)return;!e.animating&&s.cssMode&&s.loop&&e.loopFix();let l=n.target;if(s.touchEventsTarget==="wrapper"&&!lk(l,e.wrapperEl)||"which"in n&&n.which===3||"button"in n&&n.button>0||i.isTouched&&i.isMoved)return;const u=!!s.noSwipingClass&&s.noSwipingClass!=="",c=n.composedPath?n.composedPath():n.path;u&&n.target&&n.target.shadowRoot&&c&&(l=c[0]);const d=s.noSwipingSelector?s.noSwipingSelector:`.${s.noSwipingClass}`,f=!!(n.target&&n.target.shadowRoot);if(s.noSwiping&&(f?tD(d,l):l.closest(d))){e.allowClick=!0;return}if(s.swipeHandler&&!l.closest(s.swipeHandler))return;a.currentX=n.pageX,a.currentY=n.pageY;const m=a.currentX,h=a.currentY;if(!nv(e,n,m))return;Object.assign(i,{isTouched:!0,isMoved:!1,allowTouchCallbacks:!0,isScrolling:void 0,startMoving:void 0}),a.startX=m,a.startY=h,i.touchStartTime=kc(),e.allowClick=!0,e.updateSize(),e.swipeDirection=void 0,s.threshold>0&&(i.allowThresholdMove=!1);let p=!0;l.matches(i.focusableElements)&&(p=!1,l.nodeName==="SELECT"&&(i.isTouched=!1)),r.activeElement&&r.activeElement.matches(i.focusableElements)&&r.activeElement!==l&&r.activeElement.blur();const v=p&&e.allowTouchMove&&s.touchStartPreventDefault;(s.touchStartForcePreventDefault||v)&&!l.isContentEditable&&n.preventDefault(),s.freeMode&&s.freeMode.enabled&&e.freeMode&&e.animating&&!s.cssMode&&e.freeMode.onTouchStart(),e.emit("touchStart",n)}function nD(t){const e=$a(),r=this,n=r.touchEventsData,{params:i,touches:s,rtlTranslate:a,enabled:o}=r;if(!o||!i.simulateTouch&&t.pointerType==="mouse")return;let l=t;if(l.originalEvent&&(l=l.originalEvent),l.type==="pointermove"&&(n.touchId!==null||l.pointerId!==n.pointerId))return;let u;if(l.type==="touchmove"){if(u=[...l.changedTouches].filter(C=>C.identifier===n.touchId)[0],!u||u.identifier!==n.touchId)return}else u=l;if(!n.isTouched){n.startMoving&&n.isScrolling&&r.emit("touchMoveOpposite",l);return}const c=u.pageX,d=u.pageY;if(l.preventedByNestedSwiper){s.startX=c,s.startY=d;return}if(!r.allowTouchMove){l.target.matches(n.focusableElements)||(r.allowClick=!1),n.isTouched&&(Object.assign(s,{startX:c,startY:d,currentX:c,currentY:d}),n.touchStartTime=kc());return}if(i.touchReleaseOnEdges&&!i.loop){if(r.isVertical()){if(d<s.startY&&r.translate<=r.maxTranslate()||d>s.startY&&r.translate>=r.minTranslate()){n.isTouched=!1,n.isMoved=!1;return}}else if(c<s.startX&&r.translate<=r.maxTranslate()||c>s.startX&&r.translate>=r.minTranslate())return}if(e.activeElement&&l.target===e.activeElement&&l.target.matches(n.focusableElements)){n.isMoved=!0,r.allowClick=!1;return}n.allowTouchCallbacks&&r.emit("touchMove",l),s.previousX=s.currentX,s.previousY=s.currentY,s.currentX=c,s.currentY=d;const f=s.currentX-s.startX,m=s.currentY-s.startY;if(r.params.threshold&&Math.sqrt(f**2+m**2)<r.params.threshold)return;if(typeof n.isScrolling>"u"){let C;r.isHorizontal()&&s.currentY===s.startY||r.isVertical()&&s.currentX===s.startX?n.isScrolling=!1:f*f+m*m>=25&&(C=Math.atan2(Math.abs(m),Math.abs(f))*180/Math.PI,n.isScrolling=r.isHorizontal()?C>i.touchAngle:90-C>i.touchAngle)}if(n.isScrolling&&r.emit("touchMoveOpposite",l),typeof n.startMoving>"u"&&(s.currentX!==s.startX||s.currentY!==s.startY)&&(n.startMoving=!0),n.isScrolling||l.type==="touchmove"&&n.preventTouchMoveFromPointerMove){n.isTouched=!1;return}if(!n.startMoving)return;r.allowClick=!1,!i.cssMode&&l.cancelable&&l.preventDefault(),i.touchMoveStopPropagation&&!i.nested&&l.stopPropagation();let h=r.isHorizontal()?f:m,p=r.isHorizontal()?s.currentX-s.previousX:s.currentY-s.previousY;i.oneWayMovement&&(h=Math.abs(h)*(a?1:-1),p=Math.abs(p)*(a?1:-1)),s.diff=h,h*=i.touchRatio,a&&(h=-h,p=-p);const v=r.touchesDirection;r.swipeDirection=h>0?"prev":"next",r.touchesDirection=p>0?"prev":"next";const g=r.params.loop&&!i.cssMode,y=r.touchesDirection==="next"&&r.allowSlideNext||r.touchesDirection==="prev"&&r.allowSlidePrev;if(!n.isMoved){if(g&&y&&r.loopFix({direction:r.swipeDirection}),n.startTranslate=r.getTranslate(),r.setTransition(0),r.animating){const C=new window.CustomEvent("transitionend",{bubbles:!0,cancelable:!0,detail:{bySwiperTouchMove:!0}});r.wrapperEl.dispatchEvent(C)}n.allowMomentumBounce=!1,i.grabCursor&&(r.allowSlideNext===!0||r.allowSlidePrev===!0)&&r.setGrabCursor(!0),r.emit("sliderFirstMove",l)}let x;if(new Date().getTime(),n.isMoved&&n.allowThresholdMove&&v!==r.touchesDirection&&g&&y&&Math.abs(h)>=1){Object.assign(s,{startX:c,startY:d,currentX:c,currentY:d,startTranslate:n.currentTranslate}),n.loopSwapReset=!0,n.startTranslate=n.currentTranslate;return}r.emit("sliderMove",l),n.isMoved=!0,n.currentTranslate=h+n.startTranslate;let S=!0,T=i.resistanceRatio;if(i.touchReleaseOnEdges&&(T=0),h>0?(g&&y&&!x&&n.allowThresholdMove&&n.currentTranslate>(i.centeredSlides?r.minTranslate()-r.slidesSizesGrid[r.activeIndex+1]-(i.slidesPerView!=="auto"&&r.slides.length-i.slidesPerView>=2?r.slidesSizesGrid[r.activeIndex+1]+r.params.spaceBetween:0)-r.params.spaceBetween:r.minTranslate())&&r.loopFix({direction:"prev",setTranslate:!0,activeSlideIndex:0}),n.currentTranslate>r.minTranslate()&&(S=!1,i.resistance&&(n.currentTranslate=r.minTranslate()-1+(-r.minTranslate()+n.startTranslate+h)**T))):h<0&&(g&&y&&!x&&n.allowThresholdMove&&n.currentTranslate<(i.centeredSlides?r.maxTranslate()+r.slidesSizesGrid[r.slidesSizesGrid.length-1]+r.params.spaceBetween+(i.slidesPerView!=="auto"&&r.slides.length-i.slidesPerView>=2?r.slidesSizesGrid[r.slidesSizesGrid.length-1]+r.params.spaceBetween:0):r.maxTranslate())&&r.loopFix({direction:"next",setTranslate:!0,activeSlideIndex:r.slides.length-(i.slidesPerView==="auto"?r.slidesPerViewDynamic():Math.ceil(parseFloat(i.slidesPerView,10)))}),n.currentTranslate<r.maxTranslate()&&(S=!1,i.resistance&&(n.currentTranslate=r.maxTranslate()+1-(r.maxTranslate()-n.startTranslate-h)**T))),S&&(l.preventedByNestedSwiper=!0),!r.allowSlideNext&&r.swipeDirection==="next"&&n.currentTranslate<n.startTranslate&&(n.currentTranslate=n.startTranslate),!r.allowSlidePrev&&r.swipeDirection==="prev"&&n.currentTranslate>n.startTranslate&&(n.currentTranslate=n.startTranslate),!r.allowSlidePrev&&!r.allowSlideNext&&(n.currentTranslate=n.startTranslate),i.threshold>0)if(Math.abs(h)>i.threshold||n.allowThresholdMove){if(!n.allowThresholdMove){n.allowThresholdMove=!0,s.startX=s.currentX,s.startY=s.currentY,n.currentTranslate=n.startTranslate,s.diff=r.isHorizontal()?s.currentX-s.startX:s.currentY-s.startY;return}}else{n.currentTranslate=n.startTranslate;return}!i.followFinger||i.cssMode||((i.freeMode&&i.freeMode.enabled&&r.freeMode||i.watchSlidesProgress)&&(r.updateActiveIndex(),r.updateSlidesClasses()),i.freeMode&&i.freeMode.enabled&&r.freeMode&&r.freeMode.onTouchMove(),r.updateProgress(n.currentTranslate),r.setTranslate(n.currentTranslate))}function iD(t){const e=this,r=e.touchEventsData;let n=t;n.originalEvent&&(n=n.originalEvent);let i;if(n.type==="touchend"||n.type==="touchcancel"){if(i=[...n.changedTouches].filter(T=>T.identifier===r.touchId)[0],!i||i.identifier!==r.touchId)return}else{if(r.touchId!==null||n.pointerId!==r.pointerId)return;i=n}if(["pointercancel","pointerout","pointerleave","contextmenu"].includes(n.type)&&!(["pointercancel","contextmenu"].includes(n.type)&&(e.browser.isSafari||e.browser.isWebView)))return;r.pointerId=null,r.touchId=null;const{params:a,touches:o,rtlTranslate:l,slidesGrid:u,enabled:c}=e;if(!c||!a.simulateTouch&&n.pointerType==="mouse")return;if(r.allowTouchCallbacks&&e.emit("touchEnd",n),r.allowTouchCallbacks=!1,!r.isTouched){r.isMoved&&a.grabCursor&&e.setGrabCursor(!1),r.isMoved=!1,r.startMoving=!1;return}a.grabCursor&&r.isMoved&&r.isTouched&&(e.allowSlideNext===!0||e.allowSlidePrev===!0)&&e.setGrabCursor(!1);const d=kc(),f=d-r.touchStartTime;if(e.allowClick){const T=n.path||n.composedPath&&n.composedPath();e.updateClickedSlide(T&&T[0]||n.target,T),e.emit("tap click",n),f<300&&d-r.lastClickTime<300&&e.emit("doubleTap doubleClick",n)}if(r.lastClickTime=kc(),Gh(()=>{e.destroyed||(e.allowClick=!0)}),!r.isTouched||!r.isMoved||!e.swipeDirection||o.diff===0&&!r.loopSwapReset||r.currentTranslate===r.startTranslate&&!r.loopSwapReset){r.isTouched=!1,r.isMoved=!1,r.startMoving=!1;return}r.isTouched=!1,r.isMoved=!1,r.startMoving=!1;let m;if(a.followFinger?m=l?e.translate:-e.translate:m=-r.currentTranslate,a.cssMode)return;if(a.freeMode&&a.freeMode.enabled){e.freeMode.onTouchEnd({currentPos:m});return}const h=m>=-e.maxTranslate()&&!e.params.loop;let p=0,v=e.slidesSizesGrid[0];for(let T=0;T<u.length;T+=T<a.slidesPerGroupSkip?1:a.slidesPerGroup){const C=T<a.slidesPerGroupSkip-1?1:a.slidesPerGroup;typeof u[T+C]<"u"?(h||m>=u[T]&&m<u[T+C])&&(p=T,v=u[T+C]-u[T]):(h||m>=u[T])&&(p=T,v=u[u.length-1]-u[u.length-2])}let g=null,y=null;a.rewind&&(e.isBeginning?y=a.virtual&&a.virtual.enabled&&e.virtual?e.virtual.slides.length-1:e.slides.length-1:e.isEnd&&(g=0));const x=(m-u[p])/v,S=p<a.slidesPerGroupSkip-1?1:a.slidesPerGroup;if(f>a.longSwipesMs){if(!a.longSwipes){e.slideTo(e.activeIndex);return}e.swipeDirection==="next"&&(x>=a.longSwipesRatio?e.slideTo(a.rewind&&e.isEnd?g:p+S):e.slideTo(p)),e.swipeDirection==="prev"&&(x>1-a.longSwipesRatio?e.slideTo(p+S):y!==null&&x<0&&Math.abs(x)>a.longSwipesRatio?e.slideTo(y):e.slideTo(p))}else{if(!a.shortSwipes){e.slideTo(e.activeIndex);return}e.navigation&&(n.target===e.navigation.nextEl||n.target===e.navigation.prevEl)?n.target===e.navigation.nextEl?e.slideTo(p+S):e.slideTo(p):(e.swipeDirection==="next"&&e.slideTo(g!==null?g:p+S),e.swipeDirection==="prev"&&e.slideTo(y!==null?y:p))}}function iv(){const t=this,{params:e,el:r}=t;if(r&&r.offsetWidth===0)return;e.breakpoints&&t.setBreakpoint();const{allowSlideNext:n,allowSlidePrev:i,snapGrid:s}=t,a=t.virtual&&t.params.virtual.enabled;t.allowSlideNext=!0,t.allowSlidePrev=!0,t.updateSize(),t.updateSlides(),t.updateSlidesClasses();const o=a&&e.loop;(e.slidesPerView==="auto"||e.slidesPerView>1)&&t.isEnd&&!t.isBeginning&&!t.params.centeredSlides&&!o?t.slideTo(t.slides.length-1,0,!1,!0):t.params.loop&&!a?t.slideToLoop(t.realIndex,0,!1,!0):t.slideTo(t.activeIndex,0,!1,!0),t.autoplay&&t.autoplay.running&&t.autoplay.paused&&(clearTimeout(t.autoplay.resizeTimeout),t.autoplay.resizeTimeout=setTimeout(()=>{t.autoplay&&t.autoplay.running&&t.autoplay.paused&&t.autoplay.resume()},500)),t.allowSlidePrev=i,t.allowSlideNext=n,t.params.watchOverflow&&s!==t.snapGrid&&t.checkOverflow()}function sD(t){const e=this;e.enabled&&(e.allowClick||(e.params.preventClicks&&t.preventDefault(),e.params.preventClicksPropagation&&e.animating&&(t.stopPropagation(),t.stopImmediatePropagation())))}function aD(){const t=this,{wrapperEl:e,rtlTranslate:r,enabled:n}=t;if(!n)return;t.previousTranslate=t.translate,t.isHorizontal()?t.translate=-e.scrollLeft:t.translate=-e.scrollTop,t.translate===0&&(t.translate=0),t.updateActiveIndex(),t.updateSlidesClasses();let i;const s=t.maxTranslate()-t.minTranslate();s===0?i=0:i=(t.translate-t.minTranslate())/s,i!==t.progress&&t.updateProgress(r?-t.translate:t.translate),t.emit("setTranslate",t.translate,!1)}function oD(t){const e=this;Du(e,t.target),!(e.params.cssMode||e.params.slidesPerView!=="auto"&&!e.params.autoHeight)&&e.update()}function lD(){const t=this;t.documentTouchHandlerProceeded||(t.documentTouchHandlerProceeded=!0,t.params.touchReleaseOnEdges&&(t.el.style.touchAction="auto"))}const JE=(t,e)=>{const r=$a(),{params:n,el:i,wrapperEl:s,device:a}=t,o=!!n.nested,l=e==="on"?"addEventListener":"removeEventListener",u=e;!i||typeof i=="string"||(r[l]("touchstart",t.onDocumentTouchStart,{passive:!1,capture:o}),i[l]("touchstart",t.onTouchStart,{passive:!1}),i[l]("pointerdown",t.onTouchStart,{passive:!1}),r[l]("touchmove",t.onTouchMove,{passive:!1,capture:o}),r[l]("pointermove",t.onTouchMove,{passive:!1,capture:o}),r[l]("touchend",t.onTouchEnd,{passive:!0}),r[l]("pointerup",t.onTouchEnd,{passive:!0}),r[l]("pointercancel",t.onTouchEnd,{passive:!0}),r[l]("touchcancel",t.onTouchEnd,{passive:!0}),r[l]("pointerout",t.onTouchEnd,{passive:!0}),r[l]("pointerleave",t.onTouchEnd,{passive:!0}),r[l]("contextmenu",t.onTouchEnd,{passive:!0}),(n.preventClicks||n.preventClicksPropagation)&&i[l]("click",t.onClick,!0),n.cssMode&&s[l]("scroll",t.onScroll),n.updateOnWindowResize?t[u](a.ios||a.android?"resize orientationchange observerUpdate":"resize observerUpdate",iv,!0):t[u]("observerUpdate",iv,!0),i[l]("load",t.onLoad,{capture:!0}))};function uD(){const t=this,{params:e}=t;t.onTouchStart=rD.bind(t),t.onTouchMove=nD.bind(t),t.onTouchEnd=iD.bind(t),t.onDocumentTouchStart=lD.bind(t),e.cssMode&&(t.onScroll=aD.bind(t)),t.onClick=sD.bind(t),t.onLoad=oD.bind(t),JE(t,"on")}function cD(){JE(this,"off")}var dD={attachEvents:uD,detachEvents:cD};const sv=(t,e)=>t.grid&&e.grid&&e.grid.rows>1;function fD(){const t=this,{realIndex:e,initialized:r,params:n,el:i}=t,s=n.breakpoints;if(!s||s&&Object.keys(s).length===0)return;const a=t.getBreakpoint(s,t.params.breakpointsBase,t.el);if(!a||t.currentBreakpoint===a)return;const l=(a in s?s[a]:void 0)||t.originalParams,u=sv(t,n),c=sv(t,l),d=t.params.grabCursor,f=l.grabCursor,m=n.enabled;u&&!c?(i.classList.remove(`${n.containerModifierClass}grid`,`${n.containerModifierClass}grid-column`),t.emitContainerClasses()):!u&&c&&(i.classList.add(`${n.containerModifierClass}grid`),(l.grid.fill&&l.grid.fill==="column"||!l.grid.fill&&n.grid.fill==="column")&&i.classList.add(`${n.containerModifierClass}grid-column`),t.emitContainerClasses()),d&&!f?t.unsetGrabCursor():!d&&f&&t.setGrabCursor(),["navigation","pagination","scrollbar"].forEach(x=>{if(typeof l[x]>"u")return;const S=n[x]&&n[x].enabled,T=l[x]&&l[x].enabled;S&&!T&&t[x].disable(),!S&&T&&t[x].enable()});const h=l.direction&&l.direction!==n.direction,p=n.loop&&(l.slidesPerView!==n.slidesPerView||h),v=n.loop;h&&r&&t.changeDirection(),Ir(t.params,l);const g=t.params.enabled,y=t.params.loop;Object.assign(t,{allowTouchMove:t.params.allowTouchMove,allowSlideNext:t.params.allowSlideNext,allowSlidePrev:t.params.allowSlidePrev}),m&&!g?t.disable():!m&&g&&t.enable(),t.currentBreakpoint=a,t.emit("_beforeBreakpoint",l),r&&(p?(t.loopDestroy(),t.loopCreate(e),t.updateSlides()):!v&&y?(t.loopCreate(e),t.updateSlides()):v&&!y&&t.loopDestroy()),t.emit("breakpoint",l)}function hD(t,e,r){if(e===void 0&&(e="window"),!t||e==="container"&&!r)return;let n=!1;const i=jr(),s=e==="window"?i.innerHeight:r.clientHeight,a=Object.keys(t).map(o=>{if(typeof o=="string"&&o.indexOf("@")===0){const l=parseFloat(o.substr(1));return{value:s*l,point:o}}return{value:o,point:o}});a.sort((o,l)=>parseInt(o.value,10)-parseInt(l.value,10));for(let o=0;o<a.length;o+=1){const{point:l,value:u}=a[o];e==="window"?i.matchMedia(`(min-width: ${u}px)`).matches&&(n=l):u<=r.clientWidth&&(n=l)}return n||"max"}var pD={setBreakpoint:fD,getBreakpoint:hD};function mD(t,e){const r=[];return t.forEach(n=>{typeof n=="object"?Object.keys(n).forEach(i=>{n[i]&&r.push(e+i)}):typeof n=="string"&&r.push(e+n)}),r}function gD(){const t=this,{classNames:e,params:r,rtl:n,el:i,device:s}=t,a=mD(["initialized",r.direction,{"free-mode":t.params.freeMode&&r.freeMode.enabled},{autoheight:r.autoHeight},{rtl:n},{grid:r.grid&&r.grid.rows>1},{"grid-column":r.grid&&r.grid.rows>1&&r.grid.fill==="column"},{android:s.android},{ios:s.ios},{"css-mode":r.cssMode},{centered:r.cssMode&&r.centeredSlides},{"watch-progress":r.watchSlidesProgress}],r.containerModifierClass);e.push(...a),i.classList.add(...e),t.emitContainerClasses()}function vD(){const t=this,{el:e,classNames:r}=t;!e||typeof e=="string"||(e.classList.remove(...r),t.emitContainerClasses())}var yD={addClasses:gD,removeClasses:vD};function xD(){const t=this,{isLocked:e,params:r}=t,{slidesOffsetBefore:n}=r;if(n){const i=t.slides.length-1,s=t.slidesGrid[i]+t.slidesSizesGrid[i]+n*2;t.isLocked=t.size>s}else t.isLocked=t.snapGrid.length===1;r.allowSlideNext===!0&&(t.allowSlideNext=!t.isLocked),r.allowSlidePrev===!0&&(t.allowSlidePrev=!t.isLocked),e&&e!==t.isLocked&&(t.isEnd=!1),e!==t.isLocked&&t.emit(t.isLocked?"lock":"unlock")}var SD={checkOverflow:xD},Hh={init:!0,direction:"horizontal",oneWayMovement:!1,swiperElementNodeName:"SWIPER-CONTAINER",touchEventsTarget:"wrapper",initialSlide:0,speed:300,cssMode:!1,updateOnWindowResize:!0,resizeObserver:!0,nested:!1,createElements:!1,eventsPrefix:"swiper",enabled:!0,focusableElements:"input, select, option, textarea, button, video, label",width:null,height:null,preventInteractionOnTransition:!1,userAgent:null,url:null,edgeSwipeDetection:!1,edgeSwipeThreshold:20,autoHeight:!1,setWrapperSize:!1,virtualTranslate:!1,effect:"slide",breakpoints:void 0,breakpointsBase:"window",spaceBetween:0,slidesPerView:1,slidesPerGroup:1,slidesPerGroupSkip:0,slidesPerGroupAuto:!1,centeredSlides:!1,centeredSlidesBounds:!1,slidesOffsetBefore:0,slidesOffsetAfter:0,normalizeSlideIndex:!0,centerInsufficientSlides:!1,watchOverflow:!0,roundLengths:!1,touchRatio:1,touchAngle:45,simulateTouch:!0,shortSwipes:!0,longSwipes:!0,longSwipesRatio:.5,longSwipesMs:300,followFinger:!0,allowTouchMove:!0,threshold:5,touchMoveStopPropagation:!1,touchStartPreventDefault:!0,touchStartForcePreventDefault:!1,touchReleaseOnEdges:!1,uniqueNavElements:!0,resistance:!0,resistanceRatio:.85,watchSlidesProgress:!1,grabCursor:!1,preventClicks:!0,preventClicksPropagation:!0,slideToClickedSlide:!1,loop:!1,loopAddBlankSlides:!0,loopAdditionalSlides:0,loopPreventsSliding:!0,rewind:!1,allowSlidePrev:!0,allowSlideNext:!0,swipeHandler:null,noSwiping:!0,noSwipingClass:"swiper-no-swiping",noSwipingSelector:null,passiveListeners:!0,maxBackfaceHiddenSlides:10,containerModifierClass:"swiper-",slideClass:"swiper-slide",slideBlankClass:"swiper-slide-blank",slideActiveClass:"swiper-slide-active",slideVisibleClass:"swiper-slide-visible",slideFullyVisibleClass:"swiper-slide-fully-visible",slideNextClass:"swiper-slide-next",slidePrevClass:"swiper-slide-prev",wrapperClass:"swiper-wrapper",lazyPreloaderClass:"swiper-lazy-preloader",lazyPreloadPrevNext:0,runCallbacksOnInit:!0,_emitClasses:!1};function ED(t,e){return function(n){n===void 0&&(n={});const i=Object.keys(n)[0],s=n[i];if(typeof s!="object"||s===null){Ir(e,n);return}if(t[i]===!0&&(t[i]={enabled:!0}),i==="navigation"&&t[i]&&t[i].enabled&&!t[i].prevEl&&!t[i].nextEl&&(t[i].auto=!0),["pagination","scrollbar"].indexOf(i)>=0&&t[i]&&t[i].enabled&&!t[i].el&&(t[i].auto=!0),!(i in t&&"enabled"in s)){Ir(e,n);return}typeof t[i]=="object"&&!("enabled"in t[i])&&(t[i].enabled=!0),t[i]||(t[i]={enabled:!1}),Ir(e,n)}}const gf={eventsEmitter:yk,update:Rk,translate:Mk,transition:Bk,slide:Kk,loop:Zk,grabCursor:eD,events:dD,breakpoints:pD,checkOverflow:SD,classes:yD},vf={};let bm=class qn{constructor(){let e,r;for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];i.length===1&&i[0].constructor&&Object.prototype.toString.call(i[0]).slice(8,-1)==="Object"?r=i[0]:[e,r]=i,r||(r={}),r=Ir({},r),e&&!r.el&&(r.el=e);const a=$a();if(r.el&&typeof r.el=="string"&&a.querySelectorAll(r.el).length>1){const c=[];return a.querySelectorAll(r.el).forEach(d=>{const f=Ir({},r,{el:d});c.push(new qn(f))}),c}const o=this;o.__swiper__=!0,o.support=XE(),o.device=ZE({userAgent:r.userAgent}),o.browser=mk(),o.eventsListeners={},o.eventsAnyListeners=[],o.modules=[...o.__modules__],r.modules&&Array.isArray(r.modules)&&o.modules.push(...r.modules);const l={};o.modules.forEach(c=>{c({params:r,swiper:o,extendParams:ED(r,l),on:o.on.bind(o),once:o.once.bind(o),off:o.off.bind(o),emit:o.emit.bind(o)})});const u=Ir({},Hh,l);return o.params=Ir({},u,vf,r),o.originalParams=Ir({},o.params),o.passedParams=Ir({},r),o.params&&o.params.on&&Object.keys(o.params.on).forEach(c=>{o.on(c,o.params.on[c])}),o.params&&o.params.onAny&&o.onAny(o.params.onAny),Object.assign(o,{enabled:o.params.enabled,el:e,classNames:[],slides:[],slidesGrid:[],snapGrid:[],slidesSizesGrid:[],isHorizontal(){return o.params.direction==="horizontal"},isVertical(){return o.params.direction==="vertical"},activeIndex:0,realIndex:0,isBeginning:!0,isEnd:!1,translate:0,previousTranslate:0,progress:0,velocity:0,animating:!1,cssOverflowAdjustment(){return Math.trunc(this.translate/2**23)*2**23},allowSlideNext:o.params.allowSlideNext,allowSlidePrev:o.params.allowSlidePrev,touchEventsData:{isTouched:void 0,isMoved:void 0,allowTouchCallbacks:void 0,touchStartTime:void 0,isScrolling:void 0,currentTranslate:void 0,startTranslate:void 0,allowThresholdMove:void 0,focusableElements:o.params.focusableElements,lastClickTime:0,clickTimeout:void 0,velocities:[],allowMomentumBounce:void 0,startMoving:void 0,pointerId:null,touchId:null},allowClick:!0,allowTouchMove:o.params.allowTouchMove,touches:{startX:0,startY:0,currentX:0,currentY:0,diff:0},imagesToLoad:[],imagesLoaded:0}),o.emit("_swiper"),o.params.init&&o.init(),o}getDirectionLabel(e){return this.isHorizontal()?e:{width:"height","margin-top":"margin-left","margin-bottom ":"margin-right","margin-left":"margin-top","margin-right":"margin-bottom","padding-left":"padding-top","padding-right":"padding-bottom",marginRight:"marginBottom"}[e]}getSlideIndex(e){const{slidesEl:r,params:n}=this,i=In(r,`.${n.slideClass}, swiper-slide`),s=ev(i[0]);return ev(e)-s}getSlideIndexByData(e){return this.getSlideIndex(this.slides.filter(r=>r.getAttribute("data-swiper-slide-index")*1===e)[0])}recalcSlides(){const e=this,{slidesEl:r,params:n}=e;e.slides=In(r,`.${n.slideClass}, swiper-slide`)}enable(){const e=this;e.enabled||(e.enabled=!0,e.params.grabCursor&&e.setGrabCursor(),e.emit("enable"))}disable(){const e=this;e.enabled&&(e.enabled=!1,e.params.grabCursor&&e.unsetGrabCursor(),e.emit("disable"))}setProgress(e,r){const n=this;e=Math.min(Math.max(e,0),1);const i=n.minTranslate(),a=(n.maxTranslate()-i)*e+i;n.translateTo(a,typeof r>"u"?0:r),n.updateActiveIndex(),n.updateSlidesClasses()}emitContainerClasses(){const e=this;if(!e.params._emitClasses||!e.el)return;const r=e.el.className.split(" ").filter(n=>n.indexOf("swiper")===0||n.indexOf(e.params.containerModifierClass)===0);e.emit("_containerClasses",r.join(" "))}getSlideClasses(e){const r=this;return r.destroyed?"":e.className.split(" ").filter(n=>n.indexOf("swiper-slide")===0||n.indexOf(r.params.slideClass)===0).join(" ")}emitSlidesClasses(){const e=this;if(!e.params._emitClasses||!e.el)return;const r=[];e.slides.forEach(n=>{const i=e.getSlideClasses(n);r.push({slideEl:n,classNames:i}),e.emit("_slideClass",n,i)}),e.emit("_slideClasses",r)}slidesPerViewDynamic(e,r){e===void 0&&(e="current"),r===void 0&&(r=!1);const n=this,{params:i,slides:s,slidesGrid:a,slidesSizesGrid:o,size:l,activeIndex:u}=n;let c=1;if(typeof i.slidesPerView=="number")return i.slidesPerView;if(i.centeredSlides){let d=s[u]?Math.ceil(s[u].swiperSlideSize):0,f;for(let m=u+1;m<s.length;m+=1)s[m]&&!f&&(d+=Math.ceil(s[m].swiperSlideSize),c+=1,d>l&&(f=!0));for(let m=u-1;m>=0;m-=1)s[m]&&!f&&(d+=s[m].swiperSlideSize,c+=1,d>l&&(f=!0))}else if(e==="current")for(let d=u+1;d<s.length;d+=1)(r?a[d]+o[d]-a[u]<l:a[d]-a[u]<l)&&(c+=1);else for(let d=u-1;d>=0;d-=1)a[u]-a[d]<l&&(c+=1);return c}update(){const e=this;if(!e||e.destroyed)return;const{snapGrid:r,params:n}=e;n.breakpoints&&e.setBreakpoint(),[...e.el.querySelectorAll('[loading="lazy"]')].forEach(a=>{a.complete&&Du(e,a)}),e.updateSize(),e.updateSlides(),e.updateProgress(),e.updateSlidesClasses();function i(){const a=e.rtlTranslate?e.translate*-1:e.translate,o=Math.min(Math.max(a,e.maxTranslate()),e.minTranslate());e.setTranslate(o),e.updateActiveIndex(),e.updateSlidesClasses()}let s;if(n.freeMode&&n.freeMode.enabled&&!n.cssMode)i(),n.autoHeight&&e.updateAutoHeight();else{if((n.slidesPerView==="auto"||n.slidesPerView>1)&&e.isEnd&&!n.centeredSlides){const a=e.virtual&&n.virtual.enabled?e.virtual.slides:e.slides;s=e.slideTo(a.length-1,0,!1,!0)}else s=e.slideTo(e.activeIndex,0,!1,!0);s||i()}n.watchOverflow&&r!==e.snapGrid&&e.checkOverflow(),e.emit("update")}changeDirection(e,r){r===void 0&&(r=!0);const n=this,i=n.params.direction;return e||(e=i==="horizontal"?"vertical":"horizontal"),e===i||e!=="horizontal"&&e!=="vertical"||(n.el.classList.remove(`${n.params.containerModifierClass}${i}`),n.el.classList.add(`${n.params.containerModifierClass}${e}`),n.emitContainerClasses(),n.params.direction=e,n.slides.forEach(s=>{e==="vertical"?s.style.width="":s.style.height=""}),n.emit("changeDirection"),r&&n.update()),n}changeLanguageDirection(e){const r=this;r.rtl&&e==="rtl"||!r.rtl&&e==="ltr"||(r.rtl=e==="rtl",r.rtlTranslate=r.params.direction==="horizontal"&&r.rtl,r.rtl?(r.el.classList.add(`${r.params.containerModifierClass}rtl`),r.el.dir="rtl"):(r.el.classList.remove(`${r.params.containerModifierClass}rtl`),r.el.dir="ltr"),r.update())}mount(e){const r=this;if(r.mounted)return!0;let n=e||r.params.el;if(typeof n=="string"&&(n=document.querySelector(n)),!n)return!1;n.swiper=r,n.parentNode&&n.parentNode.host&&n.parentNode.host.nodeName===r.params.swiperElementNodeName.toUpperCase()&&(r.isElement=!0);const i=()=>`.${(r.params.wrapperClass||"").trim().split(" ").join(".")}`;let a=n&&n.shadowRoot&&n.shadowRoot.querySelector?n.shadowRoot.querySelector(i()):In(n,i())[0];return!a&&r.params.createElements&&(a=Pc("div",r.params.wrapperClass),n.append(a),In(n,`.${r.params.slideClass}`).forEach(o=>{a.append(o)})),Object.assign(r,{el:n,wrapperEl:a,slidesEl:r.isElement&&!n.parentNode.host.slideSlots?n.parentNode.host:a,hostEl:r.isElement?n.parentNode.host:n,mounted:!0,rtl:n.dir.toLowerCase()==="rtl"||Ri(n,"direction")==="rtl",rtlTranslate:r.params.direction==="horizontal"&&(n.dir.toLowerCase()==="rtl"||Ri(n,"direction")==="rtl"),wrongRTL:Ri(a,"display")==="-webkit-box"}),!0}init(e){const r=this;if(r.initialized||r.mount(e)===!1)return r;r.emit("beforeInit"),r.params.breakpoints&&r.setBreakpoint(),r.addClasses(),r.updateSize(),r.updateSlides(),r.params.watchOverflow&&r.checkOverflow(),r.params.grabCursor&&r.enabled&&r.setGrabCursor(),r.params.loop&&r.virtual&&r.params.virtual.enabled?r.slideTo(r.params.initialSlide+r.virtual.slidesBefore,0,r.params.runCallbacksOnInit,!1,!0):r.slideTo(r.params.initialSlide,0,r.params.runCallbacksOnInit,!1,!0),r.params.loop&&r.loopCreate(),r.attachEvents();const i=[...r.el.querySelectorAll('[loading="lazy"]')];return r.isElement&&i.push(...r.hostEl.querySelectorAll('[loading="lazy"]')),i.forEach(s=>{s.complete?Du(r,s):s.addEventListener("load",a=>{Du(r,a.target)})}),zh(r),r.initialized=!0,zh(r),r.emit("init"),r.emit("afterInit"),r}destroy(e,r){e===void 0&&(e=!0),r===void 0&&(r=!0);const n=this,{params:i,el:s,wrapperEl:a,slides:o}=n;return typeof n.params>"u"||n.destroyed||(n.emit("beforeDestroy"),n.initialized=!1,n.detachEvents(),i.loop&&n.loopDestroy(),r&&(n.removeClasses(),s&&typeof s!="string"&&s.removeAttribute("style"),a&&a.removeAttribute("style"),o&&o.length&&o.forEach(l=>{l.classList.remove(i.slideVisibleClass,i.slideFullyVisibleClass,i.slideActiveClass,i.slideNextClass,i.slidePrevClass),l.removeAttribute("style"),l.removeAttribute("data-swiper-slide-index")})),n.emit("destroy"),Object.keys(n.eventsListeners).forEach(l=>{n.off(l)}),e!==!1&&(n.el&&typeof n.el!="string"&&(n.el.swiper=null),ik(n)),n.destroyed=!0),null}static extendDefaults(e){Ir(vf,e)}static get extendedDefaults(){return vf}static get defaults(){return Hh}static installModule(e){qn.prototype.__modules__||(qn.prototype.__modules__=[]);const r=qn.prototype.__modules__;typeof e=="function"&&r.indexOf(e)<0&&r.push(e)}static use(e){return Array.isArray(e)?(e.forEach(r=>qn.installModule(r)),qn):(qn.installModule(e),qn)}};Object.keys(gf).forEach(t=>{Object.keys(gf[t]).forEach(e=>{bm.prototype[e]=gf[t][e]})});bm.use([gk,vk]);const eT=["eventsPrefix","injectStyles","injectStylesUrls","modules","init","_direction","oneWayMovement","swiperElementNodeName","touchEventsTarget","initialSlide","_speed","cssMode","updateOnWindowResize","resizeObserver","nested","focusableElements","_enabled","_width","_height","preventInteractionOnTransition","userAgent","url","_edgeSwipeDetection","_edgeSwipeThreshold","_freeMode","_autoHeight","setWrapperSize","virtualTranslate","_effect","breakpoints","breakpointsBase","_spaceBetween","_slidesPerView","maxBackfaceHiddenSlides","_grid","_slidesPerGroup","_slidesPerGroupSkip","_slidesPerGroupAuto","_centeredSlides","_centeredSlidesBounds","_slidesOffsetBefore","_slidesOffsetAfter","normalizeSlideIndex","_centerInsufficientSlides","_watchOverflow","roundLengths","touchRatio","touchAngle","simulateTouch","_shortSwipes","_longSwipes","longSwipesRatio","longSwipesMs","_followFinger","allowTouchMove","_threshold","touchMoveStopPropagation","touchStartPreventDefault","touchStartForcePreventDefault","touchReleaseOnEdges","uniqueNavElements","_resistance","_resistanceRatio","_watchSlidesProgress","_grabCursor","preventClicks","preventClicksPropagation","_slideToClickedSlide","_loop","loopAdditionalSlides","loopAddBlankSlides","loopPreventsSliding","_rewind","_allowSlidePrev","_allowSlideNext","_swipeHandler","_noSwiping","noSwipingClass","noSwipingSelector","passiveListeners","containerModifierClass","slideClass","slideActiveClass","slideVisibleClass","slideFullyVisibleClass","slideNextClass","slidePrevClass","slideBlankClass","wrapperClass","lazyPreloaderClass","lazyPreloadPrevNext","runCallbacksOnInit","observer","observeParents","observeSlideChildren","a11y","_autoplay","_controller","coverflowEffect","cubeEffect","fadeEffect","flipEffect","creativeEffect","cardsEffect","hashNavigation","history","keyboard","mousewheel","_navigation","_pagination","parallax","_scrollbar","_thumbs","virtual","zoom","control"];function ws(t){return typeof t=="object"&&t!==null&&t.constructor&&Object.prototype.toString.call(t).slice(8,-1)==="Object"&&!t.__swiper__}function ca(t,e){const r=["__proto__","constructor","prototype"];Object.keys(e).filter(n=>r.indexOf(n)<0).forEach(n=>{typeof t[n]>"u"?t[n]=e[n]:ws(e[n])&&ws(t[n])&&Object.keys(e[n]).length>0?e[n].__swiper__?t[n]=e[n]:ca(t[n],e[n]):t[n]=e[n]})}function tT(t){return t===void 0&&(t={}),t.navigation&&typeof t.navigation.nextEl>"u"&&typeof t.navigation.prevEl>"u"}function rT(t){return t===void 0&&(t={}),t.pagination&&typeof t.pagination.el>"u"}function nT(t){return t===void 0&&(t={}),t.scrollbar&&typeof t.scrollbar.el>"u"}function iT(t){t===void 0&&(t="");const e=t.split(" ").map(n=>n.trim()).filter(n=>!!n),r=[];return e.forEach(n=>{r.indexOf(n)<0&&r.push(n)}),r.join(" ")}function TD(t){return t===void 0&&(t=""),t?t.includes("swiper-wrapper")?t:`swiper-wrapper ${t}`:"swiper-wrapper"}function wD(t){let{swiper:e,slides:r,passedParams:n,changedParams:i,nextEl:s,prevEl:a,scrollbarEl:o,paginationEl:l}=t;const u=i.filter(I=>I!=="children"&&I!=="direction"&&I!=="wrapperClass"),{params:c,pagination:d,navigation:f,scrollbar:m,virtual:h,thumbs:p}=e;let v,g,y,x,S,T,C,_;i.includes("thumbs")&&n.thumbs&&n.thumbs.swiper&&c.thumbs&&!c.thumbs.swiper&&(v=!0),i.includes("controller")&&n.controller&&n.controller.control&&c.controller&&!c.controller.control&&(g=!0),i.includes("pagination")&&n.pagination&&(n.pagination.el||l)&&(c.pagination||c.pagination===!1)&&d&&!d.el&&(y=!0),i.includes("scrollbar")&&n.scrollbar&&(n.scrollbar.el||o)&&(c.scrollbar||c.scrollbar===!1)&&m&&!m.el&&(x=!0),i.includes("navigation")&&n.navigation&&(n.navigation.prevEl||a)&&(n.navigation.nextEl||s)&&(c.navigation||c.navigation===!1)&&f&&!f.prevEl&&!f.nextEl&&(S=!0);const b=I=>{e[I]&&(e[I].destroy(),I==="navigation"?(e.isElement&&(e[I].prevEl.remove(),e[I].nextEl.remove()),c[I].prevEl=void 0,c[I].nextEl=void 0,e[I].prevEl=void 0,e[I].nextEl=void 0):(e.isElement&&e[I].el.remove(),c[I].el=void 0,e[I].el=void 0))};i.includes("loop")&&e.isElement&&(c.loop&&!n.loop?T=!0:!c.loop&&n.loop?C=!0:_=!0),u.forEach(I=>{if(ws(c[I])&&ws(n[I]))Object.assign(c[I],n[I]),(I==="navigation"||I==="pagination"||I==="scrollbar")&&"enabled"in n[I]&&!n[I].enabled&&b(I);else{const A=n[I];(A===!0||A===!1)&&(I==="navigation"||I==="pagination"||I==="scrollbar")?A===!1&&b(I):c[I]=n[I]}}),u.includes("controller")&&!g&&e.controller&&e.controller.control&&c.controller&&c.controller.control&&(e.controller.control=c.controller.control),i.includes("children")&&r&&h&&c.virtual.enabled?(h.slides=r,h.update(!0)):i.includes("virtual")&&h&&c.virtual.enabled&&(r&&(h.slides=r),h.update(!0)),i.includes("children")&&r&&c.loop&&(_=!0),v&&p.init()&&p.update(!0),g&&(e.controller.control=c.controller.control),y&&(e.isElement&&(!l||typeof l=="string")&&(l=document.createElement("div"),l.classList.add("swiper-pagination"),l.part.add("pagination"),e.el.appendChild(l)),l&&(c.pagination.el=l),d.init(),d.render(),d.update()),x&&(e.isElement&&(!o||typeof o=="string")&&(o=document.createElement("div"),o.classList.add("swiper-scrollbar"),o.part.add("scrollbar"),e.el.appendChild(o)),o&&(c.scrollbar.el=o),m.init(),m.updateSize(),m.setTranslate()),S&&(e.isElement&&((!s||typeof s=="string")&&(s=document.createElement("div"),s.classList.add("swiper-button-next"),s.innerHTML=e.hostEl.constructor.nextButtonSvg,s.part.add("button-next"),e.el.appendChild(s)),(!a||typeof a=="string")&&(a=document.createElement("div"),a.classList.add("swiper-button-prev"),a.innerHTML=e.hostEl.constructor.prevButtonSvg,a.part.add("button-prev"),e.el.appendChild(a))),s&&(c.navigation.nextEl=s),a&&(c.navigation.prevEl=a),f.init(),f.update()),i.includes("allowSlideNext")&&(e.allowSlideNext=n.allowSlideNext),i.includes("allowSlidePrev")&&(e.allowSlidePrev=n.allowSlidePrev),i.includes("direction")&&e.changeDirection(n.direction,!1),(T||_)&&e.loopDestroy(),(C||_)&&e.loopCreate(),e.update()}function bD(t,e){t===void 0&&(t={}),e===void 0&&(e=!0);const r={on:{}},n={},i={};ca(r,Hh),r._emitClasses=!0,r.init=!1;const s={},a=eT.map(l=>l.replace(/_/,"")),o=Object.assign({},t);return Object.keys(o).forEach(l=>{typeof t[l]>"u"||(a.indexOf(l)>=0?ws(t[l])?(r[l]={},i[l]={},ca(r[l],t[l]),ca(i[l],t[l])):(r[l]=t[l],i[l]=t[l]):l.search(/on[A-Z]/)===0&&typeof t[l]=="function"?e?n[`${l[2].toLowerCase()}${l.substr(3)}`]=t[l]:r.on[`${l[2].toLowerCase()}${l.substr(3)}`]=t[l]:s[l]=t[l])}),["navigation","pagination","scrollbar"].forEach(l=>{r[l]===!0&&(r[l]={}),r[l]===!1&&delete r[l]}),{params:r,passedParams:i,rest:s,events:n}}function LD(t,e){let{el:r,nextEl:n,prevEl:i,paginationEl:s,scrollbarEl:a,swiper:o}=t;tT(e)&&n&&i&&(o.params.navigation.nextEl=n,o.originalParams.navigation.nextEl=n,o.params.navigation.prevEl=i,o.originalParams.navigation.prevEl=i),rT(e)&&s&&(o.params.pagination.el=s,o.originalParams.pagination.el=s),nT(e)&&a&&(o.params.scrollbar.el=a,o.originalParams.scrollbar.el=a),o.init(r)}function AD(t,e,r,n,i){const s=[];if(!e)return s;const a=l=>{s.indexOf(l)<0&&s.push(l)};if(r&&n){const l=n.map(i),u=r.map(i);l.join("")!==u.join("")&&a("children"),n.length!==r.length&&a("children")}return eT.filter(l=>l[0]==="_").map(l=>l.replace(/_/,"")).forEach(l=>{if(l in t&&l in e)if(ws(t[l])&&ws(e[l])){const u=Object.keys(t[l]),c=Object.keys(e[l]);u.length!==c.length?a(l):(u.forEach(d=>{t[l][d]!==e[l][d]&&a(l)}),c.forEach(d=>{t[l][d]!==e[l][d]&&a(l)}))}else t[l]!==e[l]&&a(l)}),s}const _D=t=>{!t||t.destroyed||!t.params.virtual||t.params.virtual&&!t.params.virtual.enabled||(t.updateSlides(),t.updateProgress(),t.updateSlidesClasses(),t.parallax&&t.params.parallax&&t.params.parallax.enabled&&t.parallax.setTranslate())};function Oc(){return Oc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Oc.apply(this,arguments)}function sT(t){return t.type&&t.type.displayName&&t.type.displayName.includes("SwiperSlide")}function aT(t){const e=[];return ne.Children.toArray(t).forEach(r=>{sT(r)?e.push(r):r.props&&r.props.children&&aT(r.props.children).forEach(n=>e.push(n))}),e}function CD(t){const e=[],r={"container-start":[],"container-end":[],"wrapper-start":[],"wrapper-end":[]};return ne.Children.toArray(t).forEach(n=>{if(sT(n))e.push(n);else if(n.props&&n.props.slot&&r[n.props.slot])r[n.props.slot].push(n);else if(n.props&&n.props.children){const i=aT(n.props.children);i.length>0?i.forEach(s=>e.push(s)):r["container-end"].push(n)}else r["container-end"].push(n)}),{slides:e,slots:r}}function RD(t,e,r){if(!r)return null;const n=c=>{let d=c;return c<0?d=e.length+c:d>=e.length&&(d=d-e.length),d},i=t.isHorizontal()?{[t.rtlTranslate?"right":"left"]:`${r.offset}px`}:{top:`${r.offset}px`},{from:s,to:a}=r,o=t.params.loop?-e.length:0,l=t.params.loop?e.length*2:e.length,u=[];for(let c=o;c<l;c+=1)c>=s&&c<=a&&u.push(e[n(c)]);return u.map((c,d)=>ne.cloneElement(c,{swiper:t,style:i,key:c.props.virtualIndex||c.key||`slide-${d}`}))}function _o(t,e){return typeof window>"u"?L.useEffect(t,e):L.useLayoutEffect(t,e)}const av=L.createContext(null),ID=L.createContext(null),oT=L.forwardRef(function(t,e){let{className:r,tag:n="div",wrapperTag:i="div",children:s,onSwiper:a,...o}=t===void 0?{}:t,l=!1;const[u,c]=L.useState("swiper"),[d,f]=L.useState(null),[m,h]=L.useState(!1),p=L.useRef(!1),v=L.useRef(null),g=L.useRef(null),y=L.useRef(null),x=L.useRef(null),S=L.useRef(null),T=L.useRef(null),C=L.useRef(null),_=L.useRef(null),{params:b,passedParams:I,rest:A,events:k}=bD(o),{slides:O,slots:P}=CD(s),G=()=>{h(!m)};Object.assign(b.on,{_containerClasses(F,j){c(j)}});const K=()=>{Object.assign(b.on,k),l=!0;const F={...b};if(delete F.wrapperClass,g.current=new bm(F),g.current.virtual&&g.current.params.virtual.enabled){g.current.virtual.slides=O;const j={cache:!1,slides:O,renderExternal:f,renderExternalUpdate:!1};ca(g.current.params.virtual,j),ca(g.current.originalParams.virtual,j)}};v.current||K(),g.current&&g.current.on("_beforeBreakpoint",G);const H=()=>{l||!k||!g.current||Object.keys(k).forEach(F=>{g.current.on(F,k[F])})},se=()=>{!k||!g.current||Object.keys(k).forEach(F=>{g.current.off(F,k[F])})};L.useEffect(()=>()=>{g.current&&g.current.off("_beforeBreakpoint",G)}),L.useEffect(()=>{!p.current&&g.current&&(g.current.emitSlidesClasses(),p.current=!0)}),_o(()=>{if(e&&(e.current=v.current),!!v.current)return g.current.destroyed&&K(),LD({el:v.current,nextEl:S.current,prevEl:T.current,paginationEl:C.current,scrollbarEl:_.current,swiper:g.current},b),a&&!g.current.destroyed&&a(g.current),()=>{g.current&&!g.current.destroyed&&g.current.destroy(!0,!1)}},[]),_o(()=>{H();const F=AD(I,y.current,O,x.current,j=>j.key);return y.current=I,x.current=O,F.length&&g.current&&!g.current.destroyed&&wD({swiper:g.current,slides:O,passedParams:I,changedParams:F,nextEl:S.current,prevEl:T.current,scrollbarEl:_.current,paginationEl:C.current}),()=>{se()}}),_o(()=>{_D(g.current)},[d]);function W(){return b.virtual?RD(g.current,O,d):O.map((F,j)=>ne.cloneElement(F,{swiper:g.current,swiperSlideIndex:j}))}return ne.createElement(n,Oc({ref:v,className:iT(`${u}${r?` ${r}`:""}`)},A),ne.createElement(ID.Provider,{value:g.current},P["container-start"],ne.createElement(i,{className:TD(b.wrapperClass)},P["wrapper-start"],W(),P["wrapper-end"]),tT(b)&&ne.createElement(ne.Fragment,null,ne.createElement("div",{ref:T,className:"swiper-button-prev"}),ne.createElement("div",{ref:S,className:"swiper-button-next"})),nT(b)&&ne.createElement("div",{ref:_,className:"swiper-scrollbar"}),rT(b)&&ne.createElement("div",{ref:C,className:"swiper-pagination"}),P["container-end"]))});oT.displayName="Swiper";const lT=L.forwardRef(function(t,e){let{tag:r="div",children:n,className:i="",swiper:s,zoom:a,lazy:o,virtualIndex:l,swiperSlideIndex:u,...c}=t===void 0?{}:t;const d=L.useRef(null),[f,m]=L.useState("swiper-slide"),[h,p]=L.useState(!1);function v(S,T,C){T===d.current&&m(C)}_o(()=>{if(typeof u<"u"&&(d.current.swiperSlideIndex=u),e&&(e.current=d.current),!(!d.current||!s)){if(s.destroyed){f!=="swiper-slide"&&m("swiper-slide");return}return s.on("_slideClass",v),()=>{s&&s.off("_slideClass",v)}}}),_o(()=>{s&&d.current&&!s.destroyed&&m(s.getSlideClasses(d.current))},[s]);const g={isActive:f.indexOf("swiper-slide-active")>=0,isVisible:f.indexOf("swiper-slide-visible")>=0,isPrev:f.indexOf("swiper-slide-prev")>=0,isNext:f.indexOf("swiper-slide-next")>=0},y=()=>typeof n=="function"?n(g):n,x=()=>{p(!0)};return ne.createElement(r,Oc({ref:d,className:iT(`${f}${i?` ${i}`:""}`),"data-swiper-slide-index":l,onLoad:x},c),a&&ne.createElement(av.Provider,{value:g},ne.createElement("div",{className:"swiper-zoom-container","data-swiper-zoom":typeof a=="number"?a:void 0},y(),o&&!h&&ne.createElement("div",{className:"swiper-lazy-preloader"}))),!a&&ne.createElement(av.Provider,{value:g},y(),o&&!h&&ne.createElement("div",{className:"swiper-lazy-preloader"})))});lT.displayName="SwiperSlide";const kD=({media:t})=>{const[e,r]=L.useState(null),[n,i]=L.useState(!1),s=L.useRef(!1),a=Br(),o=()=>{s.current=!0;const c=setTimeout(()=>{s.current&&i(!0)},500);r(c)},l=()=>{s.current=!1,e&&clearTimeout(e),i(!1)},u=()=>{a(`/watch/${t.type}/${t.id}`)};return E.jsxs("article",{onMouseEnter:o,onMouseLeave:l,onClick:u,children:[E.jsx("img",{src:`${t.images.banner}`,alt:t.serie_title||t.title,className:"w-auto max-w-none h-48 object-cover rounded-md select-none"}),t.images.logo?E.jsx("img",{src:`${t.images.logo}`,alt:t.serie_title||t.title,className:"absolute bottom-1 left-1 w-1/2 h-12 object-contain rounded-md select-none"}):E.jsx("h3",{className:"absolute bottom-1 left-1 bg-black bg-opacity-50 text-white text-xs p-1 rounded-md select-none",children:t.serie_title||t.title}),E.jsx("section",{className:`absolute bg-neutral-800 bg-opacity-50 w-full z-10 bottom-0 pointer-events-none ${n?"opacity-100":"opacity-0"} transition-opacity duration-300`,children:E.jsxs("section",{className:"w-full h-full bg-black bg-opacity-75 p-4 flex flex-col gap-2",children:[E.jsx("h3",{children:t.serie_title||t.title}),E.jsxs("section",{className:"flex flex-col gap-1",children:[E.jsxs("h2",{children:["Genres: ",t.genres.map((c,d)=>E.jsxs(E.Fragment,{children:[E.jsx("span",{children:c},d),d!==t.genres.length-1&&E.jsx("span",{children:"  "})]}))]}),E.jsxs("h2",{children:["Note: ",(+t.note).toFixed(2),"/10"]}),E.jsxs("h2",{children:["Dure: ",t.duration,t.type==="serie"?" episodes":""]})]})]})})]})};function DD(t,e,r,n){return t.params.createElements&&Object.keys(n).forEach(i=>{if(!r[i]&&r.auto===!0){let s=In(t.el,`.${n[i]}`)[0];s||(s=Pc("div",n[i]),s.className=n[i],t.el.append(s)),r[i]=s,e[i]=s}}),r}function PD(t){let{swiper:e,extendParams:r,on:n,emit:i}=t;r({navigation:{nextEl:null,prevEl:null,hideOnClick:!1,disabledClass:"swiper-button-disabled",hiddenClass:"swiper-button-hidden",lockClass:"swiper-button-lock",navigationDisabledClass:"swiper-navigation-disabled"}}),e.navigation={nextEl:null,prevEl:null};function s(h){let p;return h&&typeof h=="string"&&e.isElement&&(p=e.el.querySelector(h),p)?p:(h&&(typeof h=="string"&&(p=[...document.querySelectorAll(h)]),e.params.uniqueNavElements&&typeof h=="string"&&p&&p.length>1&&e.el.querySelectorAll(h).length===1?p=e.el.querySelector(h):p&&p.length===1&&(p=p[0])),h&&!p?h:p)}function a(h,p){const v=e.params.navigation;h=Hn(h),h.forEach(g=>{g&&(g.classList[p?"add":"remove"](...v.disabledClass.split(" ")),g.tagName==="BUTTON"&&(g.disabled=p),e.params.watchOverflow&&e.enabled&&g.classList[e.isLocked?"add":"remove"](v.lockClass))})}function o(){const{nextEl:h,prevEl:p}=e.navigation;if(e.params.loop){a(p,!1),a(h,!1);return}a(p,e.isBeginning&&!e.params.rewind),a(h,e.isEnd&&!e.params.rewind)}function l(h){h.preventDefault(),!(e.isBeginning&&!e.params.loop&&!e.params.rewind)&&(e.slidePrev(),i("navigationPrev"))}function u(h){h.preventDefault(),!(e.isEnd&&!e.params.loop&&!e.params.rewind)&&(e.slideNext(),i("navigationNext"))}function c(){const h=e.params.navigation;if(e.params.navigation=DD(e,e.originalParams.navigation,e.params.navigation,{nextEl:"swiper-button-next",prevEl:"swiper-button-prev"}),!(h.nextEl||h.prevEl))return;let p=s(h.nextEl),v=s(h.prevEl);Object.assign(e.navigation,{nextEl:p,prevEl:v}),p=Hn(p),v=Hn(v);const g=(y,x)=>{y&&y.addEventListener("click",x==="next"?u:l),!e.enabled&&y&&y.classList.add(...h.lockClass.split(" "))};p.forEach(y=>g(y,"next")),v.forEach(y=>g(y,"prev"))}function d(){let{nextEl:h,prevEl:p}=e.navigation;h=Hn(h),p=Hn(p);const v=(g,y)=>{g.removeEventListener("click",y==="next"?u:l),g.classList.remove(...e.params.navigation.disabledClass.split(" "))};h.forEach(g=>v(g,"next")),p.forEach(g=>v(g,"prev"))}n("init",()=>{e.params.navigation.enabled===!1?m():(c(),o())}),n("toEdge fromEdge lock unlock",()=>{o()}),n("destroy",()=>{d()}),n("enable disable",()=>{let{nextEl:h,prevEl:p}=e.navigation;if(h=Hn(h),p=Hn(p),e.enabled){o();return}[...h,...p].filter(v=>!!v).forEach(v=>v.classList.add(e.params.navigation.lockClass))}),n("click",(h,p)=>{let{nextEl:v,prevEl:g}=e.navigation;v=Hn(v),g=Hn(g);const y=p.target;let x=g.includes(y)||v.includes(y);if(e.isElement&&!x){const S=p.path||p.composedPath&&p.composedPath();S&&(x=S.find(T=>v.includes(T)||g.includes(T)))}if(e.params.navigation.hideOnClick&&!x){if(e.pagination&&e.params.pagination&&e.params.pagination.clickable&&(e.pagination.el===y||e.pagination.el.contains(y)))return;let S;v.length?S=v[0].classList.contains(e.params.navigation.hiddenClass):g.length&&(S=g[0].classList.contains(e.params.navigation.hiddenClass)),i(S===!0?"navigationShow":"navigationHide"),[...v,...g].filter(T=>!!T).forEach(T=>T.classList.toggle(e.params.navigation.hiddenClass))}});const f=()=>{e.el.classList.remove(...e.params.navigation.navigationDisabledClass.split(" ")),c(),o()},m=()=>{e.el.classList.add(...e.params.navigation.navigationDisabledClass.split(" ")),d()};Object.assign(e.navigation,{enable:f,disable:m,update:o,init:c,destroy:d})}const Ca=({medias:t,index:e})=>{const[r,n]=L.useState(!1),[i,s]=L.useState(!1),a=L.useRef(null),o=()=>{s(!0)},l=()=>{n(!0)},u=()=>{n(!1)};return E.jsxs("div",{className:"relative w-full",onMouseEnter:l,onMouseLeave:u,children:[E.jsx(oT,{modules:[PD],spaceBetween:10,slidesPerView:"auto",direction:"horizontal",freeMode:!0,onSlideChange:o,className:"!overflow-visible  !w-full",ref:a,children:t.map((c,d)=>E.jsx(E.Fragment,{children:c?E.jsx(lT,{className:"!w-fit",children:E.jsx(kD,{media:c})},d):null}))}),i&&E.jsxs(E.Fragment,{children:[E.jsx("button",{style:{zIndex:e+1},className:`absolute left-0 top-1/2 transform -translate-y-1/2 ${r?"opacity-100":"opacity-0"} transition-opacity duration-300`,onClick:()=>{var c,d;return(d=(c=a.current)==null?void 0:c.swiper)==null?void 0:d.slidePrev()},children:" "}),E.jsx("button",{style:{zIndex:e+1},className:`absolute right-0 top-1/2 transform -translate-y-1/2 ${r?"opacity-100":"opacity-0"} transition-opacity duration-300`,onClick:()=>{var c,d;return(d=(c=a.current)==null?void 0:c.swiper)==null?void 0:d.slideNext()},children:" "})]})]})},wl=L.createContext({searchTerm:"",setSearchTerm:t=>{}}),OD=({children:t})=>{const[e,r]=L.useState("");return E.jsx(wl.Provider,{value:{searchTerm:e,setSearchTerm:r},children:t})};function MD(){const[t,e]=L.useState(""),[r,n]=L.useState(!0),[i,s]=L.useState(!0),{searchTerm:a}=L.useContext(wl),{data:o,loading:l}=ur(t),{data:u,loading:c,interupt:d}=ur("/api/medias/home");L.useEffect(()=>{c||setTimeout(()=>{n(!1)},500)},[c]),L.useEffect(()=>{l?s(!0):setTimeout(()=>{s(!1)},500)},[l]),L.useEffect(()=>{if(a===""||a.length<3){e("");return}e(`/api/medias/search/home?search=${a}`)},[a]),L.useEffect(()=>{const p=new URLSearchParams(window.location.search).get("query");p&&(d(),e(`/api/medias/search/home?search=${p}`))},[]);const f=["continue_watching","latest","recently_added","top_rated","best_of_year","family","comedy","animated","action","thriller","horror","drama","western"],m={continue_watching:"Continue Watching",latest:"Latest",recently_added:"Recently Added",top_rated:"Top Rated",best_of_year:"Best of the Year",family:"Family",comedy:"Comedy",animated:"Animated",action:"Action",thriller:"Thriller",horror:"Horror",drama:"Drama",western:"Western"};return E.jsxs(E.Fragment,{children:[E.jsx(_s,{className:"h-screen top-0 fixed bg-[--black] w-screen transition-all duration-300 pointer-events-none z-50 "+(r||i?"opacity-100":"opacity-0")}),!o&&u&&u.code===201&&E.jsxs("section",{className:`flex flex-col gap-8 pb-8 ${r||i?"overflow-hidden":""}`,children:[E.jsx(_a,{media:u.data.main_media}),E.jsx("section",{className:"flex flex-col gap-8 pl-4 overflow-hidden",children:f.map((h,p)=>{var v;return((v=u.data[h])==null?void 0:v.length)>0&&E.jsxs("section",{className:"flex flex-col gap-4 ",style:{zIndex:f.length-p},children:[E.jsx("h3",{className:"text-3xl font-bold",children:m[h]}),E.jsx(Ca,{medias:u.data[h],index:f.length-p})]},h)})})]}),o&&o.data.main_media&&o.code===201&&E.jsxs("section",{className:`flex flex-col gap-8 pb-8 ${r||i?"overflow-hidden":""}`,children:[E.jsx(_a,{media:o.data.main_media}),E.jsx("section",{className:"flex flex-col gap-8 pl-4 overflow-hidden",children:E.jsxs("section",{className:"flex flex-col gap-4",children:[E.jsx("h3",{className:"text-3xl font-bold",children:"Results"}),E.jsx(Ca,{medias:o.data.medias,index:0})]})})]}),(o&&o.code!==201||u&&u.code!==201)&&E.jsxs("section",{className:"h-screen flex flex-col justify-center items-center",children:[E.jsx("h1",{className:"text-4xl font-bold",children:"No data found"}),E.jsx("p",{className:"text-lg",children:"Please try again later"}),E.jsx("p",{className:"text-lg",children:"If you're the admin, ensure you have a library, and that you've scanned it."})]})]})}function ND(){var c;const[t,e]=L.useState(""),[r,n]=L.useState(!0),{searchTerm:i}=L.useContext(wl),{data:s}=ur(t),{data:a,interupt:o}=ur("/api/medias/movies");L.useEffect(()=>{(a||s)&&setTimeout(()=>{n(!1)},500)},[a]),L.useEffect(()=>{if(i===""||i.length<3){e("");return}e(`/api/medias/search/movies?search=${i}`)},[i]),L.useEffect(()=>{const f=new URLSearchParams(window.location.search).get("query");f&&(o(),e(`/api/medias/search/movies?search=${f}`))},[]);const l=["continue_watching","latest","recently_added","top_rated","best_of_year","family","comedy","animated","action","thriller","horror","drama","western"],u={continue_watching:"Continue Watching",latest:"Latest",recently_added:"Recently Added",top_rated:"Top Rated",best_of_year:"Best of the Year",family:"Family",comedy:"Comedy",animated:"Animated",action:"Action",thriller:"Thriller",horror:"Horror",drama:"Drama",western:"Western"};return E.jsxs(E.Fragment,{children:[E.jsx(_s,{className:"h-screen top-0 fixed bg-[--black] w-screen transition-all duration-300 pointer-events-none z-50 "+(r?"opacity-100":"opacity-0")}),!s&&a&&a.data&&E.jsxs("section",{className:`flex flex-col gap-8 pb-8 ${r?"overflow-hidden":""}`,children:[E.jsx(_a,{media:a.data.main_media}),E.jsx("section",{className:"flex flex-col gap-8 pl-4 overflow-hidden",children:l.map((d,f)=>{var m;return((m=a.data[d])==null?void 0:m.length)>0&&E.jsxs("section",{className:"flex flex-col gap-4 ",style:{zIndex:l.length-f},children:[E.jsx("h3",{className:"text-3xl font-bold",children:u[d]}),E.jsx(Ca,{medias:a.data[d],index:l.length-f})]},d)})})]}),s&&E.jsxs("section",{className:`flex flex-col gap-8 pb-8 ${r?"overflow-hidden":""}`,children:[E.jsx(_a,{media:(c=s.data)==null?void 0:c.main_media}),E.jsx("section",{className:"flex flex-col gap-8 pl-4 overflow-hidden",children:E.jsxs("section",{className:"flex flex-col gap-4",children:[E.jsx("h3",{className:"text-3xl font-bold",children:"Results"}),E.jsx(Ca,{medias:s.data.medias,index:0})]})})]}),(s&&s.code!==201||a&&a.code!==201)&&E.jsxs("section",{className:"h-screen flex flex-col justify-center items-center",children:[E.jsx("h1",{className:"text-4xl font-bold",children:"No data found"}),E.jsx("p",{className:"text-lg",children:"Please try again later"}),E.jsx("p",{className:"text-lg",children:"If you're the admin, ensure you have a library, and that you've scanned it."})]})]})}function FD(){var d,f,m;const[t,e]=L.useState(""),[r,n]=L.useState(!0),{searchTerm:i}=L.useContext(wl),{data:s}=ur(t),{data:a,loading:o,interupt:l}=ur("/api/medias/shows");L.useEffect(()=>{o||setTimeout(()=>{n(!1)},500)},[o]),L.useEffect(()=>{if(i===""||i.length<3){e("");return}e(`/api/medias/search/shows?search=${i}`)},[i]),L.useEffect(()=>{const p=new URLSearchParams(window.location.search).get("query");p&&(l(),e(`/api/medias/search/shows?search=${p}`))},[]);const u=["continue_watching","latest","recently_added","top_rated","best_of_year","family","comedy","animated","action","thriller","horror","drama","western"],c={continue_watching:"Continue Watching",latest:"Latest",recently_added:"Recently Added",top_rated:"Top Rated",best_of_year:"Best of the Year",family:"Family",comedy:"Comedy",animated:"Animated",action:"Action",thriller:"Thriller",horror:"Horror",drama:"Drama",western:"Western"};return E.jsxs(E.Fragment,{children:[E.jsx(_s,{className:"h-screen top-0 fixed bg-[--black] w-screen transition-all duration-300 pointer-events-none z-50 "+(r?"opacity-100":"opacity-0")}),!s&&a&&a.data&&E.jsxs("section",{className:`flex flex-col gap-8 pb-8 ${r?"overflow-hidden":""}`,children:[E.jsx(_a,{media:(d=a.data)==null?void 0:d.main_media}),E.jsx("section",{className:"flex flex-col gap-8 pl-4 overflow-hidden",children:u.map((h,p)=>{var v;return((v=a.data[h])==null?void 0:v.length)>0&&E.jsxs("section",{className:"flex flex-col gap-4 ",style:{zIndex:u.length-p},children:[E.jsx("h3",{className:"text-3xl font-bold",children:c[h]}),E.jsx(Ca,{medias:a.data[h],index:u.length-p})]},h)})})]}),s&&E.jsxs("section",{className:`flex flex-col gap-8 pb-8 ${r?"overflow-hidden":""}`,children:[E.jsx(_a,{media:(f=s.data)==null?void 0:f.main_media}),E.jsx("section",{className:"flex flex-col gap-8 pl-4 overflow-hidden",children:E.jsxs("section",{className:"flex flex-col gap-4",children:[E.jsx("h3",{className:"text-3xl font-bold",children:"Results"}),E.jsx(Ca,{medias:(m=s.data)==null?void 0:m.medias,index:0})]})})]}),(s&&s.code!==201||a&&a.code!==201)&&E.jsxs("section",{className:"h-screen flex flex-col justify-center items-center",children:[E.jsx("h1",{className:"text-4xl font-bold",children:"No data found"}),E.jsx("p",{className:"text-lg",children:"Please try again later"}),E.jsx("p",{className:"text-lg",children:"If you're the admin, ensure you have a library, and that you've scanned it."})]})]})}function UD(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var uT={exports:{}};(function(t,e){(function(r){var n=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,i=/^(?=([^\/?#]*))\1([^]*)$/,s=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,o={buildAbsoluteURL:function(l,u,c){if(c=c||{},l=l.trim(),u=u.trim(),!u){if(!c.alwaysNormalize)return l;var d=o.parseURL(l);if(!d)throw new Error("Error trying to parse base URL.");return d.path=o.normalizePath(d.path),o.buildURLFromParts(d)}var f=o.parseURL(u);if(!f)throw new Error("Error trying to parse relative URL.");if(f.scheme)return c.alwaysNormalize?(f.path=o.normalizePath(f.path),o.buildURLFromParts(f)):u;var m=o.parseURL(l);if(!m)throw new Error("Error trying to parse base URL.");if(!m.netLoc&&m.path&&m.path[0]!=="/"){var h=i.exec(m.path);m.netLoc=h[1],m.path=h[2]}m.netLoc&&!m.path&&(m.path="/");var p={scheme:m.scheme,netLoc:f.netLoc,path:null,params:f.params,query:f.query,fragment:f.fragment};if(!f.netLoc&&(p.netLoc=m.netLoc,f.path[0]!=="/"))if(!f.path)p.path=m.path,f.params||(p.params=m.params,f.query||(p.query=m.query));else{var v=m.path,g=v.substring(0,v.lastIndexOf("/")+1)+f.path;p.path=o.normalizePath(g)}return p.path===null&&(p.path=c.alwaysNormalize?o.normalizePath(f.path):f.path),o.buildURLFromParts(p)},parseURL:function(l){var u=n.exec(l);return u?{scheme:u[1]||"",netLoc:u[2]||"",path:u[3]||"",params:u[4]||"",query:u[5]||"",fragment:u[6]||""}:null},normalizePath:function(l){for(l=l.split("").reverse().join("").replace(s,"");l.length!==(l=l.replace(a,"")).length;);return l.split("").reverse().join("")},buildURLFromParts:function(l){return l.scheme+l.netLoc+l.path+l.params+l.query+l.fragment}};t.exports=o})()})(uT);var Lm=uT.exports;function ov(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function jt(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ov(Object(r),!0).forEach(function(n){jD(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ov(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function BD(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $D(t){var e=BD(t,"string");return typeof e=="symbol"?e:String(e)}function jD(t,e,r){return e=$D(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function It(){return It=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},It.apply(this,arguments)}const pe=Number.isFinite||function(t){return typeof t=="number"&&isFinite(t)},VD=Number.isSafeInteger||function(t){return typeof t=="number"&&Math.abs(t)<=GD},GD=Number.MAX_SAFE_INTEGER||9007199254740991;let w=function(t){return t.MEDIA_ATTACHING="hlsMediaAttaching",t.MEDIA_ATTACHED="hlsMediaAttached",t.MEDIA_DETACHING="hlsMediaDetaching",t.MEDIA_DETACHED="hlsMediaDetached",t.BUFFER_RESET="hlsBufferReset",t.BUFFER_CODECS="hlsBufferCodecs",t.BUFFER_CREATED="hlsBufferCreated",t.BUFFER_APPENDING="hlsBufferAppending",t.BUFFER_APPENDED="hlsBufferAppended",t.BUFFER_EOS="hlsBufferEos",t.BUFFER_FLUSHING="hlsBufferFlushing",t.BUFFER_FLUSHED="hlsBufferFlushed",t.MANIFEST_LOADING="hlsManifestLoading",t.MANIFEST_LOADED="hlsManifestLoaded",t.MANIFEST_PARSED="hlsManifestParsed",t.LEVEL_SWITCHING="hlsLevelSwitching",t.LEVEL_SWITCHED="hlsLevelSwitched",t.LEVEL_LOADING="hlsLevelLoading",t.LEVEL_LOADED="hlsLevelLoaded",t.LEVEL_UPDATED="hlsLevelUpdated",t.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",t.LEVELS_UPDATED="hlsLevelsUpdated",t.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",t.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",t.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",t.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",t.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",t.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",t.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",t.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",t.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",t.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",t.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",t.CUES_PARSED="hlsCuesParsed",t.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",t.INIT_PTS_FOUND="hlsInitPtsFound",t.FRAG_LOADING="hlsFragLoading",t.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",t.FRAG_LOADED="hlsFragLoaded",t.FRAG_DECRYPTED="hlsFragDecrypted",t.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",t.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",t.FRAG_PARSING_METADATA="hlsFragParsingMetadata",t.FRAG_PARSED="hlsFragParsed",t.FRAG_BUFFERED="hlsFragBuffered",t.FRAG_CHANGED="hlsFragChanged",t.FPS_DROP="hlsFpsDrop",t.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",t.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",t.ERROR="hlsError",t.DESTROYING="hlsDestroying",t.KEY_LOADING="hlsKeyLoading",t.KEY_LOADED="hlsKeyLoaded",t.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",t.BACK_BUFFER_REACHED="hlsBackBufferReached",t.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",t}({}),_e=function(t){return t.NETWORK_ERROR="networkError",t.MEDIA_ERROR="mediaError",t.KEY_SYSTEM_ERROR="keySystemError",t.MUX_ERROR="muxError",t.OTHER_ERROR="otherError",t}({}),z=function(t){return t.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",t.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",t.KEY_SYSTEM_NO_SESSION="keySystemNoSession",t.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",t.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",t.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",t.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",t.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",t.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",t.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",t.MANIFEST_LOAD_ERROR="manifestLoadError",t.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",t.MANIFEST_PARSING_ERROR="manifestParsingError",t.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",t.LEVEL_EMPTY_ERROR="levelEmptyError",t.LEVEL_LOAD_ERROR="levelLoadError",t.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",t.LEVEL_PARSING_ERROR="levelParsingError",t.LEVEL_SWITCH_ERROR="levelSwitchError",t.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",t.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",t.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",t.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",t.FRAG_LOAD_ERROR="fragLoadError",t.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",t.FRAG_DECRYPT_ERROR="fragDecryptError",t.FRAG_PARSING_ERROR="fragParsingError",t.FRAG_GAP="fragGap",t.REMUX_ALLOC_ERROR="remuxAllocError",t.KEY_LOAD_ERROR="keyLoadError",t.KEY_LOAD_TIMEOUT="keyLoadTimeOut",t.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",t.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",t.BUFFER_APPEND_ERROR="bufferAppendError",t.BUFFER_APPENDING_ERROR="bufferAppendingError",t.BUFFER_STALLED_ERROR="bufferStalledError",t.BUFFER_FULL_ERROR="bufferFullError",t.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",t.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",t.INTERNAL_EXCEPTION="internalException",t.INTERNAL_ABORTED="aborted",t.UNKNOWN="unknown",t}({});const es=function(){},Wh={trace:es,debug:es,log:es,warn:es,info:es,error:es};let Co=Wh;function zD(t){const e=self.console[t];return e?e.bind(self.console,`[${t}] >`):es}function HD(t,...e){e.forEach(function(r){Co[r]=t[r]?t[r].bind(t):zD(r)})}function WD(t,e){if(typeof console=="object"&&t===!0||typeof t=="object"){HD(t,"debug","log","info","warn","error");try{Co.log(`Debug logs enabled for "${e}" in hls.js version 1.5.15`)}catch{Co=Wh}}else Co=Wh}const U=Co,KD=/^(\d+)x(\d+)$/,lv=/(.+?)=(".*?"|.*?)(?:,|$)/g;class gt{constructor(e){typeof e=="string"&&(e=gt.parseAttrList(e)),It(this,e)}get clientAttrs(){return Object.keys(this).filter(e=>e.substring(0,2)==="X-")}decimalInteger(e){const r=parseInt(this[e],10);return r>Number.MAX_SAFE_INTEGER?1/0:r}hexadecimalInteger(e){if(this[e]){let r=(this[e]||"0x").slice(2);r=(r.length&1?"0":"")+r;const n=new Uint8Array(r.length/2);for(let i=0;i<r.length/2;i++)n[i]=parseInt(r.slice(i*2,i*2+2),16);return n}else return null}hexadecimalIntegerAsNumber(e){const r=parseInt(this[e],16);return r>Number.MAX_SAFE_INTEGER?1/0:r}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,r){const n=this[e];return n?parseFloat(n):r}enumeratedString(e){return this[e]}bool(e){return this[e]==="YES"}decimalResolution(e){const r=KD.exec(this[e]);if(r!==null)return{width:parseInt(r[1],10),height:parseInt(r[2],10)}}static parseAttrList(e){let r;const n={},i='"';for(lv.lastIndex=0;(r=lv.exec(e))!==null;){let s=r[2];s.indexOf(i)===0&&s.lastIndexOf(i)===s.length-1&&(s=s.slice(1,-1));const a=r[1].trim();n[a]=s}return n}}function YD(t){return t!=="ID"&&t!=="CLASS"&&t!=="START-DATE"&&t!=="DURATION"&&t!=="END-DATE"&&t!=="END-ON-NEXT"}function qD(t){return t==="SCTE35-OUT"||t==="SCTE35-IN"}class cT{constructor(e,r){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,r){const n=r.attr;for(const i in n)if(Object.prototype.hasOwnProperty.call(e,i)&&e[i]!==n[i]){U.warn(`DATERANGE tag attribute: "${i}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=i;break}e=It(new gt({}),n,e)}if(this.attr=e,this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const n=new Date(this.attr["END-DATE"]);pe(n.getTime())&&(this._endDate=n)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get startDate(){return this._startDate}get endDate(){if(this._endDate)return this._endDate;const e=this.duration;return e!==null?new Date(this._startDate.getTime()+e*1e3):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(pe(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isValid(){return!!this.id&&!this._badValueForSameId&&pe(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)}}class Td{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var Je={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class dT{constructor(e){this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams={[Je.AUDIO]:null,[Je.VIDEO]:null,[Je.AUDIOVIDEO]:null},this.baseurl=e}setByteRange(e,r){const n=e.split("@",2);let i;n.length===1?i=(r==null?void 0:r.byteRangeEndOffset)||0:i=parseInt(n[1]),this._byteRange=[i,parseInt(n[0])+i]}get byteRange(){return this._byteRange?this._byteRange:[]}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=Lm.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}}class yf extends dT{constructor(e,r){super(r),this._decryptdata=null,this.rawProgramDateTime=null,this.programDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.stats=new Td,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=e}get decryptdata(){const{levelkeys:e}=this;if(!e&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const r=this.levelkeys.identity;if(r)this._decryptdata=r.getDecryptData(this.sn);else{const n=Object.keys(this.levelkeys);if(n.length===1)return this._decryptdata=this.levelkeys[n[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null||!pe(this.programDateTime))return null;const e=pe(this.duration)?this.duration:0;return this.programDateTime+e*1e3}get encrypted(){var e;if((e=this._decryptdata)!=null&&e.encrypted)return!0;if(this.levelkeys){const r=Object.keys(this.levelkeys),n=r.length;if(n>1||n===1&&this.levelkeys[r[0]].encrypted)return!0}return!1}setKeyFormat(e){if(this.levelkeys){const r=this.levelkeys[e];r&&!this._decryptdata&&(this._decryptdata=r.getDecryptData(this.sn))}}abortRequests(){var e,r;(e=this.loader)==null||e.abort(),(r=this.keyLoader)==null||r.abort()}setElementaryStreamInfo(e,r,n,i,s,a=!1){const{elementaryStreams:o}=this,l=o[e];if(!l){o[e]={startPTS:r,endPTS:n,startDTS:i,endDTS:s,partial:a};return}l.startPTS=Math.min(l.startPTS,r),l.endPTS=Math.max(l.endPTS,n),l.startDTS=Math.min(l.startDTS,i),l.endDTS=Math.max(l.endDTS,s)}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[Je.AUDIO]=null,e[Je.VIDEO]=null,e[Je.AUDIOVIDEO]=null}}class XD extends dT{constructor(e,r,n,i,s){super(n),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.stats=new Td,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=r,this.index=i;const a=e.enumeratedString("BYTERANGE");a&&this.setByteRange(a,s),s&&(this.fragOffset=s.fragOffset+s.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}const ZD=10;class QD{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e){this.advanced=!0,this.updated=!0;return}const r=this.lastPartSn-e.lastPartSn,n=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!n||!!r||!this.live,this.advanced=this.endSN>e.endSN||r>0||r===0&&n>0,this.updated||this.advanced?this.misses=Math.floor(e.misses*.6):this.misses=e.misses+1,this.availabilityDelay=e.availabilityDelay}get hasProgramDateTime(){return this.fragments.length?pe(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||ZD}get drift(){const e=this.driftEndTime-this.driftStartTime;return e>0?(this.driftEnd-this.driftStart)*1e3/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var e;return(e=this.fragments)!=null&&e.length?this.fragments[this.fragments.length-1].end:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].index:-1}get lastPartSn(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}function Am(t){return Uint8Array.from(atob(t),e=>e.charCodeAt(0))}function JD(t){const e=Kh(t).subarray(0,16),r=new Uint8Array(16);return r.set(e,16-e.length),r}function eP(t){const e=function(n,i,s){const a=n[i];n[i]=n[s],n[s]=a};e(t,0,3),e(t,1,2),e(t,4,5),e(t,6,7)}function tP(t){const e=t.split(":");let r=null;if(e[0]==="data"&&e.length===2){const n=e[1].split(";"),i=n[n.length-1].split(",");if(i.length===2){const s=i[0]==="base64",a=i[1];s?(n.splice(-1,1),r=Am(a)):r=JD(a)}}return r}function Kh(t){return Uint8Array.from(unescape(encodeURIComponent(t)),e=>e.charCodeAt(0))}const Ra=typeof self<"u"?self:void 0;var ot={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},yr={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function uv(t){switch(t){case yr.FAIRPLAY:return ot.FAIRPLAY;case yr.PLAYREADY:return ot.PLAYREADY;case yr.WIDEVINE:return ot.WIDEVINE;case yr.CLEARKEY:return ot.CLEARKEY}}var ho={CENC:"1077efecc0b24d02ace33c1e52e2fb4b",CLEARKEY:"e2719d58a985b3c9781ab030af78d30e",FAIRPLAY:"94ce86fb07ff4f43adb893d2fa968ca2",PLAYREADY:"9a04f07998404286ab92e65be0885f95",WIDEVINE:"edef8ba979d64acea3c827dcd51d21ed"};function cv(t){if(t===ho.WIDEVINE)return ot.WIDEVINE;if(t===ho.PLAYREADY)return ot.PLAYREADY;if(t===ho.CENC||t===ho.CLEARKEY)return ot.CLEARKEY}function dv(t){switch(t){case ot.FAIRPLAY:return yr.FAIRPLAY;case ot.PLAYREADY:return yr.PLAYREADY;case ot.WIDEVINE:return yr.WIDEVINE;case ot.CLEARKEY:return yr.CLEARKEY}}function xf(t){const{drmSystems:e,widevineLicenseUrl:r}=t,n=e?[ot.FAIRPLAY,ot.WIDEVINE,ot.PLAYREADY,ot.CLEARKEY].filter(i=>!!e[i]):[];return!n[ot.WIDEVINE]&&r&&n.push(ot.WIDEVINE),n}const fT=function(t){return Ra!=null&&(t=Ra.navigator)!=null&&t.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}();function rP(t,e,r,n){let i;switch(t){case ot.FAIRPLAY:i=["cenc","sinf"];break;case ot.WIDEVINE:case ot.PLAYREADY:i=["cenc"];break;case ot.CLEARKEY:i=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${t}`)}return nP(i,e,r,n)}function nP(t,e,r,n){return[{initDataTypes:t,persistentState:n.persistentState||"optional",distinctiveIdentifier:n.distinctiveIdentifier||"optional",sessionTypes:n.sessionTypes||[n.sessionType||"temporary"],audioCapabilities:e.map(s=>({contentType:`audio/mp4; codecs="${s}"`,robustness:n.audioRobustness||"",encryptionScheme:n.audioEncryptionScheme||null})),videoCapabilities:r.map(s=>({contentType:`video/mp4; codecs="${s}"`,robustness:n.videoRobustness||"",encryptionScheme:n.videoEncryptionScheme||null}))}]}function hs(t,e,r){return Uint8Array.prototype.slice?t.slice(e,r):new Uint8Array(Array.prototype.slice.call(t,e,r))}const _m=(t,e)=>e+10<=t.length&&t[e]===73&&t[e+1]===68&&t[e+2]===51&&t[e+3]<255&&t[e+4]<255&&t[e+6]<128&&t[e+7]<128&&t[e+8]<128&&t[e+9]<128,hT=(t,e)=>e+10<=t.length&&t[e]===51&&t[e+1]===68&&t[e+2]===73&&t[e+3]<255&&t[e+4]<255&&t[e+6]<128&&t[e+7]<128&&t[e+8]<128&&t[e+9]<128,fl=(t,e)=>{const r=e;let n=0;for(;_m(t,e);){n+=10;const i=wd(t,e+6);n+=i,hT(t,e+10)&&(n+=10),e+=n}if(n>0)return t.subarray(r,r+n)},wd=(t,e)=>{let r=0;return r=(t[e]&127)<<21,r|=(t[e+1]&127)<<14,r|=(t[e+2]&127)<<7,r|=t[e+3]&127,r},iP=(t,e)=>_m(t,e)&&wd(t,e+6)+10<=t.length-e,Cm=t=>{const e=mT(t);for(let r=0;r<e.length;r++){const n=e[r];if(pT(n))return cP(n)}},pT=t=>t&&t.key==="PRIV"&&t.info==="com.apple.streaming.transportStreamTimestamp",sP=t=>{const e=String.fromCharCode(t[0],t[1],t[2],t[3]),r=wd(t,4),n=10;return{type:e,size:r,data:t.subarray(n,n+r)}},mT=t=>{let e=0;const r=[];for(;_m(t,e);){const n=wd(t,e+6);e+=10;const i=e+n;for(;e+8<i;){const s=sP(t.subarray(e)),a=aP(s);a&&r.push(a),e+=s.size+10}hT(t,e)&&(e+=10)}return r},aP=t=>t.type==="PRIV"?oP(t):t.type[0]==="W"?uP(t):lP(t),oP=t=>{if(t.size<2)return;const e=Nn(t.data,!0),r=new Uint8Array(t.data.subarray(e.length+1));return{key:t.type,info:e,data:r.buffer}},lP=t=>{if(t.size<2)return;if(t.type==="TXXX"){let r=1;const n=Nn(t.data.subarray(r),!0);r+=n.length+1;const i=Nn(t.data.subarray(r));return{key:t.type,info:n,data:i}}const e=Nn(t.data.subarray(1));return{key:t.type,data:e}},uP=t=>{if(t.type==="WXXX"){if(t.size<2)return;let r=1;const n=Nn(t.data.subarray(r),!0);r+=n.length+1;const i=Nn(t.data.subarray(r));return{key:t.type,info:n,data:i}}const e=Nn(t.data);return{key:t.type,data:e}},cP=t=>{if(t.data.byteLength===8){const e=new Uint8Array(t.data),r=e[3]&1;let n=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return n/=45,r&&(n+=4772185884e-2),Math.round(n)}},Nn=(t,e=!1)=>{const r=dP();if(r){const u=r.decode(t);if(e){const c=u.indexOf("\0");return c!==-1?u.substring(0,c):u}return u.replace(/\0/g,"")}const n=t.length;let i,s,a,o="",l=0;for(;l<n;){if(i=t[l++],i===0&&e)return o;if(i===0||i===3)continue;switch(i>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:o+=String.fromCharCode(i);break;case 12:case 13:s=t[l++],o+=String.fromCharCode((i&31)<<6|s&63);break;case 14:s=t[l++],a=t[l++],o+=String.fromCharCode((i&15)<<12|(s&63)<<6|(a&63)<<0);break}}return o};let Sf;function dP(){if(!navigator.userAgent.includes("PlayStation 4"))return!Sf&&typeof self.TextDecoder<"u"&&(Sf=new self.TextDecoder("utf-8")),Sf}const bn={hexDump:function(t){let e="";for(let r=0;r<t.length;r++){let n=t[r].toString(16);n.length<2&&(n="0"+n),e+=n}return e}},Mc=Math.pow(2,32)-1,fP=[].push,gT={video:1,audio:2,id3:3,text:4};function Dt(t){return String.fromCharCode.apply(null,t)}function vT(t,e){const r=t[e]<<8|t[e+1];return r<0?65536+r:r}function Te(t,e){const r=yT(t,e);return r<0?4294967296+r:r}function fv(t,e){let r=Te(t,e);return r*=Math.pow(2,32),r+=Te(t,e+4),r}function yT(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}function Ef(t,e,r){t[e]=r>>24,t[e+1]=r>>16&255,t[e+2]=r>>8&255,t[e+3]=r&255}function hP(t){const e=t.byteLength;for(let r=0;r<e;){const n=Te(t,r);if(n>8&&t[r+4]===109&&t[r+5]===111&&t[r+6]===111&&t[r+7]===102)return!0;r=n>1?r+n:e}return!1}function Oe(t,e){const r=[];if(!e.length)return r;const n=t.byteLength;for(let i=0;i<n;){const s=Te(t,i),a=Dt(t.subarray(i+4,i+8)),o=s>1?i+s:n;if(a===e[0])if(e.length===1)r.push(t.subarray(i+8,o));else{const l=Oe(t.subarray(i+8,o),e.slice(1));l.length&&fP.apply(r,l)}i=o}return r}function pP(t){const e=[],r=t[0];let n=8;const i=Te(t,n);n+=4;let s=0,a=0;r===0?(s=Te(t,n),a=Te(t,n+4),n+=8):(s=fv(t,n),a=fv(t,n+8),n+=16),n+=2;let o=t.length+a;const l=vT(t,n);n+=2;for(let u=0;u<l;u++){let c=n;const d=Te(t,c);c+=4;const f=d&2147483647;if((d&2147483648)>>>31===1)return U.warn("SIDX has hierarchical references (not supported)"),null;const h=Te(t,c);c+=4,e.push({referenceSize:f,subsegmentDuration:h,info:{duration:h/i,start:o,end:o+f-1}}),o+=f,c+=4,n=c}return{earliestPresentationTime:s,timescale:i,version:r,referencesCount:l,references:e}}function xT(t){const e=[],r=Oe(t,["moov","trak"]);for(let i=0;i<r.length;i++){const s=r[i],a=Oe(s,["tkhd"])[0];if(a){let o=a[0];const l=Te(a,o===0?12:20),u=Oe(s,["mdia","mdhd"])[0];if(u){o=u[0];const c=Te(u,o===0?12:20),d=Oe(s,["mdia","hdlr"])[0];if(d){const f=Dt(d.subarray(8,12)),m={soun:Je.AUDIO,vide:Je.VIDEO}[f];if(m){const h=Oe(s,["mdia","minf","stbl","stsd"])[0],p=mP(h);e[l]={timescale:c,type:m},e[m]=jt({timescale:c,id:l},p)}}}}}return Oe(t,["moov","mvex","trex"]).forEach(i=>{const s=Te(i,4),a=e[s];a&&(a.default={duration:Te(i,12),flags:Te(i,20)})}),e}function mP(t){const e=t.subarray(8),r=e.subarray(86),n=Dt(e.subarray(4,8));let i=n;const s=n==="enca"||n==="encv";if(s){const o=Oe(e,[n])[0].subarray(n==="enca"?28:78);Oe(o,["sinf"]).forEach(u=>{const c=Oe(u,["schm"])[0];if(c){const d=Dt(c.subarray(4,8));if(d==="cbcs"||d==="cenc"){const f=Oe(u,["frma"])[0];f&&(i=Dt(f))}}})}switch(i){case"avc1":case"avc2":case"avc3":case"avc4":{const a=Oe(r,["avcC"])[0];i+="."+tu(a[1])+tu(a[2])+tu(a[3]);break}case"mp4a":{const a=Oe(e,[n])[0],o=Oe(a.subarray(28),["esds"])[0];if(o&&o.length>12){let l=4;if(o[l++]!==3)break;l=Tf(o,l),l+=2;const u=o[l++];if(u&128&&(l+=2),u&64&&(l+=o[l++]),o[l++]!==4)break;l=Tf(o,l);const c=o[l++];if(c===64)i+="."+tu(c);else break;if(l+=12,o[l++]!==5)break;l=Tf(o,l);const d=o[l++];let f=(d&248)>>3;f===31&&(f+=1+((d&7)<<3)+((o[l]&224)>>5)),i+="."+f}break}case"hvc1":case"hev1":{const a=Oe(r,["hvcC"])[0],o=a[1],l=["","A","B","C"][o>>6],u=o&31,c=Te(a,2),d=(o&32)>>5?"H":"L",f=a[12],m=a.subarray(6,12);i+="."+l+u,i+="."+c.toString(16).toUpperCase(),i+="."+d+f;let h="";for(let p=m.length;p--;){const v=m[p];(v||h)&&(h="."+v.toString(16).toUpperCase()+h)}i+=h;break}case"dvh1":case"dvhe":{const a=Oe(r,["dvcC"])[0],o=a[2]>>1&127,l=a[2]<<5&32|a[3]>>3&31;i+="."+Tn(o)+"."+Tn(l);break}case"vp09":{const a=Oe(r,["vpcC"])[0],o=a[4],l=a[5],u=a[6]>>4&15;i+="."+Tn(o)+"."+Tn(l)+"."+Tn(u);break}case"av01":{const a=Oe(r,["av1C"])[0],o=a[1]>>>5,l=a[1]&31,u=a[2]>>>7?"H":"M",c=(a[2]&64)>>6,d=(a[2]&32)>>5,f=o===2&&c?d?12:10:c?10:8,m=(a[2]&16)>>4,h=(a[2]&8)>>3,p=(a[2]&4)>>2,v=a[2]&3;i+="."+o+"."+Tn(l)+u+"."+Tn(f)+"."+m+"."+h+p+v+"."+Tn(1)+"."+Tn(1)+"."+Tn(1)+"."+0;break}}return{codec:i,encrypted:s}}function Tf(t,e){const r=e+5;for(;t[e++]&128&&e<r;);return e}function tu(t){return("0"+t.toString(16).toUpperCase()).slice(-2)}function Tn(t){return(t<10?"0":"")+t}function gP(t,e){if(!t||!e)return t;const r=e.keyId;return r&&e.isCommonEncryption&&Oe(t,["moov","trak"]).forEach(i=>{const a=Oe(i,["mdia","minf","stbl","stsd"])[0].subarray(8);let o=Oe(a,["enca"]);const l=o.length>0;l||(o=Oe(a,["encv"])),o.forEach(u=>{const c=l?u.subarray(28):u.subarray(78);Oe(c,["sinf"]).forEach(f=>{const m=ST(f);if(m){const h=m.subarray(8,24);h.some(p=>p!==0)||(U.log(`[eme] Patching keyId in 'enc${l?"a":"v"}>sinf>>tenc' box: ${bn.hexDump(h)} -> ${bn.hexDump(r)}`),m.set(r,8))}})})}),t}function ST(t){const e=Oe(t,["schm"])[0];if(e){const r=Dt(e.subarray(4,8));if(r==="cbcs"||r==="cenc")return Oe(t,["schi","tenc"])[0]}return null}function vP(t,e){return Oe(e,["moof","traf"]).reduce((r,n)=>{const i=Oe(n,["tfdt"])[0],s=i[0],a=Oe(n,["tfhd"]).reduce((o,l)=>{const u=Te(l,4),c=t[u];if(c){let d=Te(i,4);if(s===1){if(d===Mc)return U.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),o;d*=Mc+1,d+=Te(i,8)}const f=c.timescale||9e4,m=d/f;if(pe(m)&&(o===null||m<o))return m}return o},null);return a!==null&&pe(a)&&(r===null||a<r)?a:r},null)}function yP(t,e){let r=0,n=0,i=0;const s=Oe(t,["moof","traf"]);for(let a=0;a<s.length;a++){const o=s[a],l=Oe(o,["tfhd"])[0],u=Te(l,4),c=e[u];if(!c)continue;const d=c.default,f=Te(l,0)|(d==null?void 0:d.flags);let m=d==null?void 0:d.duration;f&8&&(f&2?m=Te(l,12):m=Te(l,8));const h=c.timescale||9e4,p=Oe(o,["trun"]);for(let v=0;v<p.length;v++){if(r=xP(p[v]),!r&&m){const g=Te(p[v],4);r=m*g}c.type===Je.VIDEO?n+=r/h:c.type===Je.AUDIO&&(i+=r/h)}}if(n===0&&i===0){let a=1/0,o=0,l=0;const u=Oe(t,["sidx"]);for(let c=0;c<u.length;c++){const d=pP(u[c]);if(d!=null&&d.references){a=Math.min(a,d.earliestPresentationTime/d.timescale);const f=d.references.reduce((m,h)=>m+h.info.duration||0,0);o=Math.max(o,f+d.earliestPresentationTime/d.timescale),l=o-a}}if(l&&pe(l))return l}return n||i}function xP(t){const e=Te(t,0);let r=8;e&1&&(r+=4),e&4&&(r+=4);let n=0;const i=Te(t,4);for(let s=0;s<i;s++){if(e&256){const a=Te(t,r);n+=a,r+=4}e&512&&(r+=4),e&1024&&(r+=4),e&2048&&(r+=4)}return n}function SP(t,e,r){Oe(e,["moof","traf"]).forEach(n=>{Oe(n,["tfhd"]).forEach(i=>{const s=Te(i,4),a=t[s];if(!a)return;const o=a.timescale||9e4;Oe(n,["tfdt"]).forEach(l=>{const u=l[0],c=r*o;if(c){let d=Te(l,4);if(u===0)d-=c,d=Math.max(d,0),Ef(l,4,d);else{d*=Math.pow(2,32),d+=Te(l,8),d-=c,d=Math.max(d,0);const f=Math.floor(d/(Mc+1)),m=Math.floor(d%(Mc+1));Ef(l,4,f),Ef(l,8,m)}}})})})}function EP(t){const e={valid:null,remainder:null},r=Oe(t,["moof"]);if(r.length<2)return e.remainder=t,e;const n=r[r.length-1];return e.valid=hs(t,0,n.byteOffset-8),e.remainder=hs(t,n.byteOffset-8),e}function Jr(t,e){const r=new Uint8Array(t.length+e.length);return r.set(t),r.set(e,t.length),r}function hv(t,e){const r=[],n=e.samples,i=e.timescale,s=e.id;let a=!1;return Oe(n,["moof"]).map(l=>{const u=l.byteOffset-8;Oe(l,["traf"]).map(d=>{const f=Oe(d,["tfdt"]).map(m=>{const h=m[0];let p=Te(m,4);return h===1&&(p*=Math.pow(2,32),p+=Te(m,8)),p/i})[0];return f!==void 0&&(t=f),Oe(d,["tfhd"]).map(m=>{const h=Te(m,4),p=Te(m,0)&16777215,v=(p&1)!==0,g=(p&2)!==0,y=(p&8)!==0;let x=0;const S=(p&16)!==0;let T=0;const C=(p&32)!==0;let _=8;h===s&&(v&&(_+=8),g&&(_+=4),y&&(x=Te(m,_),_+=4),S&&(T=Te(m,_),_+=4),C&&(_+=4),e.type==="video"&&(a=TP(e.codec)),Oe(d,["trun"]).map(b=>{const I=b[0],A=Te(b,0)&16777215,k=(A&1)!==0;let O=0;const P=(A&4)!==0,G=(A&256)!==0;let K=0;const H=(A&512)!==0;let se=0;const W=(A&1024)!==0,F=(A&2048)!==0;let j=0;const te=Te(b,4);let ee=8;k&&(O=Te(b,ee),ee+=4),P&&(ee+=4);let fe=O+u;for(let ye=0;ye<te;ye++){if(G?(K=Te(b,ee),ee+=4):K=x,H?(se=Te(b,ee),ee+=4):se=T,W&&(ee+=4),F&&(I===0?j=Te(b,ee):j=yT(b,ee),ee+=4),e.type===Je.VIDEO){let Re=0;for(;Re<se;){const Ee=Te(n,fe);if(fe+=4,wP(a,n[fe])){const Fe=n.subarray(fe,fe+Ee);ET(Fe,a?2:1,t+j/i,r)}fe+=Ee,Re+=Ee+4}}t+=K/i}}))})})}),r}function TP(t){if(!t)return!1;const e=t.indexOf("."),r=e<0?t:t.substring(0,e);return r==="hvc1"||r==="hev1"||r==="dvh1"||r==="dvhe"}function wP(t,e){if(t){const r=e>>1&63;return r===39||r===40}else return(e&31)===6}function ET(t,e,r,n){const i=TT(t);let s=0;s+=e;let a=0,o=0,l=0;for(;s<i.length;){a=0;do{if(s>=i.length)break;l=i[s++],a+=l}while(l===255);o=0;do{if(s>=i.length)break;l=i[s++],o+=l}while(l===255);const u=i.length-s;let c=s;if(o<u)s+=o;else if(o>u){U.error(`Malformed SEI payload. ${o} is too small, only ${u} bytes left to parse.`);break}if(a===4){if(i[c++]===181){const f=vT(i,c);if(c+=2,f===49){const m=Te(i,c);if(c+=4,m===1195456820){const h=i[c++];if(h===3){const p=i[c++],v=31&p,g=64&p,y=g?2+v*3:0,x=new Uint8Array(y);if(g){x[0]=p;for(let S=1;S<y;S++)x[S]=i[c++]}n.push({type:h,payloadType:a,pts:r,bytes:x})}}}}}else if(a===5&&o>16){const d=[];for(let h=0;h<16;h++){const p=i[c++].toString(16);d.push(p.length==1?"0"+p:p),(h===3||h===5||h===7||h===9)&&d.push("-")}const f=o-16,m=new Uint8Array(f);for(let h=0;h<f;h++)m[h]=i[c++];n.push({payloadType:a,pts:r,uuid:d.join(""),userData:Nn(m),userDataBytes:m})}}}function TT(t){const e=t.byteLength,r=[];let n=1;for(;n<e-2;)t[n]===0&&t[n+1]===0&&t[n+2]===3?(r.push(n+2),n+=2):n++;if(r.length===0)return t;const i=e-r.length,s=new Uint8Array(i);let a=0;for(n=0;n<i;a++,n++)a===r[0]&&(a++,r.shift()),s[n]=t[a];return s}function bP(t){const e=t[0];let r="",n="",i=0,s=0,a=0,o=0,l=0,u=0;if(e===0){for(;Dt(t.subarray(u,u+1))!=="\0";)r+=Dt(t.subarray(u,u+1)),u+=1;for(r+=Dt(t.subarray(u,u+1)),u+=1;Dt(t.subarray(u,u+1))!=="\0";)n+=Dt(t.subarray(u,u+1)),u+=1;n+=Dt(t.subarray(u,u+1)),u+=1,i=Te(t,12),s=Te(t,16),o=Te(t,20),l=Te(t,24),u=28}else if(e===1){u+=4,i=Te(t,u),u+=4;const d=Te(t,u);u+=4;const f=Te(t,u);for(u+=4,a=2**32*d+f,VD(a)||(a=Number.MAX_SAFE_INTEGER,U.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),o=Te(t,u),u+=4,l=Te(t,u),u+=4;Dt(t.subarray(u,u+1))!=="\0";)r+=Dt(t.subarray(u,u+1)),u+=1;for(r+=Dt(t.subarray(u,u+1)),u+=1;Dt(t.subarray(u,u+1))!=="\0";)n+=Dt(t.subarray(u,u+1)),u+=1;n+=Dt(t.subarray(u,u+1)),u+=1}const c=t.subarray(u,t.byteLength);return{schemeIdUri:r,value:n,timeScale:i,presentationTime:a,presentationTimeDelta:s,eventDuration:o,id:l,payload:c}}function LP(t,...e){const r=e.length;let n=8,i=r;for(;i--;)n+=e[i].byteLength;const s=new Uint8Array(n);for(s[0]=n>>24&255,s[1]=n>>16&255,s[2]=n>>8&255,s[3]=n&255,s.set(t,4),i=0,n=8;i<r;i++)s.set(e[i],n),n+=e[i].byteLength;return s}function AP(t,e,r){if(t.byteLength!==16)throw new RangeError("Invalid system id");let n,i;n=0,i=new Uint8Array;let s;n>0?(s=new Uint8Array(4),e.length>0&&new DataView(s.buffer).setUint32(0,e.length,!1)):s=new Uint8Array;const a=new Uint8Array(4);return r&&r.byteLength>0&&new DataView(a.buffer).setUint32(0,r.byteLength,!1),LP([112,115,115,104],new Uint8Array([n,0,0,0]),t,s,i,a,r||new Uint8Array)}function _P(t){const e=[];if(t instanceof ArrayBuffer){const r=t.byteLength;let n=0;for(;n+32<r;){const i=new DataView(t,n),s=CP(i);e.push(s),n+=s.size}}return e}function CP(t){const e=t.getUint32(0),r=t.byteOffset,n=t.byteLength;if(n<e)return{offset:r,size:n};if(t.getUint32(4)!==1886614376)return{offset:r,size:e};const s=t.getUint32(8)>>>24;if(s!==0&&s!==1)return{offset:r,size:e};const a=t.buffer,o=bn.hexDump(new Uint8Array(a,r+12,16)),l=t.getUint32(28);let u=null,c=null;if(s===0){if(e-32<l||l<22)return{offset:r,size:e};c=new Uint8Array(a,r+32,l)}else if(s===1){if(!l||n<r+32+l*16+16)return{offset:r,size:e};u=[];for(let d=0;d<l;d++)u.push(new Uint8Array(a,r+32+d*16,16))}return{version:s,systemId:o,kids:u,data:c,offset:r,size:e}}let ru={};class hl{static clearKeyUriToKeyIdMap(){ru={}}constructor(e,r,n,i=[1],s=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=r,this.keyFormat=n,this.keyFormatVersions=i,this.iv=s,this.encrypted=e?e!=="NONE":!1,this.isCommonEncryption=this.encrypted&&e!=="AES-128"}isSupported(){if(this.method){if(this.method==="AES-128"||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case yr.FAIRPLAY:case yr.WIDEVINE:case yr.PLAYREADY:case yr.CLEARKEY:return["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(e){if(!this.encrypted||!this.uri)return null;if(this.method==="AES-128"&&this.uri&&!this.iv){typeof e!="number"&&(this.method==="AES-128"&&!this.iv&&U.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0);const n=RP(e);return new hl(this.method,this.uri,"identity",this.keyFormatVersions,n)}const r=tP(this.uri);if(r)switch(this.keyFormat){case yr.WIDEVINE:this.pssh=r,r.length>=22&&(this.keyId=r.subarray(r.length-22,r.length-6));break;case yr.PLAYREADY:{const n=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=AP(n,null,r);const i=new Uint16Array(r.buffer,r.byteOffset,r.byteLength/2),s=String.fromCharCode.apply(null,Array.from(i)),a=s.substring(s.indexOf("<"),s.length),u=new DOMParser().parseFromString(a,"text/xml").getElementsByTagName("KID")[0];if(u){const c=u.childNodes[0]?u.childNodes[0].nodeValue:u.getAttribute("VALUE");if(c){const d=Am(c).subarray(0,16);eP(d),this.keyId=d}}break}default:{let n=r.subarray(0,16);if(n.length!==16){const i=new Uint8Array(16);i.set(n,16-n.length),n=i}this.keyId=n;break}}if(!this.keyId||this.keyId.byteLength!==16){let n=ru[this.uri];if(!n){const i=Object.keys(ru).length%Number.MAX_SAFE_INTEGER;n=new Uint8Array(16),new DataView(n.buffer,12,4).setUint32(0,i),ru[this.uri]=n}this.keyId=n}return this}}function RP(t){const e=new Uint8Array(16);for(let r=12;r<16;r++)e[r]=t>>8*(15-r)&255;return e}const wT=/\{\$([a-zA-Z0-9-_]+)\}/g;function pv(t){return wT.test(t)}function pr(t,e,r){if(t.variableList!==null||t.hasVariableRefs)for(let n=r.length;n--;){const i=r[n],s=e[i];s&&(e[i]=Yh(t,s))}}function Yh(t,e){if(t.variableList!==null||t.hasVariableRefs){const r=t.variableList;return e.replace(wT,n=>{const i=n.substring(2,n.length-1),s=r==null?void 0:r[i];return s===void 0?(t.playlistParsingError||(t.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${i}"`)),n):s})}return e}function mv(t,e,r){let n=t.variableList;n||(t.variableList=n={});let i,s;if("QUERYPARAM"in e){i=e.QUERYPARAM;try{const a=new self.URL(r).searchParams;if(a.has(i))s=a.get(i);else throw new Error(`"${i}" does not match any query parameter in URI: "${r}"`)}catch(a){t.playlistParsingError||(t.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${a.message}`))}}else i=e.NAME,s=e.VALUE;i in n?t.playlistParsingError||(t.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${i}"`)):n[i]=s||""}function IP(t,e,r){const n=e.IMPORT;if(r&&n in r){let i=t.variableList;i||(t.variableList=i={}),i[n]=r[n]}else t.playlistParsingError||(t.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${n}"`))}function bs(t=!0){return typeof self>"u"?void 0:(t||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function kP(t){return typeof self<"u"&&t===self.ManagedMediaSource}const Nc={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function DP(t,e){const r=Nc[e];return!!r&&!!r[t.slice(0,4)]}function wf(t,e,r=!0){return!t.split(",").some(n=>!bT(n,e,r))}function bT(t,e,r=!0){var n;const i=bs(r);return(n=i==null?void 0:i.isTypeSupported(pl(t,e)))!=null?n:!1}function pl(t,e){return`${e}/mp4;codecs="${t}"`}function gv(t){if(t){const e=t.substring(0,4);return Nc.video[e]}return 2}function Fc(t){return t.split(",").reduce((e,r)=>{const n=Nc.video[r];return n?(n*2+e)/(e?3:2):(Nc.audio[r]+e)/(e?2:1)},0)}const bf={};function PP(t,e=!0){if(bf[t])return bf[t];const r={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"]}[t];for(let n=0;n<r.length;n++)if(bT(r[n],"audio",e))return bf[t]=r[n],r[n];return t}const OP=/flac|opus/i;function Uc(t,e=!0){return t.replace(OP,r=>PP(r.toLowerCase(),e))}function vv(t,e){return t&&t!=="mp4a"?t:e&&e.split(",")[0]}function MP(t){const e=t.split(",");for(let r=0;r<e.length;r++){const n=e[r].split(".");if(n.length>2){let i=n.shift()+".";i+=parseInt(n.shift()).toString(16),i+=("000"+parseInt(n.shift()).toString(16)).slice(-4),e[r]=i}}return e.join(",")}const yv=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,xv=/#EXT-X-MEDIA:(.*)/g,NP=/^#EXT(?:INF|-X-TARGETDURATION):/m,Sv=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),FP=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class kn{static findGroup(e,r){for(let n=0;n<e.length;n++){const i=e[n];if(i.id===r)return i}}static resolve(e,r){return Lm.buildAbsoluteURL(r,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return NP.test(e)}static parseMasterPlaylist(e,r){const n=pv(e),i={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:n},s=[];yv.lastIndex=0;let a;for(;(a=yv.exec(e))!=null;)if(a[1]){var o;const u=new gt(a[1]);pr(i,u,["CODECS","SUPPLEMENTAL-CODECS","ALLOWED-CPC","PATHWAY-ID","STABLE-VARIANT-ID","AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS","NAME"]);const c=Yh(i,a[2]),d={attrs:u,bitrate:u.decimalInteger("BANDWIDTH")||u.decimalInteger("AVERAGE-BANDWIDTH"),name:u.NAME,url:kn.resolve(c,r)},f=u.decimalResolution("RESOLUTION");f&&(d.width=f.width,d.height=f.height),UP(u.CODECS,d),(o=d.unknownCodecs)!=null&&o.length||s.push(d),i.levels.push(d)}else if(a[3]){const u=a[3],c=a[4];switch(u){case"SESSION-DATA":{const d=new gt(c);pr(i,d,["DATA-ID","LANGUAGE","VALUE","URI"]);const f=d["DATA-ID"];f&&(i.sessionData===null&&(i.sessionData={}),i.sessionData[f]=d);break}case"SESSION-KEY":{const d=Ev(c,r,i);d.encrypted&&d.isSupported()?(i.sessionKeys===null&&(i.sessionKeys=[]),i.sessionKeys.push(d)):U.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${c}"`);break}case"DEFINE":{{const d=new gt(c);pr(i,d,["NAME","VALUE","QUERYPARAM"]),mv(i,d,r)}break}case"CONTENT-STEERING":{const d=new gt(c);pr(i,d,["SERVER-URI","PATHWAY-ID"]),i.contentSteering={uri:kn.resolve(d["SERVER-URI"],r),pathwayId:d["PATHWAY-ID"]||"."};break}case"START":{i.startTimeOffset=Tv(c);break}}}const l=s.length>0&&s.length<i.levels.length;return i.levels=l?s:i.levels,i.levels.length===0&&(i.playlistParsingError=new Error("no levels found in manifest")),i}static parseMasterPlaylistMedia(e,r,n){let i;const s={},a=n.levels,o={AUDIO:a.map(u=>({id:u.attrs.AUDIO,audioCodec:u.audioCodec})),SUBTITLES:a.map(u=>({id:u.attrs.SUBTITLES,textCodec:u.textCodec})),"CLOSED-CAPTIONS":[]};let l=0;for(xv.lastIndex=0;(i=xv.exec(e))!==null;){const u=new gt(i[1]),c=u.TYPE;if(c){const d=o[c],f=s[c]||[];s[c]=f,pr(n,u,["URI","GROUP-ID","LANGUAGE","ASSOC-LANGUAGE","STABLE-RENDITION-ID","NAME","INSTREAM-ID","CHARACTERISTICS","CHANNELS"]);const m=u.LANGUAGE,h=u["ASSOC-LANGUAGE"],p=u.CHANNELS,v=u.CHARACTERISTICS,g=u["INSTREAM-ID"],y={attrs:u,bitrate:0,id:l++,groupId:u["GROUP-ID"]||"",name:u.NAME||m||"",type:c,default:u.bool("DEFAULT"),autoselect:u.bool("AUTOSELECT"),forced:u.bool("FORCED"),lang:m,url:u.URI?kn.resolve(u.URI,r):""};if(h&&(y.assocLang=h),p&&(y.channels=p),v&&(y.characteristics=v),g&&(y.instreamId=g),d!=null&&d.length){const x=kn.findGroup(d,y.groupId)||d[0];wv(y,x,"audioCodec"),wv(y,x,"textCodec")}f.push(y)}}return s}static parseLevelPlaylist(e,r,n,i,s,a){const o=new QD(r),l=o.fragments;let u=null,c=0,d=0,f=0,m=0,h=null,p=new yf(i,r),v,g,y,x=-1,S=!1,T=null;for(Sv.lastIndex=0,o.m3u8=e,o.hasVariableRefs=pv(e);(v=Sv.exec(e))!==null;){S&&(S=!1,p=new yf(i,r),p.start=f,p.sn=c,p.cc=m,p.level=n,u&&(p.initSegment=u,p.rawProgramDateTime=u.rawProgramDateTime,u.rawProgramDateTime=null,T&&(p.setByteRange(T),T=null)));const I=v[1];if(I){p.duration=parseFloat(I);const A=(" "+v[2]).slice(1);p.title=A||null,p.tagList.push(A?["INF",I,A]:["INF",I])}else if(v[3]){if(pe(p.duration)){p.start=f,y&&Av(p,y,o),p.sn=c,p.level=n,p.cc=m,l.push(p);const A=(" "+v[3]).slice(1);p.relurl=Yh(o,A),bv(p,h),h=p,f+=p.duration,c++,d=0,S=!0}}else if(v[4]){const A=(" "+v[4]).slice(1);h?p.setByteRange(A,h):p.setByteRange(A)}else if(v[5])p.rawProgramDateTime=(" "+v[5]).slice(1),p.tagList.push(["PROGRAM-DATE-TIME",p.rawProgramDateTime]),x===-1&&(x=l.length);else{if(v=v[0].match(FP),!v){U.warn("No matches on slow regex match for level playlist!");continue}for(g=1;g<v.length&&!(typeof v[g]<"u");g++);const A=(" "+v[g]).slice(1),k=(" "+v[g+1]).slice(1),O=v[g+2]?(" "+v[g+2]).slice(1):"";switch(A){case"PLAYLIST-TYPE":o.type=k.toUpperCase();break;case"MEDIA-SEQUENCE":c=o.startSN=parseInt(k);break;case"SKIP":{const P=new gt(k);pr(o,P,["RECENTLY-REMOVED-DATERANGES"]);const G=P.decimalInteger("SKIPPED-SEGMENTS");if(pe(G)){o.skippedSegments=G;for(let H=G;H--;)l.unshift(null);c+=G}const K=P.enumeratedString("RECENTLY-REMOVED-DATERANGES");K&&(o.recentlyRemovedDateranges=K.split("	"));break}case"TARGETDURATION":o.targetduration=Math.max(parseInt(k),1);break;case"VERSION":o.version=parseInt(k);break;case"INDEPENDENT-SEGMENTS":case"EXTM3U":break;case"ENDLIST":o.live=!1;break;case"#":(k||O)&&p.tagList.push(O?[k,O]:[k]);break;case"DISCONTINUITY":m++,p.tagList.push(["DIS"]);break;case"GAP":p.gap=!0,p.tagList.push([A]);break;case"BITRATE":p.tagList.push([A,k]);break;case"DATERANGE":{const P=new gt(k);pr(o,P,["ID","CLASS","START-DATE","END-DATE","SCTE35-CMD","SCTE35-OUT","SCTE35-IN"]),pr(o,P,P.clientAttrs);const G=new cT(P,o.dateRanges[P.ID]);G.isValid||o.skippedSegments?o.dateRanges[G.id]=G:U.warn(`Ignoring invalid DATERANGE tag: "${k}"`),p.tagList.push(["EXT-X-DATERANGE",k]);break}case"DEFINE":{{const P=new gt(k);pr(o,P,["NAME","VALUE","IMPORT","QUERYPARAM"]),"IMPORT"in P?IP(o,P,a):mv(o,P,r)}break}case"DISCONTINUITY-SEQUENCE":m=parseInt(k);break;case"KEY":{const P=Ev(k,r,o);if(P.isSupported()){if(P.method==="NONE"){y=void 0;break}y||(y={}),y[P.keyFormat]&&(y=It({},y)),y[P.keyFormat]=P}else U.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${k}"`);break}case"START":o.startTimeOffset=Tv(k);break;case"MAP":{const P=new gt(k);if(pr(o,P,["BYTERANGE","URI"]),p.duration){const G=new yf(i,r);Lv(G,P,n,y),u=G,p.initSegment=u,u.rawProgramDateTime&&!p.rawProgramDateTime&&(p.rawProgramDateTime=u.rawProgramDateTime)}else{const G=p.byteRangeEndOffset;if(G){const K=p.byteRangeStartOffset;T=`${G-K}@${K}`}else T=null;Lv(p,P,n,y),u=p,S=!0}break}case"SERVER-CONTROL":{const P=new gt(k);o.canBlockReload=P.bool("CAN-BLOCK-RELOAD"),o.canSkipUntil=P.optionalFloat("CAN-SKIP-UNTIL",0),o.canSkipDateRanges=o.canSkipUntil>0&&P.bool("CAN-SKIP-DATERANGES"),o.partHoldBack=P.optionalFloat("PART-HOLD-BACK",0),o.holdBack=P.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{const P=new gt(k);o.partTarget=P.decimalFloatingPoint("PART-TARGET");break}case"PART":{let P=o.partList;P||(P=o.partList=[]);const G=d>0?P[P.length-1]:void 0,K=d++,H=new gt(k);pr(o,H,["BYTERANGE","URI"]);const se=new XD(H,p,r,K,G);P.push(se),p.duration+=se.duration;break}case"PRELOAD-HINT":{const P=new gt(k);pr(o,P,["URI"]),o.preloadHint=P;break}case"RENDITION-REPORT":{const P=new gt(k);pr(o,P,["URI"]),o.renditionReports=o.renditionReports||[],o.renditionReports.push(P);break}default:U.warn(`line parsed but not handled: ${v}`);break}}}h&&!h.relurl?(l.pop(),f-=h.duration,o.partList&&(o.fragmentHint=h)):o.partList&&(bv(p,h),p.cc=m,o.fragmentHint=p,y&&Av(p,y,o));const C=l.length,_=l[0],b=l[C-1];if(f+=o.skippedSegments*o.targetduration,f>0&&C&&b){o.averagetargetduration=f/C;const I=b.sn;o.endSN=I!=="initSegment"?I:0,o.live||(b.endList=!0),_&&(o.startCC=_.cc)}else o.endSN=0,o.startCC=0;return o.fragmentHint&&(f+=o.fragmentHint.duration),o.totalduration=f,o.endCC=m,x>0&&BP(l,x),o}}function Ev(t,e,r){var n,i;const s=new gt(t);pr(r,s,["KEYFORMAT","KEYFORMATVERSIONS","URI","IV","URI"]);const a=(n=s.METHOD)!=null?n:"",o=s.URI,l=s.hexadecimalInteger("IV"),u=s.KEYFORMATVERSIONS,c=(i=s.KEYFORMAT)!=null?i:"identity";o&&s.IV&&!l&&U.error(`Invalid IV: ${s.IV}`);const d=o?kn.resolve(o,e):"",f=(u||"1").split("/").map(Number).filter(Number.isFinite);return new hl(a,d,c,f,l)}function Tv(t){const r=new gt(t).decimalFloatingPoint("TIME-OFFSET");return pe(r)?r:null}function UP(t,e){let r=(t||"").split(/[ ,]+/).filter(n=>n);["video","audio","text"].forEach(n=>{const i=r.filter(s=>DP(s,n));i.length&&(e[`${n}Codec`]=i.join(","),r=r.filter(s=>i.indexOf(s)===-1))}),e.unknownCodecs=r}function wv(t,e,r){const n=e[r];n&&(t[r]=n)}function BP(t,e){let r=t[e];for(let n=e;n--;){const i=t[n];if(!i)return;i.programDateTime=r.programDateTime-i.duration*1e3,r=i}}function bv(t,e){t.rawProgramDateTime?t.programDateTime=Date.parse(t.rawProgramDateTime):e!=null&&e.programDateTime&&(t.programDateTime=e.endProgramDateTime),pe(t.programDateTime)||(t.programDateTime=null,t.rawProgramDateTime=null)}function Lv(t,e,r,n){t.relurl=e.URI,e.BYTERANGE&&t.setByteRange(e.BYTERANGE),t.level=r,t.sn="initSegment",n&&(t.levelkeys=n),t.initSegment=null}function Av(t,e,r){t.levelkeys=e;const{encryptedFragments:n}=r;(!n.length||n[n.length-1].levelkeys!==e)&&Object.keys(e).some(i=>e[i].isCommonEncryption)&&n.push(t)}var He={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},we={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};function _v(t){const{type:e}=t;switch(e){case He.AUDIO_TRACK:return we.AUDIO;case He.SUBTITLE_TRACK:return we.SUBTITLE;default:return we.MAIN}}function Lf(t,e){let r=t.url;return(r===void 0||r.indexOf("data:")===0)&&(r=e.url),r}class $P{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(w.MANIFEST_LOADING,this.onManifestLoading,this),e.on(w.LEVEL_LOADING,this.onLevelLoading,this),e.on(w.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(w.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}unregisterListeners(){const{hls:e}=this;e.off(w.MANIFEST_LOADING,this.onManifestLoading,this),e.off(w.LEVEL_LOADING,this.onLevelLoading,this),e.off(w.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(w.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}createInternalLoader(e){const r=this.hls.config,n=r.pLoader,i=r.loader,s=n||i,a=new s(r);return this.loaders[e.type]=a,a}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const r=this.loaders[e];r&&r.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,r){const{url:n}=r;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:He.MANIFEST,url:n,deliveryDirectives:null})}onLevelLoading(e,r){const{id:n,level:i,pathwayId:s,url:a,deliveryDirectives:o}=r;this.load({id:n,level:i,pathwayId:s,responseType:"text",type:He.LEVEL,url:a,deliveryDirectives:o})}onAudioTrackLoading(e,r){const{id:n,groupId:i,url:s,deliveryDirectives:a}=r;this.load({id:n,groupId:i,level:null,responseType:"text",type:He.AUDIO_TRACK,url:s,deliveryDirectives:a})}onSubtitleTrackLoading(e,r){const{id:n,groupId:i,url:s,deliveryDirectives:a}=r;this.load({id:n,groupId:i,level:null,responseType:"text",type:He.SUBTITLE_TRACK,url:s,deliveryDirectives:a})}load(e){var r;const n=this.hls.config;let i=this.getInternalLoader(e);if(i){const u=i.context;if(u&&u.url===e.url&&u.level===e.level){U.trace("[playlist-loader]: playlist request ongoing");return}U.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),i.abort()}let s;if(e.type===He.MANIFEST?s=n.manifestLoadPolicy.default:s=It({},n.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),i=this.createInternalLoader(e),pe((r=e.deliveryDirectives)==null?void 0:r.part)){let u;if(e.type===He.LEVEL&&e.level!==null?u=this.hls.levels[e.level].details:e.type===He.AUDIO_TRACK&&e.id!==null?u=this.hls.audioTracks[e.id].details:e.type===He.SUBTITLE_TRACK&&e.id!==null&&(u=this.hls.subtitleTracks[e.id].details),u){const c=u.partTarget,d=u.targetduration;if(c&&d){const f=Math.max(c*3,d*.8)*1e3;s=It({},s,{maxTimeToFirstByteMs:Math.min(f,s.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(f,s.maxTimeToFirstByteMs)})}}}const a=s.errorRetry||s.timeoutRetry||{},o={loadPolicy:s,timeout:s.maxLoadTimeMs,maxRetry:a.maxNumRetry||0,retryDelay:a.retryDelayMs||0,maxRetryDelay:a.maxRetryDelayMs||0},l={onSuccess:(u,c,d,f)=>{const m=this.getInternalLoader(d);this.resetInternalLoader(d.type);const h=u.data;if(h.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(u,d,new Error("no EXTM3U delimiter"),f||null,c);return}c.parsing.start=performance.now(),kn.isMediaPlaylist(h)?this.handleTrackOrLevelPlaylist(u,c,d,f||null,m):this.handleMasterPlaylist(u,c,d,f)},onError:(u,c,d,f)=>{this.handleNetworkError(c,d,!1,u,f)},onTimeout:(u,c,d)=>{this.handleNetworkError(c,d,!0,void 0,u)}};i.load(e,o,l)}handleMasterPlaylist(e,r,n,i){const s=this.hls,a=e.data,o=Lf(e,n),l=kn.parseMasterPlaylist(a,o);if(l.playlistParsingError){this.handleManifestParsingError(e,n,l.playlistParsingError,i,r);return}const{contentSteering:u,levels:c,sessionData:d,sessionKeys:f,startTimeOffset:m,variableList:h}=l;this.variableList=h;const{AUDIO:p=[],SUBTITLES:v,"CLOSED-CAPTIONS":g}=kn.parseMasterPlaylistMedia(a,o,l);p.length&&!p.some(x=>!x.url)&&c[0].audioCodec&&!c[0].attrs.AUDIO&&(U.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),p.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new gt({}),bitrate:0,url:""})),s.trigger(w.MANIFEST_LOADED,{levels:c,audioTracks:p,subtitles:v,captions:g,contentSteering:u,url:o,stats:r,networkDetails:i,sessionData:d,sessionKeys:f,startTimeOffset:m,variableList:h})}handleTrackOrLevelPlaylist(e,r,n,i,s){const a=this.hls,{id:o,level:l,type:u}=n,c=Lf(e,n),d=0,f=pe(l)?l:pe(o)?o:0,m=_v(n),h=kn.parseLevelPlaylist(e.data,c,f,m,d,this.variableList);if(u===He.MANIFEST){const p={attrs:new gt({}),bitrate:0,details:h,name:"",url:c};a.trigger(w.MANIFEST_LOADED,{levels:[p],audioTracks:[],url:c,stats:r,networkDetails:i,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}r.parsing.end=performance.now(),n.levelDetails=h,this.handlePlaylistLoaded(h,e,r,n,i,s)}handleManifestParsingError(e,r,n,i,s){this.hls.trigger(w.ERROR,{type:_e.NETWORK_ERROR,details:z.MANIFEST_PARSING_ERROR,fatal:r.type===He.MANIFEST,url:e.url,err:n,error:n,reason:n.message,response:e,context:r,networkDetails:i,stats:s})}handleNetworkError(e,r,n=!1,i,s){let a=`A network ${n?"timeout":"error"+(i?" (status "+i.code+")":"")} occurred while loading ${e.type}`;e.type===He.LEVEL?a+=`: ${e.level} id: ${e.id}`:(e.type===He.AUDIO_TRACK||e.type===He.SUBTITLE_TRACK)&&(a+=` id: ${e.id} group-id: "${e.groupId}"`);const o=new Error(a);U.warn(`[playlist-loader]: ${a}`);let l=z.UNKNOWN,u=!1;const c=this.getInternalLoader(e);switch(e.type){case He.MANIFEST:l=n?z.MANIFEST_LOAD_TIMEOUT:z.MANIFEST_LOAD_ERROR,u=!0;break;case He.LEVEL:l=n?z.LEVEL_LOAD_TIMEOUT:z.LEVEL_LOAD_ERROR,u=!1;break;case He.AUDIO_TRACK:l=n?z.AUDIO_TRACK_LOAD_TIMEOUT:z.AUDIO_TRACK_LOAD_ERROR,u=!1;break;case He.SUBTITLE_TRACK:l=n?z.SUBTITLE_TRACK_LOAD_TIMEOUT:z.SUBTITLE_LOAD_ERROR,u=!1;break}c&&this.resetInternalLoader(e.type);const d={type:_e.NETWORK_ERROR,details:l,fatal:u,url:e.url,loader:c,context:e,error:o,networkDetails:r,stats:s};if(i){const f=(r==null?void 0:r.url)||e.url;d.response=jt({url:f,data:void 0},i)}this.hls.trigger(w.ERROR,d)}handlePlaylistLoaded(e,r,n,i,s,a){const o=this.hls,{type:l,level:u,id:c,groupId:d,deliveryDirectives:f}=i,m=Lf(r,i),h=_v(i),p=typeof i.level=="number"&&h===we.MAIN?u:void 0;if(!e.fragments.length){const g=new Error("No Segments found in Playlist");o.trigger(w.ERROR,{type:_e.NETWORK_ERROR,details:z.LEVEL_EMPTY_ERROR,fatal:!1,url:m,error:g,reason:g.message,response:r,context:i,level:p,parent:h,networkDetails:s,stats:n});return}e.targetduration||(e.playlistParsingError=new Error("Missing Target Duration"));const v=e.playlistParsingError;if(v){o.trigger(w.ERROR,{type:_e.NETWORK_ERROR,details:z.LEVEL_PARSING_ERROR,fatal:!1,url:m,error:v,reason:v.message,response:r,context:i,level:p,parent:h,networkDetails:s,stats:n});return}switch(e.live&&a&&(a.getCacheAge&&(e.ageHeader=a.getCacheAge()||0),(!a.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),l){case He.MANIFEST:case He.LEVEL:o.trigger(w.LEVEL_LOADED,{details:e,level:p||0,id:c||0,stats:n,networkDetails:s,deliveryDirectives:f});break;case He.AUDIO_TRACK:o.trigger(w.AUDIO_TRACK_LOADED,{details:e,id:c||0,groupId:d||"",stats:n,networkDetails:s,deliveryDirectives:f});break;case He.SUBTITLE_TRACK:o.trigger(w.SUBTITLE_TRACK_LOADED,{details:e,id:c||0,groupId:d||"",stats:n,networkDetails:s,deliveryDirectives:f});break}}}function LT(t,e){let r;try{r=new Event("addtrack")}catch{r=document.createEvent("Event"),r.initEvent("addtrack",!1,!1)}r.track=t,e.dispatchEvent(r)}function AT(t,e){const r=t.mode;if(r==="disabled"&&(t.mode="hidden"),t.cues&&!t.cues.getCueById(e.id))try{if(t.addCue(e),!t.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(n){U.debug(`[texttrack-utils]: ${n}`);try{const i=new self.TextTrackCue(e.startTime,e.endTime,e.text);i.id=e.id,t.addCue(i)}catch(i){U.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${i}`)}}r==="disabled"&&(t.mode=r)}function ta(t){const e=t.mode;if(e==="disabled"&&(t.mode="hidden"),t.cues)for(let r=t.cues.length;r--;)t.removeCue(t.cues[r]);e==="disabled"&&(t.mode=e)}function qh(t,e,r,n){const i=t.mode;if(i==="disabled"&&(t.mode="hidden"),t.cues&&t.cues.length>0){const s=VP(t.cues,e,r);for(let a=0;a<s.length;a++)(!n||n(s[a]))&&t.removeCue(s[a])}i==="disabled"&&(t.mode=i)}function jP(t,e){if(e<t[0].startTime)return 0;const r=t.length-1;if(e>t[r].endTime)return-1;let n=0,i=r;for(;n<=i;){const s=Math.floor((i+n)/2);if(e<t[s].startTime)i=s-1;else if(e>t[s].startTime&&n<r)n=s+1;else return s}return t[n].startTime-e<e-t[i].startTime?n:i}function VP(t,e,r){const n=[],i=jP(t,e);if(i>-1)for(let s=i,a=t.length;s<a;s++){const o=t[s];if(o.startTime>=e&&o.endTime<=r)n.push(o);else if(o.startTime>r)return n}return n}function Pu(t){const e=[];for(let r=0;r<t.length;r++){const n=t[r];(n.kind==="subtitles"||n.kind==="captions")&&n.label&&e.push(t[r])}return e}var dn={audioId3:"org.id3",dateRange:"com.apple.quicktime.HLS",emsg:"https://aomedia.org/emsg/ID3"};const GP=.25;function Xh(){if(!(typeof self>"u"))return self.VTTCue||self.TextTrackCue}function Cv(t,e,r,n,i){let s=new t(e,r,"");try{s.value=n,i&&(s.type=i)}catch{s=new t(e,r,JSON.stringify(i?jt({type:i},n):n))}return s}const nu=(()=>{const t=Xh();try{t&&new t(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function Af(t,e){return t.getTime()/1e3-e}function zP(t){return Uint8Array.from(t.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}class HP{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null}_registerListeners(){const{hls:e}=this;e.on(w.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(w.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(w.MANIFEST_LOADING,this.onManifestLoading,this),e.on(w.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(w.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(w.LEVEL_UPDATED,this.onLevelUpdated,this)}_unregisterListeners(){const{hls:e}=this;e.off(w.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(w.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(w.MANIFEST_LOADING,this.onManifestLoading,this),e.off(w.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(w.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(w.LEVEL_UPDATED,this.onLevelUpdated,this)}onMediaAttached(e,r){this.media=r.media}onMediaDetaching(){this.id3Track&&(ta(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const r=this.getID3Track(e.textTracks);return r.mode="hidden",r}getID3Track(e){if(this.media){for(let r=0;r<e.length;r++){const n=e[r];if(n.kind==="metadata"&&n.label==="id3")return LT(n,this.media),n}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,r){if(!this.media)return;const{hls:{config:{enableEmsgMetadataCues:n,enableID3MetadataCues:i}}}=this;if(!n&&!i)return;const{samples:s}=r;this.id3Track||(this.id3Track=this.createTrack(this.media));const a=Xh();if(a)for(let o=0;o<s.length;o++){const l=s[o].type;if(l===dn.emsg&&!n||!i)continue;const u=mT(s[o].data);if(u){const c=s[o].pts;let d=c+s[o].duration;d>nu&&(d=nu),d-c<=0&&(d=c+GP);for(let m=0;m<u.length;m++){const h=u[m];if(!pT(h)){this.updateId3CueEnds(c,l);const p=Cv(a,c,d,h,l);p&&this.id3Track.addCue(p)}}}}}updateId3CueEnds(e,r){var n;const i=(n=this.id3Track)==null?void 0:n.cues;if(i)for(let s=i.length;s--;){const a=i[s];a.type===r&&a.startTime<e&&a.endTime===nu&&(a.endTime=e)}}onBufferFlushing(e,{startOffset:r,endOffset:n,type:i}){const{id3Track:s,hls:a}=this;if(!a)return;const{config:{enableEmsgMetadataCues:o,enableID3MetadataCues:l}}=a;if(s&&(o||l)){let u;i==="audio"?u=c=>c.type===dn.audioId3&&l:i==="video"?u=c=>c.type===dn.emsg&&o:u=c=>c.type===dn.audioId3&&l||c.type===dn.emsg&&o,qh(s,r,n,u)}}onLevelUpdated(e,{details:r}){if(!this.media||!r.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;const{dateRangeCuesAppended:n,id3Track:i}=this,{dateRanges:s}=r,a=Object.keys(s);if(i){const c=Object.keys(n).filter(d=>!a.includes(d));for(let d=c.length;d--;){const f=c[d];Object.keys(n[f].cues).forEach(m=>{i.removeCue(n[f].cues[m])}),delete n[f]}}const o=r.fragments[r.fragments.length-1];if(a.length===0||!pe(o==null?void 0:o.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));const l=o.programDateTime/1e3-o.start,u=Xh();for(let c=0;c<a.length;c++){const d=a[c],f=s[d],m=Af(f.startDate,l),h=n[d],p=(h==null?void 0:h.cues)||{};let v=(h==null?void 0:h.durationKnown)||!1,g=nu;const y=f.endDate;if(y)g=Af(y,l),v=!0;else if(f.endOnNext&&!v){const S=a.reduce((T,C)=>{if(C!==f.id){const _=s[C];if(_.class===f.class&&_.startDate>f.startDate&&(!T||f.startDate<T.startDate))return _}return T},null);S&&(g=Af(S.startDate,l),v=!0)}const x=Object.keys(f.attr);for(let S=0;S<x.length;S++){const T=x[S];if(!YD(T))continue;const C=p[T];if(C)v&&!h.durationKnown&&(C.endTime=g);else if(u){let _=f.attr[T];qD(T)&&(_=zP(_));const b=Cv(u,m,g,{key:T,data:_},dn.dateRange);b&&(b.id=d,this.id3Track.addCue(b),p[T]=b)}}n[d]={cues:p,dateRange:f,durationKnown:v}}}}class WP{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=()=>this.timeupdate(),this.hls=e,this.config=e.config,this.registerListeners()}get latency(){return this._latency||0}get maxLatency(){const{config:e,levelDetails:r}=this;return e.liveMaxLatencyDuration!==void 0?e.liveMaxLatencyDuration:r?e.liveMaxLatencyDurationCount*r.targetduration:0}get targetLatency(){const{levelDetails:e}=this;if(e===null)return null;const{holdBack:r,partHoldBack:n,targetduration:i}=e,{liveSyncDuration:s,liveSyncDurationCount:a,lowLatencyMode:o}=this.config,l=this.hls.userConfig;let u=o&&n||r;(l.liveSyncDuration||l.liveSyncDurationCount||u===0)&&(u=s!==void 0?s:a*i);const c=i;return u+Math.min(this.stallCount*1,c)}get liveSyncPosition(){const e=this.estimateLiveEdge(),r=this.targetLatency,n=this.levelDetails;if(e===null||r===null||n===null)return null;const i=n.edge,s=e-r-this.edgeStalled,a=i-n.totalduration,o=i-(this.config.lowLatencyMode&&n.partTarget||n.targetduration);return Math.min(Math.max(a,s),o)}get drift(){const{levelDetails:e}=this;return e===null?1:e.drift}get edgeStalled(){const{levelDetails:e}=this;if(e===null)return 0;const r=(this.config.lowLatencyMode&&e.partTarget||e.targetduration)*3;return Math.max(e.age-r,0)}get forwardBufferLength(){const{media:e,levelDetails:r}=this;if(!e||!r)return 0;const n=e.buffered.length;return(n?e.buffered.end(n-1):r.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null}registerListeners(){this.hls.on(w.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(w.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(w.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(w.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(w.ERROR,this.onError,this)}unregisterListeners(){this.hls.off(w.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(w.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.off(w.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(w.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.off(w.ERROR,this.onError,this)}onMediaAttached(e,r){this.media=r.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)}onManifestLoading(){this.levelDetails=null,this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:r}){this.levelDetails=r,r.advanced&&this.timeupdate(),!r.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)}onError(e,r){var n;r.details===z.BUFFER_STALLED_ERROR&&(this.stallCount++,(n=this.levelDetails)!=null&&n.live&&U.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))}timeupdate(){const{media:e,levelDetails:r}=this;if(!e||!r)return;this.currentTime=e.currentTime;const n=this.computeLatency();if(n===null)return;this._latency=n;const{lowLatencyMode:i,maxLiveSyncPlaybackRate:s}=this.config;if(!i||s===1||!r.live)return;const a=this.targetLatency;if(a===null)return;const o=n-a,l=Math.min(this.maxLatency,a+r.targetduration);if(o<l&&o>.05&&this.forwardBufferLength>1){const c=Math.min(2,Math.max(1,s)),d=Math.round(2/(1+Math.exp(-.75*o-this.edgeStalled))*20)/20;e.playbackRate=Math.min(c,Math.max(1,d))}else e.playbackRate!==1&&e.playbackRate!==0&&(e.playbackRate=1)}estimateLiveEdge(){const{levelDetails:e}=this;return e===null?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return e===null?null:e-this.currentTime}}const Zh=["NONE","TYPE-0","TYPE-1",null];function KP(t){return Zh.indexOf(t)>-1}const Bc=["SDR","PQ","HLG"];function YP(t){return!!t&&Bc.indexOf(t)>-1}var Ou={No:"",Yes:"YES",v2:"v2"};function Rv(t){const{canSkipUntil:e,canSkipDateRanges:r,age:n}=t,i=n<e/2;return e&&i?r?Ou.v2:Ou.Yes:Ou.No}class Iv{constructor(e,r,n){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=r,this.skip=n}addDirectives(e){const r=new self.URL(e);return this.msn!==void 0&&r.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&r.searchParams.set("_HLS_part",this.part.toString()),this.skip&&r.searchParams.set("_HLS_skip",this.skip),r.href}}class Ia{constructor(e){this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter(r=>!!r).map(r=>r.substring(0,4)).join(","),this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(e){return kv(this._audioGroups,e)}hasSubtitleGroup(e){return kv(this._subtitleGroups,e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(e,r){if(r){if(e==="audio"){let n=this._audioGroups;n||(n=this._audioGroups=[]),n.indexOf(r)===-1&&n.push(r)}else if(e==="text"){let n=this._subtitleGroups;n||(n=this._subtitleGroups=[]),n.indexOf(r)===-1&&n.push(r)}}}get urlId(){return 0}set urlId(e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var e;return(e=this.audioGroups)==null?void 0:e[0]}get textGroupId(){var e;return(e=this.subtitleGroups)==null?void 0:e[0]}addFallback(){}}function kv(t,e){return!e||!t?!1:t.indexOf(e)!==-1}function _f(t,e){const r=e.startPTS;if(pe(r)){let n=0,i;e.sn>t.sn?(n=r-t.start,i=t):(n=t.start-r,i=e),i.duration!==n&&(i.duration=n)}else e.sn>t.sn?t.cc===e.cc&&t.minEndPTS?e.start=t.start+(t.minEndPTS-t.start):e.start=t.start+t.duration:e.start=Math.max(t.start-e.duration,0)}function _T(t,e,r,n,i,s){n-r<=0&&(U.warn("Fragment should have a positive duration",e),n=r+e.duration,s=i+e.duration);let o=r,l=n;const u=e.startPTS,c=e.endPTS;if(pe(u)){const v=Math.abs(u-r);pe(e.deltaPTS)?e.deltaPTS=Math.max(v,e.deltaPTS):e.deltaPTS=v,o=Math.max(r,u),r=Math.min(r,u),i=Math.min(i,e.startDTS),l=Math.min(n,c),n=Math.max(n,c),s=Math.max(s,e.endDTS)}const d=r-e.start;e.start!==0&&(e.start=r),e.duration=n-e.start,e.startPTS=r,e.maxStartPTS=o,e.startDTS=i,e.endPTS=n,e.minEndPTS=l,e.endDTS=s;const f=e.sn;if(!t||f<t.startSN||f>t.endSN)return 0;let m;const h=f-t.startSN,p=t.fragments;for(p[h]=e,m=h;m>0;m--)_f(p[m],p[m-1]);for(m=h;m<p.length-1;m++)_f(p[m],p[m+1]);return t.fragmentHint&&_f(p[p.length-1],t.fragmentHint),t.PTSKnown=t.alignedSliding=!0,d}function qP(t,e){let r=null;const n=t.fragments;for(let l=n.length-1;l>=0;l--){const u=n[l].initSegment;if(u){r=u;break}}t.fragmentHint&&delete t.fragmentHint.endPTS;let i=0,s;if(QP(t,e,(l,u)=>{l.relurl&&(i=l.cc-u.cc),pe(l.startPTS)&&pe(l.endPTS)&&(u.start=u.startPTS=l.startPTS,u.startDTS=l.startDTS,u.maxStartPTS=l.maxStartPTS,u.endPTS=l.endPTS,u.endDTS=l.endDTS,u.minEndPTS=l.minEndPTS,u.duration=l.endPTS-l.startPTS,u.duration&&(s=u),e.PTSKnown=e.alignedSliding=!0),u.elementaryStreams=l.elementaryStreams,u.loader=l.loader,u.stats=l.stats,l.initSegment&&(u.initSegment=l.initSegment,r=l.initSegment)}),r&&(e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments).forEach(u=>{var c;u&&(!u.initSegment||u.initSegment.relurl===((c=r)==null?void 0:c.relurl))&&(u.initSegment=r)}),e.skippedSegments)if(e.deltaUpdateFailed=e.fragments.some(l=>!l),e.deltaUpdateFailed){U.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let l=e.skippedSegments;l--;)e.fragments.shift();e.startSN=e.fragments[0].sn,e.startCC=e.fragments[0].cc}else e.canSkipDateRanges&&(e.dateRanges=XP(t.dateRanges,e.dateRanges,e.recentlyRemovedDateranges));const a=e.fragments;if(i){U.warn("discontinuity sliding from playlist, take drift into account");for(let l=0;l<a.length;l++)a[l].cc+=i}e.skippedSegments&&(e.startCC=e.fragments[0].cc),ZP(t.partList,e.partList,(l,u)=>{u.elementaryStreams=l.elementaryStreams,u.stats=l.stats}),s?_T(e,s,s.startPTS,s.endPTS,s.startDTS,s.endDTS):CT(t,e),a.length&&(e.totalduration=e.edge-a[0].start),e.driftStartTime=t.driftStartTime,e.driftStart=t.driftStart;const o=e.advancedDateTime;if(e.advanced&&o){const l=e.edge;e.driftStart||(e.driftStartTime=o,e.driftStart=l),e.driftEndTime=o,e.driftEnd=l}else e.driftEndTime=t.driftEndTime,e.driftEnd=t.driftEnd,e.advancedDateTime=t.advancedDateTime}function XP(t,e,r){const n=It({},t);return r&&r.forEach(i=>{delete n[i]}),Object.keys(e).forEach(i=>{const s=new cT(e[i].attr,n[i]);s.isValid?n[i]=s:U.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${JSON.stringify(e[i].attr)}"`)}),n}function ZP(t,e,r){if(t&&e){let n=0;for(let i=0,s=t.length;i<=s;i++){const a=t[i],o=e[i+n];a&&o&&a.index===o.index&&a.fragment.sn===o.fragment.sn?r(a,o):n--}}}function QP(t,e,r){const n=e.skippedSegments,i=Math.max(t.startSN,e.startSN)-e.startSN,s=(t.fragmentHint?1:0)+(n?e.endSN:Math.min(t.endSN,e.endSN))-e.startSN,a=e.startSN-t.startSN,o=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,l=t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments;for(let u=i;u<=s;u++){const c=l[a+u];let d=o[u];n&&!d&&u<n&&(d=e.fragments[u]=c),c&&d&&r(c,d)}}function CT(t,e){const r=e.startSN+e.skippedSegments-t.startSN,n=t.fragments;r<0||r>=n.length||Qh(e,n[r].start)}function Qh(t,e){if(e){const r=t.fragments;for(let n=t.skippedSegments;n<r.length;n++)r[n].start+=e;t.fragmentHint&&(t.fragmentHint.start+=e)}}function JP(t,e=1/0){let r=1e3*t.targetduration;if(t.updated){const n=t.fragments;if(n.length&&r*4>e){const s=n[n.length-1].duration*1e3;s<r&&(r=s)}}else r/=2;return Math.round(r)}function eO(t,e,r){if(!(t!=null&&t.details))return null;const n=t.details;let i=n.fragments[e-n.startSN];return i||(i=n.fragmentHint,i&&i.sn===e)?i:e<n.startSN&&r&&r.sn===e?r:null}function Dv(t,e,r){var n;return t!=null&&t.details?RT((n=t.details)==null?void 0:n.partList,e,r):null}function RT(t,e,r){if(t)for(let n=t.length;n--;){const i=t[n];if(i.index===r&&i.fragment.sn===e)return i}return null}function IT(t){t.forEach((e,r)=>{const{details:n}=e;n!=null&&n.fragments&&n.fragments.forEach(i=>{i.level=r})})}function $c(t){switch(t.details){case z.FRAG_LOAD_TIMEOUT:case z.KEY_LOAD_TIMEOUT:case z.LEVEL_LOAD_TIMEOUT:case z.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function Pv(t,e){const r=$c(e);return t.default[`${r?"timeout":"error"}Retry`]}function Rm(t,e){const r=t.backoff==="linear"?1:Math.pow(2,e);return Math.min(r*t.retryDelayMs,t.maxRetryDelayMs)}function Ov(t){return jt(jt({},t),{errorRetry:null,timeoutRetry:null})}function jc(t,e,r,n){if(!t)return!1;const i=n==null?void 0:n.code,s=e<t.maxNumRetry&&(tO(i)||!!r);return t.shouldRetry?t.shouldRetry(t,e,r,n,s):s}function tO(t){return t===0&&navigator.onLine===!1||!!t&&(t<400||t>499)}const kT={search:function(t,e){let r=0,n=t.length-1,i=null,s=null;for(;r<=n;){i=(r+n)/2|0,s=t[i];const a=e(s);if(a>0)r=i+1;else if(a<0)n=i-1;else return s}return null}};function rO(t,e,r){if(e===null||!Array.isArray(t)||!t.length||!pe(e))return null;const n=t[0].programDateTime;if(e<(n||0))return null;const i=t[t.length-1].endProgramDateTime;if(e>=(i||0))return null;r=r||0;for(let s=0;s<t.length;++s){const a=t[s];if(iO(e,r,a))return a}return null}function Vc(t,e,r=0,n=0,i=.005){let s=null;if(t){s=e[t.sn-e[0].sn+1]||null;const o=t.endDTS-r;o>0&&o<15e-7&&(r+=15e-7)}else r===0&&e[0].start===0&&(s=e[0]);if(s&&((!t||t.level===s.level)&&Jh(r,n,s)===0||nO(s,t,Math.min(i,n))))return s;const a=kT.search(e,Jh.bind(null,r,n));return a&&(a!==t||!s)?a:s}function nO(t,e,r){if(e&&e.start===0&&e.level<t.level&&(e.endPTS||0)>0){const n=e.tagList.reduce((i,s)=>(s[0]==="INF"&&(i+=parseFloat(s[1])),i),r);return t.start<=n}return!1}function Jh(t=0,e=0,r){if(r.start<=t&&r.start+r.duration>t)return 0;const n=Math.min(e,r.duration+(r.deltaPTS?r.deltaPTS:0));return r.start+r.duration-n<=t?1:r.start-n>t&&r.start?-1:0}function iO(t,e,r){const n=Math.min(e,r.duration+(r.deltaPTS?r.deltaPTS:0))*1e3;return(r.endProgramDateTime||0)-n>t}function sO(t,e){return kT.search(t,r=>r.cc<e?1:r.cc>e?-1:0)}var zt={DoNothing:0,SendEndCallback:1,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,InsertDiscontinuity:4,RetryRequest:5},sn={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,SwitchToSDR:4};class aO{constructor(e){this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.log=void 0,this.warn=void 0,this.error=void 0,this.hls=e,this.log=U.log.bind(U,"[info]:"),this.warn=U.warn.bind(U,"[warning]:"),this.error=U.error.bind(U,"[error]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(w.ERROR,this.onError,this),e.on(w.MANIFEST_LOADING,this.onManifestLoading,this),e.on(w.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(w.ERROR,this.onError,this),e.off(w.ERROR,this.onErrorOut,this),e.off(w.MANIFEST_LOADING,this.onManifestLoading,this),e.off(w.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(e){return(e==null?void 0:e.type)===we.MAIN?e.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(e,r){var n,i;if(r.fatal)return;const s=this.hls,a=r.context;switch(r.details){case z.FRAG_LOAD_ERROR:case z.FRAG_LOAD_TIMEOUT:case z.KEY_LOAD_ERROR:case z.KEY_LOAD_TIMEOUT:r.errorAction=this.getFragRetryOrSwitchAction(r);return;case z.FRAG_PARSING_ERROR:if((n=r.frag)!=null&&n.gap){r.errorAction={action:zt.DoNothing,flags:sn.None};return}case z.FRAG_GAP:case z.FRAG_DECRYPT_ERROR:{r.errorAction=this.getFragRetryOrSwitchAction(r),r.errorAction.action=zt.SendAlternateToPenaltyBox;return}case z.LEVEL_EMPTY_ERROR:case z.LEVEL_PARSING_ERROR:{var o,l;const u=r.parent===we.MAIN?r.level:s.loadLevel;r.details===z.LEVEL_EMPTY_ERROR&&((o=r.context)!=null&&(l=o.levelDetails)!=null&&l.live)?r.errorAction=this.getPlaylistRetryOrSwitchAction(r,u):(r.levelRetry=!1,r.errorAction=this.getLevelSwitchAction(r,u))}return;case z.LEVEL_LOAD_ERROR:case z.LEVEL_LOAD_TIMEOUT:typeof(a==null?void 0:a.level)=="number"&&(r.errorAction=this.getPlaylistRetryOrSwitchAction(r,a.level));return;case z.AUDIO_TRACK_LOAD_ERROR:case z.AUDIO_TRACK_LOAD_TIMEOUT:case z.SUBTITLE_LOAD_ERROR:case z.SUBTITLE_TRACK_LOAD_TIMEOUT:if(a){const u=s.levels[s.loadLevel];if(u&&(a.type===He.AUDIO_TRACK&&u.hasAudioGroup(a.groupId)||a.type===He.SUBTITLE_TRACK&&u.hasSubtitleGroup(a.groupId))){r.errorAction=this.getPlaylistRetryOrSwitchAction(r,s.loadLevel),r.errorAction.action=zt.SendAlternateToPenaltyBox,r.errorAction.flags=sn.MoveAllAlternatesMatchingHost;return}}return;case z.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const u=s.levels[s.loadLevel],c=u==null?void 0:u.attrs["HDCP-LEVEL"];c?r.errorAction={action:zt.SendAlternateToPenaltyBox,flags:sn.MoveAllAlternatesMatchingHDCP,hdcpLevel:c}:this.keySystemError(r)}return;case z.BUFFER_ADD_CODEC_ERROR:case z.REMUX_ALLOC_ERROR:case z.BUFFER_APPEND_ERROR:r.errorAction=this.getLevelSwitchAction(r,(i=r.level)!=null?i:s.loadLevel);return;case z.INTERNAL_EXCEPTION:case z.BUFFER_APPENDING_ERROR:case z.BUFFER_FULL_ERROR:case z.LEVEL_SWITCH_ERROR:case z.BUFFER_STALLED_ERROR:case z.BUFFER_SEEK_OVER_HOLE:case z.BUFFER_NUDGE_ON_STALL:r.errorAction={action:zt.DoNothing,flags:sn.None};return}r.type===_e.KEY_SYSTEM_ERROR&&this.keySystemError(r)}keySystemError(e){const r=this.getVariantLevelIndex(e.frag);e.levelRetry=!1,e.errorAction=this.getLevelSwitchAction(e,r)}getPlaylistRetryOrSwitchAction(e,r){const n=this.hls,i=Pv(n.config.playlistLoadPolicy,e),s=this.playlistError++;if(jc(i,s,$c(e),e.response))return{action:zt.RetryRequest,flags:sn.None,retryConfig:i,retryCount:s};const o=this.getLevelSwitchAction(e,r);return i&&(o.retryConfig=i,o.retryCount=s),o}getFragRetryOrSwitchAction(e){const r=this.hls,n=this.getVariantLevelIndex(e.frag),i=r.levels[n],{fragLoadPolicy:s,keyLoadPolicy:a}=r.config,o=Pv(e.details.startsWith("key")?a:s,e),l=r.levels.reduce((c,d)=>c+d.fragmentError,0);if(i&&(e.details!==z.FRAG_GAP&&i.fragmentError++,jc(o,l,$c(e),e.response)))return{action:zt.RetryRequest,flags:sn.None,retryConfig:o,retryCount:l};const u=this.getLevelSwitchAction(e,n);return o&&(u.retryConfig=o,u.retryCount=l),u}getLevelSwitchAction(e,r){const n=this.hls;r==null&&(r=n.loadLevel);const i=this.hls.levels[r];if(i){var s,a;const u=e.details;i.loadError++,u===z.BUFFER_APPEND_ERROR&&i.fragmentError++;let c=-1;const{levels:d,loadLevel:f,minAutoLevel:m,maxAutoLevel:h}=n;n.autoLevelEnabled||(n.loadLevel=-1);const p=(s=e.frag)==null?void 0:s.type,g=(p===we.AUDIO&&u===z.FRAG_PARSING_ERROR||e.sourceBufferName==="audio"&&(u===z.BUFFER_ADD_CODEC_ERROR||u===z.BUFFER_APPEND_ERROR))&&d.some(({audioCodec:C})=>i.audioCodec!==C),x=e.sourceBufferName==="video"&&(u===z.BUFFER_ADD_CODEC_ERROR||u===z.BUFFER_APPEND_ERROR)&&d.some(({codecSet:C,audioCodec:_})=>i.codecSet!==C&&i.audioCodec===_),{type:S,groupId:T}=(a=e.context)!=null?a:{};for(let C=d.length;C--;){const _=(C+f)%d.length;if(_!==f&&_>=m&&_<=h&&d[_].loadError===0){var o,l;const b=d[_];if(u===z.FRAG_GAP&&p===we.MAIN&&e.frag){const I=d[_].details;if(I){const A=Vc(e.frag,I.fragments,e.frag.start);if(A!=null&&A.gap)continue}}else{if(S===He.AUDIO_TRACK&&b.hasAudioGroup(T)||S===He.SUBTITLE_TRACK&&b.hasSubtitleGroup(T))continue;if(p===we.AUDIO&&(o=i.audioGroups)!=null&&o.some(I=>b.hasAudioGroup(I))||p===we.SUBTITLE&&(l=i.subtitleGroups)!=null&&l.some(I=>b.hasSubtitleGroup(I))||g&&i.audioCodec===b.audioCodec||!g&&i.audioCodec!==b.audioCodec||x&&i.codecSet===b.codecSet)continue}c=_;break}}if(c>-1&&n.loadLevel!==c)return e.levelRetry=!0,this.playlistError=0,{action:zt.SendAlternateToPenaltyBox,flags:sn.None,nextAutoLevel:c}}return{action:zt.SendAlternateToPenaltyBox,flags:sn.MoveAllAlternatesMatchingHost}}onErrorOut(e,r){var n;switch((n=r.errorAction)==null?void 0:n.action){case zt.DoNothing:break;case zt.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(r),!r.errorAction.resolved&&r.details!==z.FRAG_GAP?r.fatal=!0:/MediaSource readyState: ended/.test(r.error.message)&&(this.warn(`MediaSource ended after "${r.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError());break}if(r.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(e){const r=this.hls,n=e.errorAction;if(!n)return;const{flags:i,hdcpLevel:s,nextAutoLevel:a}=n;switch(i){case sn.None:this.switchLevel(e,a);break;case sn.MoveAllAlternatesMatchingHDCP:s&&(r.maxHdcpLevel=Zh[Zh.indexOf(s)-1],n.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${r.maxHdcpLevel}" or lower`);break}n.resolved||this.switchLevel(e,a)}switchLevel(e,r){r!==void 0&&e.errorAction&&(this.warn(`switching to level ${r} after ${e.details}`),this.hls.nextAutoLevel=r,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel)}}class Im{constructor(e,r){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.log=void 0,this.warn=void 0,this.log=U.log.bind(U,`${r}:`),this.warn=U.warn.bind(U,`${r}:`),this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){this.timer!==-1&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.requestScheduled=-1,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,r,n){const i=r==null?void 0:r.renditionReports;if(i){let s=-1;for(let a=0;a<i.length;a++){const o=i[a];let l;try{l=new self.URL(o.URI,r.url).href}catch(u){U.warn(`Could not construct new URL for Rendition Report: ${u}`),l=o.URI||""}if(l===e){s=a;break}else l===e.substring(0,l.length)&&(s=a)}if(s!==-1){const a=i[s],o=parseInt(a["LAST-MSN"])||(r==null?void 0:r.lastPartSn);let l=parseInt(a["LAST-PART"])||(r==null?void 0:r.lastPartIndex);if(this.hls.config.lowLatencyMode){const c=Math.min(r.age-r.partTarget,r.targetduration);l>=0&&c>r.partTarget&&(l+=1)}const u=n&&Rv(n);return new Iv(o,l>=0?l:void 0,u)}}}loadPlaylist(e){this.requestScheduled===-1&&(this.requestScheduled=self.performance.now())}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}shouldReloadPlaylist(e){return this.timer===-1&&this.requestScheduled===-1&&this.shouldLoadPlaylist(e)}playlistLoaded(e,r,n){const{details:i,stats:s}=r,a=self.performance.now(),o=s.loading.first?Math.max(0,a-s.loading.first):0;if(i.advancedDateTime=Date.now()-o,i.live||n!=null&&n.live){if(i.reloaded(n),n&&this.log(`live playlist ${e} ${i.advanced?"REFRESHED "+i.lastPartSn+"-"+i.lastPartIndex:i.updated?"UPDATED":"MISSED"}`),n&&i.fragments.length>0&&qP(n,i),!this.canLoad||!i.live)return;let l,u,c;if(i.canBlockReload&&i.endSN&&i.advanced){const v=this.hls.config.lowLatencyMode,g=i.lastPartSn,y=i.endSN,x=i.lastPartIndex,S=x!==-1,T=g===y,C=v?0:x;S?(u=T?y+1:g,c=T?C:x+1):u=y+1;const _=i.age,b=_+i.ageHeader;let I=Math.min(b-i.partTarget,i.targetduration*1.5);if(I>0){if(n&&I>n.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${n.tuneInGoal} to: ${I} with playlist age: ${i.age}`),I=0;else{const A=Math.floor(I/i.targetduration);if(u+=A,c!==void 0){const k=Math.round(I%i.targetduration/i.partTarget);c+=k}this.log(`CDN Tune-in age: ${i.ageHeader}s last advanced ${_.toFixed(2)}s goal: ${I} skip sn ${A} to part ${c}`)}i.tuneInGoal=I}if(l=this.getDeliveryDirectives(i,r.deliveryDirectives,u,c),v||!T){this.loadPlaylist(l);return}}else(i.canBlockReload||i.canSkipUntil)&&(l=this.getDeliveryDirectives(i,r.deliveryDirectives,u,c));const d=this.hls.mainForwardBufferInfo,f=d?d.end-d.len:0,m=(i.edge-f)*1e3,h=JP(i,m);i.updated&&a>this.requestScheduled+h&&(this.requestScheduled=s.loading.start),u!==void 0&&i.canBlockReload?this.requestScheduled=s.loading.first+h-(i.partTarget*1e3||1e3):this.requestScheduled===-1||this.requestScheduled+h<a?this.requestScheduled=a:this.requestScheduled-a<=0&&(this.requestScheduled+=h);let p=this.requestScheduled-a;p=Math.max(0,p),this.log(`reload live playlist ${e} in ${Math.round(p)} ms`),this.timer=self.setTimeout(()=>this.loadPlaylist(l),p)}else this.clearTimer()}getDeliveryDirectives(e,r,n,i){let s=Rv(e);return r!=null&&r.skip&&e.deltaUpdateFailed&&(n=r.msn,i=r.part,s=Ou.No),new Iv(n,i,s)}checkRetry(e){const r=e.details,n=$c(e),i=e.errorAction,{action:s,retryCount:a=0,retryConfig:o}=i||{},l=!!i&&!!o&&(s===zt.RetryRequest||!i.resolved&&s===zt.SendAlternateToPenaltyBox);if(l){var u;if(this.requestScheduled=-1,a>=o.maxNumRetry)return!1;if(n&&(u=e.context)!=null&&u.deliveryDirectives)this.warn(`Retrying playlist loading ${a+1}/${o.maxNumRetry} after "${r}" without delivery-directives`),this.loadPlaylist();else{const c=Rm(o,a);this.timer=self.setTimeout(()=>this.loadPlaylist(),c),this.warn(`Retrying playlist loading ${a+1}/${o.maxNumRetry} after "${r}" in ${c}ms`)}e.levelRetry=!0,i.resolved=!0}return l}}class Os{constructor(e,r=0,n=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=r,this.totalWeight_=n}sample(e,r){const n=Math.pow(this.alpha_,e);this.estimate_=r*(1-n)+n*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class oO{constructor(e,r,n,i=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new Os(e),this.fast_=new Os(r),this.defaultTTFB_=i,this.ttfb_=new Os(e)}update(e,r){const{slow_:n,fast_:i,ttfb_:s}=this;n.halfLife!==e&&(this.slow_=new Os(e,n.getEstimate(),n.getTotalWeight())),i.halfLife!==r&&(this.fast_=new Os(r,i.getEstimate(),i.getTotalWeight())),s.halfLife!==e&&(this.ttfb_=new Os(e,s.getEstimate(),s.getTotalWeight()))}sample(e,r){e=Math.max(e,this.minDelayMs_);const n=8*r,i=e/1e3,s=n/i;this.fast_.sample(i,s),this.slow_.sample(i,s)}sampleTTFB(e){const r=e/1e3,n=Math.sqrt(2)*Math.exp(-Math.pow(r,2)/2);this.ttfb_.sample(n,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}destroy(){}}const DT={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]},Mv={};function lO(t,e,r,n,i,s){const a=t.audioCodec?t.audioGroups:null,o=s==null?void 0:s.audioCodec,l=s==null?void 0:s.channels,u=l?parseInt(l):o?1/0:2;let c=null;if(a!=null&&a.length)try{a.length===1&&a[0]?c=e.groups[a[0]].channels:c=a.reduce((d,f)=>{if(f){const m=e.groups[f];if(!m)throw new Error(`Audio track group ${f} not found`);Object.keys(m.channels).forEach(h=>{d[h]=(d[h]||0)+m.channels[h]})}return d},{2:0})}catch{return!0}return t.videoCodec!==void 0&&(t.width>1920&&t.height>1088||t.height>1920&&t.width>1088||t.frameRate>Math.max(n,30)||t.videoRange!=="SDR"&&t.videoRange!==r||t.bitrate>Math.max(i,8e6))||!!c&&pe(u)&&Object.keys(c).some(d=>parseInt(d)>u)}function uO(t,e,r){const n=t.videoCodec,i=t.audioCodec;if(!n||!i||!r)return Promise.resolve(DT);const s={width:t.width,height:t.height,bitrate:Math.ceil(Math.max(t.bitrate*.9,t.averageBitrate)),framerate:t.frameRate||30},a=t.videoRange;a!=="SDR"&&(s.transferFunction=a.toLowerCase());const o=n.split(",").map(l=>({type:"media-source",video:jt(jt({},s),{},{contentType:pl(l,"video")})}));return i&&t.audioGroups&&t.audioGroups.forEach(l=>{var u;l&&((u=e.groups[l])==null||u.tracks.forEach(c=>{if(c.groupId===l){const d=c.channels||"",f=parseFloat(d);pe(f)&&f>2&&o.push.apply(o,i.split(",").map(m=>({type:"media-source",audio:{contentType:pl(m,"audio"),channels:""+f}})))}}))}),Promise.all(o.map(l=>{const u=cO(l);return Mv[u]||(Mv[u]=r.decodingInfo(l))})).then(l=>({supported:!l.some(u=>!u.supported),configurations:o,decodingInfoResults:l})).catch(l=>({supported:!1,configurations:o,decodingInfoResults:[],error:l}))}function cO(t){const{audio:e,video:r}=t,n=r||e;if(n){const i=n.contentType.split('"')[1];if(r)return`r${r.height}x${r.width}f${Math.ceil(r.framerate)}${r.transferFunction||"sd"}_${i}_${Math.ceil(r.bitrate/1e5)}`;if(e)return`c${e.channels}${e.spatialRendering?"s":"n"}_${i}`}return""}function dO(){if(typeof matchMedia=="function"){const t=matchMedia("(dynamic-range: high)"),e=matchMedia("bad query");if(t.media!==e.media)return t.matches===!0}return!1}function fO(t,e){let r=!1,n=[];return t&&(r=t!=="SDR",n=[t]),e&&(n=e.allowedVideoRanges||Bc.slice(0),r=e.preferHDR!==void 0?e.preferHDR:dO(),r?n=n.filter(i=>i!=="SDR"):n=["SDR"]),{preferHDR:r,allowedVideoRanges:n}}function hO(t,e,r,n,i){const s=Object.keys(t),a=n==null?void 0:n.channels,o=n==null?void 0:n.audioCodec,l=a&&parseInt(a)===2;let u=!0,c=!1,d=1/0,f=1/0,m=1/0,h=0,p=[];const{preferHDR:v,allowedVideoRanges:g}=fO(e,i);for(let T=s.length;T--;){const C=t[s[T]];u=C.channels[2]>0,d=Math.min(d,C.minHeight),f=Math.min(f,C.minFramerate),m=Math.min(m,C.minBitrate);const _=g.filter(b=>C.videoRanges[b]>0);_.length>0&&(c=!0,p=_)}d=pe(d)?d:0,f=pe(f)?f:0;const y=Math.max(1080,d),x=Math.max(30,f);return m=pe(m)?m:r,r=Math.max(m,r),c||(e=void 0,p=[]),{codecSet:s.reduce((T,C)=>{const _=t[C];if(C===T)return T;if(_.minBitrate>r)return Wn(C,`min bitrate of ${_.minBitrate} > current estimate of ${r}`),T;if(!_.hasDefaultAudio)return Wn(C,"no renditions with default or auto-select sound found"),T;if(o&&C.indexOf(o.substring(0,4))%5!==0)return Wn(C,`audio codec preference "${o}" not found`),T;if(a&&!l){if(!_.channels[a])return Wn(C,`no renditions with ${a} channel sound found (channels options: ${Object.keys(_.channels)})`),T}else if((!o||l)&&u&&_.channels[2]===0)return Wn(C,"no renditions with stereo sound found"),T;return _.minHeight>y?(Wn(C,`min resolution of ${_.minHeight} > maximum of ${y}`),T):_.minFramerate>x?(Wn(C,`min framerate of ${_.minFramerate} > maximum of ${x}`),T):p.some(b=>_.videoRanges[b]>0)?_.maxScore<h?(Wn(C,`max score of ${_.maxScore} < selected max of ${h}`),T):T&&(Fc(C)>=Fc(T)||_.fragmentError>t[T].fragmentError)?T:(h=_.maxScore,C):(Wn(C,`no variants with VIDEO-RANGE of ${JSON.stringify(p)} found`),T)},void 0),videoRanges:p,preferHDR:v,minFramerate:f,minBitrate:m}}function Wn(t,e){U.log(`[abr] start candidates with "${t}" ignored because ${e}`)}function pO(t){return t.reduce((e,r)=>{let n=e.groups[r.groupId];n||(n=e.groups[r.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),n.tracks.push(r);const i=r.channels||"2";return n.channels[i]=(n.channels[i]||0)+1,n.hasDefault=n.hasDefault||r.default,n.hasAutoSelect=n.hasAutoSelect||r.autoselect,n.hasDefault&&(e.hasDefaultAudio=!0),n.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function mO(t,e,r,n){return t.slice(r,n+1).reduce((i,s)=>{if(!s.codecSet)return i;const a=s.audioGroups;let o=i[s.codecSet];o||(i[s.codecSet]=o={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!a,fragmentError:0}),o.minBitrate=Math.min(o.minBitrate,s.bitrate);const l=Math.min(s.height,s.width);return o.minHeight=Math.min(o.minHeight,l),o.minFramerate=Math.min(o.minFramerate,s.frameRate),o.maxScore=Math.max(o.maxScore,s.score),o.fragmentError+=s.fragmentError,o.videoRanges[s.videoRange]=(o.videoRanges[s.videoRange]||0)+1,a&&a.forEach(u=>{if(!u)return;const c=e.groups[u];c&&(o.hasDefaultAudio=o.hasDefaultAudio||e.hasDefaultAudio?c.hasDefault:c.hasAutoSelect||!e.hasDefaultAudio&&!e.hasAutoSelectAudio,Object.keys(c.channels).forEach(d=>{o.channels[d]=(o.channels[d]||0)+c.channels[d]}))}),i},{})}function Dn(t,e,r){if("attrs"in t){const n=e.indexOf(t);if(n!==-1)return n}for(let n=0;n<e.length;n++){const i=e[n];if(da(t,i,r))return n}return-1}function da(t,e,r){const{groupId:n,name:i,lang:s,assocLang:a,characteristics:o,default:l}=t,u=t.forced;return(n===void 0||e.groupId===n)&&(i===void 0||e.name===i)&&(s===void 0||e.lang===s)&&(s===void 0||e.assocLang===a)&&(l===void 0||e.default===l)&&(u===void 0||e.forced===u)&&(o===void 0||gO(o,e.characteristics))&&(r===void 0||r(t,e))}function gO(t,e=""){const r=t.split(","),n=e.split(",");return r.length===n.length&&!r.some(i=>n.indexOf(i)===-1)}function Ms(t,e){const{audioCodec:r,channels:n}=t;return(r===void 0||(e.audioCodec||"").substring(0,4)===r.substring(0,4))&&(n===void 0||n===(e.channels||"2"))}function vO(t,e,r,n,i){const s=e[n],o=e.reduce((f,m,h)=>{const p=m.uri;return(f[p]||(f[p]=[])).push(h),f},{})[s.uri];o.length>1&&(n=Math.max.apply(Math,o));const l=s.videoRange,u=s.frameRate,c=s.codecSet.substring(0,4),d=Nv(e,n,f=>{if(f.videoRange!==l||f.frameRate!==u||f.codecSet.substring(0,4)!==c)return!1;const m=f.audioGroups,h=r.filter(p=>!m||m.indexOf(p.groupId)!==-1);return Dn(t,h,i)>-1});return d>-1?d:Nv(e,n,f=>{const m=f.audioGroups,h=r.filter(p=>!m||m.indexOf(p.groupId)!==-1);return Dn(t,h,i)>-1})}function Nv(t,e,r){for(let n=e;n;n--)if(r(t[n]))return n;for(let n=e+1;n<t.length;n++)if(r(t[n]))return n;return-1}class yO{constructor(e){this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this._abandonRulesCheck=()=>{const{fragCurrent:r,partCurrent:n,hls:i}=this,{autoLevelEnabled:s,media:a}=i;if(!r||!a)return;const o=performance.now(),l=n?n.stats:r.stats,u=n?n.duration:r.duration,c=o-l.loading.start,d=i.minAutoLevel;if(l.aborted||l.loaded&&l.loaded===l.total||r.level<=d){this.clearTimer(),this._nextAutoLevel=-1;return}if(!s||a.paused||!a.playbackRate||!a.readyState)return;const f=i.mainForwardBufferInfo;if(f===null)return;const m=this.bwEstimator.getEstimateTTFB(),h=Math.abs(a.playbackRate);if(c<=Math.max(m,1e3*(u/(h*2))))return;const p=f.len/h,v=l.loading.first?l.loading.first-l.loading.start:-1,g=l.loaded&&v>-1,y=this.getBwEstimate(),x=i.levels,S=x[r.level],T=l.total||Math.max(l.loaded,Math.round(u*S.averageBitrate/8));let C=g?c-v:c;C<1&&g&&(C=Math.min(c,l.loaded*8/y));const _=g?l.loaded*1e3/C:0,b=_?(T-l.loaded)/_:T*8/y+m/1e3;if(b<=p)return;const I=_?_*8:y;let A=Number.POSITIVE_INFINITY,k;for(k=r.level-1;k>d;k--){const P=x[k].maxBitrate;if(A=this.getTimeToLoadFrag(m/1e3,I,u*P,!x[k].details),A<p)break}if(A>=b||A>u*10)return;i.nextLoadLevel=i.nextAutoLevel=k,g?this.bwEstimator.sample(c-Math.min(m,v),l.loaded):this.bwEstimator.sampleTTFB(c);const O=x[k].maxBitrate;this.getBwEstimate()*this.hls.config.abrBandWidthUpFactor>O&&this.resetEstimator(O),this.clearTimer(),U.warn(`[abr] Fragment ${r.sn}${n?" part "+n.index:""} of level ${r.level} is loading too slowly;
      Time to underbuffer: ${p.toFixed(3)} s
      Estimated load time for current fragment: ${b.toFixed(3)} s
      Estimated load time for down switch fragment: ${A.toFixed(3)} s
      TTFB estimate: ${v|0} ms
      Current BW estimate: ${pe(y)?y|0:"Unknown"} bps
      New BW estimate: ${this.getBwEstimate()|0} bps
      Switching to level ${k} @ ${O|0} bps`),i.trigger(w.FRAG_LOAD_EMERGENCY_ABORTED,{frag:r,part:n,stats:l})},this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(e){e&&(U.log(`setting initial bwe to ${e}`),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const e=this.hls.config;return new oO(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}registerListeners(){const{hls:e}=this;e.on(w.MANIFEST_LOADING,this.onManifestLoading,this),e.on(w.FRAG_LOADING,this.onFragLoading,this),e.on(w.FRAG_LOADED,this.onFragLoaded,this),e.on(w.FRAG_BUFFERED,this.onFragBuffered,this),e.on(w.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(w.LEVEL_LOADED,this.onLevelLoaded,this),e.on(w.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(w.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(w.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e&&(e.off(w.MANIFEST_LOADING,this.onManifestLoading,this),e.off(w.FRAG_LOADING,this.onFragLoading,this),e.off(w.FRAG_LOADED,this.onFragLoaded,this),e.off(w.FRAG_BUFFERED,this.onFragBuffered,this),e.off(w.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(w.LEVEL_LOADED,this.onLevelLoaded,this),e.off(w.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(w.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(w.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(e,r){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(e,r){const n=r.frag;if(!this.ignoreFragment(n)){if(!n.bitrateTest){var i;this.fragCurrent=n,this.partCurrent=(i=r.part)!=null?i:null}this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(e,r){this.clearTimer()}onError(e,r){if(!r.fatal)switch(r.details){case z.BUFFER_ADD_CODEC_ERROR:case z.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case z.FRAG_LOAD_TIMEOUT:{const n=r.frag,{fragCurrent:i,partCurrent:s}=this;if(n&&i&&n.sn===i.sn&&n.level===i.level){const a=performance.now(),o=s?s.stats:n.stats,l=a-o.loading.start,u=o.loading.first?o.loading.first-o.loading.start:-1;if(o.loaded&&u>-1){const d=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(l-Math.min(d,u),o.loaded)}else this.bwEstimator.sampleTTFB(l)}break}}}getTimeToLoadFrag(e,r,n,i){const s=e+n/r,a=i?this.lastLevelLoadSec:0;return s+a}onLevelLoaded(e,r){const n=this.hls.config,{loading:i}=r.stats,s=i.end-i.start;pe(s)&&(this.lastLevelLoadSec=s/1e3),r.details.live?this.bwEstimator.update(n.abrEwmaSlowLive,n.abrEwmaFastLive):this.bwEstimator.update(n.abrEwmaSlowVoD,n.abrEwmaFastVoD)}onFragLoaded(e,{frag:r,part:n}){const i=n?n.stats:r.stats;if(r.type===we.MAIN&&this.bwEstimator.sampleTTFB(i.loading.first-i.loading.start),!this.ignoreFragment(r)){if(this.clearTimer(),r.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const s=n?n.duration:r.duration,a=this.hls.levels[r.level],o=(a.loaded?a.loaded.bytes:0)+i.loaded,l=(a.loaded?a.loaded.duration:0)+s;a.loaded={bytes:o,duration:l},a.realBitrate=Math.round(8*o/l)}if(r.bitrateTest){const s={stats:i,frag:r,part:n,id:r.type};this.onFragBuffered(w.FRAG_BUFFERED,s),r.bitrateTest=!1}else this.lastLoadedFragLevel=r.level}}onFragBuffered(e,r){const{frag:n,part:i}=r,s=i!=null&&i.stats.loaded?i.stats:n.stats;if(s.aborted||this.ignoreFragment(n))return;const a=s.parsing.end-s.loading.start-Math.min(s.loading.first-s.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(a,s.loaded),s.bwEstimate=this.getBwEstimate(),n.bitrateTest?this.bitrateTestDelay=a/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==we.MAIN||e.sn==="initSegment"}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:e,minAutoLevel:r}=this.hls,n=this.getBwEstimate(),i=this.hls.config.maxStarvationDelay,s=this.findBestLevel(n,r,e,0,i,1,1);if(s>-1)return s;const a=this.hls.firstLevel,o=Math.min(Math.max(a,r),e);return U.warn(`[abr] Could not find best starting auto level. Defaulting to first in playlist ${a} clamped to ${o}`),o}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const e=this.forcedAutoLevel,n=this.bwEstimator.canEstimate(),i=this.lastLoadedFragLevel>-1;if(e!==-1&&(!n||!i||this.nextAutoLevelKey===this.getAutoLevelKey()))return e;const s=n&&i?this.getNextABRAutoLevel():this.firstAutoLevel;if(e!==-1){const a=this.hls.levels;if(a.length>Math.max(e,s)&&a[e].loadError<=a[s].loadError)return e}return this._nextAutoLevel=s,this.nextAutoLevelKey=this.getAutoLevelKey(),s}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:r,hls:n}=this,{maxAutoLevel:i,config:s,minAutoLevel:a}=n,o=r?r.duration:e?e.duration:0,l=this.getBwEstimate(),u=this.getStarvationDelay();let c=s.abrBandWidthFactor,d=s.abrBandWidthUpFactor;if(u){const v=this.findBestLevel(l,a,i,u,0,c,d);if(v>=0)return v}let f=o?Math.min(o,s.maxStarvationDelay):s.maxStarvationDelay;if(!u){const v=this.bitrateTestDelay;v&&(f=(o?Math.min(o,s.maxLoadingDelay):s.maxLoadingDelay)-v,U.info(`[abr] bitrate test took ${Math.round(1e3*v)}ms, set first fragment max fetchDuration to ${Math.round(1e3*f)} ms`),c=d=1)}const m=this.findBestLevel(l,a,i,u,f,c,d);if(U.info(`[abr] ${u?"rebuffering expected":"buffer is empty"}, optimal quality level ${m}`),m>-1)return m;const h=n.levels[a],p=n.levels[n.loadLevel];return(h==null?void 0:h.bitrate)<(p==null?void 0:p.bitrate)?a:n.loadLevel}getStarvationDelay(){const e=this.hls,r=e.media;if(!r)return 1/0;const n=r&&r.playbackRate!==0?Math.abs(r.playbackRate):1,i=e.mainForwardBufferInfo;return(i?i.len:0)/n}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(e,r,n,i,s,a,o){var l;const u=i+s,c=this.lastLoadedFragLevel,d=c===-1?this.hls.firstLevel:c,{fragCurrent:f,partCurrent:m}=this,{levels:h,allAudioTracks:p,loadLevel:v,config:g}=this.hls;if(h.length===1)return 0;const y=h[d],x=!!(y!=null&&(l=y.details)!=null&&l.live),S=v===-1||c===-1;let T,C="SDR",_=(y==null?void 0:y.frameRate)||0;const{audioPreference:b,videoPreference:I}=g,A=this.audioTracksByGroup||(this.audioTracksByGroup=pO(p));if(S){if(this.firstSelection!==-1)return this.firstSelection;const K=this.codecTiers||(this.codecTiers=mO(h,A,r,n)),H=hO(K,C,e,b,I),{codecSet:se,videoRanges:W,minFramerate:F,minBitrate:j,preferHDR:te}=H;T=se,C=te?W[W.length-1]:W[0],_=F,e=Math.max(e,j),U.log(`[abr] picked start tier ${JSON.stringify(H)}`)}else T=y==null?void 0:y.codecSet,C=y==null?void 0:y.videoRange;const k=m?m.duration:f?f.duration:0,O=this.bwEstimator.getEstimateTTFB()/1e3,P=[];for(let K=n;K>=r;K--){var G;const H=h[K],se=K>d;if(!H)continue;if(g.useMediaCapabilities&&!H.supportedResult&&!H.supportedPromise){const ye=navigator.mediaCapabilities;typeof(ye==null?void 0:ye.decodingInfo)=="function"&&lO(H,A,C,_,e,b)?(H.supportedPromise=uO(H,A,ye),H.supportedPromise.then(Re=>{if(!this.hls)return;H.supportedResult=Re;const Ee=this.hls.levels,Fe=Ee.indexOf(H);Re.error?U.warn(`[abr] MediaCapabilities decodingInfo error: "${Re.error}" for level ${Fe} ${JSON.stringify(Re)}`):Re.supported||(U.warn(`[abr] Unsupported MediaCapabilities decodingInfo result for level ${Fe} ${JSON.stringify(Re)}`),Fe>-1&&Ee.length>1&&(U.log(`[abr] Removing unsupported level ${Fe}`),this.hls.removeLevel(Fe)))})):H.supportedResult=DT}if(T&&H.codecSet!==T||C&&H.videoRange!==C||se&&_>H.frameRate||!se&&_>0&&_<H.frameRate||H.supportedResult&&!((G=H.supportedResult.decodingInfoResults)!=null&&G[0].smooth)){P.push(K);continue}const W=H.details,F=(m?W==null?void 0:W.partTarget:W==null?void 0:W.averagetargetduration)||k;let j;se?j=o*e:j=a*e;const te=k&&i>=k*2&&s===0?h[K].averageBitrate:h[K].maxBitrate,ee=this.getTimeToLoadFrag(O,j,te*F,W===void 0);if(j>=te&&(K===c||H.loadError===0&&H.fragmentError===0)&&(ee<=O||!pe(ee)||x&&!this.bitrateTestDelay||ee<u)){const ye=this.forcedAutoLevel;return K!==v&&(ye===-1||ye!==v)&&(P.length&&U.trace(`[abr] Skipped level(s) ${P.join(",")} of ${n} max with CODECS and VIDEO-RANGE:"${h[P[0]].codecs}" ${h[P[0]].videoRange}; not compatible with "${y.codecs}" ${C}`),U.info(`[abr] switch candidate:${d}->${K} adjustedbw(${Math.round(j)})-bitrate=${Math.round(j-te)} ttfb:${O.toFixed(1)} avgDuration:${F.toFixed(1)} maxFetchDuration:${u.toFixed(1)} fetchDuration:${ee.toFixed(1)} firstSelection:${S} codecSet:${T} videoRange:${C} hls.loadLevel:${v}`)),S&&(this.firstSelection=K),K}}return-1}set nextAutoLevel(e){const{maxAutoLevel:r,minAutoLevel:n}=this.hls,i=Math.min(Math.max(e,n),r);this._nextAutoLevel!==i&&(this.nextAutoLevelKey="",this._nextAutoLevel=i)}}class xO{constructor(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}var Bt={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class SO{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(w.BUFFER_APPENDED,this.onBufferAppended,this),e.on(w.FRAG_BUFFERED,this.onFragBuffered,this),e.on(w.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){const{hls:e}=this;e.off(w.BUFFER_APPENDED,this.onBufferAppended,this),e.off(w.FRAG_BUFFERED,this.onFragBuffered,this),e.off(w.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,r){const n=this.activePartLists[r];if(n)for(let i=n.length;i--;){const s=n[i];if(!s)break;const a=s.end;if(s.start<=e&&a!==null&&e<=a)return s}return this.getBufferedFrag(e,r)}getBufferedFrag(e,r){const{fragments:n}=this,i=Object.keys(n);for(let s=i.length;s--;){const a=n[i[s]];if((a==null?void 0:a.body.type)===r&&a.buffered){const o=a.body;if(o.start<=e&&e<=o.end)return o}}return null}detectEvictedFragments(e,r,n,i){this.timeRanges&&(this.timeRanges[e]=r);const s=(i==null?void 0:i.fragment.sn)||-1;Object.keys(this.fragments).forEach(a=>{const o=this.fragments[a];if(!o||s>=o.body.sn)return;if(!o.buffered&&!o.loaded){o.body.type===n&&this.removeFragment(o.body);return}const l=o.range[e];l&&l.time.some(u=>{const c=!this.isTimeBuffered(u.startPTS,u.endPTS,r);return c&&this.removeFragment(o.body),c})})}detectPartialFragments(e){const r=this.timeRanges,{frag:n,part:i}=e;if(!r||n.sn==="initSegment")return;const s=Ns(n),a=this.fragments[s];if(!a||a.buffered&&n.gap)return;const o=!n.relurl;Object.keys(r).forEach(l=>{const u=n.elementaryStreams[l];if(!u)return;const c=r[l],d=o||u.partial===!0;a.range[l]=this.getBufferedTimes(n,i,d,c)}),a.loaded=null,Object.keys(a.range).length?(a.buffered=!0,(a.body.endList=n.endList||a.body.endList)&&(this.endListFragments[a.body.type]=a),iu(a)||this.removeParts(n.sn-1,n.type)):this.removeFragment(a.body)}removeParts(e,r){const n=this.activePartLists[r];n&&(this.activePartLists[r]=n.filter(i=>i.fragment.sn>=e))}fragBuffered(e,r){const n=Ns(e);let i=this.fragments[n];!i&&r&&(i=this.fragments[n]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),i&&(i.loaded=null,i.buffered=!0)}getBufferedTimes(e,r,n,i){const s={time:[],partial:n},a=e.start,o=e.end,l=e.minEndPTS||o,u=e.maxStartPTS||a;for(let c=0;c<i.length;c++){const d=i.start(c)-this.bufferPadding,f=i.end(c)+this.bufferPadding;if(u>=d&&l<=f){s.time.push({startPTS:Math.max(a,i.start(c)),endPTS:Math.min(o,i.end(c))});break}else if(a<f&&o>d){const m=Math.max(a,i.start(c)),h=Math.min(o,i.end(c));h>m&&(s.partial=!0,s.time.push({startPTS:m,endPTS:h}))}else if(o<=d)break}return s}getPartialFragment(e){let r=null,n,i,s,a=0;const{bufferPadding:o,fragments:l}=this;return Object.keys(l).forEach(u=>{const c=l[u];c&&iu(c)&&(i=c.body.start-o,s=c.body.end+o,e>=i&&e<=s&&(n=Math.min(e-i,s-e),a<=n&&(r=c.body,a=n)))}),r}isEndListAppended(e){const r=this.endListFragments[e];return r!==void 0&&(r.buffered||iu(r))}getState(e){const r=Ns(e),n=this.fragments[r];return n?n.buffered?iu(n)?Bt.PARTIAL:Bt.OK:Bt.APPENDING:Bt.NOT_LOADED}isTimeBuffered(e,r,n){let i,s;for(let a=0;a<n.length;a++){if(i=n.start(a)-this.bufferPadding,s=n.end(a)+this.bufferPadding,e>=i&&r<=s)return!0;if(r<=i)return!1}return!1}onFragLoaded(e,r){const{frag:n,part:i}=r;if(n.sn==="initSegment"||n.bitrateTest)return;const s=i?null:r,a=Ns(n);this.fragments[a]={body:n,appendedPTS:null,loaded:s,buffered:!1,range:Object.create(null)}}onBufferAppended(e,r){const{frag:n,part:i,timeRanges:s}=r;if(n.sn==="initSegment")return;const a=n.type;if(i){let o=this.activePartLists[a];o||(this.activePartLists[a]=o=[]),o.push(i)}this.timeRanges=s,Object.keys(s).forEach(o=>{const l=s[o];this.detectEvictedFragments(o,l,a,i)})}onFragBuffered(e,r){this.detectPartialFragments(r)}hasFragment(e){const r=Ns(e);return!!this.fragments[r]}hasParts(e){var r;return!!((r=this.activePartLists[e])!=null&&r.length)}removeFragmentsInRange(e,r,n,i,s){i&&!this.hasGaps||Object.keys(this.fragments).forEach(a=>{const o=this.fragments[a];if(!o)return;const l=o.body;l.type!==n||i&&!l.gap||l.start<r&&l.end>e&&(o.buffered||s)&&this.removeFragment(l)})}removeFragment(e){const r=Ns(e);e.stats.loaded=0,e.clearElementaryStreamInfo();const n=this.activePartLists[e.type];if(n){const i=e.sn;this.activePartLists[e.type]=n.filter(s=>s.fragment.sn!==i)}delete this.fragments[r],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1}}function iu(t){var e,r,n;return t.buffered&&(t.body.gap||((e=t.range.video)==null?void 0:e.partial)||((r=t.range.audio)==null?void 0:r.partial)||((n=t.range.audiovideo)==null?void 0:n.partial))}function Ns(t){return`${t.type}_${t.level}_${t.sn}`}const EO={length:0,start:()=>0,end:()=>0};class at{static isBuffered(e,r){try{if(e){const n=at.getBuffered(e);for(let i=0;i<n.length;i++)if(r>=n.start(i)&&r<=n.end(i))return!0}}catch{}return!1}static bufferInfo(e,r,n){try{if(e){const i=at.getBuffered(e),s=[];let a;for(a=0;a<i.length;a++)s.push({start:i.start(a),end:i.end(a)});return this.bufferedInfo(s,r,n)}}catch{}return{len:0,start:r,end:r,nextStart:void 0}}static bufferedInfo(e,r,n){r=Math.max(0,r),e.sort(function(u,c){const d=u.start-c.start;return d||c.end-u.end});let i=[];if(n)for(let u=0;u<e.length;u++){const c=i.length;if(c){const d=i[c-1].end;e[u].start-d<n?e[u].end>d&&(i[c-1].end=e[u].end):i.push(e[u])}else i.push(e[u])}else i=e;let s=0,a,o=r,l=r;for(let u=0;u<i.length;u++){const c=i[u].start,d=i[u].end;if(r+n>=c&&r<d)o=c,l=d,s=l-r;else if(r+n<c){a=c;break}}return{len:s,start:o||0,end:l||0,nextStart:a}}static getBuffered(e){try{return e.buffered}catch(r){return U.log("failed to get media.buffered",r),EO}}}class km{constructor(e,r,n,i=0,s=-1,a=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=su(),this.buffering={audio:su(),video:su(),audiovideo:su()},this.level=e,this.sn=r,this.id=n,this.size=i,this.part=s,this.partial=a}}function su(){return{start:0,executeStart:0,executeEnd:0,end:0}}function Mu(t,e){for(let n=0,i=t.length;n<i;n++){var r;if(((r=t[n])==null?void 0:r.cc)===e)return t[n]}return null}function TO(t,e,r){return!!(e&&(r.endCC>r.startCC||t&&t.cc<r.startCC))}function wO(t,e){const r=t.fragments,n=e.fragments;if(!n.length||!r.length){U.log("No fragments to align");return}const i=Mu(r,n[0].cc);if(!i||i&&!i.startPTS){U.log("No frag in previous level to align on");return}return i}function Fv(t,e){if(t){const r=t.start+e;t.start=t.startPTS=r,t.endPTS=r+t.duration}}function PT(t,e){const r=e.fragments;for(let n=0,i=r.length;n<i;n++)Fv(r[n],t);e.fragmentHint&&Fv(e.fragmentHint,t),e.alignedSliding=!0}function bO(t,e,r){e&&(LO(t,r,e),!r.alignedSliding&&e&&Gc(r,e),!r.alignedSliding&&e&&!r.skippedSegments&&CT(e,r))}function LO(t,e,r){if(TO(t,r,e)){const n=wO(r,e);n&&pe(n.start)&&(U.log(`Adjusting PTS using last level due to CC increase within current level ${e.url}`),PT(n.start,e))}}function Gc(t,e){if(!t.hasProgramDateTime||!e.hasProgramDateTime)return;const r=t.fragments,n=e.fragments;if(!r.length||!n.length)return;let i,s;const a=Math.min(e.endCC,t.endCC);e.startCC<a&&t.startCC<a&&(i=Mu(n,a),s=Mu(r,a)),(!i||!s)&&(i=n[Math.floor(n.length/2)],s=Mu(r,i.cc)||r[Math.floor(r.length/2)]);const o=i.programDateTime,l=s.programDateTime;if(!o||!l)return;const u=(l-o)/1e3-(s.start-i.start);PT(u,t)}const Uv=Math.pow(2,17);class AO{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,r){const n=e.url;if(!n)return Promise.reject(new Zn({type:_e.NETWORK_ERROR,details:z.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error(`Fragment does not have a ${n?"part list":"url"}`),networkDetails:null}));this.abort();const i=this.config,s=i.fLoader,a=i.loader;return new Promise((o,l)=>{if(this.loader&&this.loader.destroy(),e.gap)if(e.tagList.some(m=>m[0]==="GAP")){l($v(e));return}else e.gap=!1;const u=this.loader=e.loader=s?new s(i):new a(i),c=Bv(e),d=Ov(i.fragLoadPolicy.default),f={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:e.sn==="initSegment"?1/0:Uv};e.stats=u.stats,u.load(c,f,{onSuccess:(m,h,p,v)=>{this.resetLoader(e,u);let g=m.data;p.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(g.slice(0,16)),g=g.slice(16)),o({frag:e,part:null,payload:g,networkDetails:v})},onError:(m,h,p,v)=>{this.resetLoader(e,u),l(new Zn({type:_e.NETWORK_ERROR,details:z.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:jt({url:n,data:void 0},m),error:new Error(`HTTP Error ${m.code} ${m.text}`),networkDetails:p,stats:v}))},onAbort:(m,h,p)=>{this.resetLoader(e,u),l(new Zn({type:_e.NETWORK_ERROR,details:z.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:p,stats:m}))},onTimeout:(m,h,p)=>{this.resetLoader(e,u),l(new Zn({type:_e.NETWORK_ERROR,details:z.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${f.timeout}ms`),networkDetails:p,stats:m}))},onProgress:(m,h,p,v)=>{r&&r({frag:e,part:null,payload:p,networkDetails:v})}})})}loadPart(e,r,n){this.abort();const i=this.config,s=i.fLoader,a=i.loader;return new Promise((o,l)=>{if(this.loader&&this.loader.destroy(),e.gap||r.gap){l($v(e,r));return}const u=this.loader=e.loader=s?new s(i):new a(i),c=Bv(e,r),d=Ov(i.fragLoadPolicy.default),f={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:Uv};r.stats=u.stats,u.load(c,f,{onSuccess:(m,h,p,v)=>{this.resetLoader(e,u),this.updateStatsFromPart(e,r);const g={frag:e,part:r,payload:m.data,networkDetails:v};n(g),o(g)},onError:(m,h,p,v)=>{this.resetLoader(e,u),l(new Zn({type:_e.NETWORK_ERROR,details:z.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:r,response:jt({url:c.url,data:void 0},m),error:new Error(`HTTP Error ${m.code} ${m.text}`),networkDetails:p,stats:v}))},onAbort:(m,h,p)=>{e.stats.aborted=r.stats.aborted,this.resetLoader(e,u),l(new Zn({type:_e.NETWORK_ERROR,details:z.INTERNAL_ABORTED,fatal:!1,frag:e,part:r,error:new Error("Aborted"),networkDetails:p,stats:m}))},onTimeout:(m,h,p)=>{this.resetLoader(e,u),l(new Zn({type:_e.NETWORK_ERROR,details:z.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:r,error:new Error(`Timeout after ${f.timeout}ms`),networkDetails:p,stats:m}))}})})}updateStatsFromPart(e,r){const n=e.stats,i=r.stats,s=i.total;if(n.loaded+=i.loaded,s){const l=Math.round(e.duration/r.duration),u=Math.min(Math.round(n.loaded/s),l),d=(l-u)*Math.round(n.loaded/u);n.total=n.loaded+d}else n.total=Math.max(n.loaded,n.total);const a=n.loading,o=i.loading;a.start?a.first+=o.first-o.start:(a.start=o.start,a.first=o.first),a.end=o.end}resetLoader(e,r){e.loader=null,this.loader===r&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),r.destroy()}}function Bv(t,e=null){const r=e||t,n={frag:t,part:e,responseType:"arraybuffer",url:r.url,headers:{},rangeStart:0,rangeEnd:0},i=r.byteRangeStartOffset,s=r.byteRangeEndOffset;if(pe(i)&&pe(s)){var a;let o=i,l=s;if(t.sn==="initSegment"&&((a=t.decryptdata)==null?void 0:a.method)==="AES-128"){const u=s-i;u%16&&(l=s+(16-u%16)),i!==0&&(n.resetIV=!0,o=i-16)}n.rangeStart=o,n.rangeEnd=l}return n}function $v(t,e){const r=new Error(`GAP ${t.gap?"tag":"attribute"} found`),n={type:_e.MEDIA_ERROR,details:z.FRAG_GAP,fatal:!1,frag:t,error:r,networkDetails:null};return e&&(n.part=e),(e||t).stats.aborted=!0,new Zn(n)}class Zn extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class _O{constructor(e,r){this.subtle=void 0,this.aesIV=void 0,this.subtle=e,this.aesIV=r}decrypt(e,r){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},r,e)}}class CO{constructor(e,r){this.subtle=void 0,this.key=void 0,this.subtle=e,this.key=r}expandKey(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}function RO(t){const e=t.byteLength,r=e&&new DataView(t.buffer).getUint8(e-1);return r?hs(t,0,e-r):t}class IO{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const r=new DataView(e),n=new Uint32Array(4);for(let i=0;i<4;i++)n[i]=r.getUint32(i*4);return n}initTable(){const e=this.sBox,r=this.invSBox,n=this.subMix,i=n[0],s=n[1],a=n[2],o=n[3],l=this.invSubMix,u=l[0],c=l[1],d=l[2],f=l[3],m=new Uint32Array(256);let h=0,p=0,v=0;for(v=0;v<256;v++)v<128?m[v]=v<<1:m[v]=v<<1^283;for(v=0;v<256;v++){let g=p^p<<1^p<<2^p<<3^p<<4;g=g>>>8^g&255^99,e[h]=g,r[g]=h;const y=m[h],x=m[y],S=m[x];let T=m[g]*257^g*16843008;i[h]=T<<24|T>>>8,s[h]=T<<16|T>>>16,a[h]=T<<8|T>>>24,o[h]=T,T=S*16843009^x*65537^y*257^h*16843008,u[g]=T<<24|T>>>8,c[g]=T<<16|T>>>16,d[g]=T<<8|T>>>24,f[g]=T,h?(h=y^m[m[m[S^y]]],p^=m[m[p]]):h=p=1}}expandKey(e){const r=this.uint8ArrayToUint32Array_(e);let n=!0,i=0;for(;i<r.length&&n;)n=r[i]===this.key[i],i++;if(n)return;this.key=r;const s=this.keySize=r.length;if(s!==4&&s!==6&&s!==8)throw new Error("Invalid aes key size="+s);const a=this.ksRows=(s+6+1)*4;let o,l;const u=this.keySchedule=new Uint32Array(a),c=this.invKeySchedule=new Uint32Array(a),d=this.sBox,f=this.rcon,m=this.invSubMix,h=m[0],p=m[1],v=m[2],g=m[3];let y,x;for(o=0;o<a;o++){if(o<s){y=u[o]=r[o];continue}x=y,o%s===0?(x=x<<8|x>>>24,x=d[x>>>24]<<24|d[x>>>16&255]<<16|d[x>>>8&255]<<8|d[x&255],x^=f[o/s|0]<<24):s>6&&o%s===4&&(x=d[x>>>24]<<24|d[x>>>16&255]<<16|d[x>>>8&255]<<8|d[x&255]),u[o]=y=(u[o-s]^x)>>>0}for(l=0;l<a;l++)o=a-l,l&3?x=u[o]:x=u[o-4],l<4||o<=4?c[l]=x:c[l]=h[d[x>>>24]]^p[d[x>>>16&255]]^v[d[x>>>8&255]]^g[d[x&255]],c[l]=c[l]>>>0}networkToHostOrderSwap(e){return e<<24|(e&65280)<<8|(e&16711680)>>8|e>>>24}decrypt(e,r,n){const i=this.keySize+6,s=this.invKeySchedule,a=this.invSBox,o=this.invSubMix,l=o[0],u=o[1],c=o[2],d=o[3],f=this.uint8ArrayToUint32Array_(n);let m=f[0],h=f[1],p=f[2],v=f[3];const g=new Int32Array(e),y=new Int32Array(g.length);let x,S,T,C,_,b,I,A,k,O,P,G,K,H;const se=this.networkToHostOrderSwap;for(;r<g.length;){for(k=se(g[r]),O=se(g[r+1]),P=se(g[r+2]),G=se(g[r+3]),_=k^s[0],b=G^s[1],I=P^s[2],A=O^s[3],K=4,H=1;H<i;H++)x=l[_>>>24]^u[b>>16&255]^c[I>>8&255]^d[A&255]^s[K],S=l[b>>>24]^u[I>>16&255]^c[A>>8&255]^d[_&255]^s[K+1],T=l[I>>>24]^u[A>>16&255]^c[_>>8&255]^d[b&255]^s[K+2],C=l[A>>>24]^u[_>>16&255]^c[b>>8&255]^d[I&255]^s[K+3],_=x,b=S,I=T,A=C,K=K+4;x=a[_>>>24]<<24^a[b>>16&255]<<16^a[I>>8&255]<<8^a[A&255]^s[K],S=a[b>>>24]<<24^a[I>>16&255]<<16^a[A>>8&255]<<8^a[_&255]^s[K+1],T=a[I>>>24]<<24^a[A>>16&255]<<16^a[_>>8&255]<<8^a[b&255]^s[K+2],C=a[A>>>24]<<24^a[_>>16&255]<<16^a[b>>8&255]<<8^a[I&255]^s[K+3],y[r]=se(x^m),y[r+1]=se(C^h),y[r+2]=se(T^p),y[r+3]=se(S^v),m=k,h=O,p=P,v=G,r=r+4}return y.buffer}}const kO=16;class Dm{constructor(e,{removePKCS7Padding:r=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=e.enableSoftwareAES,this.removePKCS7Padding=r,r)try{const n=self.crypto;n&&(this.subtle=n.subtle||n.webkitSubtle)}catch{}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:r}=this;if(!e||r)return this.reset(),null;const n=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?RO(n):n}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,r,n){return this.useSoftware?new Promise((i,s)=>{this.softwareDecrypt(new Uint8Array(e),r,n);const a=this.flush();a?i(a.buffer):s(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),r,n)}softwareDecrypt(e,r,n){const{currentIV:i,currentResult:s,remainderData:a}=this;this.logOnce("JS AES decrypt"),a&&(e=Jr(a,e),this.remainderData=null);const o=this.getValidChunk(e);if(!o.length)return null;i&&(n=i);let l=this.softwareDecrypter;l||(l=this.softwareDecrypter=new IO),l.expandKey(r);const u=s;return this.currentResult=l.decrypt(o.buffer,0,n),this.currentIV=hs(o,-16).buffer,u||null}webCryptoDecrypt(e,r,n){if(this.key!==r||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,r,n));this.key=r,this.fastAesKey=new CO(this.subtle,r)}return this.fastAesKey.expandKey().then(i=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),new _O(this.subtle,new Uint8Array(n)).decrypt(e.buffer,i)):Promise.reject(new Error("web crypto not initialized"))).catch(i=>(U.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${i.name}: ${i.message}`),this.onWebCryptoError(e,r,n)))}onWebCryptoError(e,r,n){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,r,n);const i=this.flush();if(i)return i.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")}getValidChunk(e){let r=e;const n=e.length-e.length%kO;return n!==e.length&&(r=hs(e,0,n),this.remainderData=hs(e,n)),r}logOnce(e){this.logEnabled&&(U.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const DO={toString:function(t){let e="";const r=t.length;for(let n=0;n<r;n++)e+=`[${t.start(n).toFixed(3)}-${t.end(n).toFixed(3)}]`;return e}},Y={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class Pm extends xO{constructor(e,r,n,i,s){super(),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=Y.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.loadedmetadata=!1,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.onvseeking=null,this.onvended=null,this.logPrefix="",this.log=void 0,this.warn=void 0,this.playlistType=s,this.logPrefix=i,this.log=U.log.bind(U,`${i}:`),this.warn=U.warn.bind(U,`${i}:`),this.hls=e,this.fragmentLoader=new AO(e.config),this.keyLoader=n,this.fragmentTracker=r,this.config=e.config,this.decrypter=new Dm(e.config),e.on(w.MANIFEST_LOADED,this.onManifestLoaded,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;e!=null&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=Y.STOPPED}_streamEnded(e,r){if(r.live||e.nextStart||!e.end||!this.media)return!1;const n=r.partList;if(n!=null&&n.length){const s=n[n.length-1];return at.isBuffered(this.media,s.start+s.duration/2)}const i=r.fragments[r.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(i)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null){var e;return(e=this.levelLastLoaded)==null?void 0:e.details}}onMediaAttached(e,r){const n=this.media=this.mediaBuffer=r.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),n.addEventListener("seeking",this.onvseeking),n.addEventListener("ended",this.onvended);const i=this.config;this.levels&&i.autoStartLoad&&this.state===Y.STOPPED&&this.startLoad(i.startPosition)}onMediaDetaching(){const e=this.media;e!=null&&e.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&this.onvseeking&&this.onvended&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}onMediaSeeking(){const{config:e,fragCurrent:r,media:n,mediaBuffer:i,state:s}=this,a=n?n.currentTime:0,o=at.bufferInfo(i||n,a,e.maxBufferHole);if(this.log(`media seeking to ${pe(a)?a.toFixed(3):a}, state: ${s}`),this.state===Y.ENDED)this.resetLoadingState();else if(r){const l=e.maxFragLookUpTolerance,u=r.start-l,c=r.start+r.duration+l;if(!o.len||c<o.start||u>o.end){const d=a>c;(a<u||d)&&(d&&r.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),r.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}n&&(this.fragmentTracker.removeFragmentsInRange(a,1/0,this.playlistType,!0),this.lastCurrentTime=a),!this.loadedmetadata&&!o.len&&(this.nextLoadPosition=this.startPosition=a),this.tickImmediate()}onMediaEnded(){this.startPosition=this.lastCurrentTime=0}onManifestLoaded(e,r){this.startTimeOffset=r.startTimeOffset,this.initPTS=[]}onHandlerDestroying(){this.hls.off(w.MANIFEST_LOADED,this.onManifestLoaded,this),this.stopLoad(),super.onHandlerDestroying(),this.hls=null}onHandlerDestroyed(){this.state=Y.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,r,n){this._loadFragForPlayback(e,r,n)}_loadFragForPlayback(e,r,n){const i=s=>{if(this.fragContextChanged(e)){this.warn(`Fragment ${e.sn}${s.part?" p: "+s.part.index:""} of level ${e.level} was dropped during download.`),this.fragmentTracker.removeFragment(e);return}e.stats.chunkCount++,this._handleFragmentLoadProgress(s)};this._doFragLoad(e,r,n,i).then(s=>{if(!s)return;const a=this.state;if(this.fragContextChanged(e)){(a===Y.FRAG_LOADING||!this.fragCurrent&&a===Y.PARSING)&&(this.fragmentTracker.removeFragment(e),this.state=Y.IDLE);return}"payload"in s&&(this.log(`Loaded fragment ${e.sn} of level ${e.level}`),this.hls.trigger(w.FRAG_LOADED,s)),this._handleFragmentLoadComplete(s)}).catch(s=>{this.state===Y.STOPPED||this.state===Y.ERROR||(this.warn(`Frag error: ${(s==null?void 0:s.message)||s}`),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var r;const{fragmentTracker:n}=this;if(n.getState(e)===Bt.APPENDING){const s=e.type,a=this.getFwdBufferInfo(this.mediaBuffer,s),o=Math.max(e.duration,a?a.len:this.config.maxBufferLength),l=this.backtrackFragment;((l?e.sn-l.sn:0)===1||this.reduceMaxBufferLength(o,e.duration))&&n.removeFragment(e)}else((r=this.mediaBuffer)==null?void 0:r.buffered.length)===0?n.removeAllFragments():n.hasParts(e.type)&&(n.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),n.getState(e)===Bt.PARTIAL&&n.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const r=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:r,part:null,stats:r.stats,id:r.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}flushMainBuffer(e,r,n=null){if(!(e-r))return;const i={startOffset:e,endOffset:r,type:n};this.hls.trigger(w.BUFFER_FLUSHING,i)}_loadInitSegment(e,r){this._doFragLoad(e,r).then(n=>{if(!n||this.fragContextChanged(e)||!this.levels)throw new Error("init load aborted");return n}).then(n=>{const{hls:i}=this,{payload:s}=n,a=e.decryptdata;if(s&&s.byteLength>0&&a!=null&&a.key&&a.iv&&a.method==="AES-128"){const o=self.performance.now();return this.decrypter.decrypt(new Uint8Array(s),a.key.buffer,a.iv.buffer).catch(l=>{throw i.trigger(w.ERROR,{type:_e.MEDIA_ERROR,details:z.FRAG_DECRYPT_ERROR,fatal:!1,error:l,reason:l.message,frag:e}),l}).then(l=>{const u=self.performance.now();return i.trigger(w.FRAG_DECRYPTED,{frag:e,payload:l,stats:{tstart:o,tdecrypt:u}}),n.payload=l,this.completeInitSegmentLoad(n)})}return this.completeInitSegmentLoad(n)}).catch(n=>{this.state===Y.STOPPED||this.state===Y.ERROR||(this.warn(n),this.resetFragmentLoading(e))})}completeInitSegmentLoad(e){const{levels:r}=this;if(!r)throw new Error("init load aborted, missing levels");const n=e.frag.stats;this.state=Y.IDLE,e.frag.data=new Uint8Array(e.payload),n.parsing.start=n.buffering.start=self.performance.now(),n.parsing.end=n.buffering.end=self.performance.now(),this.tick()}fragContextChanged(e){const{fragCurrent:r}=this;return!e||!r||e.sn!==r.sn||e.level!==r.level}fragBufferedComplete(e,r){var n,i,s,a;const o=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${e.type} sn: ${e.sn}${r?" part: "+r.index:""} of ${this.playlistType===we.MAIN?"level":"track"} ${e.level} (frag:[${((n=e.startPTS)!=null?n:NaN).toFixed(3)}-${((i=e.endPTS)!=null?i:NaN).toFixed(3)}] > buffer:${o?DO.toString(at.getBuffered(o)):"(detached)"})`),e.sn!=="initSegment"){var l;if(e.type!==we.SUBTITLE){const c=e.elementaryStreams;if(!Object.keys(c).some(d=>!!c[d])){this.state=Y.IDLE;return}}const u=(l=this.levels)==null?void 0:l[e.level];u!=null&&u.fragmentError&&(this.log(`Resetting level fragment error count of ${u.fragmentError} on frag buffered`),u.fragmentError=0)}this.state=Y.IDLE,o&&(!this.loadedmetadata&&e.type==we.MAIN&&o.buffered.length&&((s=this.fragCurrent)==null?void 0:s.sn)===((a=this.fragPrevious)==null?void 0:a.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())}seekToStartPos(){}_handleFragmentLoadComplete(e){const{transmuxer:r}=this;if(!r)return;const{frag:n,part:i,partsLoaded:s}=e,a=!s||s.length===0||s.some(l=>!l),o=new km(n.level,n.sn,n.stats.chunkCount+1,0,i?i.index:-1,!a);r.flush(o)}_handleFragmentLoadProgress(e){}_doFragLoad(e,r,n=null,i){var s;const a=r==null?void 0:r.details;if(!this.levels||!a)throw new Error(`frag load aborted, missing level${a?"":" detail"}s`);let o=null;if(e.encrypted&&!((s=e.decryptdata)!=null&&s.key)?(this.log(`Loading key for ${e.sn} of [${a.startSN}-${a.endSN}], ${this.logPrefix==="[stream-controller]"?"level":"track"} ${e.level}`),this.state=Y.KEY_LOADING,this.fragCurrent=e,o=this.keyLoader.load(e).then(c=>{if(!this.fragContextChanged(c.frag))return this.hls.trigger(w.KEY_LOADED,c),this.state===Y.KEY_LOADING&&(this.state=Y.IDLE),c}),this.hls.trigger(w.KEY_LOADING,{frag:e}),this.fragCurrent===null&&(o=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))):!e.encrypted&&a.encryptedFragments.length&&this.keyLoader.loadClear(e,a.encryptedFragments),n=Math.max(e.start,n||0),this.config.lowLatencyMode&&e.sn!=="initSegment"){const c=a.partList;if(c&&i){n>e.end&&a.fragmentHint&&(e=a.fragmentHint);const d=this.getNextPart(c,e,n);if(d>-1){const f=c[d];this.log(`Loading part sn: ${e.sn} p: ${f.index} cc: ${e.cc} of playlist [${a.startSN}-${a.endSN}] parts [0-${d}-${c.length-1}] ${this.logPrefix==="[stream-controller]"?"level":"track"}: ${e.level}, target: ${parseFloat(n.toFixed(3))}`),this.nextLoadPosition=f.start+f.duration,this.state=Y.FRAG_LOADING;let m;return o?m=o.then(h=>!h||this.fragContextChanged(h.frag)?null:this.doFragPartsLoad(e,f,r,i)).catch(h=>this.handleFragLoadError(h)):m=this.doFragPartsLoad(e,f,r,i).catch(h=>this.handleFragLoadError(h)),this.hls.trigger(w.FRAG_LOADING,{frag:e,part:f,targetBufferTime:n}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):m}else if(!e.url||this.loadedEndOfParts(c,n))return Promise.resolve(null)}}this.log(`Loading fragment ${e.sn} cc: ${e.cc} ${a?"of ["+a.startSN+"-"+a.endSN+"] ":""}${this.logPrefix==="[stream-controller]"?"level":"track"}: ${e.level}, target: ${parseFloat(n.toFixed(3))}`),pe(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=Y.FRAG_LOADING;const l=this.config.progressive;let u;return l&&o?u=o.then(c=>!c||this.fragContextChanged(c==null?void 0:c.frag)?null:this.fragmentLoader.load(e,i)).catch(c=>this.handleFragLoadError(c)):u=Promise.all([this.fragmentLoader.load(e,l?i:void 0),o]).then(([c])=>(!l&&c&&i&&i(c),c)).catch(c=>this.handleFragLoadError(c)),this.hls.trigger(w.FRAG_LOADING,{frag:e,targetBufferTime:n}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):u}doFragPartsLoad(e,r,n,i){return new Promise((s,a)=>{var o;const l=[],u=(o=n.details)==null?void 0:o.partList,c=d=>{this.fragmentLoader.loadPart(e,d,i).then(f=>{l[d.index]=f;const m=f.part;this.hls.trigger(w.FRAG_LOADED,f);const h=Dv(n,e.sn,d.index+1)||RT(u,e.sn,d.index+1);if(h)c(h);else return s({frag:e,part:m,partsLoaded:l})}).catch(a)};c(r)})}handleFragLoadError(e){if("data"in e){const r=e.data;e.data&&r.details===z.INTERNAL_ABORTED?this.handleFragLoadAborted(r.frag,r.part):this.hls.trigger(w.ERROR,r)}else this.hls.trigger(w.ERROR,{type:_e.OTHER_ERROR,details:z.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const r=this.getCurrentContext(e);if(!r||this.state!==Y.PARSING){!this.fragCurrent&&this.state!==Y.STOPPED&&this.state!==Y.ERROR&&(this.state=Y.IDLE);return}const{frag:n,part:i,level:s}=r,a=self.performance.now();n.stats.parsing.end=a,i&&(i.stats.parsing.end=a),this.updateLevelTiming(n,i,s,e.partial)}getCurrentContext(e){const{levels:r,fragCurrent:n}=this,{level:i,sn:s,part:a}=e;if(!(r!=null&&r[i]))return this.warn(`Levels object was unset while buffering fragment ${s} of level ${i}. The current chunk will not be buffered.`),null;const o=r[i],l=a>-1?Dv(o,s,a):null,u=l?l.fragment:eO(o,s,n);return u?(n&&n!==u&&(u.stats=n.stats),{frag:u,part:l,level:o}):null}bufferFragmentData(e,r,n,i,s){var a;if(!e||this.state!==Y.PARSING)return;const{data1:o,data2:l}=e;let u=o;if(o&&l&&(u=Jr(o,l)),!((a=u)!=null&&a.length))return;const c={type:e.type,frag:r,part:n,chunkMeta:i,parent:r.type,data:u};if(this.hls.trigger(w.BUFFER_APPENDING,c),e.dropped&&e.independent&&!n){if(s)return;this.flushBufferGap(r)}}flushBufferGap(e){const r=this.media;if(!r)return;if(!at.isBuffered(r,r.currentTime)){this.flushMainBuffer(0,e.start);return}const n=r.currentTime,i=at.bufferInfo(r,n,0),s=e.duration,a=Math.min(this.config.maxFragLookUpTolerance*2,s*.25),o=Math.max(Math.min(e.start-a,i.end-a),n+a);e.start-o>a&&this.flushMainBuffer(o,e.start)}getFwdBufferInfo(e,r){const n=this.getLoadPosition();return pe(n)?this.getFwdBufferInfoAtPos(e,n,r):null}getFwdBufferInfoAtPos(e,r,n){const{config:{maxBufferHole:i}}=this,s=at.bufferInfo(e,r,i);if(s.len===0&&s.nextStart!==void 0){const a=this.fragmentTracker.getBufferedFrag(r,n);if(a&&s.nextStart<a.end)return at.bufferInfo(e,r,Math.max(s.nextStart,i))}return s}getMaxBufferLength(e){const{config:r}=this;let n;return e?n=Math.max(8*r.maxBufferSize/e,r.maxBufferLength):n=r.maxBufferLength,Math.min(n,r.maxMaxBufferLength)}reduceMaxBufferLength(e,r){const n=this.config,i=Math.max(Math.min(e-r,n.maxBufferLength),r),s=Math.max(e-r*3,n.maxMaxBufferLength/2,i);return s>=i?(n.maxMaxBufferLength=s,this.warn(`Reduce max buffer length to ${s}s`),!0):!1}getAppendedFrag(e,r=we.MAIN){const n=this.fragmentTracker.getAppendedFrag(e,we.MAIN);return n&&"fragment"in n?n.fragment:n}getNextFragment(e,r){const n=r.fragments,i=n.length;if(!i)return null;const{config:s}=this,a=n[0].start;let o;if(r.live){const l=s.initialLiveManifestSize;if(i<l)return this.warn(`Not enough fragments to start playback (have: ${i}, need: ${l})`),null;(!r.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||e<a)&&(o=this.getInitialLiveFragment(r,n),this.startPosition=this.nextLoadPosition=o?this.hls.liveSyncPosition||o.start:e)}else e<=a&&(o=n[0]);if(!o){const l=s.lowLatencyMode?r.partEnd:r.fragmentEnd;o=this.getFragmentAtPosition(e,l,r)}return this.mapToInitFragWhenRequired(o)}isLoopLoading(e,r){const n=this.fragmentTracker.getState(e);return(n===Bt.OK||n===Bt.PARTIAL&&!!e.gap)&&this.nextLoadPosition>r}getNextFragmentLoopLoading(e,r,n,i,s){const a=e.gap,o=this.getNextFragment(this.nextLoadPosition,r);if(o===null)return o;if(e=o,a&&e&&!e.gap&&n.nextStart){const l=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,n.nextStart,i);if(l!==null&&n.len+l.len>=s)return this.log(`buffer full after gaps in "${i}" playlist starting at sn: ${e.sn}`),null}return e}mapToInitFragWhenRequired(e){return e!=null&&e.initSegment&&!(e!=null&&e.initSegment.data)&&!this.bitrateTest?e.initSegment:e}getNextPart(e,r,n){let i=-1,s=!1,a=!0;for(let o=0,l=e.length;o<l;o++){const u=e[o];if(a=a&&!u.independent,i>-1&&n<u.start)break;const c=u.loaded;c?i=-1:(s||u.independent||a)&&u.fragment===r&&(i=o),s=c}return i}loadedEndOfParts(e,r){const n=e[e.length-1];return n&&r>n.start&&n.loaded}getInitialLiveFragment(e,r){const n=this.fragPrevious;let i=null;if(n){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${n.programDateTime}`),i=rO(r,n.endProgramDateTime,this.config.maxFragLookUpTolerance)),!i){const s=n.sn+1;if(s>=e.startSN&&s<=e.endSN){const a=r[s-e.startSN];n.cc===a.cc&&(i=a,this.log(`Live playlist, switching playlist, load frag with next SN: ${i.sn}`))}i||(i=sO(r,n.cc),i&&this.log(`Live playlist, switching playlist, load frag with same CC: ${i.sn}`))}}else{const s=this.hls.liveSyncPosition;s!==null&&(i=this.getFragmentAtPosition(s,this.bitrateTest?e.fragmentEnd:e.edge,e))}return i}getFragmentAtPosition(e,r,n){const{config:i}=this;let{fragPrevious:s}=this,{fragments:a,endSN:o}=n;const{fragmentHint:l}=n,{maxFragLookUpTolerance:u}=i,c=n.partList,d=!!(i.lowLatencyMode&&c!=null&&c.length&&l);d&&l&&!this.bitrateTest&&(a=a.concat(l),o=l.sn);let f;if(e<r){const m=e>r-u?0:u;f=Vc(s,a,e,m)}else f=a[a.length-1];if(f){const m=f.sn-n.startSN,h=this.fragmentTracker.getState(f);if((h===Bt.OK||h===Bt.PARTIAL&&f.gap)&&(s=f),s&&f.sn===s.sn&&(!d||c[0].fragment.sn>f.sn)&&s&&f.level===s.level){const v=a[m+1];f.sn<o&&this.fragmentTracker.getState(v)!==Bt.OK?f=v:f=null}}return f}synchronizeToLiveEdge(e){const{config:r,media:n}=this;if(!n)return;const i=this.hls.liveSyncPosition,s=n.currentTime,a=e.fragments[0].start,o=e.edge,l=s>=a-r.maxFragLookUpTolerance&&s<=o;if(i!==null&&n.duration>i&&(s<i||!l)){const u=r.liveMaxLatencyDuration!==void 0?r.liveMaxLatencyDuration:r.liveMaxLatencyDurationCount*e.targetduration;(!l&&n.readyState<4||s<o-u)&&(this.loadedmetadata||(this.nextLoadPosition=i),n.readyState&&(this.warn(`Playback: ${s.toFixed(3)} is located too far from the end of live sliding playlist: ${o}, reset currentTime to : ${i.toFixed(3)}`),n.currentTime=i))}}alignPlaylists(e,r,n){const i=e.fragments.length;if(!i)return this.warn("No fragments in live playlist"),0;const s=e.fragments[0].start,a=!r,o=e.alignedSliding&&pe(s);if(a||!o&&!s){const{fragPrevious:l}=this;bO(l,n,e);const u=e.fragments[0].start;return this.log(`Live playlist sliding: ${u.toFixed(2)} start-sn: ${r?r.startSN:"na"}->${e.startSN} prev-sn: ${l?l.sn:"na"} fragments: ${i}`),u}return s}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*3)}setStartPosition(e,r){let n=this.startPosition;if(n<r&&(n=-1),n===-1||this.lastCurrentTime===-1){const i=this.startTimeOffset!==null,s=i?this.startTimeOffset:e.startTimeOffset;s!==null&&pe(s)?(n=r+s,s<0&&(n+=e.totalduration),n=Math.min(Math.max(r,n),r+e.totalduration),this.log(`Start time offset ${s} found in ${i?"multivariant":"media"} playlist, adjust startPosition to ${n}`),this.startPosition=n):e.live?n=this.hls.liveSyncPosition||r:this.startPosition=n=0,this.lastCurrentTime=n}this.nextLoadPosition=n}getLoadPosition(){const{media:e}=this;let r=0;return this.loadedmetadata&&e?r=e.currentTime:this.nextLoadPosition&&(r=this.nextLoadPosition),r}handleFragLoadAborted(e,r){this.transmuxer&&e.sn!=="initSegment"&&e.stats.aborted&&(this.warn(`Fragment ${e.sn}${r?" part "+r.index:""} of level ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){(!this.fragCurrent||!this.fragContextChanged(e)&&this.state!==Y.FRAG_LOADING_WAITING_RETRY)&&(this.state=Y.IDLE)}onFragmentOrKeyLoadError(e,r){if(r.chunkMeta&&!r.frag){const c=this.getCurrentContext(r.chunkMeta);c&&(r.frag=c.frag)}const n=r.frag;if(!n||n.type!==e||!this.levels)return;if(this.fragContextChanged(n)){var i;this.warn(`Frag load error must match current frag to retry ${n.url} > ${(i=this.fragCurrent)==null?void 0:i.url}`);return}const s=r.details===z.FRAG_GAP;s&&this.fragmentTracker.fragBuffered(n,!0);const a=r.errorAction,{action:o,retryCount:l=0,retryConfig:u}=a||{};if(a&&o===zt.RetryRequest&&u){this.resetStartWhenNotLoaded(this.levelLastLoaded);const c=Rm(u,l);this.warn(`Fragment ${n.sn} of ${e} ${n.level} errored with ${r.details}, retrying loading ${l+1}/${u.maxNumRetry} in ${c}ms`),a.resolved=!0,this.retryDate=self.performance.now()+c,this.state=Y.FRAG_LOADING_WAITING_RETRY}else if(u&&a)if(this.resetFragmentErrors(e),l<u.maxNumRetry)!s&&o!==zt.RemoveAlternatePermanently&&(a.resolved=!0);else{U.warn(`${r.details} reached or exceeded max retry (${l})`);return}else(a==null?void 0:a.action)===zt.SendAlternateToPenaltyBox?this.state=Y.WAITING_LEVEL:this.state=Y.ERROR;this.tickImmediate()}reduceLengthAndFlushBuffer(e){if(this.state===Y.PARSING||this.state===Y.PARSED){const r=e.frag,n=e.parent,i=this.getFwdBufferInfo(this.mediaBuffer,n),s=i&&i.len>.5;s&&this.reduceMaxBufferLength(i.len,(r==null?void 0:r.duration)||10);const a=!s;return a&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${n} buffer`),r&&(this.fragmentTracker.removeFragment(r),this.nextLoadPosition=r.start),this.resetLoadingState(),a}return!1}resetFragmentErrors(e){e===we.AUDIO&&(this.fragCurrent=null),this.loadedmetadata||(this.startFragRequested=!1),this.state!==Y.STOPPED&&(this.state=Y.IDLE)}afterBufferFlushed(e,r,n){if(!e)return;const i=at.getBuffered(e);this.fragmentTracker.detectEvictedFragments(r,i,n),this.state===Y.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=Y.IDLE}resetStartWhenNotLoaded(e){if(!this.loadedmetadata){this.startFragRequested=!1;const r=e?e.details:null;r!=null&&r.live?(this.startPosition=-1,this.setStartPosition(r,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.warn(`The loading context changed while buffering fragment ${e.sn} of level ${e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,r,n,i){var s;const a=n.details;if(!a){this.warn("level.details undefined");return}if(!Object.keys(e.elementaryStreams).reduce((l,u)=>{const c=e.elementaryStreams[u];if(c){const d=c.endPTS-c.startPTS;if(d<=0)return this.warn(`Could not parse fragment ${e.sn} ${u} duration reliably (${d})`),l||!1;const f=i?0:_T(a,e,c.startPTS,c.endPTS,c.startDTS,c.endDTS);return this.hls.trigger(w.LEVEL_PTS_UPDATED,{details:a,level:n,drift:f,type:u,frag:e,start:c.startPTS,end:c.endPTS}),!0}return l},!1)&&((s=this.transmuxer)==null?void 0:s.error)===null){const l=new Error(`Found no media in fragment ${e.sn} of level ${e.level} resetting transmuxer to fallback to playlist timing`);if(n.fragmentError===0&&(n.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)),this.warn(l.message),this.hls.trigger(w.ERROR,{type:_e.MEDIA_ERROR,details:z.FRAG_PARSING_ERROR,fatal:!1,error:l,frag:e,reason:`Found no media in msn ${e.sn} of level "${n.url}"`}),!this.hls)return;this.resetTransmuxer()}this.state=Y.PARSED,this.hls.trigger(w.FRAG_PARSED,{frag:e,part:r})}resetTransmuxer(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)}recoverWorkerError(e){e.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.resetTransmuxer(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState())}set state(e){const r=this._state;r!==e&&(this._state=e,this.log(`${r}->${e}`))}get state(){return this._state}}class OT{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:r}=this;let n;if(e.length)e.length===1?n=e[0]:n=PO(e,r);else return new Uint8Array(0);return this.reset(),n}reset(){this.chunks.length=0,this.dataLength=0}}function PO(t,e){const r=new Uint8Array(e);let n=0;for(let i=0;i<t.length;i++){const s=t[i];r.set(s,n),n+=s.length}return r}function OO(){return typeof __HLS_WORKER_BUNDLE__=="function"}function MO(){const t=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),e=self.URL.createObjectURL(t);return{worker:new self.Worker(e),objectURL:e}}function NO(t){const e=new self.URL(t,self.location.href).href;return{worker:new self.Worker(e),scriptURL:e}}function Ln(t="",e=9e4){return{type:t,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class Om{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,r,n,i){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,r){return!1}appendFrame(e,r,n){}demux(e,r){this.cachedData&&(e=Jr(this.cachedData,e),this.cachedData=null);let n=fl(e,0),i=n?n.length:0,s;const a=this._audioTrack,o=this._id3Track,l=n?Cm(n):void 0,u=e.length;for((this.basePTS===null||this.frameIndex===0&&pe(l))&&(this.basePTS=FO(l,r,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),n&&n.length>0&&o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:dn.audioId3,duration:Number.POSITIVE_INFINITY});i<u;){if(this.canParse(e,i)){const c=this.appendFrame(a,e,i);c?(this.frameIndex++,this.lastPTS=c.sample.pts,i+=c.length,s=i):i=u}else iP(e,i)?(n=fl(e,i),o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:dn.audioId3,duration:Number.POSITIVE_INFINITY}),i+=n.length,s=i):i++;if(i===u&&s!==u){const c=hs(e,s);this.cachedData?this.cachedData=Jr(this.cachedData,c):this.cachedData=c}}return{audioTrack:a,videoTrack:Ln(),id3Track:o,textTrack:Ln()}}demuxSampleAes(e,r,n){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const r=this.cachedData;return r&&(this.cachedData=null,this.demux(r,0)),{audioTrack:this._audioTrack,videoTrack:Ln(),id3Track:this._id3Track,textTrack:Ln()}}destroy(){}}const FO=(t,e,r)=>{if(pe(t))return t*90;const n=r?r.baseTime*9e4/r.timescale:0;return e*9e4+n};function UO(t,e,r,n){let i,s,a,o;const l=navigator.userAgent.toLowerCase(),u=n,c=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];i=((e[r+2]&192)>>>6)+1;const d=(e[r+2]&60)>>>2;if(d>c.length-1){const f=new Error(`invalid ADTS sampling index:${d}`);t.emit(w.ERROR,w.ERROR,{type:_e.MEDIA_ERROR,details:z.FRAG_PARSING_ERROR,fatal:!0,error:f,reason:f.message});return}return a=(e[r+2]&1)<<2,a|=(e[r+3]&192)>>>6,U.log(`manifest codec:${n}, ADTS type:${i}, samplingIndex:${d}`),/firefox/i.test(l)?d>=6?(i=5,o=new Array(4),s=d-3):(i=2,o=new Array(2),s=d):l.indexOf("android")!==-1?(i=2,o=new Array(2),s=d):(i=5,o=new Array(4),n&&(n.indexOf("mp4a.40.29")!==-1||n.indexOf("mp4a.40.5")!==-1)||!n&&d>=6?s=d-3:((n&&n.indexOf("mp4a.40.2")!==-1&&(d>=6&&a===1||/vivaldi/i.test(l))||!n&&a===1)&&(i=2,o=new Array(2)),s=d)),o[0]=i<<3,o[0]|=(d&14)>>1,o[1]|=(d&1)<<7,o[1]|=a<<3,i===5&&(o[1]|=(s&14)>>1,o[2]=(s&1)<<7,o[2]|=8,o[3]=0),{config:o,samplerate:c[d],channelCount:a,codec:"mp4a.40."+i,manifestCodec:u}}function MT(t,e){return t[e]===255&&(t[e+1]&246)===240}function NT(t,e){return t[e+1]&1?7:9}function Mm(t,e){return(t[e+3]&3)<<11|t[e+4]<<3|(t[e+5]&224)>>>5}function BO(t,e){return e+5<t.length}function zc(t,e){return e+1<t.length&&MT(t,e)}function $O(t,e){return BO(t,e)&&MT(t,e)&&Mm(t,e)<=t.length-e}function jO(t,e){if(zc(t,e)){const r=NT(t,e);if(e+r>=t.length)return!1;const n=Mm(t,e);if(n<=r)return!1;const i=e+n;return i===t.length||zc(t,i)}return!1}function FT(t,e,r,n,i){if(!t.samplerate){const s=UO(e,r,n,i);if(!s)return;t.config=s.config,t.samplerate=s.samplerate,t.channelCount=s.channelCount,t.codec=s.codec,t.manifestCodec=s.manifestCodec,U.log(`parsed codec:${t.codec}, rate:${s.samplerate}, channels:${s.channelCount}`)}}function UT(t){return 1024*9e4/t}function VO(t,e){const r=NT(t,e);if(e+r<=t.length){const n=Mm(t,e)-r;if(n>0)return{headerLength:r,frameLength:n}}}function BT(t,e,r,n,i){const s=UT(t.samplerate),a=n+i*s,o=VO(e,r);let l;if(o){const{frameLength:d,headerLength:f}=o,m=f+d,h=Math.max(0,r+m-e.length);h?(l=new Uint8Array(m-f),l.set(e.subarray(r+f,e.length),0)):l=e.subarray(r+f,r+m);const p={unit:l,pts:a};return h||t.samples.push(p),{sample:p,length:m,missing:h}}const u=e.length-r;return l=new Uint8Array(u),l.set(e.subarray(r,e.length),0),{sample:{unit:l,pts:a},length:u,missing:-1}}let au=null;const GO=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],zO=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],HO=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],WO=[0,1,1,4];function $T(t,e,r,n,i){if(r+24>e.length)return;const s=jT(e,r);if(s&&r+s.frameLength<=e.length){const a=s.samplesPerFrame*9e4/s.sampleRate,o=n+i*a,l={unit:e.subarray(r,r+s.frameLength),pts:o,dts:o};return t.config=[],t.channelCount=s.channelCount,t.samplerate=s.sampleRate,t.samples.push(l),{sample:l,length:s.frameLength,missing:0}}}function jT(t,e){const r=t[e+1]>>3&3,n=t[e+1]>>1&3,i=t[e+2]>>4&15,s=t[e+2]>>2&3;if(r!==1&&i!==0&&i!==15&&s!==3){const a=t[e+2]>>1&1,o=t[e+3]>>6,l=r===3?3-n:n===3?3:4,u=GO[l*14+i-1]*1e3,d=zO[(r===3?0:r===2?1:2)*3+s],f=o===3?1:2,m=HO[r][n],h=WO[n],p=m*8*h,v=Math.floor(m*u/d+a)*h;if(au===null){const x=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);au=x?parseInt(x[1]):0}return!!au&&au<=87&&n===2&&u>=224e3&&o===0&&(t[e+3]=t[e+3]|128),{sampleRate:d,channelCount:f,frameLength:v,samplesPerFrame:p}}}function Nm(t,e){return t[e]===255&&(t[e+1]&224)===224&&(t[e+1]&6)!==0}function VT(t,e){return e+1<t.length&&Nm(t,e)}function KO(t,e){return Nm(t,e)&&4<=t.length-e}function GT(t,e){if(e+1<t.length&&Nm(t,e)){const n=jT(t,e);let i=4;n!=null&&n.frameLength&&(i=n.frameLength);const s=e+i;return s===t.length||VT(t,s)}return!1}class YO extends Om{constructor(e,r){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=r}resetInitSegment(e,r,n,i){super.resetInitSegment(e,r,n,i),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:r,duration:i,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const r=fl(e,0);let n=(r==null?void 0:r.length)||0;if(GT(e,n))return!1;for(let i=e.length;n<i;n++)if(jO(e,n))return U.log("ADTS sync word found !"),!0;return!1}canParse(e,r){return $O(e,r)}appendFrame(e,r,n){FT(e,this.observer,r,n,e.manifestCodec);const i=BT(e,r,n,this.basePTS,this.frameIndex);if(i&&i.missing===0)return i}}const qO=/\/emsg[-/]ID3/i;class XO{constructor(e,r){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=r}resetTimeStamp(){}resetInitSegment(e,r,n,i){const s=this.videoTrack=Ln("video",1),a=this.audioTrack=Ln("audio",1),o=this.txtTrack=Ln("text",1);if(this.id3Track=Ln("id3",1),this.timeOffset=0,!(e!=null&&e.byteLength))return;const l=xT(e);if(l.video){const{id:u,timescale:c,codec:d}=l.video;s.id=u,s.timescale=o.timescale=c,s.codec=d}if(l.audio){const{id:u,timescale:c,codec:d}=l.audio;a.id=u,a.timescale=c,a.codec=d}o.id=gT.text,s.sampleDuration=0,s.duration=a.duration=i}resetContiguity(){this.remainderData=null}static probe(e){return hP(e)}demux(e,r){this.timeOffset=r;let n=e;const i=this.videoTrack,s=this.txtTrack;if(this.config.progressive){this.remainderData&&(n=Jr(this.remainderData,e));const o=EP(n);this.remainderData=o.remainder,i.samples=o.valid||new Uint8Array}else i.samples=n;const a=this.extractID3Track(i,r);return s.samples=hv(r,i),{videoTrack:i,audioTrack:this.audioTrack,id3Track:a,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,r=this.videoTrack,n=this.txtTrack;r.samples=this.remainderData||new Uint8Array,this.remainderData=null;const i=this.extractID3Track(r,this.timeOffset);return n.samples=hv(e,r),{videoTrack:r,audioTrack:Ln(),id3Track:i,textTrack:Ln()}}extractID3Track(e,r){const n=this.id3Track;if(e.samples.length){const i=Oe(e.samples,["emsg"]);i&&i.forEach(s=>{const a=bP(s);if(qO.test(a.schemeIdUri)){const o=pe(a.presentationTime)?a.presentationTime/a.timeScale:r+a.presentationTimeDelta/a.timeScale;let l=a.eventDuration===4294967295?Number.POSITIVE_INFINITY:a.eventDuration/a.timeScale;l<=.001&&(l=Number.POSITIVE_INFINITY);const u=a.payload;n.samples.push({data:u,len:u.byteLength,dts:o,pts:o,type:dn.emsg,duration:l})}})}return n}demuxSampleAes(e,r,n){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){}}const zT=(t,e)=>{let r=0,n=5;e+=n;const i=new Uint32Array(1),s=new Uint32Array(1),a=new Uint8Array(1);for(;n>0;){a[0]=t[e];const o=Math.min(n,8),l=8-o;s[0]=4278190080>>>24+l<<l,i[0]=(a[0]&s[0])>>l,r=r?r<<o|i[0]:i[0],e+=1,n-=o}return r};class ZO extends Om{constructor(e){super(),this.observer=void 0,this.observer=e}resetInitSegment(e,r,n,i){super.resetInitSegment(e,r,n,i),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:r,duration:i,inputTimeScale:9e4,dropped:0}}canParse(e,r){return r+64<e.length}appendFrame(e,r,n){const i=HT(e,r,n,this.basePTS,this.frameIndex);if(i!==-1)return{sample:e.samples[e.samples.length-1],length:i,missing:0}}static probe(e){if(!e)return!1;const r=fl(e,0);if(!r)return!1;const n=r.length;return e[n]===11&&e[n+1]===119&&Cm(r)!==void 0&&zT(e,n)<16}}function HT(t,e,r,n,i){if(r+8>e.length||e[r]!==11||e[r+1]!==119)return-1;const s=e[r+4]>>6;if(s>=3)return-1;const o=[48e3,44100,32e3][s],l=e[r+4]&63,c=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][l*3+s]*2;if(r+c>e.length)return-1;const d=e[r+6]>>5;let f=0;d===2?f+=2:(d&1&&d!==1&&(f+=2),d&4&&(f+=2));const m=(e[r+6]<<8|e[r+7])>>12-f&1,p=[2,1,2,3,3,4,4,5][d]+m,v=e[r+5]>>3,g=e[r+5]&7,y=new Uint8Array([s<<6|v<<1|g>>2,(g&3)<<6|d<<3|m<<2|l>>4,l<<4&224]),x=1536/o*9e4,S=n+i*x,T=e.subarray(r,r+c);return t.config=y,t.channelCount=p,t.samplerate=o,t.samples.push({unit:T,pts:S}),c}class QO{constructor(){this.VideoSample=null}createVideoSample(e,r,n,i){return{key:e,frame:!1,pts:r,dts:n,units:[],debug:i,length:0}}getLastNalUnit(e){var r;let n=this.VideoSample,i;if((!n||n.units.length===0)&&(n=e[e.length-1]),(r=n)!=null&&r.units){const s=n.units;i=s[s.length-1]}return i}pushAccessUnit(e,r){if(e.units.length&&e.frame){if(e.pts===void 0){const n=r.samples,i=n.length;if(i){const s=n[i-1];e.pts=s.pts,e.dts=s.dts}else{r.dropped++;return}}r.samples.push(e)}e.debug.length&&U.log(e.pts+"/"+e.dts+":"+e.debug)}}class jv{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,r=this.bytesAvailable,n=e.byteLength-r,i=new Uint8Array(4),s=Math.min(4,r);if(s===0)throw new Error("no bytes available");i.set(e.subarray(n,n+s)),this.word=new DataView(i.buffer).getUint32(0),this.bitsAvailable=s*8,this.bytesAvailable-=s}skipBits(e){let r;e=Math.min(e,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,r=e>>3,e-=r<<3,this.bytesAvailable-=r,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let r=Math.min(this.bitsAvailable,e);const n=this.word>>>32-r;if(e>32&&U.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=r,this.bitsAvailable>0)this.word<<=r;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return r=e-r,r>0&&this.bitsAvailable?n<<r|this.readBits(r):n}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if(this.word&2147483648>>>e)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}skipScalingList(e){let r=8,n=8,i;for(let s=0;s<e;s++)n!==0&&(i=this.readEG(),n=(r+i+256)%256),r=n===0?r:n}readSPS(){let e=0,r=0,n=0,i=0,s,a,o;const l=this.readUByte.bind(this),u=this.readBits.bind(this),c=this.readUEG.bind(this),d=this.readBoolean.bind(this),f=this.skipBits.bind(this),m=this.skipEG.bind(this),h=this.skipUEG.bind(this),p=this.skipScalingList.bind(this);l();const v=l();if(u(5),f(3),l(),h(),v===100||v===110||v===122||v===244||v===44||v===83||v===86||v===118||v===128){const C=c();if(C===3&&f(1),h(),h(),f(1),d())for(a=C!==3?8:12,o=0;o<a;o++)d()&&(o<6?p(16):p(64))}h();const g=c();if(g===0)c();else if(g===1)for(f(1),m(),m(),s=c(),o=0;o<s;o++)m();h(),f(1);const y=c(),x=c(),S=u(1);S===0&&f(1),f(1),d()&&(e=c(),r=c(),n=c(),i=c());let T=[1,1];if(d()&&d())switch(l()){case 1:T=[1,1];break;case 2:T=[12,11];break;case 3:T=[10,11];break;case 4:T=[16,11];break;case 5:T=[40,33];break;case 6:T=[24,11];break;case 7:T=[20,11];break;case 8:T=[32,11];break;case 9:T=[80,33];break;case 10:T=[18,11];break;case 11:T=[15,11];break;case 12:T=[64,33];break;case 13:T=[160,99];break;case 14:T=[4,3];break;case 15:T=[3,2];break;case 16:T=[2,1];break;case 255:{T=[l()<<8|l(),l()<<8|l()];break}}return{width:Math.ceil((y+1)*16-e*2-r*2),height:(2-S)*(x+1)*16-(S?2:4)*(n+i),pixelRatio:T}}readSliceType(){return this.readUByte(),this.readUEG(),this.readUEG()}}class JO extends QO{parseAVCPES(e,r,n,i,s){const a=this.parseAVCNALu(e,n.data);let o=this.VideoSample,l,u=!1;n.data=null,o&&a.length&&!e.audFound&&(this.pushAccessUnit(o,e),o=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts,"")),a.forEach(c=>{var d;switch(c.type){case 1:{let p=!1;l=!0;const v=c.data;if(u&&v.length>4){const g=new jv(v).readSliceType();(g===2||g===4||g===7||g===9)&&(p=!0)}if(p){var f;(f=o)!=null&&f.frame&&!o.key&&(this.pushAccessUnit(o,e),o=this.VideoSample=null)}o||(o=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts,"")),o.frame=!0,o.key=p;break}case 5:l=!0,(d=o)!=null&&d.frame&&!o.key&&(this.pushAccessUnit(o,e),o=this.VideoSample=null),o||(o=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts,"")),o.key=!0,o.frame=!0;break;case 6:{l=!0,ET(c.data,1,n.pts,r.samples);break}case 7:{var m,h;l=!0,u=!0;const p=c.data,g=new jv(p).readSPS();if(!e.sps||e.width!==g.width||e.height!==g.height||((m=e.pixelRatio)==null?void 0:m[0])!==g.pixelRatio[0]||((h=e.pixelRatio)==null?void 0:h[1])!==g.pixelRatio[1]){e.width=g.width,e.height=g.height,e.pixelRatio=g.pixelRatio,e.sps=[p],e.duration=s;const y=p.subarray(1,4);let x="avc1.";for(let S=0;S<3;S++){let T=y[S].toString(16);T.length<2&&(T="0"+T),x+=T}e.codec=x}break}case 8:l=!0,e.pps=[c.data];break;case 9:l=!0,e.audFound=!0,o&&this.pushAccessUnit(o,e),o=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts,"");break;case 12:l=!0;break;default:l=!1,o&&(o.debug+="unknown NAL "+c.type+" ");break}o&&l&&o.units.push(c)}),i&&o&&(this.pushAccessUnit(o,e),this.VideoSample=null)}parseAVCNALu(e,r){const n=r.byteLength;let i=e.naluState||0;const s=i,a=[];let o=0,l,u,c,d=-1,f=0;for(i===-1&&(d=0,f=r[0]&31,i=0,o=1);o<n;){if(l=r[o++],!i){i=l?0:1;continue}if(i===1){i=l?0:2;continue}if(!l)i=3;else if(l===1){if(u=o-i-1,d>=0){const m={data:r.subarray(d,u),type:f};a.push(m)}else{const m=this.getLastNalUnit(e.samples);m&&(s&&o<=4-s&&m.state&&(m.data=m.data.subarray(0,m.data.byteLength-s)),u>0&&(m.data=Jr(m.data,r.subarray(0,u)),m.state=0))}o<n?(c=r[o]&31,d=o,f=c,i=0):i=-1}else i=0}if(d>=0&&i>=0){const m={data:r.subarray(d,n),type:f,state:i};a.push(m)}if(a.length===0){const m=this.getLastNalUnit(e.samples);m&&(m.data=Jr(m.data,r))}return e.naluState=i,a}}class eM{constructor(e,r,n){this.keyData=void 0,this.decrypter=void 0,this.keyData=n,this.decrypter=new Dm(r,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer)}decryptAacSample(e,r,n){const i=e[r].unit;if(i.length<=16)return;const s=i.subarray(16,i.length-i.length%16),a=s.buffer.slice(s.byteOffset,s.byteOffset+s.length);this.decryptBuffer(a).then(o=>{const l=new Uint8Array(o);i.set(l,16),this.decrypter.isSync()||this.decryptAacSamples(e,r+1,n)})}decryptAacSamples(e,r,n){for(;;r++){if(r>=e.length){n();return}if(!(e[r].unit.length<32)&&(this.decryptAacSample(e,r,n),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const r=Math.floor((e.length-48)/160)*16+16,n=new Int8Array(r);let i=0;for(let s=32;s<e.length-16;s+=160,i+=16)n.set(e.subarray(s,s+16),i);return n}getAvcDecryptedUnit(e,r){const n=new Uint8Array(r);let i=0;for(let s=32;s<e.length-16;s+=160,i+=16)e.set(n.subarray(i,i+16),s);return e}decryptAvcSample(e,r,n,i,s){const a=TT(s.data),o=this.getAvcEncryptedData(a);this.decryptBuffer(o.buffer).then(l=>{s.data=this.getAvcDecryptedUnit(a,l),this.decrypter.isSync()||this.decryptAvcSamples(e,r,n+1,i)})}decryptAvcSamples(e,r,n,i){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;r++,n=0){if(r>=e.length){i();return}const s=e[r].units;for(;!(n>=s.length);n++){const a=s[n];if(!(a.data.length<=48||a.type!==1&&a.type!==5)&&(this.decryptAvcSample(e,r,n,i,a),!this.decrypter.isSync()))return}}}}const Ft=188;class Ti{constructor(e,r,n){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=r,this.typeSupported=n,this.videoParser=new JO}static probe(e){const r=Ti.syncOffset(e);return r>0&&U.warn(`MPEG2-TS detected but first sync word found @ offset ${r}`),r!==-1}static syncOffset(e){const r=e.length;let n=Math.min(Ft*5,r-Ft)+1,i=0;for(;i<n;){let s=!1,a=-1,o=0;for(let l=i;l<r;l+=Ft)if(e[l]===71&&(r-l===Ft||e[l+Ft]===71)){if(o++,a===-1&&(a=l,a!==0&&(n=Math.min(a+Ft*99,e.length-Ft)+1)),s||(s=ep(e,l)===0),s&&o>1&&(a===0&&o>2||l+Ft>n))return a}else{if(o)return-1;break}i++}return-1}static createTrack(e,r){return{container:e==="video"||e==="audio"?"video/mp2t":void 0,type:e,id:gT[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:e==="audio"?r:void 0}}resetInitSegment(e,r,n,i){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=Ti.createTrack("video"),this._audioTrack=Ti.createTrack("audio",i),this._id3Track=Ti.createTrack("id3"),this._txtTrack=Ti.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.remainderData=null,this.audioCodec=r,this.videoCodec=n,this._duration=i}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_videoTrack:r,_id3Track:n}=this;e&&(e.pesData=null),r&&(r.pesData=null),n&&(n.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(e,r,n=!1,i=!1){n||(this.sampleAes=null);let s;const a=this._videoTrack,o=this._audioTrack,l=this._id3Track,u=this._txtTrack;let c=a.pid,d=a.pesData,f=o.pid,m=l.pid,h=o.pesData,p=l.pesData,v=null,g=this.pmtParsed,y=this._pmtId,x=e.length;if(this.remainderData&&(e=Jr(this.remainderData,e),x=e.length,this.remainderData=null),x<Ft&&!i)return this.remainderData=e,{audioTrack:o,videoTrack:a,id3Track:l,textTrack:u};const S=Math.max(0,Ti.syncOffset(e));x-=(x-S)%Ft,x<e.byteLength&&!i&&(this.remainderData=new Uint8Array(e.buffer,x,e.buffer.byteLength-x));let T=0;for(let _=S;_<x;_+=Ft)if(e[_]===71){const b=!!(e[_+1]&64),I=ep(e,_),A=(e[_+3]&48)>>4;let k;if(A>1){if(k=_+5+e[_+4],k===_+Ft)continue}else k=_+4;switch(I){case c:b&&(d&&(s=Fs(d))&&this.videoParser.parseAVCPES(a,u,s,!1,this._duration),d={data:[],size:0}),d&&(d.data.push(e.subarray(k,_+Ft)),d.size+=_+Ft-k);break;case f:if(b){if(h&&(s=Fs(h)))switch(o.segmentCodec){case"aac":this.parseAACPES(o,s);break;case"mp3":this.parseMPEGPES(o,s);break;case"ac3":this.parseAC3PES(o,s);break}h={data:[],size:0}}h&&(h.data.push(e.subarray(k,_+Ft)),h.size+=_+Ft-k);break;case m:b&&(p&&(s=Fs(p))&&this.parseID3PES(l,s),p={data:[],size:0}),p&&(p.data.push(e.subarray(k,_+Ft)),p.size+=_+Ft-k);break;case 0:b&&(k+=e[k]+1),y=this._pmtId=tM(e,k);break;case y:{b&&(k+=e[k]+1);const O=rM(e,k,this.typeSupported,n,this.observer);c=O.videoPid,c>0&&(a.pid=c,a.segmentCodec=O.segmentVideoCodec),f=O.audioPid,f>0&&(o.pid=f,o.segmentCodec=O.segmentAudioCodec),m=O.id3Pid,m>0&&(l.pid=m),v!==null&&!g&&(U.warn(`MPEG-TS PMT found at ${_} after unknown PID '${v}'. Backtracking to sync byte @${S} to parse all TS packets.`),v=null,_=S-188),g=this.pmtParsed=!0;break}case 17:case 8191:break;default:v=I;break}}else T++;T>0&&Hc(this.observer,new Error(`Found ${T} TS packet/s that do not start with 0x47`)),a.pesData=d,o.pesData=h,l.pesData=p;const C={audioTrack:o,videoTrack:a,id3Track:l,textTrack:u};return i&&this.extractRemainingSamples(C),C}flush(){const{remainderData:e}=this;this.remainderData=null;let r;return e?r=this.demux(e,-1,!1,!0):r={videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(r),this.sampleAes?this.decrypt(r,this.sampleAes):r}extractRemainingSamples(e){const{audioTrack:r,videoTrack:n,id3Track:i,textTrack:s}=e,a=n.pesData,o=r.pesData,l=i.pesData;let u;if(a&&(u=Fs(a))?(this.videoParser.parseAVCPES(n,s,u,!0,this._duration),n.pesData=null):n.pesData=a,o&&(u=Fs(o))){switch(r.segmentCodec){case"aac":this.parseAACPES(r,u);break;case"mp3":this.parseMPEGPES(r,u);break;case"ac3":this.parseAC3PES(r,u);break}r.pesData=null}else o!=null&&o.size&&U.log("last AAC PES packet truncated,might overlap between fragments"),r.pesData=o;l&&(u=Fs(l))?(this.parseID3PES(i,u),i.pesData=null):i.pesData=l}demuxSampleAes(e,r,n){const i=this.demux(e,n,!0,!this.config.progressive),s=this.sampleAes=new eM(this.observer,this.config,r);return this.decrypt(i,s)}decrypt(e,r){return new Promise(n=>{const{audioTrack:i,videoTrack:s}=e;i.samples&&i.segmentCodec==="aac"?r.decryptAacSamples(i.samples,0,()=>{s.samples?r.decryptAvcSamples(s.samples,0,0,()=>{n(e)}):n(e)}):s.samples&&r.decryptAvcSamples(s.samples,0,0,()=>{n(e)})})}destroy(){this._duration=0}parseAACPES(e,r){let n=0;const i=this.aacOverFlow;let s=r.data;if(i){this.aacOverFlow=null;const d=i.missing,f=i.sample.unit.byteLength;if(d===-1)s=Jr(i.sample.unit,s);else{const m=f-d;i.sample.unit.set(s.subarray(0,d),m),e.samples.push(i.sample),n=i.missing}}let a,o;for(a=n,o=s.length;a<o-1&&!zc(s,a);a++);if(a!==n){let d;const f=a<o-1;if(f?d=`AAC PES did not start with ADTS header,offset:${a}`:d="No ADTS header found in AAC PES",Hc(this.observer,new Error(d),f),!f)return}FT(e,this.observer,s,a,this.audioCodec);let l;if(r.pts!==void 0)l=r.pts;else if(i){const d=UT(e.samplerate);l=i.sample.pts+d}else{U.warn("[tsdemuxer]: AAC PES unknown PTS");return}let u=0,c;for(;a<o;)if(c=BT(e,s,a,l,u),a+=c.length,c.missing){this.aacOverFlow=c;break}else for(u++;a<o-1&&!zc(s,a);a++);}parseMPEGPES(e,r){const n=r.data,i=n.length;let s=0,a=0;const o=r.pts;if(o===void 0){U.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;a<i;)if(VT(n,a)){const l=$T(e,n,a,o,s);if(l)a+=l.length,s++;else break}else a++}parseAC3PES(e,r){{const n=r.data,i=r.pts;if(i===void 0){U.warn("[tsdemuxer]: AC3 PES unknown PTS");return}const s=n.length;let a=0,o=0,l;for(;o<s&&(l=HT(e,n,o,i,a++))>0;)o+=l}}parseID3PES(e,r){if(r.pts===void 0){U.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const n=It({},r,{type:this._videoTrack?dn.emsg:dn.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(n)}}function ep(t,e){return((t[e+1]&31)<<8)+t[e+2]}function tM(t,e){return(t[e+10]&31)<<8|t[e+11]}function rM(t,e,r,n,i){const s={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},a=(t[e+1]&15)<<8|t[e+2],o=e+3+a-4,l=(t[e+10]&15)<<8|t[e+11];for(e+=12+l;e<o;){const u=ep(t,e),c=(t[e+3]&15)<<8|t[e+4];switch(t[e]){case 207:if(!n){Cf("ADTS AAC");break}case 15:s.audioPid===-1&&(s.audioPid=u);break;case 21:s.id3Pid===-1&&(s.id3Pid=u);break;case 219:if(!n){Cf("H.264");break}case 27:s.videoPid===-1&&(s.videoPid=u,s.segmentVideoCodec="avc");break;case 3:case 4:!r.mpeg&&!r.mp3?U.log("MPEG audio found, not supported in this browser"):s.audioPid===-1&&(s.audioPid=u,s.segmentAudioCodec="mp3");break;case 193:if(!n){Cf("AC-3");break}case 129:r.ac3?s.audioPid===-1&&(s.audioPid=u,s.segmentAudioCodec="ac3"):U.log("AC-3 audio found, not supported in this browser");break;case 6:if(s.audioPid===-1&&c>0){let d=e+5,f=c;for(;f>2;){switch(t[d]){case 106:r.ac3!==!0?U.log("AC-3 audio found, not supported in this browser for now"):(s.audioPid=u,s.segmentAudioCodec="ac3");break}const h=t[d+1]+2;d+=h,f-=h}}break;case 194:case 135:return Hc(i,new Error("Unsupported EC-3 in M2TS found")),s;case 36:return Hc(i,new Error("Unsupported HEVC in M2TS found")),s}e+=c+5}return s}function Hc(t,e,r){U.warn(`parsing error: ${e.message}`),t.emit(w.ERROR,w.ERROR,{type:_e.MEDIA_ERROR,details:z.FRAG_PARSING_ERROR,fatal:!1,levelRetry:r,error:e,reason:e.message})}function Cf(t){U.log(`${t} with AES-128-CBC encryption found in unencrypted stream`)}function Fs(t){let e=0,r,n,i,s,a;const o=t.data;if(!t||t.size===0)return null;for(;o[0].length<19&&o.length>1;)o[0]=Jr(o[0],o[1]),o.splice(1,1);if(r=o[0],(r[0]<<16)+(r[1]<<8)+r[2]===1){if(n=(r[4]<<8)+r[5],n&&n>t.size-6)return null;const u=r[7];u&192&&(s=(r[9]&14)*536870912+(r[10]&255)*4194304+(r[11]&254)*16384+(r[12]&255)*128+(r[13]&254)/2,u&64?(a=(r[14]&14)*536870912+(r[15]&255)*4194304+(r[16]&254)*16384+(r[17]&255)*128+(r[18]&254)/2,s-a>60*9e4&&(U.warn(`${Math.round((s-a)/9e4)}s delta between PTS and DTS, align them`),s=a)):a=s),i=r[8];let c=i+9;if(t.size<=c)return null;t.size-=c;const d=new Uint8Array(t.size);for(let f=0,m=o.length;f<m;f++){r=o[f];let h=r.byteLength;if(c)if(c>h){c-=h;continue}else r=r.subarray(c),h-=c,c=0;d.set(r,e),e+=h}return n&&(n-=i+3),{data:d,pts:s,dts:a,len:n}}return null}class nM extends Om{resetInitSegment(e,r,n,i){super.resetInitSegment(e,r,n,i),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:r,duration:i,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const r=fl(e,0);let n=(r==null?void 0:r.length)||0;if(r&&e[n]===11&&e[n+1]===119&&Cm(r)!==void 0&&zT(e,n)<=16)return!1;for(let i=e.length;n<i;n++)if(GT(e,n))return U.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,r){return KO(e,r)}appendFrame(e,r,n){if(this.basePTS!==null)return $T(e,r,n,this.basePTS,this.frameIndex)}}class Vv{static getSilentFrame(e,r){switch(e){case"mp4a.40.2":if(r===1)return new Uint8Array([0,200,0,128,35,128]);if(r===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(r===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(r===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(r===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(r===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(r===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(r===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(r===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const yi=Math.pow(2,32)-1;class B{static init(){B.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let e;for(e in B.types)B.types.hasOwnProperty(e)&&(B.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const r=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);B.HDLR_TYPES={video:r,audio:n};const i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),s=new Uint8Array([0,0,0,0,0,0,0,0]);B.STTS=B.STSC=B.STCO=s,B.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),B.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),B.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),B.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const a=new Uint8Array([105,115,111,109]),o=new Uint8Array([97,118,99,49]),l=new Uint8Array([0,0,0,1]);B.FTYP=B.box(B.types.ftyp,a,l,a,o),B.DINF=B.box(B.types.dinf,B.box(B.types.dref,i))}static box(e,...r){let n=8,i=r.length;const s=i;for(;i--;)n+=r[i].byteLength;const a=new Uint8Array(n);for(a[0]=n>>24&255,a[1]=n>>16&255,a[2]=n>>8&255,a[3]=n&255,a.set(e,4),i=0,n=8;i<s;i++)a.set(r[i],n),n+=r[i].byteLength;return a}static hdlr(e){return B.box(B.types.hdlr,B.HDLR_TYPES[e])}static mdat(e){return B.box(B.types.mdat,e)}static mdhd(e,r){r*=e;const n=Math.floor(r/(yi+1)),i=Math.floor(r%(yi+1));return B.box(B.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,n>>24,n>>16&255,n>>8&255,n&255,i>>24,i>>16&255,i>>8&255,i&255,85,196,0,0]))}static mdia(e){return B.box(B.types.mdia,B.mdhd(e.timescale,e.duration),B.hdlr(e.type),B.minf(e))}static mfhd(e){return B.box(B.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255]))}static minf(e){return e.type==="audio"?B.box(B.types.minf,B.box(B.types.smhd,B.SMHD),B.DINF,B.stbl(e)):B.box(B.types.minf,B.box(B.types.vmhd,B.VMHD),B.DINF,B.stbl(e))}static moof(e,r,n){return B.box(B.types.moof,B.mfhd(e),B.traf(n,r))}static moov(e){let r=e.length;const n=[];for(;r--;)n[r]=B.trak(e[r]);return B.box.apply(null,[B.types.moov,B.mvhd(e[0].timescale,e[0].duration)].concat(n).concat(B.mvex(e)))}static mvex(e){let r=e.length;const n=[];for(;r--;)n[r]=B.trex(e[r]);return B.box.apply(null,[B.types.mvex,...n])}static mvhd(e,r){r*=e;const n=Math.floor(r/(yi+1)),i=Math.floor(r%(yi+1)),s=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,n>>24,n>>16&255,n>>8&255,n&255,i>>24,i>>16&255,i>>8&255,i&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return B.box(B.types.mvhd,s)}static sdtp(e){const r=e.samples||[],n=new Uint8Array(4+r.length);let i,s;for(i=0;i<r.length;i++)s=r[i].flags,n[i+4]=s.dependsOn<<4|s.isDependedOn<<2|s.hasRedundancy;return B.box(B.types.sdtp,n)}static stbl(e){return B.box(B.types.stbl,B.stsd(e),B.box(B.types.stts,B.STTS),B.box(B.types.stsc,B.STSC),B.box(B.types.stsz,B.STSZ),B.box(B.types.stco,B.STCO))}static avc1(e){let r=[],n=[],i,s,a;for(i=0;i<e.sps.length;i++)s=e.sps[i],a=s.byteLength,r.push(a>>>8&255),r.push(a&255),r=r.concat(Array.prototype.slice.call(s));for(i=0;i<e.pps.length;i++)s=e.pps[i],a=s.byteLength,n.push(a>>>8&255),n.push(a&255),n=n.concat(Array.prototype.slice.call(s));const o=B.box(B.types.avcC,new Uint8Array([1,r[3],r[4],r[5],255,224|e.sps.length].concat(r).concat([e.pps.length]).concat(n))),l=e.width,u=e.height,c=e.pixelRatio[0],d=e.pixelRatio[1];return B.box(B.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,l&255,u>>8&255,u&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),o,B.box(B.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),B.box(B.types.pasp,new Uint8Array([c>>24,c>>16&255,c>>8&255,c&255,d>>24,d>>16&255,d>>8&255,d&255])))}static esds(e){const r=e.config.length;return new Uint8Array([0,0,0,0,3,23+r,0,1,0,4,15+r,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([r]).concat(e.config).concat([6,1,2]))}static audioStsd(e){const r=e.samplerate;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,r>>8&255,r&255,0,0])}static mp4a(e){return B.box(B.types.mp4a,B.audioStsd(e),B.box(B.types.esds,B.esds(e)))}static mp3(e){return B.box(B.types[".mp3"],B.audioStsd(e))}static ac3(e){return B.box(B.types["ac-3"],B.audioStsd(e),B.box(B.types.dac3,e.config))}static stsd(e){return e.type==="audio"?e.segmentCodec==="mp3"&&e.codec==="mp3"?B.box(B.types.stsd,B.STSD,B.mp3(e)):e.segmentCodec==="ac3"?B.box(B.types.stsd,B.STSD,B.ac3(e)):B.box(B.types.stsd,B.STSD,B.mp4a(e)):B.box(B.types.stsd,B.STSD,B.avc1(e))}static tkhd(e){const r=e.id,n=e.duration*e.timescale,i=e.width,s=e.height,a=Math.floor(n/(yi+1)),o=Math.floor(n%(yi+1));return B.box(B.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,r>>24&255,r>>16&255,r>>8&255,r&255,0,0,0,0,a>>24,a>>16&255,a>>8&255,a&255,o>>24,o>>16&255,o>>8&255,o&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,i>>8&255,i&255,0,0,s>>8&255,s&255,0,0]))}static traf(e,r){const n=B.sdtp(e),i=e.id,s=Math.floor(r/(yi+1)),a=Math.floor(r%(yi+1));return B.box(B.types.traf,B.box(B.types.tfhd,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,i&255])),B.box(B.types.tfdt,new Uint8Array([1,0,0,0,s>>24,s>>16&255,s>>8&255,s&255,a>>24,a>>16&255,a>>8&255,a&255])),B.trun(e,n.length+16+20+8+16+8+8),n)}static trak(e){return e.duration=e.duration||4294967295,B.box(B.types.trak,B.tkhd(e),B.mdia(e))}static trex(e){const r=e.id;return B.box(B.types.trex,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,r&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,r){const n=e.samples||[],i=n.length,s=12+16*i,a=new Uint8Array(s);let o,l,u,c,d,f;for(r+=8+s,a.set([e.type==="video"?1:0,0,15,1,i>>>24&255,i>>>16&255,i>>>8&255,i&255,r>>>24&255,r>>>16&255,r>>>8&255,r&255],0),o=0;o<i;o++)l=n[o],u=l.duration,c=l.size,d=l.flags,f=l.cts,a.set([u>>>24&255,u>>>16&255,u>>>8&255,u&255,c>>>24&255,c>>>16&255,c>>>8&255,c&255,d.isLeading<<2|d.dependsOn,d.isDependedOn<<6|d.hasRedundancy<<4|d.paddingValue<<1|d.isNonSync,d.degradPrio&61440,d.degradPrio&15,f>>>24&255,f>>>16&255,f>>>8&255,f&255],12+16*o);return B.box(B.types.trun,a)}static initSegment(e){B.types||B.init();const r=B.moov(e);return Jr(B.FTYP,r)}}B.types=void 0;B.HDLR_TYPES=void 0;B.STTS=void 0;B.STSC=void 0;B.STCO=void 0;B.STSZ=void 0;B.VMHD=void 0;B.SMHD=void 0;B.STSD=void 0;B.FTYP=void 0;B.DINF=void 0;const WT=9e4;function Fm(t,e,r=1,n=!1){const i=t*e*r;return n?Math.round(i):i}function iM(t,e,r=1,n=!1){return Fm(t,e,1/r,n)}function io(t,e=!1){return Fm(t,1e3,1/WT,e)}function sM(t,e=1){return Fm(t,WT,1/e)}const aM=10*1e3,Gv=1024,oM=1152,lM=1536;let Us=null,Rf=null;class Nu{constructor(e,r,n,i=""){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=r,this.typeSupported=n,this.ISGenerated=!1,Us===null){const a=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Us=a?parseInt(a[1]):0}if(Rf===null){const s=navigator.userAgent.match(/Safari\/(\d+)/i);Rf=s?parseInt(s[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(e){U.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=e}resetNextTimestamp(){U.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){U.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(e){let r=!1;const n=e.reduce((i,s)=>{const a=s.pts-i;return a<-4294967296?(r=!0,Hr(i,s.pts)):a>0?i:s.pts},e[0].pts);return r&&U.debug("PTS rollover detected"),n}remux(e,r,n,i,s,a,o,l){let u,c,d,f,m,h,p=s,v=s;const g=e.pid>-1,y=r.pid>-1,x=r.samples.length,S=e.samples.length>0,T=o&&x>0||x>1;if((!g||S)&&(!y||T)||this.ISGenerated||o){if(this.ISGenerated){var _,b,I,A;const G=this.videoTrackConfig;G&&(r.width!==G.width||r.height!==G.height||((_=r.pixelRatio)==null?void 0:_[0])!==((b=G.pixelRatio)==null?void 0:b[0])||((I=r.pixelRatio)==null?void 0:I[1])!==((A=G.pixelRatio)==null?void 0:A[1]))&&this.resetInitSegment()}else d=this.generateIS(e,r,s,a);const k=this.isVideoContiguous;let O=-1,P;if(T&&(O=uM(r.samples),!k&&this.config.forceKeyFrameOnDiscontinuity))if(h=!0,O>0){U.warn(`[mp4-remuxer]: Dropped ${O} out of ${x} video samples due to a missing keyframe`);const G=this.getVideoStartPts(r.samples);r.samples=r.samples.slice(O),r.dropped+=O,v+=(r.samples[0].pts-G)/r.inputTimeScale,P=v}else O===-1&&(U.warn(`[mp4-remuxer]: No keyframe found out of ${x} video samples`),h=!1);if(this.ISGenerated){if(S&&T){const G=this.getVideoStartPts(r.samples),H=(Hr(e.samples[0].pts,G)-G)/r.inputTimeScale;p+=Math.max(0,H),v+=Math.max(0,-H)}if(S){if(e.samplerate||(U.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),d=this.generateIS(e,r,s,a)),c=this.remuxAudio(e,p,this.isAudioContiguous,a,y||T||l===we.AUDIO?v:void 0),T){const G=c?c.endPTS-c.startPTS:0;r.inputTimeScale||(U.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),d=this.generateIS(e,r,s,a)),u=this.remuxVideo(r,v,k,G)}}else T&&(u=this.remuxVideo(r,v,k,0));u&&(u.firstKeyFrame=O,u.independent=O!==-1,u.firstKeyFramePTS=P)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(n.samples.length&&(m=KT(n,s,this._initPTS,this._initDTS)),i.samples.length&&(f=YT(i,s,this._initPTS))),{audio:c,video:u,initSegment:d,independent:h,text:f,id3:m}}generateIS(e,r,n,i){const s=e.samples,a=r.samples,o=this.typeSupported,l={},u=this._initPTS;let c=!u||i,d="audio/mp4",f,m,h;if(c&&(f=m=1/0),e.config&&s.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":o.mpeg?(d="audio/mpeg",e.codec=""):o.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3";break}l.audio={id:"audio",container:d,codec:e.codec,initSegment:e.segmentCodec==="mp3"&&o.mpeg?new Uint8Array(0):B.initSegment([e]),metadata:{channelCount:e.channelCount}},c&&(h=e.inputTimeScale,!u||h!==u.timescale?f=m=s[0].pts-Math.round(h*n):c=!1)}if(r.sps&&r.pps&&a.length){if(r.timescale=r.inputTimeScale,l.video={id:"main",container:"video/mp4",codec:r.codec,initSegment:B.initSegment([r]),metadata:{width:r.width,height:r.height}},c)if(h=r.inputTimeScale,!u||h!==u.timescale){const p=this.getVideoStartPts(a),v=Math.round(h*n);m=Math.min(m,Hr(a[0].dts,p)-v),f=Math.min(f,p-v)}else c=!1;this.videoTrackConfig={width:r.width,height:r.height,pixelRatio:r.pixelRatio}}if(Object.keys(l).length)return this.ISGenerated=!0,c?(this._initPTS={baseTime:f,timescale:h},this._initDTS={baseTime:m,timescale:h}):f=h=void 0,{tracks:l,initPTS:f,timescale:h}}remuxVideo(e,r,n,i){const s=e.inputTimeScale,a=e.samples,o=[],l=a.length,u=this._initPTS;let c=this.nextAvcDts,d=8,f=this.videoSampleDuration,m,h,p=Number.POSITIVE_INFINITY,v=Number.NEGATIVE_INFINITY,g=!1;if(!n||c===null){const F=r*s,j=a[0].pts-Hr(a[0].dts,a[0].pts);Us&&c!==null&&Math.abs(F-j-c)<15e3?n=!0:c=F-j}const y=u.baseTime*s/u.timescale;for(let F=0;F<l;F++){const j=a[F];j.pts=Hr(j.pts-y,c),j.dts=Hr(j.dts-y,c),j.dts<a[F>0?F-1:F].dts&&(g=!0)}g&&a.sort(function(F,j){const te=F.dts-j.dts,ee=F.pts-j.pts;return te||ee}),m=a[0].dts,h=a[a.length-1].dts;const x=h-m,S=x?Math.round(x/(l-1)):f||e.inputTimeScale/30;if(n){const F=m-c,j=F>S,te=F<-1;if((j||te)&&(j?U.warn(`AVC: ${io(F,!0)} ms (${F}dts) hole between fragments detected at ${r.toFixed(3)}`):U.warn(`AVC: ${io(-F,!0)} ms (${F}dts) overlapping between fragments detected at ${r.toFixed(3)}`),!te||c>=a[0].pts||Us)){m=c;const ee=a[0].pts-F;if(j)a[0].dts=m,a[0].pts=ee;else for(let fe=0;fe<a.length&&!(a[fe].dts>ee);fe++)a[fe].dts-=F,a[fe].pts-=F;U.log(`Video: Initial PTS/DTS adjusted: ${io(ee,!0)}/${io(m,!0)}, delta: ${io(F,!0)} ms`)}}m=Math.max(0,m);let T=0,C=0,_=m;for(let F=0;F<l;F++){const j=a[F],te=j.units,ee=te.length;let fe=0;for(let ye=0;ye<ee;ye++)fe+=te[ye].data.length;C+=fe,T+=ee,j.length=fe,j.dts<_?(j.dts=_,_+=S/4|0||1):_=j.dts,p=Math.min(j.pts,p),v=Math.max(j.pts,v)}h=a[l-1].dts;const b=C+4*T+8;let I;try{I=new Uint8Array(b)}catch(F){this.observer.emit(w.ERROR,w.ERROR,{type:_e.MUX_ERROR,details:z.REMUX_ALLOC_ERROR,fatal:!1,error:F,bytes:b,reason:`fail allocating video mdat ${b}`});return}const A=new DataView(I.buffer);A.setUint32(0,b),I.set(B.types.mdat,4);let k=!1,O=Number.POSITIVE_INFINITY,P=Number.POSITIVE_INFINITY,G=Number.NEGATIVE_INFINITY,K=Number.NEGATIVE_INFINITY;for(let F=0;F<l;F++){const j=a[F],te=j.units;let ee=0;for(let Re=0,Ee=te.length;Re<Ee;Re++){const Fe=te[Re],st=Fe.data,br=Fe.data.byteLength;A.setUint32(d,br),d+=4,I.set(st,d),d+=br,ee+=4+br}let fe;if(F<l-1)f=a[F+1].dts-j.dts,fe=a[F+1].pts-j.pts;else{const Re=this.config,Ee=F>0?j.dts-a[F-1].dts:S;if(fe=F>0?j.pts-a[F-1].pts:S,Re.stretchShortVideoTrack&&this.nextAudioPts!==null){const Fe=Math.floor(Re.maxBufferHole*s),st=(i?p+i*s:this.nextAudioPts)-j.pts;st>Fe?(f=st-Ee,f<0?f=Ee:k=!0,U.log(`[mp4-remuxer]: It is approximately ${st/90} ms to the next segment; using duration ${f/90} ms for the last video frame.`)):f=Ee}else f=Ee}const ye=Math.round(j.pts-j.dts);O=Math.min(O,f),G=Math.max(G,f),P=Math.min(P,fe),K=Math.max(K,fe),o.push(new zv(j.key,f,ee,ye))}if(o.length){if(Us){if(Us<70){const F=o[0].flags;F.dependsOn=2,F.isNonSync=0}}else if(Rf&&K-P<G-O&&S/G<.025&&o[0].cts===0){U.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let F=m;for(let j=0,te=o.length;j<te;j++){const ee=F+o[j].duration,fe=F+o[j].cts;if(j<te-1){const ye=ee+o[j+1].cts;o[j].duration=ye-fe}else o[j].duration=j?o[j-1].duration:S;o[j].cts=0,F=ee}}}f=k||!f?S:f,this.nextAvcDts=c=h+f,this.videoSampleDuration=f,this.isVideoContiguous=!0;const W={data1:B.moof(e.sequenceNumber++,m,It({},e,{samples:o})),data2:I,startPTS:p/s,endPTS:(v+f)/s,startDTS:m/s,endDTS:c/s,type:"video",hasAudio:!1,hasVideo:!0,nb:o.length,dropped:e.dropped};return e.samples=[],e.dropped=0,W}getSamplesPerFrame(e){switch(e.segmentCodec){case"mp3":return oM;case"ac3":return lM;default:return Gv}}remuxAudio(e,r,n,i,s){const a=e.inputTimeScale,o=e.samplerate?e.samplerate:a,l=a/o,u=this.getSamplesPerFrame(e),c=u*l,d=this._initPTS,f=e.segmentCodec==="mp3"&&this.typeSupported.mpeg,m=[],h=s!==void 0;let p=e.samples,v=f?0:8,g=this.nextAudioPts||-1;const y=r*a,x=d.baseTime*a/d.timescale;if(this.isAudioContiguous=n=n||p.length&&g>0&&(i&&Math.abs(y-g)<9e3||Math.abs(Hr(p[0].pts-x,y)-g)<20*c),p.forEach(function(H){H.pts=Hr(H.pts-x,y)}),!n||g<0){if(p=p.filter(H=>H.pts>=0),!p.length)return;s===0?g=0:i&&!h?g=Math.max(0,y):g=p[0].pts}if(e.segmentCodec==="aac"){const H=this.config.maxAudioFramesDrift;for(let se=0,W=g;se<p.length;se++){const F=p[se],j=F.pts,te=j-W,ee=Math.abs(1e3*te/a);if(te<=-H*c&&h)se===0&&(U.warn(`Audio frame @ ${(j/a).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*te/a)} ms.`),this.nextAudioPts=g=W=j);else if(te>=H*c&&ee<aM&&h){let fe=Math.round(te/c);W=j-fe*c,W<0&&(fe--,W+=c),se===0&&(this.nextAudioPts=g=W),U.warn(`[mp4-remuxer]: Injecting ${fe} audio frame @ ${(W/a).toFixed(3)}s due to ${Math.round(1e3*te/a)} ms gap.`);for(let ye=0;ye<fe;ye++){const Re=Math.max(W,0);let Ee=Vv.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);Ee||(U.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),Ee=F.unit.subarray()),p.splice(se,0,{unit:Ee,pts:Re}),W+=c,se++}}F.pts=W,W+=c}}let S=null,T=null,C,_=0,b=p.length;for(;b--;)_+=p[b].unit.byteLength;for(let H=0,se=p.length;H<se;H++){const W=p[H],F=W.unit;let j=W.pts;if(T!==null){const ee=m[H-1];ee.duration=Math.round((j-T)/l)}else if(n&&e.segmentCodec==="aac"&&(j=g),S=j,_>0){_+=v;try{C=new Uint8Array(_)}catch(ee){this.observer.emit(w.ERROR,w.ERROR,{type:_e.MUX_ERROR,details:z.REMUX_ALLOC_ERROR,fatal:!1,error:ee,bytes:_,reason:`fail allocating audio mdat ${_}`});return}f||(new DataView(C.buffer).setUint32(0,_),C.set(B.types.mdat,4))}else return;C.set(F,v);const te=F.byteLength;v+=te,m.push(new zv(!0,u,te,0)),T=j}const I=m.length;if(!I)return;const A=m[m.length-1];this.nextAudioPts=g=T+l*A.duration;const k=f?new Uint8Array(0):B.moof(e.sequenceNumber++,S/l,It({},e,{samples:m}));e.samples=[];const O=S/a,P=g/a,K={data1:k,data2:C,startPTS:O,endPTS:P,startDTS:O,endDTS:P,type:"audio",hasAudio:!0,hasVideo:!1,nb:I};return this.isAudioContiguous=!0,K}remuxEmptyAudio(e,r,n,i){const s=e.inputTimeScale,a=e.samplerate?e.samplerate:s,o=s/a,l=this.nextAudioPts,u=this._initDTS,c=u.baseTime*9e4/u.timescale,d=(l!==null?l:i.startDTS*s)+c,f=i.endDTS*s+c,m=o*Gv,h=Math.ceil((f-d)/m),p=Vv.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(U.warn("[mp4-remuxer]: remux empty Audio"),!p){U.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");return}const v=[];for(let g=0;g<h;g++){const y=d+g*m;v.push({unit:p,pts:y,dts:y})}return e.samples=v,this.remuxAudio(e,r,n,!1)}}function Hr(t,e){let r;if(e===null)return t;for(e<t?r=-8589934592:r=8589934592;Math.abs(t-e)>4294967296;)t+=r;return t}function uM(t){for(let e=0;e<t.length;e++)if(t[e].key)return e;return-1}function KT(t,e,r,n){const i=t.samples.length;if(!i)return;const s=t.inputTimeScale;for(let o=0;o<i;o++){const l=t.samples[o];l.pts=Hr(l.pts-r.baseTime*s/r.timescale,e*s)/s,l.dts=Hr(l.dts-n.baseTime*s/n.timescale,e*s)/s}const a=t.samples;return t.samples=[],{samples:a}}function YT(t,e,r){const n=t.samples.length;if(!n)return;const i=t.inputTimeScale;for(let a=0;a<n;a++){const o=t.samples[a];o.pts=Hr(o.pts-r.baseTime*i/r.timescale,e*i)/i}t.samples.sort((a,o)=>a.pts-o.pts);const s=t.samples;return t.samples=[],{samples:s}}class zv{constructor(e,r,n,i){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=r,this.size=n,this.cts=i,this.flags={isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:e?2:1,isNonSync:e?0:1}}}class cM{constructor(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null}destroy(){}resetTimeStamp(e){this.initPTS=e,this.lastEndTime=null}resetNextTimestamp(){this.lastEndTime=null}resetInitSegment(e,r,n,i){this.audioCodec=r,this.videoCodec=n,this.generateInitSegment(gP(e,i)),this.emitInitSegment=!0}generateInitSegment(e){let{audioCodec:r,videoCodec:n}=this;if(!(e!=null&&e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const i=this.initData=xT(e);i.audio&&(r=Hv(i.audio,Je.AUDIO)),i.video&&(n=Hv(i.video,Je.VIDEO));const s={};i.audio&&i.video?s.audiovideo={container:"video/mp4",codec:r+","+n,initSegment:e,id:"main"}:i.audio?s.audio={container:"audio/mp4",codec:r,initSegment:e,id:"audio"}:i.video?s.video={container:"video/mp4",codec:n,initSegment:e,id:"main"}:U.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=s}remux(e,r,n,i,s,a){var o,l;let{initPTS:u,lastEndTime:c}=this;const d={audio:void 0,video:void 0,text:i,id3:n,initSegment:void 0};pe(c)||(c=this.lastEndTime=s||0);const f=r.samples;if(!(f!=null&&f.length))return d;const m={initPTS:void 0,timescale:1};let h=this.initData;if((o=h)!=null&&o.length||(this.generateInitSegment(f),h=this.initData),!((l=h)!=null&&l.length))return U.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),d;this.emitInitSegment&&(m.tracks=this.initTracks,this.emitInitSegment=!1);const p=yP(f,h),v=vP(h,f),g=v===null?s:v;(dM(u,g,s,p)||m.timescale!==u.timescale&&a)&&(m.initPTS=g-s,u&&u.timescale===1&&U.warn(`Adjusting initPTS by ${m.initPTS-u.baseTime}`),this.initPTS=u={baseTime:m.initPTS,timescale:1});const y=e?g-u.baseTime/u.timescale:c,x=y+p;SP(h,f,u.baseTime/u.timescale),p>0?this.lastEndTime=x:(U.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const S=!!h.audio,T=!!h.video;let C="";S&&(C+="audio"),T&&(C+="video");const _={data1:f,startPTS:y,startDTS:y,endPTS:x,endDTS:x,type:C,hasAudio:S,hasVideo:T,nb:1,dropped:0};return d.audio=_.type==="audio"?_:void 0,d.video=_.type!=="audio"?_:void 0,d.initSegment=m,d.id3=KT(n,s,u,u),i.samples.length&&(d.text=YT(i,s,u)),d}}function dM(t,e,r,n){if(t===null)return!0;const i=Math.max(n,1),s=e-t.baseTime/t.timescale;return Math.abs(s-r)>i}function Hv(t,e){const r=t==null?void 0:t.codec;if(r&&r.length>4)return r;if(e===Je.AUDIO){if(r==="ec-3"||r==="ac-3"||r==="alac")return r;if(r==="fLaC"||r==="Opus")return Uc(r,!1);const n="mp4a.40.5";return U.info(`Parsed audio codec "${r}" or audio object type not handled. Using "${n}"`),n}return U.warn(`Unhandled video codec "${r}"`),r==="hvc1"||r==="hev1"?"hvc1.1.6.L120.90":r==="av01"?"av01.0.04M.08":"avc1.42e01e"}let Qn;try{Qn=self.performance.now.bind(self.performance)}catch{U.debug("Unable to use Performance API on this environment"),Qn=Ra==null?void 0:Ra.Date.now}const Fu=[{demux:XO,remux:cM},{demux:Ti,remux:Nu},{demux:YO,remux:Nu},{demux:nM,remux:Nu}];Fu.splice(2,0,{demux:ZO,remux:Nu});class Wv{constructor(e,r,n,i,s){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=r,this.config=n,this.vendor=i,this.id=s}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,r,n,i){const s=n.transmuxing;s.executeStart=Qn();let a=new Uint8Array(e);const{currentTransmuxState:o,transmuxConfig:l}=this;i&&(this.currentTransmuxState=i);const{contiguous:u,discontinuity:c,trackSwitch:d,accurateTimeOffset:f,timeOffset:m,initSegmentChange:h}=i||o,{audioCodec:p,videoCodec:v,defaultInitPts:g,duration:y,initSegmentData:x}=l,S=fM(a,r);if(S&&S.method==="AES-128"){const b=this.getDecrypter();if(b.isSync()){let I=b.softwareDecrypt(a,S.key.buffer,S.iv.buffer);if(n.part>-1&&(I=b.flush()),!I)return s.executeEnd=Qn(),If(n);a=new Uint8Array(I)}else return this.decryptionPromise=b.webCryptoDecrypt(a,S.key.buffer,S.iv.buffer).then(I=>{const A=this.push(I,null,n);return this.decryptionPromise=null,A}),this.decryptionPromise}const T=this.needsProbing(c,d);if(T){const b=this.configureTransmuxer(a);if(b)return U.warn(`[transmuxer] ${b.message}`),this.observer.emit(w.ERROR,w.ERROR,{type:_e.MEDIA_ERROR,details:z.FRAG_PARSING_ERROR,fatal:!1,error:b,reason:b.message}),s.executeEnd=Qn(),If(n)}(c||d||h||T)&&this.resetInitSegment(x,p,v,y,r),(c||h||T)&&this.resetInitialTimestamp(g),u||this.resetContiguity();const C=this.transmux(a,S,m,f,n),_=this.currentTransmuxState;return _.contiguous=!0,_.discontinuity=!1,_.trackSwitch=!1,s.executeEnd=Qn(),C}flush(e){const r=e.transmuxing;r.executeStart=Qn();const{decrypter:n,currentTransmuxState:i,decryptionPromise:s}=this;if(s)return s.then(()=>this.flush(e));const a=[],{timeOffset:o}=i;if(n){const d=n.flush();d&&a.push(this.push(d,null,e))}const{demuxer:l,remuxer:u}=this;if(!l||!u)return r.executeEnd=Qn(),[If(e)];const c=l.flush(o);return Uu(c)?c.then(d=>(this.flushRemux(a,d,e),a)):(this.flushRemux(a,c,e),a)}flushRemux(e,r,n){const{audioTrack:i,videoTrack:s,id3Track:a,textTrack:o}=r,{accurateTimeOffset:l,timeOffset:u}=this.currentTransmuxState;U.log(`[transmuxer.ts]: Flushed fragment ${n.sn}${n.part>-1?" p: "+n.part:""} of level ${n.level}`);const c=this.remuxer.remux(i,s,a,o,u,l,!0,this.id);e.push({remuxResult:c,chunkMeta:n}),n.transmuxing.executeEnd=Qn()}resetInitialTimestamp(e){const{demuxer:r,remuxer:n}=this;!r||!n||(r.resetTimeStamp(e),n.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:r}=this;!e||!r||(e.resetContiguity(),r.resetNextTimestamp())}resetInitSegment(e,r,n,i,s){const{demuxer:a,remuxer:o}=this;!a||!o||(a.resetInitSegment(e,r,n,i),o.resetInitSegment(e,r,n,s))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,r,n,i,s){let a;return r&&r.method==="SAMPLE-AES"?a=this.transmuxSampleAes(e,r,n,i,s):a=this.transmuxUnencrypted(e,n,i,s),a}transmuxUnencrypted(e,r,n,i){const{audioTrack:s,videoTrack:a,id3Track:o,textTrack:l}=this.demuxer.demux(e,r,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(s,a,o,l,r,n,!1,this.id),chunkMeta:i}}transmuxSampleAes(e,r,n,i,s){return this.demuxer.demuxSampleAes(e,r,n).then(a=>({remuxResult:this.remuxer.remux(a.audioTrack,a.videoTrack,a.id3Track,a.textTrack,n,i,!1,this.id),chunkMeta:s}))}configureTransmuxer(e){const{config:r,observer:n,typeSupported:i,vendor:s}=this;let a;for(let f=0,m=Fu.length;f<m;f++){var o;if((o=Fu[f].demux)!=null&&o.probe(e)){a=Fu[f];break}}if(!a)return new Error("Failed to find demuxer by probing fragment data");const l=this.demuxer,u=this.remuxer,c=a.remux,d=a.demux;(!u||!(u instanceof c))&&(this.remuxer=new c(n,r,i,s)),(!l||!(l instanceof d))&&(this.demuxer=new d(n,r,i),this.probe=d.probe)}needsProbing(e,r){return!this.demuxer||!this.remuxer||e||r}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new Dm(this.config)),e}}function fM(t,e){let r=null;return t.byteLength>0&&(e==null?void 0:e.key)!=null&&e.iv!==null&&e.method!=null&&(r=e),r}const If=t=>({remuxResult:{},chunkMeta:t});function Uu(t){return"then"in t&&t.then instanceof Function}class hM{constructor(e,r,n,i,s){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=r,this.initSegmentData=n,this.duration=i,this.defaultInitPts=s||null}}class pM{constructor(e,r,n,i,s,a){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=r,this.accurateTimeOffset=n,this.trackSwitch=i,this.timeOffset=s,this.initSegmentChange=a}}var qT={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function i(l,u,c){this.fn=l,this.context=u,this.once=c||!1}function s(l,u,c,d,f){if(typeof c!="function")throw new TypeError("The listener must be a function");var m=new i(c,d||l,f),h=r?r+u:u;return l._events[h]?l._events[h].fn?l._events[h]=[l._events[h],m]:l._events[h].push(m):(l._events[h]=m,l._eventsCount++),l}function a(l,u){--l._eventsCount===0?l._events=new n:delete l._events[u]}function o(){this._events=new n,this._eventsCount=0}o.prototype.eventNames=function(){var u=[],c,d;if(this._eventsCount===0)return u;for(d in c=this._events)e.call(c,d)&&u.push(r?d.slice(1):d);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(c)):u},o.prototype.listeners=function(u){var c=r?r+u:u,d=this._events[c];if(!d)return[];if(d.fn)return[d.fn];for(var f=0,m=d.length,h=new Array(m);f<m;f++)h[f]=d[f].fn;return h},o.prototype.listenerCount=function(u){var c=r?r+u:u,d=this._events[c];return d?d.fn?1:d.length:0},o.prototype.emit=function(u,c,d,f,m,h){var p=r?r+u:u;if(!this._events[p])return!1;var v=this._events[p],g=arguments.length,y,x;if(v.fn){switch(v.once&&this.removeListener(u,v.fn,void 0,!0),g){case 1:return v.fn.call(v.context),!0;case 2:return v.fn.call(v.context,c),!0;case 3:return v.fn.call(v.context,c,d),!0;case 4:return v.fn.call(v.context,c,d,f),!0;case 5:return v.fn.call(v.context,c,d,f,m),!0;case 6:return v.fn.call(v.context,c,d,f,m,h),!0}for(x=1,y=new Array(g-1);x<g;x++)y[x-1]=arguments[x];v.fn.apply(v.context,y)}else{var S=v.length,T;for(x=0;x<S;x++)switch(v[x].once&&this.removeListener(u,v[x].fn,void 0,!0),g){case 1:v[x].fn.call(v[x].context);break;case 2:v[x].fn.call(v[x].context,c);break;case 3:v[x].fn.call(v[x].context,c,d);break;case 4:v[x].fn.call(v[x].context,c,d,f);break;default:if(!y)for(T=1,y=new Array(g-1);T<g;T++)y[T-1]=arguments[T];v[x].fn.apply(v[x].context,y)}}return!0},o.prototype.on=function(u,c,d){return s(this,u,c,d,!1)},o.prototype.once=function(u,c,d){return s(this,u,c,d,!0)},o.prototype.removeListener=function(u,c,d,f){var m=r?r+u:u;if(!this._events[m])return this;if(!c)return a(this,m),this;var h=this._events[m];if(h.fn)h.fn===c&&(!f||h.once)&&(!d||h.context===d)&&a(this,m);else{for(var p=0,v=[],g=h.length;p<g;p++)(h[p].fn!==c||f&&!h[p].once||d&&h[p].context!==d)&&v.push(h[p]);v.length?this._events[m]=v.length===1?v[0]:v:a(this,m)}return this},o.prototype.removeAllListeners=function(u){var c;return u?(c=r?r+u:u,this._events[c]&&a(this,c)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=r,o.EventEmitter=o,t.exports=o})(qT);var mM=qT.exports,Um=UD(mM);class XT{constructor(e,r,n,i){this.error=null,this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;const s=e.config;this.hls=e,this.id=r,this.useWorker=!!s.enableWorker,this.onTransmuxComplete=n,this.onFlush=i;const a=(u,c)=>{c=c||{},c.frag=this.frag,c.id=this.id,u===w.ERROR&&(this.error=c.error),this.hls.trigger(u,c)};this.observer=new Um,this.observer.on(w.FRAG_DECRYPTED,a),this.observer.on(w.ERROR,a);const o=bs(s.preferManagedMediaSource)||{isTypeSupported:()=>!1},l={mpeg:o.isTypeSupported("audio/mpeg"),mp3:o.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:o.isTypeSupported('audio/mp4; codecs="ac-3"')};if(this.useWorker&&typeof Worker<"u"&&(s.workerPath||OO())){try{s.workerPath?(U.log(`loading Web Worker ${s.workerPath} for "${r}"`),this.workerContext=NO(s.workerPath)):(U.log(`injecting Web Worker for "${r}"`),this.workerContext=MO()),this.onwmsg=d=>this.onWorkerMessage(d);const{worker:c}=this.workerContext;c.addEventListener("message",this.onwmsg),c.onerror=d=>{const f=new Error(`${d.message}  (${d.filename}:${d.lineno})`);s.enableWorker=!1,U.warn(`Error in "${r}" Web Worker, fallback to inline`),this.hls.trigger(w.ERROR,{type:_e.OTHER_ERROR,details:z.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:f})},c.postMessage({cmd:"init",typeSupported:l,vendor:"",id:r,config:JSON.stringify(s)})}catch(c){U.warn(`Error setting up "${r}" Web Worker, fallback to inline`,c),this.resetWorker(),this.error=null,this.transmuxer=new Wv(this.observer,l,s,"",r)}return}this.transmuxer=new Wv(this.observer,l,s,"",r)}resetWorker(){if(this.workerContext){const{worker:e,objectURL:r}=this.workerContext;r&&self.URL.revokeObjectURL(r),e.removeEventListener("message",this.onwmsg),e.onerror=null,e.terminate(),this.workerContext=null}}destroy(){if(this.workerContext)this.resetWorker(),this.onwmsg=void 0;else{const r=this.transmuxer;r&&(r.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null}push(e,r,n,i,s,a,o,l,u,c){var d,f;u.transmuxing.start=self.performance.now();const{transmuxer:m}=this,h=a?a.start:s.start,p=s.decryptdata,v=this.frag,g=!(v&&s.cc===v.cc),y=!(v&&u.level===v.level),x=v?u.sn-v.sn:-1,S=this.part?u.part-this.part.index:-1,T=x===0&&u.id>1&&u.id===(v==null?void 0:v.stats.chunkCount),C=!y&&(x===1||x===0&&(S===1||T&&S<=0)),_=self.performance.now();(y||x||s.stats.parsing.start===0)&&(s.stats.parsing.start=_),a&&(S||!C)&&(a.stats.parsing.start=_);const b=!(v&&((d=s.initSegment)==null?void 0:d.url)===((f=v.initSegment)==null?void 0:f.url)),I=new pM(g,C,l,y,h,b);if(!C||g||b){U.log(`[transmuxer-interface, ${s.type}]: Starting new transmux session for sn: ${u.sn} p: ${u.part} level: ${u.level} id: ${u.id}
        discontinuity: ${g}
        trackSwitch: ${y}
        contiguous: ${C}
        accurateTimeOffset: ${l}
        timeOffset: ${h}
        initSegmentChange: ${b}`);const A=new hM(n,i,r,o,c);this.configureTransmuxer(A)}if(this.frag=s,this.part=a,this.workerContext)this.workerContext.worker.postMessage({cmd:"demux",data:e,decryptdata:p,chunkMeta:u,state:I},e instanceof ArrayBuffer?[e]:[]);else if(m){const A=m.push(e,p,u,I);Uu(A)?(m.async=!0,A.then(k=>{this.handleTransmuxComplete(k)}).catch(k=>{this.transmuxerError(k,u,"transmuxer-interface push error")})):(m.async=!1,this.handleTransmuxComplete(A))}}flush(e){e.transmuxing.start=self.performance.now();const{transmuxer:r}=this;if(this.workerContext)this.workerContext.worker.postMessage({cmd:"flush",chunkMeta:e});else if(r){let n=r.flush(e);Uu(n)||r.async?(Uu(n)||(n=Promise.resolve(n)),n.then(s=>{this.handleFlushResult(s,e)}).catch(s=>{this.transmuxerError(s,e,"transmuxer-interface flush error")})):this.handleFlushResult(n,e)}}transmuxerError(e,r,n){this.hls&&(this.error=e,this.hls.trigger(w.ERROR,{type:_e.MEDIA_ERROR,details:z.FRAG_PARSING_ERROR,chunkMeta:r,frag:this.frag||void 0,fatal:!1,error:e,err:e,reason:n}))}handleFlushResult(e,r){e.forEach(n=>{this.handleTransmuxComplete(n)}),this.onFlush(r)}onWorkerMessage(e){const r=e.data;if(!(r!=null&&r.event)){U.warn(`worker message received with no ${r?"event name":"data"}`);return}const n=this.hls;if(this.hls)switch(r.event){case"init":{var i;const s=(i=this.workerContext)==null?void 0:i.objectURL;s&&self.URL.revokeObjectURL(s);break}case"transmuxComplete":{this.handleTransmuxComplete(r.data);break}case"flush":{this.onFlush(r.data);break}case"workerLog":U[r.data.logType]&&U[r.data.logType](r.data.message);break;default:{r.data=r.data||{},r.data.frag=this.frag,r.data.id=this.id,n.trigger(r.event,r.data);break}}}configureTransmuxer(e){const{transmuxer:r}=this;this.workerContext?this.workerContext.worker.postMessage({cmd:"configure",config:e}):r&&r.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}function ZT(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!ka(t[r].attrs,e[r].attrs))return!1;return!0}function ka(t,e,r){const n=t["STABLE-RENDITION-ID"];return n&&!r?n===e["STABLE-RENDITION-ID"]:!(r||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(i=>t[i]!==e[i])}function tp(t,e){return e.label.toLowerCase()===t.name.toLowerCase()&&(!e.language||e.language.toLowerCase()===(t.lang||"").toLowerCase())}const Kv=100;class gM extends Pm{constructor(e,r,n){super(e,r,n,"[audio-stream-controller]",we.AUDIO),this.videoBuffer=null,this.videoTrackCC=-1,this.waitingVideoCC=-1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null,this.bufferedTrack=null,this.switchingTrack=null}_registerListeners(){const{hls:e}=this;e.on(w.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(w.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(w.MANIFEST_LOADING,this.onManifestLoading,this),e.on(w.LEVEL_LOADED,this.onLevelLoaded,this),e.on(w.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(w.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(w.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(w.ERROR,this.onError,this),e.on(w.BUFFER_RESET,this.onBufferReset,this),e.on(w.BUFFER_CREATED,this.onBufferCreated,this),e.on(w.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(w.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(w.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(w.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(w.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(w.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(w.MANIFEST_LOADING,this.onManifestLoading,this),e.off(w.LEVEL_LOADED,this.onLevelLoaded,this),e.off(w.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(w.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(w.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(w.ERROR,this.onError,this),e.off(w.BUFFER_RESET,this.onBufferReset,this),e.off(w.BUFFER_CREATED,this.onBufferCreated,this),e.off(w.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(w.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(w.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(w.FRAG_BUFFERED,this.onFragBuffered,this)}onInitPtsFound(e,{frag:r,id:n,initPTS:i,timescale:s}){if(n==="main"){const a=r.cc;this.initPTS[r.cc]={baseTime:i,timescale:s},this.log(`InitPTS for cc: ${a} found from main: ${i}`),this.videoTrackCC=a,this.state===Y.WAITING_INIT_PTS&&this.tick()}}startLoad(e){if(!this.levels){this.startPosition=e,this.state=Y.STOPPED;return}const r=this.lastCurrentTime;this.stopLoad(),this.setInterval(Kv),r>0&&e===-1?(this.log(`Override startPosition with lastCurrentTime @${r.toFixed(3)}`),e=r,this.state=Y.IDLE):(this.loadedmetadata=!1,this.state=Y.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}doTick(){switch(this.state){case Y.IDLE:this.doTickIdle();break;case Y.WAITING_TRACK:{var e;const{levels:n,trackId:i}=this,s=n==null||(e=n[i])==null?void 0:e.details;if(s){if(this.waitForCdnTuneIn(s))break;this.state=Y.WAITING_INIT_PTS}break}case Y.FRAG_LOADING_WAITING_RETRY:{var r;const n=performance.now(),i=this.retryDate;if(!i||n>=i||(r=this.media)!=null&&r.seeking){const{levels:s,trackId:a}=this;this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded((s==null?void 0:s[a])||null),this.state=Y.IDLE}break}case Y.WAITING_INIT_PTS:{const n=this.waitingData;if(n){const{frag:i,part:s,cache:a,complete:o}=n;if(this.initPTS[i.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=Y.FRAG_LOADING;const l=a.flush(),u={frag:i,part:s,payload:l,networkDetails:null};this._handleFragmentLoadProgress(u),o&&super._handleFragmentLoadComplete(u)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log(`Waiting fragment cc (${i.cc}) cancelled because video is at cc ${this.videoTrackCC}`),this.clearWaitingFragment();else{const l=this.getLoadPosition(),u=at.bufferInfo(this.mediaBuffer,l,this.config.maxBufferHole);Jh(u.end,this.config.maxFragLookUpTolerance,i)<0&&(this.log(`Waiting fragment cc (${i.cc}) @ ${i.start} cancelled because another fragment at ${u.end} is needed`),this.clearWaitingFragment())}}else this.state=Y.IDLE}}this.onTickEnd()}clearWaitingFragment(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=Y.IDLE)}resetLoadingState(){this.clearWaitingFragment(),super.resetLoadingState()}onTickEnd(){const{media:e}=this;e!=null&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){const{hls:e,levels:r,media:n,trackId:i}=this,s=e.config;if(!n&&(this.startFragRequested||!s.startFragPrefetch)||!(r!=null&&r[i]))return;const a=r[i],o=a.details;if(!o||o.live&&this.levelLastLoaded!==a||this.waitForCdnTuneIn(o)){this.state=Y.WAITING_TRACK;return}const l=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&l&&(this.bufferFlushed=!1,this.afterBufferFlushed(l,Je.AUDIO,we.AUDIO));const u=this.getFwdBufferInfo(l,we.AUDIO);if(u===null)return;const{bufferedTrack:c,switchingTrack:d}=this;if(!d&&this._streamEnded(u,o)){e.trigger(w.BUFFER_EOS,{type:"audio"}),this.state=Y.ENDED;return}const f=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,we.MAIN),m=u.len,h=this.getMaxBufferLength(f==null?void 0:f.len),p=o.fragments,v=p[0].start;let g=this.flushing?this.getLoadPosition():u.end;if(d&&n){const T=this.getLoadPosition();c&&!ka(d.attrs,c.attrs)&&(g=T),o.PTSKnown&&T<v&&(u.end>v||u.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),n.currentTime=v+.05)}if(m>=h&&!d&&g<p[p.length-1].start)return;let y=this.getNextFragment(g,o),x=!1;if(y&&this.isLoopLoading(y,g)&&(x=!!y.gap,y=this.getNextFragmentLoopLoading(y,o,u,we.MAIN,h)),!y){this.bufferFlushed=!0;return}const S=f&&y.start>f.end+o.targetduration;if(S||!(f!=null&&f.len)&&u.len){const T=this.getAppendedFrag(y.start,we.MAIN);if(T===null||(x||(x=!!T.gap||!!S&&f.len===0),S&&!x||x&&u.nextStart&&u.nextStart<T.end))return}this.loadFragment(y,a,g)}getMaxBufferLength(e){const r=super.getMaxBufferLength();return e?Math.min(Math.max(r,e),this.config.maxMaxBufferLength):r}onMediaDetaching(){this.videoBuffer=null,this.bufferFlushed=this.flushing=!1,super.onMediaDetaching()}onAudioTracksUpdated(e,{audioTracks:r}){this.resetTransmuxer(),this.levels=r.map(n=>new Ia(n))}onAudioTrackSwitching(e,r){const n=!!r.url;this.trackId=r.id;const{fragCurrent:i}=this;i&&(i.abortRequests(),this.removeUnbufferedFrags(i.start)),this.resetLoadingState(),n?this.setInterval(Kv):this.resetTransmuxer(),n?(this.switchingTrack=r,this.state=Y.IDLE,this.flushAudioIfNeeded(r)):(this.switchingTrack=null,this.bufferedTrack=r,this.state=Y.STOPPED),this.tick()}onManifestLoading(){this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=this.flushing=!1,this.levels=this.mainDetails=this.waitingData=this.bufferedTrack=this.cachedTrackLoadedData=this.switchingTrack=null,this.startFragRequested=!1,this.trackId=this.videoTrackCC=this.waitingVideoCC=-1}onLevelLoaded(e,r){this.mainDetails=r.details,this.cachedTrackLoadedData!==null&&(this.hls.trigger(w.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)}onAudioTrackLoaded(e,r){var n;if(this.mainDetails==null){this.cachedTrackLoadedData=r;return}const{levels:i}=this,{details:s,id:a}=r;if(!i){this.warn(`Audio tracks were reset while loading level ${a}`);return}this.log(`Audio track ${a} loaded [${s.startSN},${s.endSN}]${s.lastPartSn?`[part-${s.lastPartSn}-${s.lastPartIndex}]`:""},duration:${s.totalduration}`);const o=i[a];let l=0;if(s.live||(n=o.details)!=null&&n.live){this.checkLiveUpdate(s);const c=this.mainDetails;if(s.deltaUpdateFailed||!c)return;if(!o.details&&s.hasProgramDateTime&&c.hasProgramDateTime)Gc(s,c),l=s.fragments[0].start;else{var u;l=this.alignPlaylists(s,o.details,(u=this.levelLastLoaded)==null?void 0:u.details)}}o.details=s,this.levelLastLoaded=o,!this.startFragRequested&&(this.mainDetails||!s.live)&&this.setStartPosition(this.mainDetails||s,l),this.state===Y.WAITING_TRACK&&!this.waitForCdnTuneIn(s)&&(this.state=Y.IDLE),this.tick()}_handleFragmentLoadProgress(e){var r;const{frag:n,part:i,payload:s}=e,{config:a,trackId:o,levels:l}=this;if(!l){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);return}const u=l[o];if(!u){this.warn("Audio track is undefined on fragment load progress");return}const c=u.details;if(!c){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(n.start);return}const d=a.defaultAudioCodec||u.audioCodec||"mp4a.40.2";let f=this.transmuxer;f||(f=this.transmuxer=new XT(this.hls,we.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const m=this.initPTS[n.cc],h=(r=n.initSegment)==null?void 0:r.data;if(m!==void 0){const v=i?i.index:-1,g=v!==-1,y=new km(n.level,n.sn,n.stats.chunkCount,s.byteLength,v,g);f.push(s,h,d,"",n,i,c.totalduration,!1,y,m)}else{this.log(`Unknown video PTS for cc ${n.cc}, waiting for video PTS before demuxing audio frag ${n.sn} of [${c.startSN} ,${c.endSN}],track ${o}`);const{cache:p}=this.waitingData=this.waitingData||{frag:n,part:i,cache:new OT,complete:!1};p.push(new Uint8Array(s)),this.waitingVideoCC=this.videoTrackCC,this.state=Y.WAITING_INIT_PTS}}_handleFragmentLoadComplete(e){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1}onBufferCreated(e,r){const n=r.tracks.audio;n&&(this.mediaBuffer=n.buffer||null),r.tracks.video&&(this.videoBuffer=r.tracks.video.buffer||null)}onFragBuffered(e,r){const{frag:n,part:i}=r;if(n.type!==we.AUDIO){if(!this.loadedmetadata&&n.type===we.MAIN){const s=this.videoBuffer||this.media;s&&at.getBuffered(s).length&&(this.loadedmetadata=!0)}return}if(this.fragContextChanged(n)){this.warn(`Fragment ${n.sn}${i?" p: "+i.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(n.sn!=="initSegment"){this.fragPrevious=n;const s=this.switchingTrack;s&&(this.bufferedTrack=s,this.switchingTrack=null,this.hls.trigger(w.AUDIO_TRACK_SWITCHED,jt({},s)))}this.fragBufferedComplete(n,i)}onError(e,r){var n;if(r.fatal){this.state=Y.ERROR;return}switch(r.details){case z.FRAG_GAP:case z.FRAG_PARSING_ERROR:case z.FRAG_DECRYPT_ERROR:case z.FRAG_LOAD_ERROR:case z.FRAG_LOAD_TIMEOUT:case z.KEY_LOAD_ERROR:case z.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(we.AUDIO,r);break;case z.AUDIO_TRACK_LOAD_ERROR:case z.AUDIO_TRACK_LOAD_TIMEOUT:case z.LEVEL_PARSING_ERROR:!r.levelRetry&&this.state===Y.WAITING_TRACK&&((n=r.context)==null?void 0:n.type)===He.AUDIO_TRACK&&(this.state=Y.IDLE);break;case z.BUFFER_APPEND_ERROR:case z.BUFFER_FULL_ERROR:if(!r.parent||r.parent!=="audio")return;if(r.details===z.BUFFER_APPEND_ERROR){this.resetLoadingState();return}this.reduceLengthAndFlushBuffer(r)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case z.INTERNAL_EXCEPTION:this.recoverWorkerError(r);break}}onBufferFlushing(e,{type:r}){r!==Je.VIDEO&&(this.flushing=!0)}onBufferFlushed(e,{type:r}){if(r!==Je.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===Y.ENDED&&(this.state=Y.IDLE);const n=this.mediaBuffer||this.media;n&&(this.afterBufferFlushed(n,r,we.AUDIO),this.tick())}}_handleTransmuxComplete(e){var r;const n="audio",{hls:i}=this,{remuxResult:s,chunkMeta:a}=e,o=this.getCurrentContext(a);if(!o){this.resetWhenMissingContext(a);return}const{frag:l,part:u,level:c}=o,{details:d}=c,{audio:f,text:m,id3:h,initSegment:p}=s;if(this.fragContextChanged(l)||!d){this.fragmentTracker.removeFragment(l);return}if(this.state=Y.PARSING,this.switchingTrack&&f&&this.completeAudioSwitch(this.switchingTrack),p!=null&&p.tracks){const v=l.initSegment||l;this._bufferInitSegment(c,p.tracks,v,a),i.trigger(w.FRAG_PARSING_INIT_SEGMENT,{frag:v,id:n,tracks:p.tracks})}if(f){const{startPTS:v,endPTS:g,startDTS:y,endDTS:x}=f;u&&(u.elementaryStreams[Je.AUDIO]={startPTS:v,endPTS:g,startDTS:y,endDTS:x}),l.setElementaryStreamInfo(Je.AUDIO,v,g,y,x),this.bufferFragmentData(f,l,u,a)}if(h!=null&&(r=h.samples)!=null&&r.length){const v=It({id:n,frag:l,details:d},h);i.trigger(w.FRAG_PARSING_METADATA,v)}if(m){const v=It({id:n,frag:l,details:d},m);i.trigger(w.FRAG_PARSING_USERDATA,v)}}_bufferInitSegment(e,r,n,i){if(this.state!==Y.PARSING)return;r.video&&delete r.video;const s=r.audio;if(!s)return;s.id="audio";const a=e.audioCodec;this.log(`Init audio buffer, container:${s.container}, codecs[level/parsed]=[${a}/${s.codec}]`),a&&a.split(",").length===1&&(s.levelCodec=a),this.hls.trigger(w.BUFFER_CODECS,r);const o=s.initSegment;if(o!=null&&o.byteLength){const l={type:"audio",frag:n,part:null,chunkMeta:i,parent:n.type,data:o};this.hls.trigger(w.BUFFER_APPENDING,l)}this.tickImmediate()}loadFragment(e,r,n){const i=this.fragmentTracker.getState(e);if(this.fragCurrent=e,this.switchingTrack||i===Bt.NOT_LOADED||i===Bt.PARTIAL){var s;if(e.sn==="initSegment")this._loadInitSegment(e,r);else if((s=r.details)!=null&&s.live&&!this.initPTS[e.cc]){this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=Y.WAITING_INIT_PTS;const a=this.mainDetails;a&&a.fragments[0].start!==r.details.fragments[0].start&&Gc(r.details,a)}else this.startFragRequested=!0,super.loadFragment(e,r,n)}else this.clearTrackerIfNeeded(e)}flushAudioIfNeeded(e){const{media:r,bufferedTrack:n}=this,i=n==null?void 0:n.attrs,s=e.attrs;r&&i&&(i.CHANNELS!==s.CHANNELS||n.name!==e.name||n.lang!==e.lang)&&(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null)}completeAudioSwitch(e){const{hls:r}=this;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,r.trigger(w.AUDIO_TRACK_SWITCHED,jt({},e))}}class vM extends Im{constructor(e){super(e,"[audio-track-controller]"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(w.MANIFEST_LOADING,this.onManifestLoading,this),e.on(w.MANIFEST_PARSED,this.onManifestParsed,this),e.on(w.LEVEL_LOADING,this.onLevelLoading,this),e.on(w.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(w.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(w.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(w.MANIFEST_LOADING,this.onManifestLoading,this),e.off(w.MANIFEST_PARSED,this.onManifestParsed,this),e.off(w.LEVEL_LOADING,this.onLevelLoading,this),e.off(w.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(w.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(w.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,r){this.tracks=r.audioTracks||[]}onAudioTrackLoaded(e,r){const{id:n,groupId:i,details:s}=r,a=this.tracksInGroup[n];if(!a||a.groupId!==i){this.warn(`Audio track with id:${n} and group:${i} not found in active group ${a==null?void 0:a.groupId}`);return}const o=a.details;a.details=r.details,this.log(`Audio track ${n} "${a.name}" lang:${a.lang} group:${i} loaded [${s.startSN}-${s.endSN}]`),n===this.trackId&&this.playlistLoaded(n,r,o)}onLevelLoading(e,r){this.switchLevel(r.level)}onLevelSwitching(e,r){this.switchLevel(r.level)}switchLevel(e){const r=this.hls.levels[e];if(!r)return;const n=r.audioGroups||null,i=this.groupIds;let s=this.currentTrack;if(!n||(i==null?void 0:i.length)!==(n==null?void 0:n.length)||n!=null&&n.some(o=>(i==null?void 0:i.indexOf(o))===-1)){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const o=this.tracks.filter(f=>!n||n.indexOf(f.groupId)!==-1);if(o.length)this.selectDefaultTrack&&!o.some(f=>f.default)&&(this.selectDefaultTrack=!1),o.forEach((f,m)=>{f.id=m});else if(!s&&!this.tracksInGroup.length)return;this.tracksInGroup=o;const l=this.hls.config.audioPreference;if(!s&&l){const f=Dn(l,o,Ms);if(f>-1)s=o[f];else{const m=Dn(l,this.tracks);s=this.tracks[m]}}let u=this.findTrackId(s);u===-1&&s&&(u=this.findTrackId(null));const c={audioTracks:o};this.log(`Updating audio tracks, ${o.length} track(s) found in group(s): ${n==null?void 0:n.join(",")}`),this.hls.trigger(w.AUDIO_TRACKS_UPDATED,c);const d=this.trackId;if(u!==-1&&d===-1)this.setAudioTrack(u);else if(o.length&&d===-1){var a;const f=new Error(`No audio track selected for current audio group-ID(s): ${(a=this.groupIds)==null?void 0:a.join(",")} track count: ${o.length}`);this.warn(f.message),this.hls.trigger(w.ERROR,{type:_e.MEDIA_ERROR,details:z.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:f})}}else this.shouldReloadPlaylist(s)&&this.setAudioTrack(this.trackId)}onError(e,r){r.fatal||!r.context||r.context.type===He.AUDIO_TRACK&&r.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(r.context.groupId)!==-1)&&(this.requestScheduled=-1,this.checkRetry(r))}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioOption(e){const r=this.hls;if(r.config.audioPreference=e,e){const n=this.allAudioTracks;if(this.selectDefaultTrack=!1,n.length){const i=this.currentTrack;if(i&&da(e,i,Ms))return i;const s=Dn(e,this.tracksInGroup,Ms);if(s>-1){const a=this.tracksInGroup[s];return this.setAudioTrack(s),a}else if(i){let a=r.loadLevel;a===-1&&(a=r.firstAutoLevel);const o=vO(e,r.levels,n,a,Ms);if(o===-1)return null;r.nextLoadLevel=o}if(e.channels||e.audioCodec){const a=Dn(e,n);if(a>-1)return n[a]}}}return null}setAudioTrack(e){const r=this.tracksInGroup;if(e<0||e>=r.length){this.warn(`Invalid audio track id: ${e}`);return}this.clearTimer(),this.selectDefaultTrack=!1;const n=this.currentTrack,i=r[e],s=i.details&&!i.details.live;if(e===this.trackId&&i===n&&s||(this.log(`Switching to audio-track ${e} "${i.name}" lang:${i.lang} group:${i.groupId} channels:${i.channels}`),this.trackId=e,this.currentTrack=i,this.hls.trigger(w.AUDIO_TRACK_SWITCHING,jt({},i)),s))return;const a=this.switchParams(i.url,n==null?void 0:n.details,i.details);this.loadPlaylist(a)}findTrackId(e){const r=this.tracksInGroup;for(let n=0;n<r.length;n++){const i=r[n];if(!(this.selectDefaultTrack&&!i.default)&&(!e||da(e,i,Ms)))return n}if(e){const{name:n,lang:i,assocLang:s,characteristics:a,audioCodec:o,channels:l}=e;for(let u=0;u<r.length;u++){const c=r[u];if(da({name:n,lang:i,assocLang:s,characteristics:a,audioCodec:o,channels:l},c,Ms))return u}for(let u=0;u<r.length;u++){const c=r[u];if(ka(e.attrs,c.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return u}for(let u=0;u<r.length;u++){const c=r[u];if(ka(e.attrs,c.attrs,["LANGUAGE"]))return u}}return-1}loadPlaylist(e){const r=this.currentTrack;if(this.shouldLoadPlaylist(r)&&r){super.loadPlaylist();const n=r.id,i=r.groupId;let s=r.url;if(e)try{s=e.addDirectives(s)}catch(a){this.warn(`Could not construct new URL with HLS Delivery Directives: ${a}`)}this.log(`loading audio-track playlist ${n} "${r.name}" lang:${r.lang} group:${i}`),this.clearTimer(),this.hls.trigger(w.AUDIO_TRACK_LOADING,{url:s,id:n,groupId:i,deliveryDirectives:e||null})}}}const Yv=500;class yM extends Pm{constructor(e,r,n){super(e,r,n,"[subtitle-stream-controller]",we.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}_registerListeners(){const{hls:e}=this;e.on(w.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(w.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(w.MANIFEST_LOADING,this.onManifestLoading,this),e.on(w.LEVEL_LOADED,this.onLevelLoaded,this),e.on(w.ERROR,this.onError,this),e.on(w.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(w.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(w.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(w.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(w.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(w.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(w.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(w.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(w.MANIFEST_LOADING,this.onManifestLoading,this),e.off(w.LEVEL_LOADED,this.onLevelLoaded,this),e.off(w.ERROR,this.onError,this),e.off(w.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(w.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(w.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(w.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(w.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(w.FRAG_BUFFERED,this.onFragBuffered,this)}startLoad(e){this.stopLoad(),this.state=Y.IDLE,this.setInterval(Yv),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}onManifestLoading(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()}onMediaDetaching(){this.tracksBuffered=[],super.onMediaDetaching()}onLevelLoaded(e,r){this.mainDetails=r.details}onSubtitleFragProcessed(e,r){const{frag:n,success:i}=r;if(this.fragPrevious=n,this.state=Y.IDLE,!i)return;const s=this.tracksBuffered[this.currentTrackId];if(!s)return;let a;const o=n.start;for(let u=0;u<s.length;u++)if(o>=s[u].start&&o<=s[u].end){a=s[u];break}const l=n.start+n.duration;a?a.end=l:(a={start:o,end:l},s.push(a)),this.fragmentTracker.fragBuffered(n),this.fragBufferedComplete(n,null)}onBufferFlushing(e,r){const{startOffset:n,endOffset:i}=r;if(n===0&&i!==Number.POSITIVE_INFINITY){const s=i-1;if(s<=0)return;r.endOffsetSubtitles=Math.max(0,s),this.tracksBuffered.forEach(a=>{for(let o=0;o<a.length;){if(a[o].end<=s){a.shift();continue}else if(a[o].start<s)a[o].start=s;else break;o++}}),this.fragmentTracker.removeFragmentsInRange(n,s,we.SUBTITLE)}}onFragBuffered(e,r){if(!this.loadedmetadata&&r.frag.type===we.MAIN){var n;(n=this.media)!=null&&n.buffered.length&&(this.loadedmetadata=!0)}}onError(e,r){const n=r.frag;(n==null?void 0:n.type)===we.SUBTITLE&&(r.details===z.FRAG_GAP&&this.fragmentTracker.fragBuffered(n,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==Y.STOPPED&&(this.state=Y.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:r}){if(this.levels&&ZT(this.levels,r)){this.levels=r.map(n=>new Ia(n));return}this.tracksBuffered=[],this.levels=r.map(n=>{const i=new Ia(n);return this.tracksBuffered[i.id]=[],i}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,we.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(e,r){var n;if(this.currentTrackId=r.id,!((n=this.levels)!=null&&n.length)||this.currentTrackId===-1){this.clearInterval();return}const i=this.levels[this.currentTrackId];i!=null&&i.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,i&&this.setInterval(Yv)}onSubtitleTrackLoaded(e,r){var n;const{currentTrackId:i,levels:s}=this,{details:a,id:o}=r;if(!s){this.warn(`Subtitle tracks were reset while loading level ${o}`);return}const l=s[o];if(o>=s.length||!l)return;this.log(`Subtitle track ${o} loaded [${a.startSN},${a.endSN}]${a.lastPartSn?`[part-${a.lastPartSn}-${a.lastPartIndex}]`:""},duration:${a.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let u=0;if(a.live||(n=l.details)!=null&&n.live){const d=this.mainDetails;if(a.deltaUpdateFailed||!d)return;const f=d.fragments[0];if(!l.details)a.hasProgramDateTime&&d.hasProgramDateTime?(Gc(a,d),u=a.fragments[0].start):f&&(u=f.start,Qh(a,u));else{var c;u=this.alignPlaylists(a,l.details,(c=this.levelLastLoaded)==null?void 0:c.details),u===0&&f&&(u=f.start,Qh(a,u))}}l.details=a,this.levelLastLoaded=l,o===i&&(!this.startFragRequested&&(this.mainDetails||!a.live)&&this.setStartPosition(this.mainDetails||a,u),this.tick(),a.live&&!this.fragCurrent&&this.media&&this.state===Y.IDLE&&(Vc(null,a.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),l.details=void 0)))}_handleFragmentLoadComplete(e){const{frag:r,payload:n}=e,i=r.decryptdata,s=this.hls;if(!this.fragContextChanged(r)&&n&&n.byteLength>0&&i!=null&&i.key&&i.iv&&i.method==="AES-128"){const a=performance.now();this.decrypter.decrypt(new Uint8Array(n),i.key.buffer,i.iv.buffer).catch(o=>{throw s.trigger(w.ERROR,{type:_e.MEDIA_ERROR,details:z.FRAG_DECRYPT_ERROR,fatal:!1,error:o,reason:o.message,frag:r}),o}).then(o=>{const l=performance.now();s.trigger(w.FRAG_DECRYPTED,{frag:r,payload:o,stats:{tstart:a,tdecrypt:l}})}).catch(o=>{this.warn(`${o.name}: ${o.message}`),this.state=Y.IDLE})}}doTick(){if(!this.media){this.state=Y.IDLE;return}if(this.state===Y.IDLE){const{currentTrackId:e,levels:r}=this,n=r==null?void 0:r[e];if(!n||!r.length||!n.details)return;const{config:i}=this,s=this.getLoadPosition(),a=at.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],s,i.maxBufferHole),{end:o,len:l}=a,u=this.getFwdBufferInfo(this.media,we.MAIN),c=n.details,d=this.getMaxBufferLength(u==null?void 0:u.len)+c.levelTargetDuration;if(l>d)return;const f=c.fragments,m=f.length,h=c.edge;let p=null;const v=this.fragPrevious;if(o<h){const g=i.maxFragLookUpTolerance,y=o>h-g?0:g;p=Vc(v,f,Math.max(f[0].start,o),y),!p&&v&&v.start<f[0].start&&(p=f[0])}else p=f[m-1];if(!p)return;if(p=this.mapToInitFragWhenRequired(p),p.sn!=="initSegment"){const g=p.sn-c.startSN,y=f[g-1];y&&y.cc===p.cc&&this.fragmentTracker.getState(y)===Bt.NOT_LOADED&&(p=y)}this.fragmentTracker.getState(p)===Bt.NOT_LOADED&&this.loadFragment(p,n,o)}}getMaxBufferLength(e){const r=super.getMaxBufferLength();return e?Math.max(r,e):r}loadFragment(e,r,n){this.fragCurrent=e,e.sn==="initSegment"?this._loadInitSegment(e,r):(this.startFragRequested=!0,super.loadFragment(e,r,n))}get mediaBufferTimeRanges(){return new xM(this.tracksBuffered[this.currentTrackId]||[])}}class xM{constructor(e){this.buffered=void 0;const r=(n,i,s)=>{if(i=i>>>0,i>s-1)throw new DOMException(`Failed to execute '${n}' on 'TimeRanges': The index provided (${i}) is greater than the maximum bound (${s})`);return e[i][n]};this.buffered={get length(){return e.length},end(n){return r("end",n,e.length)},start(n){return r("start",n,e.length)}}}}class SM extends Im{constructor(e){super(e,"[subtitle-track-controller]"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let r=null;const n=Pu(this.media.textTracks);for(let s=0;s<n.length;s++)if(n[s].mode==="hidden")r=n[s];else if(n[s].mode==="showing"){r=n[s];break}const i=this.findTrackForTextTrack(r);this.subtitleTrack!==i&&this.setSubtitleTrack(i)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:e}=this;e.on(w.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(w.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(w.MANIFEST_LOADING,this.onManifestLoading,this),e.on(w.MANIFEST_PARSED,this.onManifestParsed,this),e.on(w.LEVEL_LOADING,this.onLevelLoading,this),e.on(w.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(w.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(w.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(w.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(w.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(w.MANIFEST_LOADING,this.onManifestLoading,this),e.off(w.MANIFEST_PARSED,this.onManifestParsed,this),e.off(w.LEVEL_LOADING,this.onLevelLoading,this),e.off(w.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(w.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(w.ERROR,this.onError,this)}onMediaAttached(e,r){this.media=r.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}onMediaDetaching(){if(!this.media)return;self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),Pu(this.media.textTracks).forEach(r=>{ta(r)}),this.subtitleTrack=-1,this.media=null}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,r){this.tracks=r.subtitleTracks}onSubtitleTrackLoaded(e,r){const{id:n,groupId:i,details:s}=r,a=this.tracksInGroup[n];if(!a||a.groupId!==i){this.warn(`Subtitle track with id:${n} and group:${i} not found in active group ${a==null?void 0:a.groupId}`);return}const o=a.details;a.details=r.details,this.log(`Subtitle track ${n} "${a.name}" lang:${a.lang} group:${i} loaded [${s.startSN}-${s.endSN}]`),n===this.trackId&&this.playlistLoaded(n,r,o)}onLevelLoading(e,r){this.switchLevel(r.level)}onLevelSwitching(e,r){this.switchLevel(r.level)}switchLevel(e){const r=this.hls.levels[e];if(!r)return;const n=r.subtitleGroups||null,i=this.groupIds;let s=this.currentTrack;if(!n||(i==null?void 0:i.length)!==(n==null?void 0:n.length)||n!=null&&n.some(a=>(i==null?void 0:i.indexOf(a))===-1)){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const a=this.tracks.filter(c=>!n||n.indexOf(c.groupId)!==-1);if(a.length)this.selectDefaultTrack&&!a.some(c=>c.default)&&(this.selectDefaultTrack=!1),a.forEach((c,d)=>{c.id=d});else if(!s&&!this.tracksInGroup.length)return;this.tracksInGroup=a;const o=this.hls.config.subtitlePreference;if(!s&&o){this.selectDefaultTrack=!1;const c=Dn(o,a);if(c>-1)s=a[c];else{const d=Dn(o,this.tracks);s=this.tracks[d]}}let l=this.findTrackId(s);l===-1&&s&&(l=this.findTrackId(null));const u={subtitleTracks:a};this.log(`Updating subtitle tracks, ${a.length} track(s) found in "${n==null?void 0:n.join(",")}" group-id`),this.hls.trigger(w.SUBTITLE_TRACKS_UPDATED,u),l!==-1&&this.trackId===-1&&this.setSubtitleTrack(l)}else this.shouldReloadPlaylist(s)&&this.setSubtitleTrack(this.trackId)}findTrackId(e){const r=this.tracksInGroup,n=this.selectDefaultTrack;for(let i=0;i<r.length;i++){const s=r[i];if(!(n&&!s.default||!n&&!e)&&(!e||da(s,e)))return i}if(e){for(let i=0;i<r.length;i++){const s=r[i];if(ka(e.attrs,s.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return i}for(let i=0;i<r.length;i++){const s=r[i];if(ka(e.attrs,s.attrs,["LANGUAGE"]))return i}}return-1}findTrackForTextTrack(e){if(e){const r=this.tracksInGroup;for(let n=0;n<r.length;n++){const i=r[n];if(tp(i,e))return n}}return-1}onError(e,r){r.fatal||!r.context||r.context.type===He.SUBTITLE_TRACK&&r.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(r.context.groupId)!==-1)&&this.checkRetry(r)}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}setSubtitleOption(e){if(this.hls.config.subtitlePreference=e,e){const r=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,r.length){const n=this.currentTrack;if(n&&da(e,n))return n;const i=Dn(e,this.tracksInGroup);if(i>-1){const s=this.tracksInGroup[i];return this.setSubtitleTrack(i),s}else{if(n)return null;{const s=Dn(e,r);if(s>-1)return r[s]}}}}return null}loadPlaylist(e){super.loadPlaylist();const r=this.currentTrack;if(this.shouldLoadPlaylist(r)&&r){const n=r.id,i=r.groupId;let s=r.url;if(e)try{s=e.addDirectives(s)}catch(a){this.warn(`Could not construct new URL with HLS Delivery Directives: ${a}`)}this.log(`Loading subtitle playlist for id ${n}`),this.hls.trigger(w.SUBTITLE_TRACK_LOADING,{url:s,id:n,groupId:i,deliveryDirectives:e||null})}}toggleTrackModes(){const{media:e}=this;if(!e)return;const r=Pu(e.textTracks),n=this.currentTrack;let i;if(n&&(i=r.filter(s=>tp(n,s))[0],i||this.warn(`Unable to find subtitle TextTrack with name "${n.name}" and language "${n.lang}"`)),[].slice.call(r).forEach(s=>{s.mode!=="disabled"&&s!==i&&(s.mode="disabled")}),i){const s=this.subtitleDisplay?"showing":"hidden";i.mode!==s&&(i.mode=s)}}setSubtitleTrack(e){const r=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(e<-1||e>=r.length||!pe(e)){this.warn(`Invalid subtitle track id: ${e}`);return}this.clearTimer(),this.selectDefaultTrack=!1;const n=this.currentTrack,i=r[e]||null;if(this.trackId=e,this.currentTrack=i,this.toggleTrackModes(),!i){this.hls.trigger(w.SUBTITLE_TRACK_SWITCH,{id:e});return}const s=!!i.details&&!i.details.live;if(e===this.trackId&&i===n&&s)return;this.log(`Switching to subtitle-track ${e}`+(i?` "${i.name}" lang:${i.lang} group:${i.groupId}`:""));const{id:a,groupId:o="",name:l,type:u,url:c}=i;this.hls.trigger(w.SUBTITLE_TRACK_SWITCH,{id:a,groupId:o,name:l,type:u,url:c});const d=this.switchParams(i.url,n==null?void 0:n.details,i.details);this.loadPlaylist(d)}}class EM{constructor(e){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=e}append(e,r,n){const i=this.queues[r];i.push(e),i.length===1&&!n&&this.executeNext(r)}insertAbort(e,r){this.queues[r].unshift(e),this.executeNext(r)}appendBlocker(e){let r;const n=new Promise(s=>{r=s}),i={execute:r,onStart:()=>{},onComplete:()=>{},onError:()=>{}};return this.append(i,e),n}executeNext(e){const r=this.queues[e];if(r.length){const n=r[0];try{n.execute()}catch(i){U.warn(`[buffer-operation-queue]: Exception executing "${e}" SourceBuffer operation: ${i}`),n.onError(i);const s=this.buffers[e];s!=null&&s.updating||this.shiftAndExecuteNext(e)}}}shiftAndExecuteNext(e){this.queues[e].shift(),this.executeNext(e)}current(e){return this.queues[e][0]}}const qv=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/;class TM{constructor(e){this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendSource=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this.log=void 0,this.warn=void 0,this.error=void 0,this._onEndStreaming=n=>{this.hls&&this.hls.pauseBuffering()},this._onStartStreaming=n=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=()=>{const{media:n,mediaSource:i}=this;this.log("Media source opened"),n&&(n.removeEventListener("emptied",this._onMediaEmptied),this.updateMediaElementDuration(),this.hls.trigger(w.MEDIA_ATTACHED,{media:n,mediaSource:i})),i&&i.removeEventListener("sourceopen",this._onMediaSourceOpen),this.checkPendingTracks()},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:n,_objectUrl:i}=this;n!==i&&U.error(`Media element src was set while attaching MediaSource (${i} > ${n})`)},this.hls=e;const r="[buffer-controller]";this.appendSource=kP(bs(e.config.preferManagedMediaSource)),this.log=U.log.bind(U,r),this.warn=U.warn.bind(U,r),this.error=U.error.bind(U,r),this._initSourceBuffer(),this.registerListeners()}hasSourceTypes(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null,this.hls=null}registerListeners(){const{hls:e}=this;e.on(w.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(w.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(w.MANIFEST_LOADING,this.onManifestLoading,this),e.on(w.MANIFEST_PARSED,this.onManifestParsed,this),e.on(w.BUFFER_RESET,this.onBufferReset,this),e.on(w.BUFFER_APPENDING,this.onBufferAppending,this),e.on(w.BUFFER_CODECS,this.onBufferCodecs,this),e.on(w.BUFFER_EOS,this.onBufferEos,this),e.on(w.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(w.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(w.FRAG_PARSED,this.onFragParsed,this),e.on(w.FRAG_CHANGED,this.onFragChanged,this)}unregisterListeners(){const{hls:e}=this;e.off(w.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(w.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(w.MANIFEST_LOADING,this.onManifestLoading,this),e.off(w.MANIFEST_PARSED,this.onManifestParsed,this),e.off(w.BUFFER_RESET,this.onBufferReset,this),e.off(w.BUFFER_APPENDING,this.onBufferAppending,this),e.off(w.BUFFER_CODECS,this.onBufferCodecs,this),e.off(w.BUFFER_EOS,this.onBufferEos,this),e.off(w.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(w.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(w.FRAG_PARSED,this.onFragParsed,this),e.off(w.FRAG_CHANGED,this.onFragChanged,this)}_initSourceBuffer(){this.sourceBuffer={},this.operationQueue=new EM(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.appendErrors={audio:0,video:0,audiovideo:0},this.lastMpegAudioChunk=null}onManifestLoading(){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,r){let n=2;(r.audio&&!r.video||!r.altAudio)&&(n=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=n,this.log(`${this.bufferCodecEventsExpected} bufferCodec event(s) expected`)}onMediaAttaching(e,r){const n=this.media=r.media,i=bs(this.appendSource);if(n&&i){var s;const a=this.mediaSource=new i;this.log(`created media source: ${(s=a.constructor)==null?void 0:s.name}`),a.addEventListener("sourceopen",this._onMediaSourceOpen),a.addEventListener("sourceended",this._onMediaSourceEnded),a.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(a.addEventListener("startstreaming",this._onStartStreaming),a.addEventListener("endstreaming",this._onEndStreaming));const o=this._objectUrl=self.URL.createObjectURL(a);if(this.appendSource)try{n.removeAttribute("src");const l=self.ManagedMediaSource;n.disableRemotePlayback=n.disableRemotePlayback||l&&a instanceof l,Xv(n),wM(n,o),n.load()}catch{n.src=o}else n.src=o;n.addEventListener("emptied",this._onMediaEmptied)}}onMediaDetaching(){const{media:e,mediaSource:r,_objectUrl:n}=this;if(r){if(this.log("media source detaching"),r.readyState==="open")try{r.endOfStream()}catch(i){this.warn(`onMediaDetaching: ${i.message} while calling endOfStream`)}this.onBufferReset(),r.removeEventListener("sourceopen",this._onMediaSourceOpen),r.removeEventListener("sourceended",this._onMediaSourceEnded),r.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(r.removeEventListener("startstreaming",this._onStartStreaming),r.removeEventListener("endstreaming",this._onEndStreaming)),e&&(e.removeEventListener("emptied",this._onMediaEmptied),n&&self.URL.revokeObjectURL(n),this.mediaSrc===n?(e.removeAttribute("src"),this.appendSource&&Xv(e),e.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(w.MEDIA_DETACHED,void 0)}onBufferReset(){this.getSourceBufferTypes().forEach(e=>{this.resetBuffer(e)}),this._initSourceBuffer()}resetBuffer(e){const r=this.sourceBuffer[e];try{if(r){var n;this.removeBufferListeners(e),this.sourceBuffer[e]=void 0,(n=this.mediaSource)!=null&&n.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(r)}}catch(i){this.warn(`onBufferReset ${e}`,i)}}onBufferCodecs(e,r){const n=this.getSourceBufferTypes().length,i=Object.keys(r);if(i.forEach(a=>{if(n){const l=this.tracks[a];if(l&&typeof l.buffer.changeType=="function"){var o;const{id:u,codec:c,levelCodec:d,container:f,metadata:m}=r[a],h=vv(l.codec,l.levelCodec),p=h==null?void 0:h.replace(qv,"$1");let v=vv(c,d);const g=(o=v)==null?void 0:o.replace(qv,"$1");if(v&&p!==g){a.slice(0,5)==="audio"&&(v=Uc(v,this.appendSource));const y=`${f};codecs=${v}`;this.appendChangeType(a,y),this.log(`switching codec ${h} to ${v}`),this.tracks[a]={buffer:l.buffer,codec:c,container:f,levelCodec:d,metadata:m,id:u}}}}else this.pendingTracks[a]=r[a]}),n)return;const s=Math.max(this.bufferCodecEventsExpected-1,0);this.bufferCodecEventsExpected!==s&&(this.log(`${s} bufferCodec event(s) expected ${i.join(",")}`),this.bufferCodecEventsExpected=s),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks()}appendChangeType(e,r){const{operationQueue:n}=this,i={execute:()=>{const s=this.sourceBuffer[e];s&&(this.log(`changing ${e} sourceBuffer type to ${r}`),s.changeType(r)),n.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:s=>{this.warn(`Failed to change ${e} SourceBuffer type`,s)}};n.append(i,e,!!this.pendingTracks[e])}onBufferAppending(e,r){const{hls:n,operationQueue:i,tracks:s}=this,{data:a,type:o,frag:l,part:u,chunkMeta:c}=r,d=c.buffering[o],f=self.performance.now();d.start=f;const m=l.stats.buffering,h=u?u.stats.buffering:null;m.start===0&&(m.start=f),h&&h.start===0&&(h.start=f);const p=s.audio;let v=!1;o==="audio"&&(p==null?void 0:p.container)==="audio/mpeg"&&(v=!this.lastMpegAudioChunk||c.id===1||this.lastMpegAudioChunk.sn!==c.sn,this.lastMpegAudioChunk=c);const g=l.start,y={execute:()=>{if(d.executeStart=self.performance.now(),v){const x=this.sourceBuffer[o];if(x){const S=g-x.timestampOffset;Math.abs(S)>=.1&&(this.log(`Updating audio SourceBuffer timestampOffset to ${g} (delta: ${S}) sn: ${l.sn})`),x.timestampOffset=g)}}this.appendExecutor(a,o)},onStart:()=>{},onComplete:()=>{const x=self.performance.now();d.executeEnd=d.end=x,m.first===0&&(m.first=x),h&&h.first===0&&(h.first=x);const{sourceBuffer:S}=this,T={};for(const C in S)T[C]=at.getBuffered(S[C]);this.appendErrors[o]=0,o==="audio"||o==="video"?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(w.BUFFER_APPENDED,{type:o,frag:l,part:u,chunkMeta:c,parent:l.type,timeRanges:T})},onError:x=>{const S={type:_e.MEDIA_ERROR,parent:l.type,details:z.BUFFER_APPEND_ERROR,sourceBufferName:o,frag:l,part:u,chunkMeta:c,error:x,err:x,fatal:!1};if(x.code===DOMException.QUOTA_EXCEEDED_ERR)S.details=z.BUFFER_FULL_ERROR;else{const T=++this.appendErrors[o];S.details=z.BUFFER_APPEND_ERROR,this.warn(`Failed ${T}/${n.config.appendErrorMaxRetry} times to append segment in "${o}" sourceBuffer`),T>=n.config.appendErrorMaxRetry&&(S.fatal=!0)}n.trigger(w.ERROR,S)}};i.append(y,o,!!this.pendingTracks[o])}onBufferFlushing(e,r){const{operationQueue:n}=this,i=s=>({execute:this.removeExecutor.bind(this,s,r.startOffset,r.endOffset),onStart:()=>{},onComplete:()=>{this.hls.trigger(w.BUFFER_FLUSHED,{type:s})},onError:a=>{this.warn(`Failed to remove from ${s} SourceBuffer`,a)}});r.type?n.append(i(r.type),r.type):this.getSourceBufferTypes().forEach(s=>{n.append(i(s),s)})}onFragParsed(e,r){const{frag:n,part:i}=r,s=[],a=i?i.elementaryStreams:n.elementaryStreams;a[Je.AUDIOVIDEO]?s.push("audiovideo"):(a[Je.AUDIO]&&s.push("audio"),a[Je.VIDEO]&&s.push("video"));const o=()=>{const l=self.performance.now();n.stats.buffering.end=l,i&&(i.stats.buffering.end=l);const u=i?i.stats:n.stats;this.hls.trigger(w.FRAG_BUFFERED,{frag:n,part:i,stats:u,id:n.type})};s.length===0&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${n.type} level: ${n.level} sn: ${n.sn}`),this.blockBuffers(o,s)}onFragChanged(e,r){this.trimBuffers()}onBufferEos(e,r){this.getSourceBufferTypes().reduce((i,s)=>{const a=this.sourceBuffer[s];return a&&(!r.type||r.type===s)&&(a.ending=!0,a.ended||(a.ended=!0,this.log(`${s} sourceBuffer now EOS`))),i&&!!(!a||a.ended)},!0)&&(this.log("Queueing mediaSource.endOfStream()"),this.blockBuffers(()=>{this.getSourceBufferTypes().forEach(s=>{const a=this.sourceBuffer[s];a&&(a.ending=!1)});const{mediaSource:i}=this;if(!i||i.readyState!=="open"){i&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${i.readyState}`);return}this.log("Calling mediaSource.endOfStream()"),i.endOfStream()}))}onLevelUpdated(e,{details:r}){r.fragments.length&&(this.details=r,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())}trimBuffers(){const{hls:e,details:r,media:n}=this;if(!n||r===null||!this.getSourceBufferTypes().length)return;const s=e.config,a=n.currentTime,o=r.levelTargetDuration,l=r.live&&s.liveBackBufferLength!==null?s.liveBackBufferLength:s.backBufferLength;if(pe(l)&&l>0){const u=Math.max(l,o),c=Math.floor(a/o)*o-u;this.flushBackBuffer(a,o,c)}if(pe(s.frontBufferFlushThreshold)&&s.frontBufferFlushThreshold>0){const u=Math.max(s.maxBufferLength,s.frontBufferFlushThreshold),c=Math.max(u,o),d=Math.floor(a/o)*o+c;this.flushFrontBuffer(a,o,d)}}flushBackBuffer(e,r,n){const{details:i,sourceBuffer:s}=this;this.getSourceBufferTypes().forEach(o=>{const l=s[o];if(l){const u=at.getBuffered(l);if(u.length>0&&n>u.start(0)){if(this.hls.trigger(w.BACK_BUFFER_REACHED,{bufferEnd:n}),i!=null&&i.live)this.hls.trigger(w.LIVE_BACK_BUFFER_REACHED,{bufferEnd:n});else if(l.ended&&u.end(u.length-1)-e<r*2){this.log(`Cannot flush ${o} back buffer while SourceBuffer is in ended state`);return}this.hls.trigger(w.BUFFER_FLUSHING,{startOffset:0,endOffset:n,type:o})}}})}flushFrontBuffer(e,r,n){const{sourceBuffer:i}=this;this.getSourceBufferTypes().forEach(a=>{const o=i[a];if(o){const l=at.getBuffered(o),u=l.length;if(u<2)return;const c=l.start(u-1),d=l.end(u-1);if(n>c||e>=c&&e<=d)return;if(o.ended&&e-d<2*r){this.log(`Cannot flush ${a} front buffer while SourceBuffer is in ended state`);return}this.hls.trigger(w.BUFFER_FLUSHING,{startOffset:c,endOffset:1/0,type:a})}})}updateMediaElementDuration(){if(!this.details||!this.media||!this.mediaSource||this.mediaSource.readyState!=="open")return;const{details:e,hls:r,media:n,mediaSource:i}=this,s=e.fragments[0].start+e.totalduration,a=n.duration,o=pe(i.duration)?i.duration:0;e.live&&r.config.liveDurationInfinity?(i.duration=1/0,this.updateSeekableRange(e)):(s>o&&s>a||!pe(a))&&(this.log(`Updating Media Source duration to ${s.toFixed(3)}`),i.duration=s)}updateSeekableRange(e){const r=this.mediaSource,n=e.fragments;if(n.length&&e.live&&r!=null&&r.setLiveSeekableRange){const s=Math.max(0,n[0].start),a=Math.max(s,s+e.totalduration);this.log(`Media Source duration is set to ${r.duration}. Setting seekable range to ${s}-${a}.`),r.setLiveSeekableRange(s,a)}}checkPendingTracks(){const{bufferCodecEventsExpected:e,operationQueue:r,pendingTracks:n}=this,i=Object.keys(n).length;if(i&&(!e||i===2||"audiovideo"in n)){this.createSourceBuffers(n),this.pendingTracks={};const s=this.getSourceBufferTypes();if(s.length)this.hls.trigger(w.BUFFER_CREATED,{tracks:this.tracks}),s.forEach(a=>{r.executeNext(a)});else{const a=new Error("could not create source buffer for media codec(s)");this.hls.trigger(w.ERROR,{type:_e.MEDIA_ERROR,details:z.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:a,reason:a.message})}}}createSourceBuffers(e){const{sourceBuffer:r,mediaSource:n}=this;if(!n)throw Error("createSourceBuffers called when mediaSource was null");for(const s in e)if(!r[s]){var i;const a=e[s];if(!a)throw Error(`source buffer exists for track ${s}, however track does not`);let o=((i=a.levelCodec)==null?void 0:i.indexOf(","))===-1?a.levelCodec:a.codec;o&&s.slice(0,5)==="audio"&&(o=Uc(o,this.appendSource));const l=`${a.container};codecs=${o}`;this.log(`creating sourceBuffer(${l})`);try{const u=r[s]=n.addSourceBuffer(l),c=s;this.addBufferListener(c,"updatestart",this._onSBUpdateStart),this.addBufferListener(c,"updateend",this._onSBUpdateEnd),this.addBufferListener(c,"error",this._onSBUpdateError),this.appendSource&&this.addBufferListener(c,"bufferedchange",(d,f)=>{const m=f.removedRanges;m!=null&&m.length&&this.hls.trigger(w.BUFFER_FLUSHED,{type:s})}),this.tracks[s]={buffer:u,codec:o,container:a.container,levelCodec:a.levelCodec,metadata:a.metadata,id:a.id}}catch(u){this.error(`error while trying to add sourceBuffer: ${u.message}`),this.hls.trigger(w.ERROR,{type:_e.MEDIA_ERROR,details:z.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:u,sourceBufferName:s,mimeType:l})}}}get mediaSrc(){var e,r;const n=((e=this.media)==null||(r=e.querySelector)==null?void 0:r.call(e,"source"))||this.media;return n==null?void 0:n.src}_onSBUpdateStart(e){const{operationQueue:r}=this;r.current(e).onStart()}_onSBUpdateEnd(e){var r;if(((r=this.mediaSource)==null?void 0:r.readyState)==="closed"){this.resetBuffer(e);return}const{operationQueue:n}=this;n.current(e).onComplete(),n.shiftAndExecuteNext(e)}_onSBUpdateError(e,r){var n;const i=new Error(`${e} SourceBuffer error. MediaSource readyState: ${(n=this.mediaSource)==null?void 0:n.readyState}`);this.error(`${i}`,r),this.hls.trigger(w.ERROR,{type:_e.MEDIA_ERROR,details:z.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:i,fatal:!1});const s=this.operationQueue.current(e);s&&s.onError(i)}removeExecutor(e,r,n){const{media:i,mediaSource:s,operationQueue:a,sourceBuffer:o}=this,l=o[e];if(!i||!s||!l){this.warn(`Attempting to remove from the ${e} SourceBuffer, but it does not exist`),a.shiftAndExecuteNext(e);return}const u=pe(i.duration)?i.duration:1/0,c=pe(s.duration)?s.duration:1/0,d=Math.max(0,r),f=Math.min(n,u,c);f>d&&(!l.ending||l.ended)?(l.ended=!1,this.log(`Removing [${d},${f}] from the ${e} SourceBuffer`),l.remove(d,f)):a.shiftAndExecuteNext(e)}appendExecutor(e,r){const n=this.sourceBuffer[r];if(!n){if(!this.pendingTracks[r])throw new Error(`Attempting to append to the ${r} SourceBuffer, but it does not exist`);return}n.ended=!1,n.appendBuffer(e)}blockBuffers(e,r=this.getSourceBufferTypes()){if(!r.length){this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);return}const{operationQueue:n}=this,i=r.map(s=>n.appendBlocker(s));Promise.all(i).then(()=>{e(),r.forEach(s=>{const a=this.sourceBuffer[s];a!=null&&a.updating||n.shiftAndExecuteNext(s)})})}getSourceBufferTypes(){return Object.keys(this.sourceBuffer)}addBufferListener(e,r,n){const i=this.sourceBuffer[e];if(!i)return;const s=n.bind(this,e);this.listeners[e].push({event:r,listener:s}),i.addEventListener(r,s)}removeBufferListeners(e){const r=this.sourceBuffer[e];r&&this.listeners[e].forEach(n=>{r.removeEventListener(n.event,n.listener)})}}function Xv(t){const e=t.querySelectorAll("source");[].slice.call(e).forEach(r=>{t.removeChild(r)})}function wM(t,e){const r=self.document.createElement("source");r.type="video/mp4",r.src=e,t.appendChild(r)}const bM={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},QT=t=>String.fromCharCode(bM[t]||t),an=15,Kn=100,LM={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},AM={17:2,18:4,21:6,22:8,23:10,19:13,20:15},_M={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},CM={25:2,26:4,29:6,30:8,31:10,27:13,28:15},RM=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class IM{constructor(){this.time=null,this.verboseLevel=0}log(e,r){if(this.verboseLevel>=e){const n=typeof r=="function"?r():r;U.log(`${this.time} [${e}] ${n}`)}}}const Zi=function(e){const r=[];for(let n=0;n<e.length;n++)r.push(e[n].toString(16));return r};class JT{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const r=["foreground","underline","italics","background","flash"];for(let n=0;n<r.length;n++){const i=r[n];e.hasOwnProperty(i)&&(this[i]=e[i])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class kM{constructor(){this.uchar=" ",this.penState=new JT}reset(){this.uchar=" ",this.penState.reset()}setChar(e,r){this.uchar=e,this.penState.copy(r)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class DM{constructor(e){this.chars=[],this.pos=0,this.currPenState=new JT,this.cueStartTime=null,this.logger=void 0;for(let r=0;r<Kn;r++)this.chars.push(new kM);this.logger=e}equals(e){for(let r=0;r<Kn;r++)if(!this.chars[r].equals(e.chars[r]))return!1;return!0}copy(e){for(let r=0;r<Kn;r++)this.chars[r].copy(e.chars[r])}isEmpty(){let e=!0;for(let r=0;r<Kn;r++)if(!this.chars[r].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>Kn&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=Kn)}moveCursor(e){const r=this.pos+e;if(e>1)for(let n=this.pos+1;n<r+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(r)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const r=QT(e);if(this.pos>=Kn){this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+r+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(r,this.currPenState),this.moveCursor(1)}clearFromPos(e){let r;for(r=e;r<Kn;r++)this.chars[r].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let r=!0;for(let n=0;n<Kn;n++){const i=this.chars[n].uchar;i!==" "&&(r=!1),e.push(i)}return r?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}class kf{constructor(e){this.rows=[],this.currRow=an-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let r=0;r<an;r++)this.rows.push(new DM(e));this.logger=e}reset(){for(let e=0;e<an;e++)this.rows[e].clear();this.currRow=an-1}equals(e){let r=!0;for(let n=0;n<an;n++)if(!this.rows[n].equals(e.rows[n])){r=!1;break}return r}copy(e){for(let r=0;r<an;r++)this.rows[r].copy(e.rows[r])}isEmpty(){let e=!0;for(let r=0;r<an;r++)if(!this.rows[r].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+JSON.stringify(e));let r=e.row-1;if(this.nrRollUpRows&&r<this.nrRollUpRows-1&&(r=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==r){for(let o=0;o<an;o++)this.rows[o].clear();const s=this.currRow+1-this.nrRollUpRows,a=this.lastOutputScreen;if(a){const o=a.rows[s].cueStartTime,l=this.logger.time;if(o!==null&&l!==null&&o<l)for(let u=0;u<this.nrRollUpRows;u++)this.rows[r-this.nrRollUpRows+u+1].copy(a.rows[s+u])}}this.currRow=r;const n=this.rows[this.currRow];if(e.indent!==null){const s=e.indent,a=Math.max(s-1,0);n.setCursor(e.indent),e.color=n.chars[a].penState.foreground}const i={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(i)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const e=this.currRow+1-this.nrRollUpRows,r=this.rows.splice(e,1)[0];r.clear(),this.rows.splice(this.currRow,0,r),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const r=[];let n="",i=-1;for(let s=0;s<an;s++){const a=this.rows[s].getTextString();a&&(i=s+1,e?r.push("Row "+i+": '"+a+"'"):r.push(a.trim()))}return r.length>0&&(e?n="["+r.join(" | ")+"]":n=r.join(`
`)),n}getTextAndFormat(){return this.rows}}class Zv{constructor(e,r,n){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=r,this.mode=null,this.verbose=0,this.displayedMemory=new kf(n),this.nonDisplayedMemory=new kf(n),this.lastOutputScreen=new kf(n),this.currRollUpRow=this.displayedMemory.rows[an-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=n}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[an-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let n=0;n<e.length;n++)this.writeScreen.insertChar(e[n]);const r=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>r+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const r={flash:!1};if(r.underline=e%2===1,r.italics=e>=46,r.italics)r.foreground="white";else{const n=Math.floor(e/2)-16,i=["white","green","blue","cyan","red","yellow","magenta"];r.foreground=i[n]}this.logger.log(2,"MIDROW: "+JSON.stringify(r)),this.writeScreen.setPen(r)}outputDataUpdate(e=!1){const r=this.logger.time;r!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=r:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,r,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:r),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class Qv{constructor(e,r,n){this.channels=void 0,this.currentChannel=0,this.cmdHistory=OM(),this.logger=void 0;const i=this.logger=new IM;this.channels=[null,new Zv(e,r,i),new Zv(e+1,n,i)]}getHandler(e){return this.channels[e].getHandler()}setHandler(e,r){this.channels[e].setHandler(r)}addData(e,r){this.logger.time=e;for(let n=0;n<r.length;n+=2){const i=r[n]&127,s=r[n+1]&127;let a=!1,o=null;if(i===0&&s===0)continue;this.logger.log(3,()=>"["+Zi([r[n],r[n+1]])+"] -> ("+Zi([i,s])+")");const l=this.cmdHistory;if(i>=16&&i<=31){if(PM(i,s,l)){ou(null,null,l),this.logger.log(3,()=>"Repeated command ("+Zi([i,s])+") is dropped");continue}ou(i,s,this.cmdHistory),a=this.parseCmd(i,s),a||(a=this.parseMidrow(i,s)),a||(a=this.parsePAC(i,s)),a||(a=this.parseBackgroundAttributes(i,s))}else ou(null,null,l);if(!a&&(o=this.parseChars(i,s),o)){const c=this.currentChannel;c&&c>0?this.channels[c].insertChars(o):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!a&&!o&&this.logger.log(2,()=>"Couldn't parse cleaned data "+Zi([i,s])+" orig: "+Zi([r[n],r[n+1]]))}}parseCmd(e,r){const n=(e===20||e===28||e===21||e===29)&&r>=32&&r<=47,i=(e===23||e===31)&&r>=33&&r<=35;if(!(n||i))return!1;const s=e===20||e===21||e===23?1:2,a=this.channels[s];return e===20||e===21||e===28||e===29?r===32?a.ccRCL():r===33?a.ccBS():r===34?a.ccAOF():r===35?a.ccAON():r===36?a.ccDER():r===37?a.ccRU(2):r===38?a.ccRU(3):r===39?a.ccRU(4):r===40?a.ccFON():r===41?a.ccRDC():r===42?a.ccTR():r===43?a.ccRTD():r===44?a.ccEDM():r===45?a.ccCR():r===46?a.ccENM():r===47&&a.ccEOC():a.ccTO(r-32),this.currentChannel=s,!0}parseMidrow(e,r){let n=0;if((e===17||e===25)&&r>=32&&r<=47){if(e===17?n=1:n=2,n!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const i=this.channels[n];return i?(i.ccMIDROW(r),this.logger.log(3,()=>"MIDROW ("+Zi([e,r])+")"),!0):!1}return!1}parsePAC(e,r){let n;const i=(e>=17&&e<=23||e>=25&&e<=31)&&r>=64&&r<=127,s=(e===16||e===24)&&r>=64&&r<=95;if(!(i||s))return!1;const a=e<=23?1:2;r>=64&&r<=95?n=a===1?LM[e]:_M[e]:n=a===1?AM[e]:CM[e];const o=this.channels[a];return o?(o.setPAC(this.interpretPAC(n,r)),this.currentChannel=a,!0):!1}interpretPAC(e,r){let n;const i={color:null,italics:!1,indent:null,underline:!1,row:e};return r>95?n=r-96:n=r-64,i.underline=(n&1)===1,n<=13?i.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(i.italics=!0,i.color="white"):i.indent=Math.floor((n-16)/2)*4,i}parseChars(e,r){let n,i=null,s=null;if(e>=25?(n=2,s=e-8):(n=1,s=e),s>=17&&s<=19){let a;s===17?a=r+80:s===18?a=r+112:a=r+144,this.logger.log(2,()=>"Special char '"+QT(a)+"' in channel "+n),i=[a]}else e>=32&&e<=127&&(i=r===0?[e]:[e,r]);return i&&this.logger.log(3,()=>"Char codes =  "+Zi(i).join(",")),i}parseBackgroundAttributes(e,r){const n=(e===16||e===24)&&r>=32&&r<=47,i=(e===23||e===31)&&r>=45&&r<=47;if(!(n||i))return!1;let s;const a={};e===16||e===24?(s=Math.floor((r-32)/2),a.background=RM[s],r%2===1&&(a.background=a.background+"_semi")):r===45?a.background="transparent":(a.foreground="black",r===47&&(a.underline=!0));const o=e<=23?1:2;return this.channels[o].setBkgData(a),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const r=this.channels[e];r&&r.reset()}ou(null,null,this.cmdHistory)}cueSplitAtTime(e){for(let r=0;r<this.channels.length;r++){const n=this.channels[r];n&&n.cueSplitAtTime(e)}}}function ou(t,e,r){r.a=t,r.b=e}function PM(t,e,r){return r.a===t&&r.b===e}function OM(){return{a:null,b:null}}class lu{constructor(e,r){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=r}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,r,n){(this.startTime===null||this.startTime>e)&&(this.startTime=e),this.endTime=r,this.screen=n,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}var Bm=function(){if(Ra!=null&&Ra.VTTCue)return self.VTTCue;const t=["","lr","rl"],e=["start","middle","end","left","right"];function r(o,l){if(typeof l!="string"||!Array.isArray(o))return!1;const u=l.toLowerCase();return~o.indexOf(u)?u:!1}function n(o){return r(t,o)}function i(o){return r(e,o)}function s(o,...l){let u=1;for(;u<arguments.length;u++){const c=arguments[u];for(const d in c)o[d]=c[d]}return o}function a(o,l,u){const c=this,d={enumerable:!0};c.hasBeenReset=!1;let f="",m=!1,h=o,p=l,v=u,g=null,y="",x=!0,S="auto",T="start",C=50,_="middle",b=50,I="middle";Object.defineProperty(c,"id",s({},d,{get:function(){return f},set:function(A){f=""+A}})),Object.defineProperty(c,"pauseOnExit",s({},d,{get:function(){return m},set:function(A){m=!!A}})),Object.defineProperty(c,"startTime",s({},d,{get:function(){return h},set:function(A){if(typeof A!="number")throw new TypeError("Start time must be set to a number.");h=A,this.hasBeenReset=!0}})),Object.defineProperty(c,"endTime",s({},d,{get:function(){return p},set:function(A){if(typeof A!="number")throw new TypeError("End time must be set to a number.");p=A,this.hasBeenReset=!0}})),Object.defineProperty(c,"text",s({},d,{get:function(){return v},set:function(A){v=""+A,this.hasBeenReset=!0}})),Object.defineProperty(c,"region",s({},d,{get:function(){return g},set:function(A){g=A,this.hasBeenReset=!0}})),Object.defineProperty(c,"vertical",s({},d,{get:function(){return y},set:function(A){const k=n(A);if(k===!1)throw new SyntaxError("An invalid or illegal string was specified.");y=k,this.hasBeenReset=!0}})),Object.defineProperty(c,"snapToLines",s({},d,{get:function(){return x},set:function(A){x=!!A,this.hasBeenReset=!0}})),Object.defineProperty(c,"line",s({},d,{get:function(){return S},set:function(A){if(typeof A!="number"&&A!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");S=A,this.hasBeenReset=!0}})),Object.defineProperty(c,"lineAlign",s({},d,{get:function(){return T},set:function(A){const k=i(A);if(!k)throw new SyntaxError("An invalid or illegal string was specified.");T=k,this.hasBeenReset=!0}})),Object.defineProperty(c,"position",s({},d,{get:function(){return C},set:function(A){if(A<0||A>100)throw new Error("Position must be between 0 and 100.");C=A,this.hasBeenReset=!0}})),Object.defineProperty(c,"positionAlign",s({},d,{get:function(){return _},set:function(A){const k=i(A);if(!k)throw new SyntaxError("An invalid or illegal string was specified.");_=k,this.hasBeenReset=!0}})),Object.defineProperty(c,"size",s({},d,{get:function(){return b},set:function(A){if(A<0||A>100)throw new Error("Size must be between 0 and 100.");b=A,this.hasBeenReset=!0}})),Object.defineProperty(c,"align",s({},d,{get:function(){return I},set:function(A){const k=i(A);if(!k)throw new SyntaxError("An invalid or illegal string was specified.");I=k,this.hasBeenReset=!0}})),c.displayState=void 0}return a.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},a}();class MM{decode(e,r){if(!e)return"";if(typeof e!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function ew(t){function e(n,i,s,a){return(n|0)*3600+(i|0)*60+(s|0)+parseFloat(a||0)}const r=t.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return r?parseFloat(r[2])>59?e(r[2],r[3],0,r[4]):e(r[1],r[2],r[3],r[4]):null}let NM=class{constructor(){this.values=Object.create(null)}set(e,r){!this.get(e)&&r!==""&&(this.values[e]=r)}get(e,r,n){return n?this.has(e)?this.values[e]:r[n]:this.has(e)?this.values[e]:r}has(e){return e in this.values}alt(e,r,n){for(let i=0;i<n.length;++i)if(r===n[i]){this.set(e,r);break}}integer(e,r){/^-?\d+$/.test(r)&&this.set(e,parseInt(r,10))}percent(e,r){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(r)){const n=parseFloat(r);if(n>=0&&n<=100)return this.set(e,n),!0}return!1}};function tw(t,e,r,n){const i=n?t.split(n):[t];for(const s in i){if(typeof i[s]!="string")continue;const a=i[s].split(r);if(a.length!==2)continue;const o=a[0],l=a[1];e(o,l)}}const rp=new Bm(0,0,""),uu=rp.align==="middle"?"middle":"center";function FM(t,e,r){const n=t;function i(){const o=ew(t);if(o===null)throw new Error("Malformed timestamp: "+n);return t=t.replace(/^[^\sa-zA-Z-]+/,""),o}function s(o,l){const u=new NM;tw(o,function(f,m){let h;switch(f){case"region":for(let p=r.length-1;p>=0;p--)if(r[p].id===m){u.set(f,r[p].region);break}break;case"vertical":u.alt(f,m,["rl","lr"]);break;case"line":h=m.split(","),u.integer(f,h[0]),u.percent(f,h[0])&&u.set("snapToLines",!1),u.alt(f,h[0],["auto"]),h.length===2&&u.alt("lineAlign",h[1],["start",uu,"end"]);break;case"position":h=m.split(","),u.percent(f,h[0]),h.length===2&&u.alt("positionAlign",h[1],["start",uu,"end","line-left","line-right","auto"]);break;case"size":u.percent(f,m);break;case"align":u.alt(f,m,["start",uu,"end","left","right"]);break}},/:/,/\s/),l.region=u.get("region",null),l.vertical=u.get("vertical","");let c=u.get("line","auto");c==="auto"&&rp.line===-1&&(c=-1),l.line=c,l.lineAlign=u.get("lineAlign","start"),l.snapToLines=u.get("snapToLines",!0),l.size=u.get("size",100),l.align=u.get("align",uu);let d=u.get("position","auto");d==="auto"&&rp.position===50&&(d=l.align==="start"||l.align==="left"?0:l.align==="end"||l.align==="right"?100:50),l.position=d}function a(){t=t.replace(/^\s+/,"")}if(a(),e.startTime=i(),a(),t.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+n);t=t.slice(3),a(),e.endTime=i(),a(),s(t,e)}function rw(t){return t.replace(/<br(?: \/)?>/gi,`
`)}class UM{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new MM,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const r=this;e&&(r.buffer+=r.decoder.decode(e,{stream:!0}));function n(){let s=r.buffer,a=0;for(s=rw(s);a<s.length&&s[a]!=="\r"&&s[a]!==`
`;)++a;const o=s.slice(0,a);return s[a]==="\r"&&++a,s[a]===`
`&&++a,r.buffer=s.slice(a),o}function i(s){tw(s,function(a,o){},/:/)}try{let s="";if(r.state==="INITIAL"){if(!/\r\n|\n/.test(r.buffer))return this;s=n();const o=s.match(/^()?WEBVTT([ \t].*)?$/);if(!(o!=null&&o[0]))throw new Error("Malformed WebVTT signature.");r.state="HEADER"}let a=!1;for(;r.buffer;){if(!/\r\n|\n/.test(r.buffer))return this;switch(a?a=!1:s=n(),r.state){case"HEADER":/:/.test(s)?i(s):s||(r.state="ID");continue;case"NOTE":s||(r.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(s)){r.state="NOTE";break}if(!s)continue;if(r.cue=new Bm(0,0,""),r.state="CUE",s.indexOf("-->")===-1){r.cue.id=s;continue}case"CUE":if(!r.cue){r.state="BADCUE";continue}try{FM(s,r.cue,r.regionList)}catch{r.cue=null,r.state="BADCUE";continue}r.state="CUETEXT";continue;case"CUETEXT":{const o=s.indexOf("-->")!==-1;if(!s||o&&(a=!0)){r.oncue&&r.cue&&r.oncue(r.cue),r.cue=null,r.state="ID";continue}if(r.cue===null)continue;r.cue.text&&(r.cue.text+=`
`),r.cue.text+=s}continue;case"BADCUE":s||(r.state="ID")}}}catch{r.state==="CUETEXT"&&r.cue&&r.oncue&&r.oncue(r.cue),r.cue=null,r.state=r.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||e.state==="HEADER")&&(e.buffer+=`

`,e.parse()),e.state==="INITIAL"||e.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(r){e.onparsingerror&&e.onparsingerror(r)}return e.onflush&&e.onflush(),this}}const BM=/\r\n|\n\r|\n|\r/g,Df=function(e,r,n=0){return e.slice(n,n+r.length)===r},$M=function(e){let r=parseInt(e.slice(-3));const n=parseInt(e.slice(-6,-4)),i=parseInt(e.slice(-9,-7)),s=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!pe(r)||!pe(n)||!pe(i)||!pe(s))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return r+=1e3*n,r+=60*1e3*i,r+=60*60*1e3*s,r},Pf=function(e){let r=5381,n=e.length;for(;n;)r=r*33^e.charCodeAt(--n);return(r>>>0).toString()};function $m(t,e,r){return Pf(t.toString())+Pf(e.toString())+Pf(r)}const jM=function(e,r,n){let i=e[r],s=e[i.prevCC];if(!s||!s.new&&i.new){e.ccOffset=e.presentationOffset=i.start,i.new=!1;return}for(;(a=s)!=null&&a.new;){var a;e.ccOffset+=i.start-s.start,i.new=!1,i=s,s=e[i.prevCC]}e.presentationOffset=n};function VM(t,e,r,n,i,s,a){const o=new UM,l=Nn(new Uint8Array(t)).trim().replace(BM,`
`).split(`
`),u=[],c=e?sM(e.baseTime,e.timescale):0;let d="00:00.000",f=0,m=0,h,p=!0;o.oncue=function(v){const g=r[n];let y=r.ccOffset;const x=(f-c)/9e4;if(g!=null&&g.new&&(m!==void 0?y=r.ccOffset=g.start:jM(r,n,x)),x){if(!e){h=new Error("Missing initPTS for VTT MPEGTS");return}y=x-r.presentationOffset}const S=v.endTime-v.startTime,T=Hr((v.startTime+y-m)*9e4,i*9e4)/9e4;v.startTime=Math.max(T,0),v.endTime=Math.max(T+S,0);const C=v.text.trim();v.text=decodeURIComponent(encodeURIComponent(C)),v.id||(v.id=$m(v.startTime,v.endTime,C)),v.endTime>0&&u.push(v)},o.onparsingerror=function(v){h=v},o.onflush=function(){if(h){a(h);return}s(u)},l.forEach(v=>{if(p)if(Df(v,"X-TIMESTAMP-MAP=")){p=!1,v.slice(16).split(",").forEach(g=>{Df(g,"LOCAL:")?d=g.slice(6):Df(g,"MPEGTS:")&&(f=parseInt(g.slice(7)))});try{m=$M(d)/1e3}catch(g){h=g}return}else v===""&&(p=!1);o.parse(v+`
`)}),o.flush()}const Of="stpp.ttml.im1t",nw=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,iw=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,GM={left:"start",center:"center",right:"end",start:"start",end:"end"};function Jv(t,e,r,n){const i=Oe(new Uint8Array(t),["mdat"]);if(i.length===0){n(new Error("Could not parse IMSC1 mdat"));return}const s=i.map(o=>Nn(o)),a=iM(e.baseTime,1,e.timescale);try{s.forEach(o=>r(zM(o,a)))}catch(o){n(o)}}function zM(t,e){const i=new DOMParser().parseFromString(t,"text/xml").getElementsByTagName("tt")[0];if(!i)throw new Error("Invalid ttml");const s={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},a=Object.keys(s).reduce((d,f)=>(d[f]=i.getAttribute(`ttp:${f}`)||s[f],d),{}),o=i.getAttribute("xml:space")!=="preserve",l=ey(Mf(i,"styling","style")),u=ey(Mf(i,"layout","region")),c=Mf(i,"body","[begin]");return[].map.call(c,d=>{const f=sw(d,o);if(!f||!d.hasAttribute("begin"))return null;const m=Ff(d.getAttribute("begin"),a),h=Ff(d.getAttribute("dur"),a);let p=Ff(d.getAttribute("end"),a);if(m===null)throw ty(d);if(p===null){if(h===null)throw ty(d);p=m+h}const v=new Bm(m-e,p-e,f);v.id=$m(v.startTime,v.endTime,v.text);const g=u[d.getAttribute("region")],y=l[d.getAttribute("style")],x=HM(g,y,l),{textAlign:S}=x;if(S){const T=GM[S];T&&(v.lineAlign=T),v.align=S}return It(v,x),v}).filter(d=>d!==null)}function Mf(t,e,r){const n=t.getElementsByTagName(e)[0];return n?[].slice.call(n.querySelectorAll(r)):[]}function ey(t){return t.reduce((e,r)=>{const n=r.getAttribute("xml:id");return n&&(e[n]=r),e},{})}function sw(t,e){return[].slice.call(t.childNodes).reduce((r,n,i)=>{var s;return n.nodeName==="br"&&i?r+`
`:(s=n.childNodes)!=null&&s.length?sw(n,e):e?r+n.textContent.trim().replace(/\s+/g," "):r+n.textContent},"")}function HM(t,e,r){const n="http://www.w3.org/ns/ttml#styling";let i=null;const s=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],a=t!=null&&t.hasAttribute("style")?t.getAttribute("style"):null;return a&&r.hasOwnProperty(a)&&(i=r[a]),s.reduce((o,l)=>{const u=Nf(e,n,l)||Nf(t,n,l)||Nf(i,n,l);return u&&(o[l]=u),o},{})}function Nf(t,e,r){return t&&t.hasAttributeNS(e,r)?t.getAttributeNS(e,r):null}function ty(t){return new Error(`Could not parse ttml timestamp ${t}`)}function Ff(t,e){if(!t)return null;let r=ew(t);return r===null&&(nw.test(t)?r=WM(t,e):iw.test(t)&&(r=KM(t,e))),r}function WM(t,e){const r=nw.exec(t),n=(r[4]|0)+(r[5]|0)/e.subFrameRate;return(r[1]|0)*3600+(r[2]|0)*60+(r[3]|0)+n/e.frameRate}function KM(t,e){const r=iw.exec(t),n=Number(r[1]);switch(r[2]){case"h":return n*3600;case"m":return n*60;case"ms":return n*1e3;case"f":return n/e.frameRate;case"t":return n/e.tickRate}return n}class YM{constructor(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=ny(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(w.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(w.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(w.MANIFEST_LOADING,this.onManifestLoading,this),e.on(w.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(w.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(w.FRAG_LOADING,this.onFragLoading,this),e.on(w.FRAG_LOADED,this.onFragLoaded,this),e.on(w.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(w.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(w.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(w.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(w.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(w.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(w.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(w.MANIFEST_LOADING,this.onManifestLoading,this),e.off(w.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(w.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(w.FRAG_LOADING,this.onFragLoading,this),e.off(w.FRAG_LOADED,this.onFragLoaded,this),e.off(w.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(w.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(w.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(w.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(w.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){if(this.config.enableCEA708Captions&&(!this.cea608Parser1||!this.cea608Parser2)){const e=new lu(this,"textTrack1"),r=new lu(this,"textTrack2"),n=new lu(this,"textTrack3"),i=new lu(this,"textTrack4");this.cea608Parser1=new Qv(1,e,r),this.cea608Parser2=new Qv(3,n,i)}}addCues(e,r,n,i,s){let a=!1;for(let o=s.length;o--;){const l=s[o],u=qM(l[0],l[1],r,n);if(u>=0&&(l[0]=Math.min(l[0],r),l[1]=Math.max(l[1],n),a=!0,u/(n-r)>.5))return}if(a||s.push([r,n]),this.config.renderTextTracksNatively){const o=this.captionsTracks[e];this.Cues.newCue(o,r,n,i)}else{const o=this.Cues.newCue(null,r,n,i);this.hls.trigger(w.CUES_PARSED,{type:"captions",cues:o,track:e})}}onInitPtsFound(e,{frag:r,id:n,initPTS:i,timescale:s}){const{unparsedVttFrags:a}=this;n==="main"&&(this.initPTS[r.cc]={baseTime:i,timescale:s}),a.length&&(this.unparsedVttFrags=[],a.forEach(o=>{this.onFragLoaded(w.FRAG_LOADED,o)}))}getExistingTrack(e,r){const{media:n}=this;if(n)for(let i=0;i<n.textTracks.length;i++){const s=n.textTracks[i];if(ry(s,{name:e,lang:r,attrs:{}}))return s}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:r,captionsTracks:n,media:i}=this,{label:s,languageCode:a}=r[e],o=this.getExistingTrack(s,a);if(o)n[e]=o,ta(n[e]),LT(n[e],i);else{const l=this.createTextTrack("captions",s,a);l&&(l[e]=!0,n[e]=l)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const r=this.captionsProperties[e];if(!r)return;const n=r.label,i={_id:e,label:n,kind:"captions",default:r.media?!!r.media.default:!1,closedCaptions:r.media};this.nonNativeCaptionsTracks[e]=i,this.hls.trigger(w.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[i]})}createTextTrack(e,r,n){const i=this.media;if(i)return i.addTextTrack(e,r,n)}onMediaAttaching(e,r){this.media=r.media,this._cleanTracks()}onMediaDetaching(){const{captionsTracks:e}=this;Object.keys(e).forEach(r=>{ta(e[r]),delete e[r]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=ny(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const r=e.textTracks;if(r)for(let n=0;n<r.length;n++)ta(r[n])}onSubtitleTracksUpdated(e,r){const n=r.subtitleTracks||[],i=n.some(s=>s.textCodec===Of);if(this.config.enableWebVTT||i&&this.config.enableIMSC1){if(ZT(this.tracks,n)){this.tracks=n;return}if(this.textTracks=[],this.tracks=n,this.config.renderTextTracksNatively){const a=this.media,o=a?Pu(a.textTracks):null;if(this.tracks.forEach((l,u)=>{let c;if(o){let d=null;for(let f=0;f<o.length;f++)if(o[f]&&ry(o[f],l)){d=o[f],o[f]=null;break}d&&(c=d)}if(c)ta(c);else{const d=aw(l);c=this.createTextTrack(d,l.name,l.lang),c&&(c.mode="disabled")}c&&this.textTracks.push(c)}),o!=null&&o.length){const l=o.filter(u=>u!==null).map(u=>u.label);l.length&&U.warn(`Media element contains unused subtitle tracks: ${l.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const a=this.tracks.map(o=>({label:o.name,kind:o.type.toLowerCase(),default:o.default,subtitleTrack:o}));this.hls.trigger(w.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:a})}}}onManifestLoaded(e,r){this.config.enableCEA708Captions&&r.captions&&r.captions.forEach(n=>{const i=/(?:CC|SERVICE)([1-4])/.exec(n.instreamId);if(!i)return;const s=`textTrack${i[1]}`,a=this.captionsProperties[s];a&&(a.label=n.name,n.lang&&(a.languageCode=n.lang),a.media=n)})}closedCaptionsForLevel(e){const r=this.hls.levels[e.level];return r==null?void 0:r.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,r){if(this.enabled&&r.frag.type===we.MAIN){var n,i;const{cea608Parser1:s,cea608Parser2:a,lastSn:o}=this,{cc:l,sn:u}=r.frag,c=(n=(i=r.part)==null?void 0:i.index)!=null?n:-1;s&&a&&(u!==o+1||u===o&&c!==this.lastPartIndex+1||l!==this.lastCc)&&(s.reset(),a.reset()),this.lastCc=l,this.lastSn=u,this.lastPartIndex=c}}onFragLoaded(e,r){const{frag:n,payload:i}=r;if(n.type===we.SUBTITLE)if(i.byteLength){const s=n.decryptdata,a="stats"in r;if(s==null||!s.encrypted||a){const o=this.tracks[n.level],l=this.vttCCs;l[n.cc]||(l[n.cc]={start:n.start,prevCC:this.prevCC,new:!0},this.prevCC=n.cc),o&&o.textCodec===Of?this._parseIMSC1(n,i):this._parseVTTs(r)}}else this.hls.trigger(w.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,r){const n=this.hls;Jv(r,this.initPTS[e.cc],i=>{this._appendCues(i,e.level),n.trigger(w.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},i=>{U.log(`Failed to parse IMSC1: ${i}`),n.trigger(w.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:i})})}_parseVTTs(e){var r;const{frag:n,payload:i}=e,{initPTS:s,unparsedVttFrags:a}=this,o=s.length-1;if(!s[n.cc]&&o===-1){a.push(e);return}const l=this.hls,u=(r=n.initSegment)!=null&&r.data?Jr(n.initSegment.data,new Uint8Array(i)):i;VM(u,this.initPTS[n.cc],this.vttCCs,n.cc,n.start,c=>{this._appendCues(c,n.level),l.trigger(w.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:n})},c=>{const d=c.message==="Missing initPTS for VTT MPEGTS";d?a.push(e):this._fallbackToIMSC1(n,i),U.log(`Failed to parse VTT cue: ${c}`),!(d&&o>n.cc)&&l.trigger(w.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:c})})}_fallbackToIMSC1(e,r){const n=this.tracks[e.level];n.textCodec||Jv(r,this.initPTS[e.cc],()=>{n.textCodec=Of,this._parseIMSC1(e,r)},()=>{n.textCodec="wvtt"})}_appendCues(e,r){const n=this.hls;if(this.config.renderTextTracksNatively){const i=this.textTracks[r];if(!i||i.mode==="disabled")return;e.forEach(s=>AT(i,s))}else{const i=this.tracks[r];if(!i)return;const s=i.default?"default":"subtitles"+r;n.trigger(w.CUES_PARSED,{type:"subtitles",cues:e,track:s})}}onFragDecrypted(e,r){const{frag:n}=r;n.type===we.SUBTITLE&&this.onFragLoaded(w.FRAG_LOADED,r)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,r){this.initCea608Parsers();const{cea608Parser1:n,cea608Parser2:i}=this;if(!this.enabled||!n||!i)return;const{frag:s,samples:a}=r;if(!(s.type===we.MAIN&&this.closedCaptionsForLevel(s)==="NONE"))for(let o=0;o<a.length;o++){const l=a[o].bytes;if(l){const u=this.extractCea608Data(l);n.addData(a[o].pts,u[0]),i.addData(a[o].pts,u[1])}}}onBufferFlushing(e,{startOffset:r,endOffset:n,endOffsetSubtitles:i,type:s}){const{media:a}=this;if(!(!a||a.currentTime<n)){if(!s||s==="video"){const{captionsTracks:o}=this;Object.keys(o).forEach(l=>qh(o[l],r,n))}if(this.config.renderTextTracksNatively&&r===0&&i!==void 0){const{textTracks:o}=this;Object.keys(o).forEach(l=>qh(o[l],r,i))}}}extractCea608Data(e){const r=[[],[]],n=e[0]&31;let i=2;for(let s=0;s<n;s++){const a=e[i++],o=127&e[i++],l=127&e[i++];if(o===0&&l===0)continue;if((4&a)!==0){const c=3&a;(c===0||c===1)&&(r[c].push(o),r[c].push(l))}}return r}}function aw(t){return t.characteristics&&/transcribes-spoken-dialog/gi.test(t.characteristics)&&/describes-music-and-sound/gi.test(t.characteristics)?"captions":"subtitles"}function ry(t,e){return!!t&&t.kind===aw(e)&&tp(e,t)}function qM(t,e,r,n){return Math.min(e,n)-Math.max(t,r)}function ny(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}class jm{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(w.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(w.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(w.MANIFEST_PARSED,this.onManifestParsed,this),e.on(w.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(w.BUFFER_CODECS,this.onBufferCodecs,this),e.on(w.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(w.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(w.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(w.MANIFEST_PARSED,this.onManifestParsed,this),e.off(w.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(w.BUFFER_CODECS,this.onBufferCodecs,this),e.off(w.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,r){const n=this.hls.levels[r.droppedLevel];this.isLevelAllowed(n)&&this.restrictedLevels.push({bitrate:n.bitrate,height:n.height,width:n.width})}onMediaAttaching(e,r){this.media=r.media instanceof HTMLVideoElement?r.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(e,r){const n=this.hls;this.restrictedLevels=[],this.firstLevel=r.firstLevel,n.config.capLevelToPlayerSize&&r.video&&this.startCapping()}onLevelsUpdated(e,r){this.timer&&pe(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(e,r){this.hls.config.capLevelToPlayerSize&&r.video&&this.startCapping()}onMediaDetaching(){this.stopCapping()}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}const e=this.hls.levels;if(e.length){const r=this.hls,n=this.getMaxLevel(e.length-1);n!==this.autoLevelCapping&&U.log(`Setting autoLevelCapping to ${n}: ${e[n].height}p@${e[n].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),r.autoLevelCapping=n,r.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=r.autoLevelCapping}}}getMaxLevel(e){const r=this.hls.levels;if(!r.length)return-1;const n=r.filter((i,s)=>this.isLevelAllowed(i)&&s<=e);return this.clientRect=null,jm.getMaxLevelByMediaSize(n,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,r={width:0,height:0};if(e){const n=e.getBoundingClientRect();r.width=n.width,r.height=n.height,!r.width&&!r.height&&(r.width=n.right-n.left||e.width||0,r.height=n.bottom-n.top||e.height||0)}return this.clientRect=r,r}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch{}return e}isLevelAllowed(e){return!this.restrictedLevels.some(n=>e.bitrate===n.bitrate&&e.width===n.width&&e.height===n.height)}static getMaxLevelByMediaSize(e,r,n){if(!(e!=null&&e.length))return-1;const i=(o,l)=>l?o.width!==l.width||o.height!==l.height:!0;let s=e.length-1;const a=Math.max(r,n);for(let o=0;o<e.length;o+=1){const l=e[o];if((l.width>=a||l.height>=a)&&i(l,e[o+1])){s=o;break}}return s}}class XM{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(w.MEDIA_ATTACHING,this.onMediaAttaching,this)}unregisterListeners(){this.hls.off(w.MEDIA_ATTACHING,this.onMediaAttaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,r){const n=this.hls.config;if(n.capLevelOnFPSDrop){const i=r.media instanceof self.HTMLVideoElement?r.media:null;this.media=i,i&&typeof i.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),n.fpsDroppedMonitoringPeriod)}}checkFPS(e,r,n){const i=performance.now();if(r){if(this.lastTime){const s=i-this.lastTime,a=n-this.lastDroppedFrames,o=r-this.lastDecodedFrames,l=1e3*a/s,u=this.hls;if(u.trigger(w.FPS_DROP,{currentDropped:a,currentDecoded:o,totalDroppedFrames:n}),l>0&&a>u.config.fpsDroppedMonitoringThreshold*o){let c=u.currentLevel;U.warn("drop FPS ratio greater than max allowed value for currentLevel: "+c),c>0&&(u.autoLevelCapping===-1||u.autoLevelCapping>=c)&&(c=c-1,u.trigger(w.FPS_DROP_LEVEL_CAPPING,{level:c,droppedLevel:u.currentLevel}),u.autoLevelCapping=c,this.streamController.nextLevelSwitch())}}this.lastTime=i,this.lastDroppedFrames=n,this.lastDecodedFrames=r}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const r=e.getVideoPlaybackQuality();this.checkFPS(e,r.totalVideoFrames,r.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}const cu="[eme]";class fa{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=fa.CDMCleanupPromise?[fa.CDMCleanupPromise]:[],this.onMediaEncrypted=this._onMediaEncrypted.bind(this),this.onWaitingForKey=this._onWaitingForKey.bind(this),this.debug=U.debug.bind(U,cu),this.log=U.log.bind(U,cu),this.warn=U.warn.bind(U,cu),this.error=U.error.bind(U,cu),this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.unregisterListeners(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.onMediaEncrypted=this.onWaitingForKey=this.keyIdToKeySessionPromise=null,this.config=null}registerListeners(){this.hls.on(w.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(w.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(w.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(w.MANIFEST_LOADED,this.onManifestLoaded,this)}unregisterListeners(){this.hls.off(w.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(w.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(w.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(w.MANIFEST_LOADED,this.onManifestLoaded,this)}getLicenseServerUrl(e){const{drmSystems:r,widevineLicenseUrl:n}=this.config,i=r[e];if(i)return i.licenseUrl;if(e===ot.WIDEVINE&&n)return n;throw new Error(`no license server URL configured for key-system "${e}"`)}getServerCertificateUrl(e){const{drmSystems:r}=this.config,n=r[e];if(n)return n.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const r=this.hls.levels,n=(a,o,l)=>!!a&&l.indexOf(a)===o,i=r.map(a=>a.audioCodec).filter(n),s=r.map(a=>a.videoCodec).filter(n);return i.length+s.length===0&&s.push("avc1.42e01e"),new Promise((a,o)=>{const l=u=>{const c=u.shift();this.getMediaKeysPromise(c,i,s).then(d=>a({keySystem:c,mediaKeys:d})).catch(d=>{u.length?l(u):d instanceof zr?o(d):o(new zr({type:_e.KEY_SYSTEM_ERROR,details:z.KEY_SYSTEM_NO_ACCESS,error:d,fatal:!0},d.message))})};l(e)})}requestMediaKeySystemAccess(e,r){const{requestMediaKeySystemAccessFunc:n}=this.config;if(typeof n!="function"){let i=`Configured requestMediaKeySystemAccess is not a function ${n}`;return fT===null&&self.location.protocol==="http:"&&(i=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(i))}return n(e,r)}getMediaKeysPromise(e,r,n){const i=rP(e,r,n,this.config.drmSystemOptions),s=this.keySystemAccessPromises[e];let a=s==null?void 0:s.keySystemAccess;if(!a){this.log(`Requesting encrypted media "${e}" key-system access with config: ${JSON.stringify(i)}`),a=this.requestMediaKeySystemAccess(e,i);const o=this.keySystemAccessPromises[e]={keySystemAccess:a};return a.catch(l=>{this.log(`Failed to obtain access to key-system "${e}": ${l}`)}),a.then(l=>{this.log(`Access for key-system "${l.keySystem}" obtained`);const u=this.fetchServerCertificate(e);return this.log(`Create media-keys for "${e}"`),o.mediaKeys=l.createMediaKeys().then(c=>(this.log(`Media-keys created for "${e}"`),u.then(d=>d?this.setMediaKeysServerCertificate(c,e,d):c))),o.mediaKeys.catch(c=>{this.error(`Failed to create media-keys for "${e}"}: ${c}`)}),o.mediaKeys})}return a.then(()=>s.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:r,mediaKeys:n}){this.log(`Creating key-system session "${r}" keyId: ${bn.hexDump(e.keyId||[])}`);const i=n.createSession(),s={decryptdata:e,keySystem:r,mediaKeys:n,mediaKeysSession:i,keyStatus:"status-pending"};return this.mediaKeySessions.push(s),s}renewKeySession(e){const r=e.decryptdata;if(r.pssh){const n=this.createMediaKeySessionContext(e),i=this.getKeyIdString(r),s="cenc";this.keyIdToKeySessionPromise[i]=this.generateRequestWithPreferredKeySession(n,s,r.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}getKeyIdString(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(e.keyId===null)throw new Error("keyId is null");return bn.hexDump(e.keyId)}updateKeySession(e,r){var n;const i=e.mediaKeysSession;return this.log(`Updating key-session "${i.sessionId}" for keyID ${bn.hexDump(((n=e.decryptdata)==null?void 0:n.keyId)||[])}
      } (data length: ${r&&r.byteLength})`),i.update(r)}selectKeySystemFormat(e){const r=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${r.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(r)),this.keyFormatPromise}getKeyFormatPromise(e){return new Promise((r,n)=>{const i=xf(this.config),s=e.map(uv).filter(a=>!!a&&i.indexOf(a)!==-1);return this.getKeySystemSelectionPromise(s).then(({keySystem:a})=>{const o=dv(a);o?r(o):n(new Error(`Unable to find format for key-system "${a}"`))}).catch(n)})}loadKey(e){const r=e.keyInfo.decryptdata,n=this.getKeyIdString(r),i=`(keyId: ${n} format: "${r.keyFormat}" method: ${r.method} uri: ${r.uri})`;this.log(`Starting session for key ${i}`);let s=this.keyIdToKeySessionPromise[n];return s||(s=this.keyIdToKeySessionPromise[n]=this.getKeySystemForKeyPromise(r).then(({keySystem:a,mediaKeys:o})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${i}`),this.attemptSetMediaKeys(a,o).then(()=>{this.throwIfDestroyed();const l=this.createMediaKeySessionContext({keySystem:a,mediaKeys:o,decryptdata:r});return this.generateRequestWithPreferredKeySession(l,"cenc",r.pssh,"playlist-key")}))),s.catch(a=>this.handleError(a))),s}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e){this.hls&&(this.error(e.message),e instanceof zr?this.hls.trigger(w.ERROR,e.data):this.hls.trigger(w.ERROR,{type:_e.KEY_SYSTEM_ERROR,details:z.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0}))}getKeySystemForKeyPromise(e){const r=this.getKeyIdString(e),n=this.keyIdToKeySessionPromise[r];if(!n){const i=uv(e.keyFormat),s=i?[i]:xf(this.config);return this.attemptKeySystemAccess(s)}return n}getKeySystemSelectionPromise(e){if(e.length||(e=xf(this.config)),e.length===0)throw new zr({type:_e.KEY_SYSTEM_ERROR,details:z.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${JSON.stringify({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}_onMediaEncrypted(e){const{initDataType:r,initData:n}=e,i=`"${e.type}" event: init data type: "${r}"`;if(this.debug(i),n===null)return;let s,a;if(r==="sinf"&&this.config.drmSystems[ot.FAIRPLAY]){const d=Dt(new Uint8Array(n));try{const f=Am(JSON.parse(d).sinf),m=ST(new Uint8Array(f));if(!m)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");s=m.subarray(8,24),a=ot.FAIRPLAY}catch(f){this.warn(`${i} Failed to parse sinf: ${f}`);return}}else{const d=_P(n),f=d.filter(m=>m.systemId===ho.WIDEVINE)[0];if(!f){d.length===0||d.some(m=>!m.systemId)?this.warn(`${i} contains incomplete or invalid pssh data`):this.log(`ignoring ${i} for ${d.map(m=>cv(m.systemId)).join(",")} pssh data in favor of playlist keys`);return}if(a=cv(f.systemId),f.version===0&&f.data){const m=f.data.length-22;s=f.data.subarray(m,m+16)}}if(!a||!s)return;const o=bn.hexDump(s),{keyIdToKeySessionPromise:l,mediaKeySessions:u}=this;let c=l[o];for(let d=0;d<u.length;d++){const f=u[d],m=f.decryptdata;if(!m.keyId)continue;const h=bn.hexDump(m.keyId);if(o===h||m.uri.replace(/-/g,"").indexOf(o)!==-1){if(c=l[h],m.pssh)break;delete l[h],m.pssh=new Uint8Array(n),m.keyId=s,c=l[o]=c.then(()=>this.generateRequestWithPreferredKeySession(f,r,n,"encrypted-event-key-match"));break}}c||(c=l[o]=this.getKeySystemSelectionPromise([a]).then(({keySystem:d,mediaKeys:f})=>{var m;this.throwIfDestroyed();const h=new hl("ISO-23001-7",o,(m=dv(d))!=null?m:"");return h.pssh=new Uint8Array(n),h.keyId=s,this.attemptSetMediaKeys(d,f).then(()=>{this.throwIfDestroyed();const p=this.createMediaKeySessionContext({decryptdata:h,keySystem:d,mediaKeys:f});return this.generateRequestWithPreferredKeySession(p,r,n,"encrypted-event-no-match")})})),c.catch(d=>this.handleError(d))}_onWaitingForKey(e){this.log(`"${e.type}" event`)}attemptSetMediaKeys(e,r){const n=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const i=Promise.all(n).then(()=>{if(!this.media)throw new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(r)});return this.setMediaKeysQueue.push(i),i.then(()=>{this.log(`Media-keys set for "${e}"`),n.push(i),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(s=>n.indexOf(s)===-1)})}generateRequestWithPreferredKeySession(e,r,n,i){var s,a;const o=(s=this.config.drmSystems)==null||(a=s[e.keySystem])==null?void 0:a.generateRequest;if(o)try{const h=o.call(this.hls,r,n,e);if(!h)throw new Error("Invalid response from configured generateRequest filter");r=h.initDataType,n=e.decryptdata.pssh=h.initData?new Uint8Array(h.initData):null}catch(h){var l;if(this.warn(h.message),(l=this.hls)!=null&&l.config.debug)throw h}if(n===null)return this.log(`Skipping key-session request for "${i}" (no initData)`),Promise.resolve(e);const u=this.getKeyIdString(e.decryptdata);this.log(`Generating key-session request for "${i}": ${u} (init data type: ${r} length: ${n?n.byteLength:null})`);const c=new Um,d=e._onmessage=h=>{const p=e.mediaKeysSession;if(!p){c.emit("error",new Error("invalid state"));return}const{messageType:v,message:g}=h;this.log(`"${v}" message event for session "${p.sessionId}" message size: ${g.byteLength}`),v==="license-request"||v==="license-renewal"?this.renewLicense(e,g).catch(y=>{this.handleError(y),c.emit("error",y)}):v==="license-release"?e.keySystem===ot.FAIRPLAY&&(this.updateKeySession(e,Kh("acknowledged")),this.removeSession(e)):this.warn(`unhandled media key message type "${v}"`)},f=e._onkeystatuseschange=h=>{if(!e.mediaKeysSession){c.emit("error",new Error("invalid state"));return}this.onKeyStatusChange(e);const v=e.keyStatus;c.emit("keyStatus",v),v==="expired"&&(this.warn(`${e.keySystem} expired for key ${u}`),this.renewKeySession(e))};e.mediaKeysSession.addEventListener("message",d),e.mediaKeysSession.addEventListener("keystatuseschange",f);const m=new Promise((h,p)=>{c.on("error",p),c.on("keyStatus",v=>{v.startsWith("usable")?h():v==="output-restricted"?p(new zr({type:_e.KEY_SYSTEM_ERROR,details:z.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):v==="internal-error"?p(new zr({type:_e.KEY_SYSTEM_ERROR,details:z.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${v}"`)):v==="expired"?p(new Error("key expired while generating request")):this.warn(`unhandled key status change "${v}"`)})});return e.mediaKeysSession.generateRequest(r,n).then(()=>{var h;this.log(`Request generated for key-session "${(h=e.mediaKeysSession)==null?void 0:h.sessionId}" keyId: ${u}`)}).catch(h=>{throw new zr({type:_e.KEY_SYSTEM_ERROR,details:z.KEY_SYSTEM_NO_SESSION,error:h,fatal:!1},`Error generating key-session request: ${h}`)}).then(()=>m).catch(h=>{throw c.removeAllListeners(),this.removeSession(e),h}).then(()=>(c.removeAllListeners(),e))}onKeyStatusChange(e){e.mediaKeysSession.keyStatuses.forEach((r,n)=>{this.log(`key status change "${r}" for keyStatuses keyId: ${bn.hexDump("buffer"in n?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n))} session keyId: ${bn.hexDump(new Uint8Array(e.decryptdata.keyId||[]))} uri: ${e.decryptdata.uri}`),e.keyStatus=r})}fetchServerCertificate(e){const r=this.config,n=r.loader,i=new n(r),s=this.getServerCertificateUrl(e);return s?(this.log(`Fetching server certificate for "${e}"`),new Promise((a,o)=>{const l={responseType:"arraybuffer",url:s},u=r.certLoadPolicy.default,c={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},d={onSuccess:(f,m,h,p)=>{a(f.data)},onError:(f,m,h,p)=>{o(new zr({type:_e.KEY_SYSTEM_ERROR,details:z.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:h,response:jt({url:l.url,data:void 0},f)},`"${e}" certificate request failed (${s}). Status: ${f.code} (${f.text})`))},onTimeout:(f,m,h)=>{o(new zr({type:_e.KEY_SYSTEM_ERROR,details:z.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:h,response:{url:l.url,data:void 0}},`"${e}" certificate request timed out (${s})`))},onAbort:(f,m,h)=>{o(new Error("aborted"))}};i.load(l,c,d)})):Promise.resolve()}setMediaKeysServerCertificate(e,r,n){return new Promise((i,s)=>{e.setServerCertificate(n).then(a=>{this.log(`setServerCertificate ${a?"success":"not supported by CDM"} (${n==null?void 0:n.byteLength}) on "${r}"`),i(e)}).catch(a=>{s(new zr({type:_e.KEY_SYSTEM_ERROR,details:z.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:a,fatal:!0},a.message))})})}renewLicense(e,r){return this.requestLicense(e,new Uint8Array(r)).then(n=>this.updateKeySession(e,new Uint8Array(n)).catch(i=>{throw new zr({type:_e.KEY_SYSTEM_ERROR,details:z.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:i,fatal:!0},i.message)}))}unpackPlayReadyKeyMessage(e,r){const n=String.fromCharCode.apply(null,new Uint16Array(r.buffer));if(!n.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),r;const i=new DOMParser().parseFromString(n,"application/xml"),s=i.querySelectorAll("HttpHeader");if(s.length>0){let c;for(let d=0,f=s.length;d<f;d++){var a,o;c=s[d];const m=(a=c.querySelector("name"))==null?void 0:a.textContent,h=(o=c.querySelector("value"))==null?void 0:o.textContent;m&&h&&e.setRequestHeader(m,h)}}const l=i.querySelector("Challenge"),u=l==null?void 0:l.textContent;if(!u)throw new Error("Cannot find <Challenge> in key message");return Kh(atob(u))}setupLicenseXHR(e,r,n,i){const s=this.config.licenseXhrSetup;return s?Promise.resolve().then(()=>{if(!n.decryptdata)throw new Error("Key removed");return s.call(this.hls,e,r,n,i)}).catch(a=>{if(!n.decryptdata)throw a;return e.open("POST",r,!0),s.call(this.hls,e,r,n,i)}).then(a=>(e.readyState||e.open("POST",r,!0),{xhr:e,licenseChallenge:a||i})):(e.open("POST",r,!0),Promise.resolve({xhr:e,licenseChallenge:i}))}requestLicense(e,r){const n=this.config.keyLoadPolicy.default;return new Promise((i,s)=>{const a=this.getLicenseServerUrl(e.keySystem);this.log(`Sending license request to URL: ${a}`);const o=new XMLHttpRequest;o.responseType="arraybuffer",o.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return s(new Error("invalid state"));if(o.readyState===4)if(o.status===200){this._requestLicenseFailureCount=0;let l=o.response;this.log(`License received ${l instanceof ArrayBuffer?l.byteLength:l}`);const u=this.config.licenseResponseCallback;if(u)try{l=u.call(this.hls,o,a,e)}catch(c){this.error(c)}i(l)}else{const l=n.errorRetry,u=l?l.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>u||o.status>=400&&o.status<500)s(new zr({type:_e.KEY_SYSTEM_ERROR,details:z.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:o,response:{url:a,data:void 0,code:o.status,text:o.statusText}},`License Request XHR failed (${a}). Status: ${o.status} (${o.statusText})`));else{const c=u-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${c} attempts left`),this.requestLicense(e,r).then(i,s)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=o,this.setupLicenseXHR(o,a,e,r).then(({xhr:l,licenseChallenge:u})=>{e.keySystem==ot.PLAYREADY&&(u=this.unpackPlayReadyKeyMessage(l,u)),l.send(u)})})}onMediaAttached(e,r){if(!this.config.emeEnabled)return;const n=r.media;this.media=n,n.addEventListener("encrypted",this.onMediaEncrypted),n.addEventListener("waitingforkey",this.onWaitingForKey)}onMediaDetached(){const e=this.media,r=this.mediaKeySessions;e&&(e.removeEventListener("encrypted",this.onMediaEncrypted),e.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},hl.clearKeyUriToKeyIdMap();const n=r.length;fa.CDMCleanupPromise=Promise.all(r.map(i=>this.removeSession(i)).concat(e==null?void 0:e.setMediaKeys(null).catch(i=>{this.log(`Could not clear media keys: ${i}`)}))).then(()=>{n&&(this.log("finished closing key sessions and clearing media keys"),r.length=0)}).catch(i=>{this.log(`Could not close sessions and clear media keys: ${i}`)})}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(e,{sessionKeys:r}){if(!(!r||!this.config.emeEnabled)&&!this.keyFormatPromise){const n=r.reduce((i,s)=>(i.indexOf(s.keyFormat)===-1&&i.push(s.keyFormat),i),[]);this.log(`Selecting key-system from session-keys ${n.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(n)}}removeSession(e){const{mediaKeysSession:r,licenseXhr:n}=e;if(r){this.log(`Remove licenses and keys and close session ${r.sessionId}`),e._onmessage&&(r.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(r.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),n&&n.readyState!==XMLHttpRequest.DONE&&n.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const i=this.mediaKeySessions.indexOf(e);return i>-1&&this.mediaKeySessions.splice(i,1),r.remove().catch(s=>{this.log(`Could not remove session: ${s}`)}).then(()=>r.close()).catch(s=>{this.log(`Could not close session: ${s}`)})}}}fa.CDMCleanupPromise=void 0;class zr extends Error{constructor(e,r){super(r),this.data=void 0,e.error||(e.error=new Error(r)),this.data=e,e.err=e.error}}var Xt;(function(t){t.MANIFEST="m",t.AUDIO="a",t.VIDEO="v",t.MUXED="av",t.INIT="i",t.CAPTION="c",t.TIMED_TEXT="tt",t.KEY="k",t.OTHER="o"})(Xt||(Xt={}));var np;(function(t){t.DASH="d",t.HLS="h",t.SMOOTH="s",t.OTHER="o"})(np||(np={}));var os;(function(t){t.OBJECT="CMCD-Object",t.REQUEST="CMCD-Request",t.SESSION="CMCD-Session",t.STATUS="CMCD-Status"})(os||(os={}));const ZM={[os.OBJECT]:["br","d","ot","tb"],[os.REQUEST]:["bl","dl","mtp","nor","nrr","su"],[os.SESSION]:["cid","pr","sf","sid","st","v"],[os.STATUS]:["bs","rtp"]};class Da{constructor(e,r){this.value=void 0,this.params=void 0,Array.isArray(e)&&(e=e.map(n=>n instanceof Da?n:new Da(n))),this.value=e,this.params=r}}class ow{constructor(e){this.description=void 0,this.description=e}}const QM="Dict";function JM(t){return Array.isArray(t)?JSON.stringify(t):t instanceof Map?"Map{}":t instanceof Set?"Set{}":typeof t=="object"?JSON.stringify(t):String(t)}function eN(t,e,r,n){return new Error(`failed to ${t} "${JM(e)}" as ${r}`,{cause:n})}const iy="Bare Item",tN="Boolean",rN="Byte Sequence",nN="Decimal",iN="Integer";function sN(t){return t<-999999999999999||999999999999999<t}const aN=/[\x00-\x1f\x7f]+/,oN="Token",lN="Key";function Bn(t,e,r){return eN("serialize",t,e,r)}function uN(t){if(typeof t!="boolean")throw Bn(t,tN);return t?"?1":"?0"}function cN(t){return btoa(String.fromCharCode(...t))}function dN(t){if(ArrayBuffer.isView(t)===!1)throw Bn(t,rN);return`:${cN(t)}:`}function lw(t){if(sN(t))throw Bn(t,iN);return t.toString()}function fN(t){return`@${lw(t.getTime()/1e3)}`}function uw(t,e){if(t<0)return-uw(-t,e);const r=Math.pow(10,e);if(Math.abs(t*r%1-.5)<Number.EPSILON){const i=Math.floor(t*r);return(i%2===0?i:i+1)/r}else return Math.round(t*r)/r}function hN(t){const e=uw(t,3);if(Math.floor(Math.abs(e)).toString().length>12)throw Bn(t,nN);const r=e.toString();return r.includes(".")?r:`${r}.0`}const pN="String";function mN(t){if(aN.test(t))throw Bn(t,pN);return`"${t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function gN(t){return t.description||t.toString().slice(7,-1)}function sy(t){const e=gN(t);if(/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(e)===!1)throw Bn(e,oN);return e}function ip(t){switch(typeof t){case"number":if(!pe(t))throw Bn(t,iy);return Number.isInteger(t)?lw(t):hN(t);case"string":return mN(t);case"symbol":return sy(t);case"boolean":return uN(t);case"object":if(t instanceof Date)return fN(t);if(t instanceof Uint8Array)return dN(t);if(t instanceof ow)return sy(t);default:throw Bn(t,iy)}}function sp(t){if(/^[a-z*][a-z0-9\-_.*]*$/.test(t)===!1)throw Bn(t,lN);return t}function Vm(t){return t==null?"":Object.entries(t).map(([e,r])=>r===!0?`;${sp(e)}`:`;${sp(e)}=${ip(r)}`).join("")}function cw(t){return t instanceof Da?`${ip(t.value)}${Vm(t.params)}`:ip(t)}function vN(t){return`(${t.value.map(cw).join(" ")})${Vm(t.params)}`}function yN(t,e={whitespace:!0}){if(typeof t!="object")throw Bn(t,QM);const r=t instanceof Map?t.entries():Object.entries(t),n=e!=null&&e.whitespace?" ":"";return Array.from(r).map(([i,s])=>{s instanceof Da||(s=new Da(s));let a=sp(i);return s.value===!0?a+=Vm(s.params):(a+="=",Array.isArray(s.value)?a+=vN(s):a+=cw(s)),a}).join(`,${n}`)}function xN(t,e){return yN(t,e)}const SN=t=>t==="ot"||t==="sf"||t==="st",EN=t=>typeof t=="number"?pe(t):t!=null&&t!==""&&t!==!1;function TN(t,e){const r=new URL(t),n=new URL(e);if(r.origin!==n.origin)return t;const i=r.pathname.split("/").slice(1),s=n.pathname.split("/").slice(1,-1);for(;i[0]===s[0];)i.shift(),s.shift();for(;s.length;)s.shift(),i.unshift("..");return i.join("/")}function wN(){try{return crypto.randomUUID()}catch{try{const e=URL.createObjectURL(new Blob),r=e.toString();return URL.revokeObjectURL(e),r.slice(r.lastIndexOf("/")+1)}catch{let r=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,i=>{const s=(r+Math.random()*16)%16|0;return r=Math.floor(r/16),(i=="x"?s:s&3|8).toString(16)})}}}const Bu=t=>Math.round(t),bN=(t,e)=>(e!=null&&e.baseUrl&&(t=TN(t,e.baseUrl)),encodeURIComponent(t)),du=t=>Bu(t/100)*100,LN={br:Bu,d:Bu,bl:du,dl:du,mtp:du,nor:bN,rtp:du,tb:Bu};function AN(t,e){const r={};if(t==null||typeof t!="object")return r;const n=Object.keys(t).sort(),i=It({},LN,e==null?void 0:e.formatters),s=e==null?void 0:e.filter;return n.forEach(a=>{if(s!=null&&s(a))return;let o=t[a];const l=i[a];l&&(o=l(o,e)),!(a==="v"&&o===1)&&(a=="pr"&&o===1||EN(o)&&(SN(a)&&typeof o=="string"&&(o=new ow(o)),r[a]=o))}),r}function dw(t,e={}){return t?xN(AN(t,e),It({whitespace:!1},e)):""}function _N(t,e={}){if(!t)return{};const r=Object.entries(t),n=Object.entries(ZM).concat(Object.entries((e==null?void 0:e.customHeaderMap)||{})),i=r.reduce((s,a)=>{var o,l;const[u,c]=a,d=((o=n.find(f=>f[1].includes(u)))==null?void 0:o[0])||os.REQUEST;return(l=s[d])!=null||(s[d]={}),s[d][u]=c,s},{});return Object.entries(i).reduce((s,[a,o])=>(s[a]=dw(o,e),s),{})}function CN(t,e,r){return It(t,_N(e,r))}const RN="CMCD";function IN(t,e={}){if(!t)return"";const r=dw(t,e);return`${RN}=${encodeURIComponent(r)}`}const ay=/CMCD=[^&#]+/;function kN(t,e,r){const n=IN(e,r);if(!n)return t;if(ay.test(t))return t.replace(ay,n);const i=t.includes("?")?"&":"?";return`${t}${i}${n}`}class DN{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=i=>{try{this.apply(i,{ot:Xt.MANIFEST,su:!this.initialized})}catch(s){U.warn("Could not generate manifest CMCD data.",s)}},this.applyFragmentData=i=>{try{const s=i.frag,a=this.hls.levels[s.level],o=this.getObjectType(s),l={d:s.duration*1e3,ot:o};(o===Xt.VIDEO||o===Xt.AUDIO||o==Xt.MUXED)&&(l.br=a.bitrate/1e3,l.tb=this.getTopBandwidth(o)/1e3,l.bl=this.getBufferLength(o)),this.apply(i,l)}catch(s){U.warn("Could not generate segment CMCD data.",s)}},this.hls=e;const r=this.config=e.config,{cmcd:n}=r;n!=null&&(r.pLoader=this.createPlaylistLoader(),r.fLoader=this.createFragmentLoader(),this.sid=n.sessionId||wN(),this.cid=n.contentId,this.useHeaders=n.useHeaders===!0,this.includeKeys=n.includeKeys,this.registerListeners())}registerListeners(){const e=this.hls;e.on(w.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(w.MEDIA_DETACHED,this.onMediaDetached,this),e.on(w.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(w.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(w.MEDIA_DETACHED,this.onMediaDetached,this),e.off(w.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=null}onMediaAttached(e,r){this.media=r.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,r){var n,i;this.audioBuffer=(n=r.tracks.audio)==null?void 0:n.buffer,this.videoBuffer=(i=r.tracks.video)==null?void 0:i.buffer}createData(){var e;return{v:1,sf:np.HLS,sid:this.sid,cid:this.cid,pr:(e=this.media)==null?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,r={}){It(r,this.createData());const n=r.ot===Xt.INIT||r.ot===Xt.VIDEO||r.ot===Xt.MUXED;this.starved&&n&&(r.bs=!0,r.su=!0,this.starved=!1),r.su==null&&(r.su=this.buffering);const{includeKeys:i}=this;i&&(r=Object.keys(r).reduce((s,a)=>(i.includes(a)&&(s[a]=r[a]),s),{})),this.useHeaders?(e.headers||(e.headers={}),CN(e.headers,r)):e.url=kN(e.url,r)}getObjectType(e){const{type:r}=e;if(r==="subtitle")return Xt.TIMED_TEXT;if(e.sn==="initSegment")return Xt.INIT;if(r==="audio")return Xt.AUDIO;if(r==="main")return this.hls.audioTracks.length?Xt.VIDEO:Xt.MUXED}getTopBandwidth(e){let r=0,n;const i=this.hls;if(e===Xt.AUDIO)n=i.audioTracks;else{const s=i.maxAutoLevel,a=s>-1?s+1:i.levels.length;n=i.levels.slice(0,a)}for(const s of n)s.bitrate>r&&(r=s.bitrate);return r>0?r:NaN}getBufferLength(e){const r=this.hls.media,n=e===Xt.AUDIO?this.audioBuffer:this.videoBuffer;return!n||!r?NaN:at.bufferInfo(n,r.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:e}=this.config,r=this.applyPlaylistData,n=e||this.config.loader;return class{constructor(s){this.loader=void 0,this.loader=new n(s)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(s,a,o){r(s),this.loader.load(s,a,o)}}}createFragmentLoader(){const{fLoader:e}=this.config,r=this.applyFragmentData,n=e||this.config.loader;return class{constructor(s){this.loader=void 0,this.loader=new n(s)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(s,a,o){r(s),this.loader.load(s,a,o)}}}}const PN=3e5;class ON{constructor(e){this.hls=void 0,this.log=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this.pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.log=U.log.bind(U,"[content-steering]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(w.MANIFEST_LOADING,this.onManifestLoading,this),e.on(w.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(w.MANIFEST_PARSED,this.onManifestParsed,this),e.on(w.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(w.MANIFEST_LOADING,this.onManifestLoading,this),e.off(w.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(w.MANIFEST_PARSED,this.onManifestParsed,this),e.off(w.ERROR,this.onError,this))}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const e=this.timeToLoad*1e3-(performance.now()-this.updated);if(e>0){this.scheduleRefresh(this.uri,e);return}}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){this.reloadTimer!==-1&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const r=this.levels;r&&(this.levels=r.filter(n=>n!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,r){const{contentSteering:n}=r;n!==null&&(this.pathwayId=n.pathwayId,this.uri=n.uri,this.started&&this.startLoad())}onManifestParsed(e,r){this.audioTracks=r.audioTracks,this.subtitleTracks=r.subtitleTracks}onError(e,r){const{errorAction:n}=r;if((n==null?void 0:n.action)===zt.SendAlternateToPenaltyBox&&n.flags===sn.MoveAllAlternatesMatchingHost){const i=this.levels;let s=this.pathwayPriority,a=this.pathwayId;if(r.context){const{groupId:o,pathwayId:l,type:u}=r.context;o&&i?a=this.getPathwayForGroupId(o,u,a):l&&(a=l)}a in this.penalizedPathways||(this.penalizedPathways[a]=performance.now()),!s&&i&&(s=i.reduce((o,l)=>(o.indexOf(l.pathwayId)===-1&&o.push(l.pathwayId),o),[])),s&&s.length>1&&(this.updatePathwayPriority(s),n.resolved=this.pathwayId!==a),n.resolved||U.warn(`Could not resolve ${r.details} ("${r.error.message}") with content-steering for Pathway: ${a} levels: ${i&&i.length} priorities: ${JSON.stringify(s)} penalized: ${JSON.stringify(this.penalizedPathways)}`)}}filterParsedLevels(e){this.levels=e;let r=this.getLevelsForPathway(this.pathwayId);if(r.length===0){const n=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${n}"`),r=this.getLevelsForPathway(n),this.pathwayId=n}return r.length!==e.length?(this.log(`Found ${r.length}/${e.length} levels in Pathway "${this.pathwayId}"`),r):e}getLevelsForPathway(e){return this.levels===null?[]:this.levels.filter(r=>e===r.pathwayId)}updatePathwayPriority(e){this.pathwayPriority=e;let r;const n=this.penalizedPathways,i=performance.now();Object.keys(n).forEach(s=>{i-n[s]>PN&&delete n[s]});for(let s=0;s<e.length;s++){const a=e[s];if(a in n)continue;if(a===this.pathwayId)return;const o=this.hls.nextLoadLevel,l=this.hls.levels[o];if(r=this.getLevelsForPathway(a),r.length>0){this.log(`Setting Pathway to "${a}"`),this.pathwayId=a,IT(r),this.hls.trigger(w.LEVELS_UPDATED,{levels:r});const u=this.hls.levels[o];l&&u&&this.levels&&(u.attrs["STABLE-VARIANT-ID"]!==l.attrs["STABLE-VARIANT-ID"]&&u.bitrate!==l.bitrate&&this.log(`Unstable Pathways change from bitrate ${l.bitrate} to ${u.bitrate}`),this.hls.nextLoadLevel=o);break}}}getPathwayForGroupId(e,r,n){const i=this.getLevelsForPathway(n).concat(this.levels||[]);for(let s=0;s<i.length;s++)if(r===He.AUDIO_TRACK&&i[s].hasAudioGroup(e)||r===He.SUBTITLE_TRACK&&i[s].hasSubtitleGroup(e))return i[s].pathwayId;return n}clonePathways(e){const r=this.levels;if(!r)return;const n={},i={};e.forEach(s=>{const{ID:a,"BASE-ID":o,"URI-REPLACEMENT":l}=s;if(r.some(c=>c.pathwayId===a))return;const u=this.getLevelsForPathway(o).map(c=>{const d=new gt(c.attrs);d["PATHWAY-ID"]=a;const f=d.AUDIO&&`${d.AUDIO}_clone_${a}`,m=d.SUBTITLES&&`${d.SUBTITLES}_clone_${a}`;f&&(n[d.AUDIO]=f,d.AUDIO=f),m&&(i[d.SUBTITLES]=m,d.SUBTITLES=m);const h=fw(c.uri,d["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",l),p=new Ia({attrs:d,audioCodec:c.audioCodec,bitrate:c.bitrate,height:c.height,name:c.name,url:h,videoCodec:c.videoCodec,width:c.width});if(c.audioGroups)for(let v=1;v<c.audioGroups.length;v++)p.addGroupId("audio",`${c.audioGroups[v]}_clone_${a}`);if(c.subtitleGroups)for(let v=1;v<c.subtitleGroups.length;v++)p.addGroupId("text",`${c.subtitleGroups[v]}_clone_${a}`);return p});r.push(...u),oy(this.audioTracks,n,l,a),oy(this.subtitleTracks,i,l,a)})}loadSteeringManifest(e){const r=this.hls.config,n=r.loader;this.loader&&this.loader.destroy(),this.loader=new n(r);let i;try{i=new self.URL(e)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${e}`);return}if(i.protocol!=="data:"){const c=(this.hls.bandwidthEstimate||r.abrEwmaDefaultEstimate)|0;i.searchParams.set("_HLS_pathway",this.pathwayId),i.searchParams.set("_HLS_throughput",""+c)}const s={responseType:"json",url:i.href},a=r.steeringManifestLoadPolicy.default,o=a.errorRetry||a.timeoutRetry||{},l={loadPolicy:a,timeout:a.maxLoadTimeMs,maxRetry:o.maxNumRetry||0,retryDelay:o.retryDelayMs||0,maxRetryDelay:o.maxRetryDelayMs||0},u={onSuccess:(c,d,f,m)=>{this.log(`Loaded steering manifest: "${i}"`);const h=c.data;if(h.VERSION!==1){this.log(`Steering VERSION ${h.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=h.TTL;const{"RELOAD-URI":p,"PATHWAY-CLONES":v,"PATHWAY-PRIORITY":g}=h;if(p)try{this.uri=new self.URL(p,i).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${p}`);return}this.scheduleRefresh(this.uri||f.url),v&&this.clonePathways(v);const y={steeringManifest:h,url:i.toString()};this.hls.trigger(w.STEERING_MANIFEST_LOADED,y),g&&this.updatePathwayPriority(g)},onError:(c,d,f,m)=>{if(this.log(`Error loading steering manifest: ${c.code} ${c.text} (${d.url})`),this.stopLoad(),c.code===410){this.enabled=!1,this.log(`Steering manifest ${d.url} no longer available`);return}let h=this.timeToLoad*1e3;if(c.code===429){const p=this.loader;if(typeof(p==null?void 0:p.getResponseHeader)=="function"){const v=p.getResponseHeader("Retry-After");v&&(h=parseFloat(v)*1e3)}this.log(`Steering manifest ${d.url} rate limited`);return}this.scheduleRefresh(this.uri||d.url,h)},onTimeout:(c,d,f)=>{this.log(`Timeout loading steering manifest (${d.url})`),this.scheduleRefresh(this.uri||d.url)}};this.log(`Requesting steering manifest: ${i}`),this.loader.load(s,l,u)}scheduleRefresh(e,r=this.timeToLoad*1e3){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var n;const i=(n=this.hls)==null?void 0:n.media;if(i&&!i.ended){this.loadSteeringManifest(e);return}this.scheduleRefresh(e,this.timeToLoad*1e3)},r)}}function oy(t,e,r,n){t&&Object.keys(e).forEach(i=>{const s=t.filter(a=>a.groupId===i).map(a=>{const o=It({},a);return o.details=void 0,o.attrs=new gt(o.attrs),o.url=o.attrs.URI=fw(a.url,a.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",r),o.groupId=o.attrs["GROUP-ID"]=e[i],o.attrs["PATHWAY-ID"]=n,o});t.push(...s)})}function fw(t,e,r,n){const{HOST:i,PARAMS:s,[r]:a}=n;let o;e&&(o=a==null?void 0:a[e],o&&(t=o));const l=new self.URL(t);return i&&!o&&(l.host=i),s&&Object.keys(s).sort().forEach(u=>{u&&l.searchParams.set(u,s[u])}),l.href}const MN=/^age:\s*[\d.]+\s*$/im;class hw{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new Td,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,e.readyState!==4&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,r,n){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=r,this.callbacks=n,this.loadInternal()}loadInternal(){const{config:e,context:r}=this;if(!e||!r)return;const n=this.loader=new self.XMLHttpRequest,i=this.stats;i.loading.first=0,i.loaded=0,i.aborted=!1;const s=this.xhrSetup;s?Promise.resolve().then(()=>{if(!(this.loader!==n||this.stats.aborted))return s(n,r.url)}).catch(a=>{if(!(this.loader!==n||this.stats.aborted))return n.open("GET",r.url,!0),s(n,r.url)}).then(()=>{this.loader!==n||this.stats.aborted||this.openAndSendXhr(n,r,e)}).catch(a=>{this.callbacks.onError({code:n.status,text:a.message},r,n,i)}):this.openAndSendXhr(n,r,e)}openAndSendXhr(e,r,n){e.readyState||e.open("GET",r.url,!0);const i=r.headers,{maxTimeToFirstByteMs:s,maxLoadTimeMs:a}=n.loadPolicy;if(i)for(const o in i)e.setRequestHeader(o,i[o]);r.rangeEnd&&e.setRequestHeader("Range","bytes="+r.rangeStart+"-"+(r.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=r.responseType,self.clearTimeout(this.requestTimeout),n.timeout=s&&pe(s)?s:a,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),n.timeout),e.send()}readystatechange(){const{context:e,loader:r,stats:n}=this;if(!e||!r)return;const i=r.readyState,s=this.config;if(!n.aborted&&i>=2&&(n.loading.first===0&&(n.loading.first=Math.max(self.performance.now(),n.loading.start),s.timeout!==s.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),s.timeout=s.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),s.loadPolicy.maxLoadTimeMs-(n.loading.first-n.loading.start)))),i===4)){self.clearTimeout(this.requestTimeout),r.onreadystatechange=null,r.onprogress=null;const a=r.status,o=r.responseType!=="text";if(a>=200&&a<300&&(o&&r.response||r.responseText!==null)){n.loading.end=Math.max(self.performance.now(),n.loading.first);const l=o?r.response:r.responseText,u=r.responseType==="arraybuffer"?l.byteLength:l.length;if(n.loaded=n.total=u,n.bwEstimate=n.total*8e3/(n.loading.end-n.loading.first),!this.callbacks)return;const c=this.callbacks.onProgress;if(c&&c(n,e,l,r),!this.callbacks)return;const d={url:r.responseURL,data:l,code:a};this.callbacks.onSuccess(d,n,e,r)}else{const l=s.loadPolicy.errorRetry,u=n.retry,c={url:e.url,data:void 0,code:a};jc(l,u,!1,c)?this.retry(l):(U.error(`${a} while loading ${e.url}`),this.callbacks.onError({code:a,text:r.statusText},e,r,n))}}}loadtimeout(){if(!this.config)return;const e=this.config.loadPolicy.timeoutRetry,r=this.stats.retry;if(jc(e,r,!0))this.retry(e);else{var n;U.warn(`timeout while loading ${(n=this.context)==null?void 0:n.url}`);const i=this.callbacks;i&&(this.abortInternal(),i.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:r,stats:n}=this;this.retryDelay=Rm(e,n.retry),n.retry++,U.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${r==null?void 0:r.url}, retrying ${n.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const r=this.stats;r.loaded=e.loaded,e.lengthComputable&&(r.total=e.total)}getCacheAge(){let e=null;if(this.loader&&MN.test(this.loader.getAllResponseHeaders())){const r=this.loader.getResponseHeader("age");e=r?parseFloat(r):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}function NN(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}const FN=/(\d+)-(\d+)\/(\d+)/;class ly{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||jN,this.controller=new self.AbortController,this.stats=new Td}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,r,n){const i=this.stats;if(i.loading.start)throw new Error("Loader can only be used once.");i.loading.start=self.performance.now();const s=UN(e,this.controller.signal),a=n.onProgress,o=e.responseType==="arraybuffer",l=o?"byteLength":"length",{maxTimeToFirstByteMs:u,maxLoadTimeMs:c}=r.loadPolicy;this.context=e,this.config=r,this.callbacks=n,this.request=this.fetchSetup(e,s),self.clearTimeout(this.requestTimeout),r.timeout=u&&pe(u)?u:c,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),n.onTimeout(i,e,this.response)},r.timeout),self.fetch(this.request).then(d=>{this.response=this.loader=d;const f=Math.max(self.performance.now(),i.loading.start);if(self.clearTimeout(this.requestTimeout),r.timeout=c,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),n.onTimeout(i,e,this.response)},c-(f-i.loading.start)),!d.ok){const{status:m,statusText:h}=d;throw new VN(h||"fetch, bad network response",m,d)}return i.loading.first=f,i.total=$N(d.headers)||i.total,a&&pe(r.highWaterMark)?this.loadProgressively(d,i,e,r.highWaterMark,a):o?d.arrayBuffer():e.responseType==="json"?d.json():d.text()}).then(d=>{const f=this.response;if(!f)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),i.loading.end=Math.max(self.performance.now(),i.loading.first);const m=d[l];m&&(i.loaded=i.total=m);const h={url:f.url,data:d,code:f.status};a&&!pe(r.highWaterMark)&&a(i,e,d,f),n.onSuccess(h,i,e,f)}).catch(d=>{if(self.clearTimeout(this.requestTimeout),i.aborted)return;const f=d&&d.code||0,m=d?d.message:null;n.onError({code:f,text:m},e,d?d.details:null,i)})}getCacheAge(){let e=null;if(this.response){const r=this.response.headers.get("age");e=r?parseFloat(r):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,r,n,i=0,s){const a=new OT,o=e.body.getReader(),l=()=>o.read().then(u=>{if(u.done)return a.dataLength&&s(r,n,a.flush(),e),Promise.resolve(new ArrayBuffer(0));const c=u.value,d=c.length;return r.loaded+=d,d<i||a.dataLength?(a.push(c),a.dataLength>=i&&s(r,n,a.flush(),e)):s(r,n,c,e),l()}).catch(()=>Promise.reject());return l()}}function UN(t,e){const r={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(It({},t.headers))};return t.rangeEnd&&r.headers.set("Range","bytes="+t.rangeStart+"-"+String(t.rangeEnd-1)),r}function BN(t){const e=FN.exec(t);if(e)return parseInt(e[2])-parseInt(e[1])+1}function $N(t){const e=t.get("Content-Range");if(e){const n=BN(e);if(pe(n))return n}const r=t.get("Content-Length");if(r)return parseInt(r)}function jN(t,e){return new self.Request(t.url,e)}class VN extends Error{constructor(e,r,n){super(e),this.code=void 0,this.details=void 0,this.code=r,this.details=n}}const GN=/\s/,zN={newCue(t,e,r,n){const i=[];let s,a,o,l,u;const c=self.VTTCue||self.TextTrackCue;for(let f=0;f<n.rows.length;f++)if(s=n.rows[f],o=!0,l=0,u="",!s.isEmpty()){var d;for(let p=0;p<s.chars.length;p++)GN.test(s.chars[p].uchar)&&o?l++:(u+=s.chars[p].uchar,o=!1);s.cueStartTime=e,e===r&&(r+=1e-4),l>=16?l--:l++;const m=rw(u.trim()),h=$m(e,r,m);t!=null&&(d=t.cues)!=null&&d.getCueById(h)||(a=new c(e,r,m),a.id=h,a.line=f+1,a.align="left",a.position=10+Math.min(80,Math.floor(l*8/32)*10),i.push(a))}return t&&i.length&&(i.sort((f,m)=>f.line==="auto"||m.line==="auto"?0:f.line>8&&m.line>8?m.line-f.line:f.line-m.line),i.forEach(f=>AT(t,f))),i}},HN={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},pw=jt(jt({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,maxBufferSize:60*1e3*1e3,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:hw,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:yO,bufferController:TM,capLevelController:jm,errorController:aO,fpsController:XM,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:fT,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0,useMediaCapabilities:!0,certLoadPolicy:{default:HN},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},WN()),{},{subtitleStreamController:yM,subtitleTrackController:SM,timelineController:YM,audioStreamController:gM,audioTrackController:vM,emeController:fa,cmcdController:DN,contentSteeringController:ON});function WN(){return{cueHandler:zN,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function KN(t,e){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(e.liveMaxLatencyDurationCount!==void 0&&(e.liveSyncDurationCount===void 0||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(e.liveMaxLatencyDuration!==void 0&&(e.liveSyncDuration===void 0||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const r=ap(t),n=["manifest","level","frag"],i=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return n.forEach(s=>{const a=`${s==="level"?"playlist":s}LoadPolicy`,o=e[a]===void 0,l=[];i.forEach(u=>{const c=`${s}Loading${u}`,d=e[c];if(d!==void 0&&o){l.push(c);const f=r[a].default;switch(e[a]={default:f},u){case"TimeOut":f.maxLoadTimeMs=d,f.maxTimeToFirstByteMs=d;break;case"MaxRetry":f.errorRetry.maxNumRetry=d,f.timeoutRetry.maxNumRetry=d;break;case"RetryDelay":f.errorRetry.retryDelayMs=d,f.timeoutRetry.retryDelayMs=d;break;case"MaxRetryTimeout":f.errorRetry.maxRetryDelayMs=d,f.timeoutRetry.maxRetryDelayMs=d;break}}}),l.length&&U.warn(`hls.js config: "${l.join('", "')}" setting(s) are deprecated, use "${a}": ${JSON.stringify(e[a])}`)}),jt(jt({},r),e)}function ap(t){return t&&typeof t=="object"?Array.isArray(t)?t.map(ap):Object.keys(t).reduce((e,r)=>(e[r]=ap(t[r]),e),{}):t}function YN(t){const e=t.loader;e!==ly&&e!==hw?(U.log("[config]: Custom loader detected, cannot enable progressive streaming"),t.progressive=!1):NN()&&(t.loader=ly,t.progressive=!0,t.enableSoftwareAES=!0,U.log("[config]: Progressive streaming enabled, using FetchLoader"))}let Uf;class qN extends Im{constructor(e,r){super(e,"[level-controller]"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=r,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(w.MANIFEST_LOADING,this.onManifestLoading,this),e.on(w.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(w.LEVEL_LOADED,this.onLevelLoaded,this),e.on(w.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(w.FRAG_BUFFERED,this.onFragBuffered,this),e.on(w.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(w.MANIFEST_LOADING,this.onManifestLoading,this),e.off(w.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(w.LEVEL_LOADED,this.onLevelLoaded,this),e.off(w.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(w.FRAG_BUFFERED,this.onFragBuffered,this),e.off(w.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(r=>{r.loadError=0,r.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(e,r){this.resetLevels()}onManifestLoaded(e,r){const n=this.hls.config.preferManagedMediaSource,i=[],s={},a={};let o=!1,l=!1,u=!1;r.levels.forEach(c=>{var d,f;const m=c.attrs;let{audioCodec:h,videoCodec:p}=c;((d=h)==null?void 0:d.indexOf("mp4a.40.34"))!==-1&&(Uf||(Uf=/chrome|firefox/i.test(navigator.userAgent)),Uf&&(c.audioCodec=h=void 0)),h&&(c.audioCodec=h=Uc(h,n)),((f=p)==null?void 0:f.indexOf("avc1"))===0&&(p=c.videoCodec=MP(p));const{width:v,height:g,unknownCodecs:y}=c;if(o||(o=!!(v&&g)),l||(l=!!p),u||(u=!!h),y!=null&&y.length||h&&!wf(h,"audio",n)||p&&!wf(p,"video",n))return;const{CODECS:x,"FRAME-RATE":S,"HDCP-LEVEL":T,"PATHWAY-ID":C,RESOLUTION:_,"VIDEO-RANGE":b}=m,A=`${`${C||"."}-`}${c.bitrate}-${_}-${S}-${x}-${b}-${T}`;if(s[A])if(s[A].uri!==c.url&&!c.attrs["PATHWAY-ID"]){const k=a[A]+=1;c.attrs["PATHWAY-ID"]=new Array(k+1).join(".");const O=new Ia(c);s[A]=O,i.push(O)}else s[A].addGroupId("audio",m.AUDIO),s[A].addGroupId("text",m.SUBTITLES);else{const k=new Ia(c);s[A]=k,a[A]=1,i.push(k)}}),this.filterAndSortMediaOptions(i,r,o,l,u)}filterAndSortMediaOptions(e,r,n,i,s){let a=[],o=[],l=e;if((n||i)&&s&&(l=l.filter(({videoCodec:h,videoRange:p,width:v,height:g})=>(!!h||!!(v&&g))&&YP(p))),l.length===0){Promise.resolve().then(()=>{if(this.hls){r.levels.length&&this.warn(`One or more CODECS in variant not supported: ${JSON.stringify(r.levels[0].attrs)}`);const h=new Error("no level with compatible codecs found in manifest");this.hls.trigger(w.ERROR,{type:_e.MEDIA_ERROR,details:z.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:r.url,error:h,reason:h.message})}});return}if(r.audioTracks){const{preferManagedMediaSource:h}=this.hls.config;a=r.audioTracks.filter(p=>!p.audioCodec||wf(p.audioCodec,"audio",h)),uy(a)}r.subtitles&&(o=r.subtitles,uy(o));const u=l.slice(0);l.sort((h,p)=>{if(h.attrs["HDCP-LEVEL"]!==p.attrs["HDCP-LEVEL"])return(h.attrs["HDCP-LEVEL"]||"")>(p.attrs["HDCP-LEVEL"]||"")?1:-1;if(n&&h.height!==p.height)return h.height-p.height;if(h.frameRate!==p.frameRate)return h.frameRate-p.frameRate;if(h.videoRange!==p.videoRange)return Bc.indexOf(h.videoRange)-Bc.indexOf(p.videoRange);if(h.videoCodec!==p.videoCodec){const v=gv(h.videoCodec),g=gv(p.videoCodec);if(v!==g)return g-v}if(h.uri===p.uri&&h.codecSet!==p.codecSet){const v=Fc(h.codecSet),g=Fc(p.codecSet);if(v!==g)return g-v}return h.averageBitrate!==p.averageBitrate?h.averageBitrate-p.averageBitrate:0});let c=u[0];if(this.steering&&(l=this.steering.filterParsedLevels(l),l.length!==u.length)){for(let h=0;h<u.length;h++)if(u[h].pathwayId===l[0].pathwayId){c=u[h];break}}this._levels=l;for(let h=0;h<l.length;h++)if(l[h]===c){var d;this._firstLevel=h;const p=c.bitrate,v=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${l.length} level(s) found, first bitrate: ${p}`),((d=this.hls.userConfig)==null?void 0:d.abrEwmaDefaultEstimate)===void 0){const g=Math.min(p,this.hls.config.abrEwmaDefaultEstimateMax);g>v&&v===pw.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=g)}break}const f=s&&!i,m={levels:l,audioTracks:a,subtitleTracks:o,sessionData:r.sessionData,sessionKeys:r.sessionKeys,firstLevel:this._firstLevel,stats:r.stats,audio:s,video:i,altAudio:!f&&a.some(h=>!!h.url)};this.hls.trigger(w.MANIFEST_PARSED,m),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}get levels(){return this._levels.length===0?null:this._levels}get level(){return this.currentLevelIndex}set level(e){const r=this._levels;if(r.length===0)return;if(e<0||e>=r.length){const c=new Error("invalid level idx"),d=e<0;if(this.hls.trigger(w.ERROR,{type:_e.OTHER_ERROR,details:z.LEVEL_SWITCH_ERROR,level:e,fatal:d,error:c,reason:c.message}),d)return;e=Math.min(e,r.length-1)}const n=this.currentLevelIndex,i=this.currentLevel,s=i?i.attrs["PATHWAY-ID"]:void 0,a=r[e],o=a.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=a,n===e&&a.details&&i&&s===o)return;this.log(`Switching to level ${e} (${a.height?a.height+"p ":""}${a.videoRange?a.videoRange+" ":""}${a.codecSet?a.codecSet+" ":""}@${a.bitrate})${o?" with Pathway "+o:""} from level ${n}${s?" with Pathway "+s:""}`);const l={level:e,attrs:a.attrs,details:a.details,bitrate:a.bitrate,averageBitrate:a.averageBitrate,maxBitrate:a.maxBitrate,realBitrate:a.realBitrate,width:a.width,height:a.height,codecSet:a.codecSet,audioCodec:a.audioCodec,videoCodec:a.videoCodec,audioGroups:a.audioGroups,subtitleGroups:a.subtitleGroups,loaded:a.loaded,loadError:a.loadError,fragmentError:a.fragmentError,name:a.name,id:a.id,uri:a.uri,url:a.url,urlId:0,audioGroupIds:a.audioGroupIds,textGroupIds:a.textGroupIds};this.hls.trigger(w.LEVEL_SWITCHING,l);const u=a.details;if(!u||u.live){const c=this.switchParams(a.uri,i==null?void 0:i.details,u);this.loadPlaylist(c)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,this._startLevel===void 0&&(this._startLevel=e),e!==-1&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(this._startLevel===void 0){const e=this.hls.config.startLevel;return e!==void 0?e:this.hls.firstAutoLevel}return this._startLevel}set startLevel(e){this._startLevel=e}onError(e,r){r.fatal||!r.context||r.context.type===He.LEVEL&&r.context.level===this.level&&this.checkRetry(r)}onFragBuffered(e,{frag:r}){if(r!==void 0&&r.type===we.MAIN){const n=r.elementaryStreams;if(!Object.keys(n).some(s=>!!n[s]))return;const i=this._levels[r.level];i!=null&&i.loadError&&(this.log(`Resetting level error count of ${i.loadError} on frag buffered`),i.loadError=0)}}onLevelLoaded(e,r){var n;const{level:i,details:s}=r,a=this._levels[i];if(!a){var o;this.warn(`Invalid level index ${i}`),(o=r.deliveryDirectives)!=null&&o.skip&&(s.deltaUpdateFailed=!0);return}i===this.currentLevelIndex?(a.fragmentError===0&&(a.loadError=0),this.playlistLoaded(i,r,a.details)):(n=r.deliveryDirectives)!=null&&n.skip&&(s.deltaUpdateFailed=!0)}loadPlaylist(e){super.loadPlaylist();const r=this.currentLevelIndex,n=this.currentLevel;if(n&&this.shouldLoadPlaylist(n)){let i=n.uri;if(e)try{i=e.addDirectives(i)}catch(a){this.warn(`Could not construct new URL with HLS Delivery Directives: ${a}`)}const s=n.attrs["PATHWAY-ID"];this.log(`Loading level index ${r}${(e==null?void 0:e.msn)!==void 0?" at sn "+e.msn+" part "+e.part:""} with${s?" Pathway "+s:""} ${i}`),this.clearTimer(),this.hls.trigger(w.LEVEL_LOADING,{url:i,level:r,pathwayId:n.attrs["PATHWAY-ID"],id:0,deliveryDirectives:e||null})}}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=e)}removeLevel(e){var r;const n=this._levels.filter((i,s)=>s!==e?!0:(this.steering&&this.steering.removeLevel(i),i===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,i.details&&i.details.fragments.forEach(a=>a.level=-1)),!1));IT(n),this._levels=n,this.currentLevelIndex>-1&&(r=this.currentLevel)!=null&&r.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.hls.trigger(w.LEVELS_UPDATED,{levels:n})}onLevelsUpdated(e,{levels:r}){this._levels=r}checkMaxAutoUpdated(){const{autoLevelCapping:e,maxAutoLevel:r,maxHdcpLevel:n}=this.hls;this._maxAutoLevel!==r&&(this._maxAutoLevel=r,this.hls.trigger(w.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:e,levels:this.levels,maxAutoLevel:r,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:n}))}}function uy(t){const e={};t.forEach(r=>{const n=r.groupId||"";r.id=e[n]=e[n]||0,e[n]++})}class XN{constructor(e){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const n in this.keyUriToKeyInfo){const i=this.keyUriToKeyInfo[n].loader;if(i){var r;if(e&&e!==((r=i.context)==null?void 0:r.frag.type))return;i.abort()}}}detach(){for(const e in this.keyUriToKeyInfo){const r=this.keyUriToKeyInfo[e];(r.mediaKeySessionContext||r.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyUriToKeyInfo){const r=this.keyUriToKeyInfo[e].loader;r&&r.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(e,r=z.KEY_LOAD_ERROR,n,i,s){return new Zn({type:_e.NETWORK_ERROR,details:r,fatal:!1,frag:e,response:s,error:n,networkDetails:i})}loadClear(e,r){if(this.emeController&&this.config.emeEnabled){const{sn:n,cc:i}=e;for(let s=0;s<r.length;s++){const a=r[s];if(i<=a.cc&&(n==="initSegment"||a.sn==="initSegment"||n<a.sn)){this.emeController.selectKeySystemFormat(a).then(o=>{a.setKeyFormat(o)});break}}}}load(e){return!e.decryptdata&&e.encrypted&&this.emeController?this.emeController.selectKeySystemFormat(e).then(r=>this.loadInternal(e,r)):this.loadInternal(e)}loadInternal(e,r){var n,i;r&&e.setKeyFormat(r);const s=e.decryptdata;if(!s){const u=new Error(r?`Expected frag.decryptdata to be defined after setting format ${r}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(e,z.KEY_LOAD_ERROR,u))}const a=s.uri;if(!a)return Promise.reject(this.createKeyLoadError(e,z.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${a}"`)));let o=this.keyUriToKeyInfo[a];if((n=o)!=null&&n.decryptdata.key)return s.key=o.decryptdata.key,Promise.resolve({frag:e,keyInfo:o});if((i=o)!=null&&i.keyLoadPromise){var l;switch((l=o.mediaKeySessionContext)==null?void 0:l.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return o.keyLoadPromise.then(u=>(s.key=u.keyInfo.decryptdata.key,{frag:e,keyInfo:o}))}}switch(o=this.keyUriToKeyInfo[a]={decryptdata:s,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},s.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return s.keyFormat==="identity"?this.loadKeyHTTP(o,e):this.loadKeyEME(o,e);case"AES-128":return this.loadKeyHTTP(o,e);default:return Promise.reject(this.createKeyLoadError(e,z.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${s.method}"`)))}}loadKeyEME(e,r){const n={frag:r,keyInfo:e};if(this.emeController&&this.config.emeEnabled){const i=this.emeController.loadKey(n);if(i)return(e.keyLoadPromise=i.then(s=>(e.mediaKeySessionContext=s,n))).catch(s=>{throw e.keyLoadPromise=null,s})}return Promise.resolve(n)}loadKeyHTTP(e,r){const n=this.config,i=n.loader,s=new i(n);return r.keyLoader=e.loader=s,e.keyLoadPromise=new Promise((a,o)=>{const l={keyInfo:e,frag:r,responseType:"arraybuffer",url:e.decryptdata.uri},u=n.keyLoadPolicy.default,c={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},d={onSuccess:(f,m,h,p)=>{const{frag:v,keyInfo:g,url:y}=h;if(!v.decryptdata||g!==this.keyUriToKeyInfo[y])return o(this.createKeyLoadError(v,z.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),p));g.decryptdata.key=v.decryptdata.key=new Uint8Array(f.data),v.keyLoader=null,g.loader=null,a({frag:v,keyInfo:g})},onError:(f,m,h,p)=>{this.resetLoader(m),o(this.createKeyLoadError(r,z.KEY_LOAD_ERROR,new Error(`HTTP Error ${f.code} loading key ${f.text}`),h,jt({url:l.url,data:void 0},f)))},onTimeout:(f,m,h)=>{this.resetLoader(m),o(this.createKeyLoadError(r,z.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),h))},onAbort:(f,m,h)=>{this.resetLoader(m),o(this.createKeyLoadError(r,z.INTERNAL_ABORTED,new Error("key loading aborted"),h))}};s.load(l,c,d)})}resetLoader(e){const{frag:r,keyInfo:n,url:i}=e,s=n.loader;r.keyLoader===s&&(r.keyLoader=null,n.loader=null),delete this.keyUriToKeyInfo[i],s&&s.destroy()}}function mw(){return self.SourceBuffer||self.WebKitSourceBuffer}function gw(){if(!bs())return!1;const e=mw();return!e||e.prototype&&typeof e.prototype.appendBuffer=="function"&&typeof e.prototype.remove=="function"}function ZN(){if(!gw())return!1;const t=bs();return typeof(t==null?void 0:t.isTypeSupported)=="function"&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(e=>t.isTypeSupported(pl(e,"video")))||["mp4a.40.2","fLaC"].some(e=>t.isTypeSupported(pl(e,"audio"))))}function QN(){var t;const e=mw();return typeof(e==null||(t=e.prototype)==null?void 0:t.changeType)=="function"}const JN=250,$u=2,eF=.1,tF=.05;class rF{constructor(e,r,n,i){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=e,this.media=r,this.fragmentTracker=n,this.hls=i}destroy(){this.media=null,this.hls=this.fragmentTracker=null}poll(e,r){const{config:n,media:i,stalled:s}=this;if(i===null)return;const{currentTime:a,seeking:o}=i,l=this.seeking&&!o,u=!this.seeking&&o;if(this.seeking=o,a!==e){if(this.moved=!0,o||(this.nudgeRetry=0),s!==null){if(this.stallReported){const v=self.performance.now()-s;U.warn(`playback not stuck anymore @${a}, after ${Math.round(v)}ms`),this.stallReported=!1}this.stalled=null}return}if(u||l){this.stalled=null;return}if(i.paused&&!o||i.ended||i.playbackRate===0||!at.getBuffered(i).length){this.nudgeRetry=0;return}const c=at.bufferInfo(i,a,0),d=c.nextStart||0;if(o){const v=c.len>$u,g=!d||r&&r.start<=a||d-a>$u&&!this.fragmentTracker.getPartialFragment(a);if(v||g)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var f;if(!(c.len>0)&&!d)return;const g=Math.max(d,c.start||0)-a,y=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,S=(y==null||(f=y.details)==null?void 0:f.live)?y.details.targetduration*2:$u,T=this.fragmentTracker.getPartialFragment(a);if(g>0&&(g<=S||T)){i.paused||this._trySkipBufferHole(T);return}}const m=self.performance.now();if(s===null){this.stalled=m;return}const h=m-s;if(!o&&h>=JN&&(this._reportStall(c),!this.media))return;const p=at.bufferInfo(i,a,n.maxBufferHole);this._tryFixBufferStall(p,h)}_tryFixBufferStall(e,r){const{config:n,fragmentTracker:i,media:s}=this;if(s===null)return;const a=s.currentTime,o=i.getPartialFragment(a);o&&(this._trySkipBufferHole(o)||!this.media)||(e.len>n.maxBufferHole||e.nextStart&&e.nextStart-a<n.maxBufferHole)&&r>n.highBufferWatchdogPeriod*1e3&&(U.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}_reportStall(e){const{hls:r,media:n,stallReported:i}=this;if(!i&&n){this.stallReported=!0;const s=new Error(`Playback stalling at @${n.currentTime} due to low buffer (${JSON.stringify(e)})`);U.warn(s.message),r.trigger(w.ERROR,{type:_e.MEDIA_ERROR,details:z.BUFFER_STALLED_ERROR,fatal:!1,error:s,buffer:e.len})}}_trySkipBufferHole(e){const{config:r,hls:n,media:i}=this;if(i===null)return 0;const s=i.currentTime,a=at.bufferInfo(i,s,0),o=s<a.start?a.start:a.nextStart;if(o){const l=a.len<=r.maxBufferHole,u=a.len>0&&a.len<1&&i.readyState<3,c=o-s;if(c>0&&(l||u)){if(c>r.maxBufferHole){const{fragmentTracker:f}=this;let m=!1;if(s===0){const h=f.getAppendedFrag(0,we.MAIN);h&&o<h.end&&(m=!0)}if(!m){const h=e||f.getAppendedFrag(s,we.MAIN);if(h){let p=!1,v=h.end;for(;v<o;){const g=f.getPartialFragment(v);if(g)v+=g.duration;else{p=!0;break}}if(p)return 0}}}const d=Math.max(o+tF,s+eF);if(U.warn(`skipping hole, adjusting currentTime from ${s} to ${d}`),this.moved=!0,this.stalled=null,i.currentTime=d,e&&!e.gap){const f=new Error(`fragment loaded with buffer holes, seeking from ${s} to ${d}`);n.trigger(w.ERROR,{type:_e.MEDIA_ERROR,details:z.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:f,reason:f.message,frag:e})}return d}}return 0}_tryNudgeBuffer(){const{config:e,hls:r,media:n,nudgeRetry:i}=this;if(n===null)return;const s=n.currentTime;if(this.nudgeRetry++,i<e.nudgeMaxRetry){const a=s+(i+1)*e.nudgeOffset,o=new Error(`Nudging 'currentTime' from ${s} to ${a}`);U.warn(o.message),n.currentTime=a,r.trigger(w.ERROR,{type:_e.MEDIA_ERROR,details:z.BUFFER_NUDGE_ON_STALL,error:o,fatal:!1})}else{const a=new Error(`Playhead still not moving while enough data buffered @${s} after ${e.nudgeMaxRetry} nudges`);U.error(a.message),r.trigger(w.ERROR,{type:_e.MEDIA_ERROR,details:z.BUFFER_STALLED_ERROR,error:a,fatal:!0})}}}const nF=100;class iF extends Pm{constructor(e,r,n){super(e,r,n,"[stream-controller]",we.MAIN),this.audioCodecSwap=!1,this.gapController=null,this.level=-1,this._forceStartLoad=!1,this.altAudio=!1,this.audioOnly=!1,this.fragPlaying=null,this.onvplaying=null,this.onvseeked=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(w.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(w.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(w.MANIFEST_LOADING,this.onManifestLoading,this),e.on(w.MANIFEST_PARSED,this.onManifestParsed,this),e.on(w.LEVEL_LOADING,this.onLevelLoading,this),e.on(w.LEVEL_LOADED,this.onLevelLoaded,this),e.on(w.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(w.ERROR,this.onError,this),e.on(w.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(w.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(w.BUFFER_CREATED,this.onBufferCreated,this),e.on(w.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(w.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(w.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(w.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(w.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(w.MANIFEST_LOADING,this.onManifestLoading,this),e.off(w.MANIFEST_PARSED,this.onManifestParsed,this),e.off(w.LEVEL_LOADED,this.onLevelLoaded,this),e.off(w.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(w.ERROR,this.onError,this),e.off(w.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(w.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(w.BUFFER_CREATED,this.onBufferCreated,this),e.off(w.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(w.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(w.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying()}startLoad(e){if(this.levels){const{lastCurrentTime:r,hls:n}=this;if(this.stopLoad(),this.setInterval(nF),this.level=-1,!this.startFragRequested){let i=n.startLevel;i===-1&&(n.config.testBandwidth&&this.levels.length>1?(i=0,this.bitrateTest=!0):i=n.firstAutoLevel),n.nextLoadLevel=i,this.level=n.loadLevel,this.loadedmetadata=!1}r>0&&e===-1&&(this.log(`Override startPosition with lastCurrentTime @${r.toFixed(3)}`),e=r),this.state=Y.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this._forceStartLoad=!0,this.state=Y.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case Y.WAITING_LEVEL:{const{levels:r,level:n}=this,i=r==null?void 0:r[n],s=i==null?void 0:i.details;if(s&&(!s.live||this.levelLastLoaded===i)){if(this.waitForCdnTuneIn(s))break;this.state=Y.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=Y.IDLE;break}break}case Y.FRAG_LOADING_WAITING_RETRY:{var e;const r=self.performance.now(),n=this.retryDate;if(!n||r>=n||(e=this.media)!=null&&e.seeking){const{levels:i,level:s}=this,a=i==null?void 0:i[s];this.resetStartWhenNotLoaded(a||null),this.state=Y.IDLE}}break}this.state===Y.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){super.onTickEnd(),this.checkBuffer(),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:r,levels:n,media:i}=this;if(r===null||!i&&(this.startFragRequested||!e.config.startFragPrefetch)||this.altAudio&&this.audioOnly)return;const s=e.nextLoadLevel;if(!(n!=null&&n[s]))return;const a=n[s],o=this.getMainFwdBufferInfo();if(o===null)return;const l=this.getLevelDetails();if(l&&this._streamEnded(o,l)){const p={};this.altAudio&&(p.type="video"),this.hls.trigger(w.BUFFER_EOS,p),this.state=Y.ENDED;return}e.loadLevel!==s&&e.manualLevel===-1&&this.log(`Adapting to level ${s} from level ${this.level}`),this.level=e.nextLoadLevel=s;const u=a.details;if(!u||this.state===Y.WAITING_LEVEL||u.live&&this.levelLastLoaded!==a){this.level=s,this.state=Y.WAITING_LEVEL;return}const c=o.len,d=this.getMaxBufferLength(a.maxBitrate);if(c>=d)return;this.backtrackFragment&&this.backtrackFragment.start>o.end&&(this.backtrackFragment=null);const f=this.backtrackFragment?this.backtrackFragment.start:o.end;let m=this.getNextFragment(f,u);if(this.couldBacktrack&&!this.fragPrevious&&m&&m.sn!=="initSegment"&&this.fragmentTracker.getState(m)!==Bt.OK){var h;const v=((h=this.backtrackFragment)!=null?h:m).sn-u.startSN,g=u.fragments[v-1];g&&m.cc===g.cc&&(m=g,this.fragmentTracker.removeFragment(g))}else this.backtrackFragment&&o.len&&(this.backtrackFragment=null);if(m&&this.isLoopLoading(m,f)){if(!m.gap){const v=this.audioOnly&&!this.altAudio?Je.AUDIO:Je.VIDEO,g=(v===Je.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;g&&this.afterBufferFlushed(g,v,we.MAIN)}m=this.getNextFragmentLoopLoading(m,u,o,we.MAIN,d)}m&&(m.initSegment&&!m.initSegment.data&&!this.bitrateTest&&(m=m.initSegment),this.loadFragment(m,a,f))}loadFragment(e,r,n){const i=this.fragmentTracker.getState(e);this.fragCurrent=e,i===Bt.NOT_LOADED||i===Bt.PARTIAL?e.sn==="initSegment"?this._loadInitSegment(e,r):this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,r)):(this.startFragRequested=!0,super.loadFragment(e,r,n)):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,we.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:r}=this;if(r!=null&&r.readyState){let n;const i=this.getAppendedFrag(r.currentTime);i&&i.start>1&&this.flushMainBuffer(0,i.start-1);const s=this.getLevelDetails();if(s!=null&&s.live){const o=this.getMainFwdBufferInfo();if(!o||o.len<s.targetduration*2)return}if(!r.paused&&e){const o=this.hls.nextLoadLevel,l=e[o],u=this.fragLastKbps;u&&this.fragCurrent?n=this.fragCurrent.duration*l.maxBitrate/(1e3*u)+1:n=0}else n=0;const a=this.getBufferedFrag(r.currentTime+n);if(a){const o=this.followingBufferedFrag(a);if(o){this.abortCurrentFrag();const l=o.maxStartPTS?o.maxStartPTS:o.start,u=o.duration,c=Math.max(a.end,l+Math.min(Math.max(u-this.config.maxFragLookUpTolerance,u*(this.couldBacktrack?.5:.125)),u*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(c,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case Y.KEY_LOADING:case Y.FRAG_LOADING:case Y.FRAG_LOADING_WAITING_RETRY:case Y.PARSING:case Y.PARSED:this.state=Y.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,r){super.flushMainBuffer(e,r,this.altAudio?"video":null)}onMediaAttached(e,r){super.onMediaAttached(e,r);const n=r.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),n.addEventListener("playing",this.onvplaying),n.addEventListener("seeked",this.onvseeked),this.gapController=new rF(this.config,n,this.fragmentTracker,this.hls)}onMediaDetaching(){const{media:e}=this;e&&this.onvplaying&&this.onvseeked&&(e.removeEventListener("playing",this.onvplaying),e.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),super.onMediaDetaching()}onMediaPlaying(){this.tick()}onMediaSeeked(){const e=this.media,r=e?e.currentTime:null;pe(r)&&this.log(`Media seeked to ${r.toFixed(3)}`);const n=this.getMainFwdBufferInfo();if(n===null||n.len===0){this.warn(`Main forward buffer length on "seeked" event ${n?n.len:"empty"})`);return}this.tick()}onManifestLoading(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(w.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=this.fragLastKbps=0,this.levels=this.fragPlaying=this.backtrackFragment=this.levelLastLoaded=null,this.altAudio=this.audioOnly=this.startFragRequested=!1}onManifestParsed(e,r){let n=!1,i=!1;r.levels.forEach(s=>{const a=s.audioCodec;a&&(n=n||a.indexOf("mp4a.40.2")!==-1,i=i||a.indexOf("mp4a.40.5")!==-1)}),this.audioCodecSwitch=n&&i&&!QN(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=r.levels,this.startFragRequested=!1}onLevelLoading(e,r){const{levels:n}=this;if(!n||this.state!==Y.IDLE)return;const i=n[r.level];(!i.details||i.details.live&&this.levelLastLoaded!==i||this.waitForCdnTuneIn(i.details))&&(this.state=Y.WAITING_LEVEL)}onLevelLoaded(e,r){var n;const{levels:i}=this,s=r.level,a=r.details,o=a.totalduration;if(!i){this.warn(`Levels were reset while loading level ${s}`);return}this.log(`Level ${s} loaded [${a.startSN},${a.endSN}]${a.lastPartSn?`[part-${a.lastPartSn}-${a.lastPartIndex}]`:""}, cc [${a.startCC}, ${a.endCC}] duration:${o}`);const l=i[s],u=this.fragCurrent;u&&(this.state===Y.FRAG_LOADING||this.state===Y.FRAG_LOADING_WAITING_RETRY)&&u.level!==r.level&&u.loader&&this.abortCurrentFrag();let c=0;if(a.live||(n=l.details)!=null&&n.live){var d;if(this.checkLiveUpdate(a),a.deltaUpdateFailed)return;c=this.alignPlaylists(a,l.details,(d=this.levelLastLoaded)==null?void 0:d.details)}if(l.details=a,this.levelLastLoaded=l,this.hls.trigger(w.LEVEL_UPDATED,{details:a,level:s}),this.state===Y.WAITING_LEVEL){if(this.waitForCdnTuneIn(a))return;this.state=Y.IDLE}this.startFragRequested?a.live&&this.synchronizeToLiveEdge(a):this.setStartPosition(a,c),this.tick()}_handleFragmentLoadProgress(e){var r;const{frag:n,part:i,payload:s}=e,{levels:a}=this;if(!a){this.warn(`Levels were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);return}const o=a[n.level],l=o.details;if(!l){this.warn(`Dropping fragment ${n.sn} of level ${n.level} after level details were reset`),this.fragmentTracker.removeFragment(n);return}const u=o.videoCodec,c=l.PTSKnown||!l.live,d=(r=n.initSegment)==null?void 0:r.data,f=this._getAudioCodec(o),m=this.transmuxer=this.transmuxer||new XT(this.hls,we.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),h=i?i.index:-1,p=h!==-1,v=new km(n.level,n.sn,n.stats.chunkCount,s.byteLength,h,p),g=this.initPTS[n.cc];m.push(s,d,f,u,n,i,l.totalduration,c,v,g)}onAudioTrackSwitching(e,r){const n=this.altAudio;if(!!!r.url){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const a=this.fragCurrent;a&&(this.log("Switching to main audio track, cancel main fragment load"),a.abortRequests(),this.fragmentTracker.removeFragment(a)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();const s=this.hls;n&&(s.trigger(w.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null}),this.fragmentTracker.removeAllFragments()),s.trigger(w.AUDIO_TRACK_SWITCHED,r)}}onAudioTrackSwitched(e,r){const n=r.id,i=!!this.hls.audioTracks[n].url;if(i){const s=this.videoBuffer;s&&this.mediaBuffer!==s&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=s)}this.altAudio=i,this.tick()}onBufferCreated(e,r){const n=r.tracks;let i,s,a=!1;for(const o in n){const l=n[o];if(l.id==="main"){if(s=o,i=l,o==="video"){const u=n[o];u&&(this.videoBuffer=u.buffer)}}else a=!0}a&&i?(this.log(`Alternate track found, use ${s}.buffered to schedule main fragment loading`),this.mediaBuffer=i.buffer):this.mediaBuffer=this.media}onFragBuffered(e,r){const{frag:n,part:i}=r;if(n&&n.type!==we.MAIN)return;if(this.fragContextChanged(n)){this.warn(`Fragment ${n.sn}${i?" p: "+i.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}`),this.state===Y.PARSED&&(this.state=Y.IDLE);return}const s=i?i.stats:n.stats;this.fragLastKbps=Math.round(8*s.total/(s.buffering.end-s.loading.first)),n.sn!=="initSegment"&&(this.fragPrevious=n),this.fragBufferedComplete(n,i)}onError(e,r){var n;if(r.fatal){this.state=Y.ERROR;return}switch(r.details){case z.FRAG_GAP:case z.FRAG_PARSING_ERROR:case z.FRAG_DECRYPT_ERROR:case z.FRAG_LOAD_ERROR:case z.FRAG_LOAD_TIMEOUT:case z.KEY_LOAD_ERROR:case z.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(we.MAIN,r);break;case z.LEVEL_LOAD_ERROR:case z.LEVEL_LOAD_TIMEOUT:case z.LEVEL_PARSING_ERROR:!r.levelRetry&&this.state===Y.WAITING_LEVEL&&((n=r.context)==null?void 0:n.type)===He.LEVEL&&(this.state=Y.IDLE);break;case z.BUFFER_APPEND_ERROR:case z.BUFFER_FULL_ERROR:if(!r.parent||r.parent!=="main")return;if(r.details===z.BUFFER_APPEND_ERROR){this.resetLoadingState();return}this.reduceLengthAndFlushBuffer(r)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case z.INTERNAL_EXCEPTION:this.recoverWorkerError(r);break}}checkBuffer(){const{media:e,gapController:r}=this;if(!(!e||!r||!e.readyState)){if(this.loadedmetadata||!at.getBuffered(e).length){const n=this.state!==Y.IDLE?this.fragCurrent:null;r.poll(this.lastCurrentTime,n)}this.lastCurrentTime=e.currentTime}}onFragLoadEmergencyAborted(){this.state=Y.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()}onBufferFlushed(e,{type:r}){if(r!==Je.AUDIO||this.audioOnly&&!this.altAudio){const n=(r===Je.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(n,r,we.MAIN),this.tick()}}onLevelsUpdated(e,r){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level),this.levels=r.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const r=e.currentTime;let n=this.startPosition;if(n>=0&&r<n){if(e.seeking){this.log(`could not seek to ${n}, already seeking at ${r}`);return}const i=at.getBuffered(e),a=(i.length?i.start(0):0)-n;a>0&&(a<this.config.maxBufferHole||a<this.config.maxFragLookUpTolerance)&&(this.log(`adjusting start position by ${a} to match buffer start`),n+=a,this.startPosition=n),this.log(`seek to target start position ${n} from current time ${r}`),e.currentTime=n}}_getAudioCodec(e){let r=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&r&&(this.log("Swapping audio codec"),r.indexOf("mp4a.40.5")!==-1?r="mp4a.40.2":r="mp4a.40.5"),r}_loadBitrateTestFrag(e,r){e.bitrateTest=!0,this._doFragLoad(e,r).then(n=>{const{hls:i}=this;if(!n||this.fragContextChanged(e))return;r.fragmentError=0,this.state=Y.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const s=e.stats;s.parsing.start=s.parsing.end=s.buffering.start=s.buffering.end=self.performance.now(),i.trigger(w.FRAG_LOADED,n),e.bitrateTest=!1})}_handleTransmuxComplete(e){var r;const n="main",{hls:i}=this,{remuxResult:s,chunkMeta:a}=e,o=this.getCurrentContext(a);if(!o){this.resetWhenMissingContext(a);return}const{frag:l,part:u,level:c}=o,{video:d,text:f,id3:m,initSegment:h}=s,{details:p}=c,v=this.altAudio?void 0:s.audio;if(this.fragContextChanged(l)){this.fragmentTracker.removeFragment(l);return}if(this.state=Y.PARSING,h){if(h!=null&&h.tracks){const x=l.initSegment||l;this._bufferInitSegment(c,h.tracks,x,a),i.trigger(w.FRAG_PARSING_INIT_SEGMENT,{frag:x,id:n,tracks:h.tracks})}const g=h.initPTS,y=h.timescale;pe(g)&&(this.initPTS[l.cc]={baseTime:g,timescale:y},i.trigger(w.INIT_PTS_FOUND,{frag:l,id:n,initPTS:g,timescale:y}))}if(d&&p&&l.sn!=="initSegment"){const g=p.fragments[l.sn-1-p.startSN],y=l.sn===p.startSN,x=!g||l.cc>g.cc;if(s.independent!==!1){const{startPTS:S,endPTS:T,startDTS:C,endDTS:_}=d;if(u)u.elementaryStreams[d.type]={startPTS:S,endPTS:T,startDTS:C,endDTS:_};else if(d.firstKeyFrame&&d.independent&&a.id===1&&!x&&(this.couldBacktrack=!0),d.dropped&&d.independent){const b=this.getMainFwdBufferInfo(),I=(b?b.end:this.getLoadPosition())+this.config.maxBufferHole,A=d.firstKeyFramePTS?d.firstKeyFramePTS:S;if(!y&&I<A-this.config.maxBufferHole&&!x){this.backtrack(l);return}else x&&(l.gap=!0);l.setElementaryStreamInfo(d.type,l.start,T,l.start,_,!0)}else y&&S>$u&&(l.gap=!0);l.setElementaryStreamInfo(d.type,S,T,C,_),this.backtrackFragment&&(this.backtrackFragment=l),this.bufferFragmentData(d,l,u,a,y||x)}else if(y||x)l.gap=!0;else{this.backtrack(l);return}}if(v){const{startPTS:g,endPTS:y,startDTS:x,endDTS:S}=v;u&&(u.elementaryStreams[Je.AUDIO]={startPTS:g,endPTS:y,startDTS:x,endDTS:S}),l.setElementaryStreamInfo(Je.AUDIO,g,y,x,S),this.bufferFragmentData(v,l,u,a)}if(p&&m!=null&&(r=m.samples)!=null&&r.length){const g={id:n,frag:l,details:p,samples:m.samples};i.trigger(w.FRAG_PARSING_METADATA,g)}if(p&&f){const g={id:n,frag:l,details:p,samples:f.samples};i.trigger(w.FRAG_PARSING_USERDATA,g)}}_bufferInitSegment(e,r,n,i){if(this.state!==Y.PARSING)return;this.audioOnly=!!r.audio&&!r.video,this.altAudio&&!this.audioOnly&&delete r.audio;const{audio:s,video:a,audiovideo:o}=r;if(s){let l=e.audioCodec;const u=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){l&&(l.indexOf("mp4a.40.5")!==-1?l="mp4a.40.2":l="mp4a.40.5");const c=s.metadata;c&&"channelCount"in c&&(c.channelCount||1)!==1&&u.indexOf("firefox")===-1&&(l="mp4a.40.5")}l&&l.indexOf("mp4a.40.5")!==-1&&u.indexOf("android")!==-1&&s.container!=="audio/mpeg"&&(l="mp4a.40.2",this.log(`Android: force audio codec to ${l}`)),e.audioCodec&&e.audioCodec!==l&&this.log(`Swapping manifest audio codec "${e.audioCodec}" for "${l}"`),s.levelCodec=l,s.id="main",this.log(`Init audio buffer, container:${s.container}, codecs[selected/level/parsed]=[${l||""}/${e.audioCodec||""}/${s.codec}]`)}a&&(a.levelCodec=e.videoCodec,a.id="main",this.log(`Init video buffer, container:${a.container}, codecs[level/parsed]=[${e.videoCodec||""}/${a.codec}]`)),o&&this.log(`Init audiovideo buffer, container:${o.container}, codecs[level/parsed]=[${e.codecs}/${o.codec}]`),this.hls.trigger(w.BUFFER_CODECS,r),Object.keys(r).forEach(l=>{const c=r[l].initSegment;c!=null&&c.byteLength&&this.hls.trigger(w.BUFFER_APPENDING,{type:l,data:c,frag:n,part:null,chunkMeta:i,parent:n.type})}),this.tickImmediate()}getMainFwdBufferInfo(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,we.MAIN)}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=Y.IDLE}checkFragmentChanged(){const e=this.media;let r=null;if(e&&e.readyState>1&&e.seeking===!1){const n=e.currentTime;if(at.isBuffered(e,n)?r=this.getAppendedFrag(n):at.isBuffered(e,n+.1)&&(r=this.getAppendedFrag(n+.1)),r){this.backtrackFragment=null;const i=this.fragPlaying,s=r.level;(!i||r.sn!==i.sn||i.level!==s)&&(this.fragPlaying=r,this.hls.trigger(w.FRAG_CHANGED,{frag:r}),(!i||i.level!==s)&&this.hls.trigger(w.LEVEL_SWITCHED,{level:s}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){const e=this.media;return e?this.fragPlaying||this.getAppendedFrag(e.currentTime):null}get currentProgramDateTime(){const e=this.media;if(e){const r=e.currentTime,n=this.currentFrag;if(n&&pe(r)&&pe(n.programDateTime)){const i=n.programDateTime+(r-n.start)*1e3;return new Date(i)}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class kr{static get version(){return"1.5.15"}static isMSESupported(){return gw()}static isSupported(){return ZN()}static getMediaSource(){return bs()}static get Events(){return w}static get ErrorTypes(){return _e}static get ErrorDetails(){return z}static get DefaultConfig(){return kr.defaultConfig?kr.defaultConfig:pw}static set DefaultConfig(e){kr.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this.started=!1,this._emitter=new Um,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null,this.triggeringException=void 0,WD(e.debug||!1,"Hls instance");const r=this.config=KN(kr.DefaultConfig,e);this.userConfig=e,r.progressive&&YN(r);const{abrController:n,bufferController:i,capLevelController:s,errorController:a,fpsController:o}=r,l=new a(this),u=this.abrController=new n(this),c=this.bufferController=new i(this),d=this.capLevelController=new s(this),f=new o(this),m=new $P(this),h=new HP(this),p=r.contentSteeringController,v=p?new p(this):null,g=this.levelController=new qN(this,v),y=new SO(this),x=new XN(this.config),S=this.streamController=new iF(this,y,x);d.setStreamController(S),f.setStreamController(S);const T=[m,g,S];v&&T.splice(1,0,v),this.networkControllers=T;const C=[u,c,d,f,h,y];this.audioTrackController=this.createController(r.audioTrackController,T);const _=r.audioStreamController;_&&T.push(new _(this,y,x)),this.subtitleTrackController=this.createController(r.subtitleTrackController,T);const b=r.subtitleStreamController;b&&T.push(new b(this,y,x)),this.createController(r.timelineController,C),x.emeController=this.emeController=this.createController(r.emeController,C),this.cmcdController=this.createController(r.cmcdController,C),this.latencyController=this.createController(WP,C),this.coreComponents=C,T.push(l);const I=l.onErrorOut;typeof I=="function"&&this.on(w.ERROR,I,l)}createController(e,r){if(e){const n=new e(this);return r&&r.push(n),n}return null}on(e,r,n=this){this._emitter.on(e,r,n)}once(e,r,n=this){this._emitter.once(e,r,n)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,r,n=this,i){this._emitter.off(e,r,n,i)}listeners(e){return this._emitter.listeners(e)}emit(e,r,n){return this._emitter.emit(e,r,n)}trigger(e,r){if(this.config.debug)return this.emit(e,e,r);try{return this.emit(e,e,r)}catch(n){if(U.error("An internal error happened while handling event "+e+'. Error message: "'+n.message+'". Here is a stacktrace:',n),!this.triggeringException){this.triggeringException=!0;const i=e===w.ERROR;this.trigger(w.ERROR,{type:_e.OTHER_ERROR,details:z.INTERNAL_EXCEPTION,fatal:i,event:e,error:n}),this.triggeringException=!1}}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){U.log("destroy"),this.trigger(w.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(r=>r.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(r=>r.destroy()),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){U.log("attachMedia"),this._media=e,this.trigger(w.MEDIA_ATTACHING,{media:e})}detachMedia(){U.log("detachMedia"),this.trigger(w.MEDIA_DETACHING,void 0),this._media=null}loadSource(e){this.stopLoad();const r=this.media,n=this.url,i=this.url=Lm.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,U.log(`loadSource:${i}`),r&&n&&(n!==i||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(r)),this.trigger(w.MANIFEST_LOADING,{url:e})}startLoad(e=-1){U.log(`startLoad(${e})`),this.started=!0,this.networkControllers.forEach(r=>{r.startLoad(e)})}stopLoad(){U.log("stopLoad"),this.started=!1,this.networkControllers.forEach(e=>{e.stopLoad()})}resumeBuffering(){this.started&&this.networkControllers.forEach(e=>{"fragmentLoader"in e&&e.startLoad(-1)})}pauseBuffering(){this.networkControllers.forEach(e=>{"fragmentLoader"in e&&e.stopLoad()})}swapAudioCodec(){U.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){U.log("recoverMediaError");const e=this._media;this.detachMedia(),e&&this.attachMedia(e)}removeLevel(e){this.levelController.removeLevel(e)}get levels(){const e=this.levelController.levels;return e||[]}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){U.log(`set currentLevel:${e}`),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){U.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){U.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){U.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){const e=this.levelController.startLevel;return e===-1&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e}set startLevel(e){U.log(`set startLevel:${e}`),e!==-1&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const r=!!e;r!==this.config.capLevelToPlayerSize&&(r?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=r)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}set bandwidthEstimate(e){this.abrController.resetEstimator(e)}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(U.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){KP(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:r}}=this;if(!e)return 0;const n=e.length;for(let i=0;i<n;i++)if(e[i].maxBitrate>=r)return i;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:r,maxHdcpLevel:n}=this;let i;if(r===-1&&e!=null&&e.length?i=e.length-1:i=r,n)for(let s=i;s--;){const a=e[s].attrs["HDCP-LEVEL"];if(a&&a<=n)return s}return i}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(e){this.abrController.nextAutoLevel=e}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}setAudioOption(e){var r;return(r=this.audioTrackController)==null?void 0:r.setAudioOption(e)}setSubtitleOption(e){var r;return(r=this.subtitleTrackController)==null||r.setSubtitleOption(e),null}get allAudioTracks(){const e=this.audioTrackController;return e?e.allAudioTracks:[]}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const r=this.audioTrackController;r&&(r.audioTrack=e)}get allSubtitleTracks(){const e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const r=this.subtitleTrackController;r&&(r.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return e?e.subtitleDisplay:!1}set subtitleDisplay(e){const r=this.subtitleTrackController;r&&(r.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}}kr.defaultConfig=void 0;function sF(t){return Mt({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M208 432h-48a16 16 0 0 1-16-16V96a16 16 0 0 1 16-16h48a16 16 0 0 1 16 16v320a16 16 0 0 1-16 16zm144 0h-48a16 16 0 0 1-16-16V96a16 16 0 0 1 16-16h48a16 16 0 0 1 16 16v320a16 16 0 0 1-16 16z"},child:[]}]})(t)}function aF(t){return Mt({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M133 440a35.37 35.37 0 0 1-17.5-4.67c-12-6.8-19.46-20-19.46-34.33V111c0-14.37 7.46-27.53 19.46-34.33a35.13 35.13 0 0 1 35.77.45l247.85 148.36a36 36 0 0 1 0 61l-247.89 148.4A35.5 35.5 0 0 1 133 440z"},child:[]}]})(t)}function oF(t){return Mt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M19 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-8 12H9.5v-2h-2v2H6V9h1.5v2.5h2V9H11v6zm2-6h4c.55 0 1 .45 1 1v4c0 .55-.45 1-1 1h-4V9zm1.5 4.5h2v-3h-2v3z"},child:[]}]})(t)}function lF(t){return Mt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zM4 12h4v2H4v-2zm10 6H4v-2h10v2zm6 0h-4v-2h4v2zm0-4H10v-2h10v2z"},child:[]}]})(t)}function uF(t){return Mt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M18.5 12A4.5 4.5 0 0 0 16 7.97v8.05c1.48-.73 2.5-2.25 2.5-4.02zM5 9v6h4l5 5V4L9 9H5z"},child:[]}]})(t)}function cF(t){return Mt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M7 9v6h4l5 5V4l-5 5H7z"},child:[]}]})(t)}function dF(t){return Mt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M16.5 12A4.5 4.5 0 0 0 14 7.97v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51A8.796 8.796 0 0 0 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3 3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06a8.99 8.99 0 0 0 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4 9.91 6.09 12 8.18V4z"},child:[]}]})(t)}function fF(t){return Mt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M3 9v6h4l5 5V4L7 9H3zm13.5 3A4.5 4.5 0 0 0 14 7.97v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"},child:[]}]})(t)}function hF(t){return Mt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z",opacity:".1"},child:[]},{tag:"path",attr:{d:"M21 3H3c-1.1 0-2 .9-2 2v3h2V5h18v14h-7v2h7c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM1 18v3h3c0-1.66-1.34-3-3-3zm0-4v2c2.76 0 5 2.24 5 5h2c0-3.87-3.13-7-7-7zm0-4v2a9 9 0 0 1 9 9h2c0-6.08-4.93-11-11-11z"},child:[]}]})(t)}function pF(t){return Mt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 3a9 9 0 0 0-9 9v7c0 1.1.9 2 2 2h4v-8H5v-1c0-3.87 3.13-7 7-7s7 3.13 7 7v1h-4v8h4c1.1 0 2-.9 2-2v-7a9 9 0 0 0-9-9z"},child:[]}]})(t)}function mF(t){return Mt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M3 5H1v16c0 1.1.9 2 2 2h16v-2H3V5zm18-4H7c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V3c0-1.1-.9-2-2-2zm0 16H7V3h14v14z"},child:[]}]})(t)}function vw(t){return Mt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"},child:[]}]})(t)}function gF(t){return Mt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12z"},child:[]}]})(t)}function vF(t){return Mt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M10 6 8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"},child:[]}]})(t)}function yF(t){return Mt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3z"},child:[]}]})(t)}function xF(t){return Mt({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"},child:[]}]})(t)}const Bf=({icon:t,values:e,selectedValue:r,canDeselect:n,setSelectedValue:i})=>{const[s,a]=L.useState(!1),o=L.useRef(null),l=()=>{a(!s)},u=c=>{n&&(r==null?void 0:r.id)===c.id?i(null):i(c),a(!1)};return L.useEffect(()=>{const c=d=>{o.current&&!o.current.contains(d.target)&&a(!1)};return document.addEventListener("click",c),()=>{document.removeEventListener("click",c)}},[]),E.jsxs("div",{className:"relative hover:bg-neutral-700 p-1 rounded",ref:o,children:[E.jsx("button",{className:"py-1 rounded flex items-center gap-2",onClick:l,children:t!==void 0&&t}),s&&E.jsx("ul",{className:"absolute bottom-[120%] min-w-fit w-full right-0 bg-neutral-800 border border-neutral-700 rounded mt-2",children:e.map(c=>E.jsxs("li",{className:"px-4 py-2 cursor-pointer hover:bg-neutral-700 w-full flex gap-2 items-center justify-start overflow-visible text-nowrap",onClick:()=>u(c),children:[c.id!==(r==null?void 0:r.id)&&t,c.id===(r==null?void 0:r.id)&&E.jsx(vw,{}),c.name||`${c.height}p`]},c.id))})]})},SF=({icon:t,seasons:e=[],currentEpisodeId:r,onSelect:n})=>{const[i,s]=L.useState(!1),[a,o]=L.useState(null),[l,u]=L.useState(null),c=L.useRef(null),d=p=>{p.stopPropagation(),s(!i)},f=(p,v)=>{p.stopPropagation(),o(v)},m=(p,v)=>{p.stopPropagation(),u(v),n(v),s(!1)},h=p=>{p.stopPropagation(),o(null)};return L.useEffect(()=>{const p=v=>{c.current&&!c.current.contains(v.target)&&s(!1)};return document.addEventListener("click",p),()=>{document.removeEventListener("click",p)}},[]),E.jsxs("section",{className:"relative","aria-label":"Episode selector",ref:c,children:[E.jsxs("button",{className:"p-2 rounded flex items-center gap-2 hover:bg-neutral-700",onClick:d,"aria-haspopup":"true","aria-expanded":i,children:[t,!t&&E.jsx("span",{className:"sr-only",children:"Select episode:"})]}),i&&E.jsx("section",{className:"absolute bottom-full right-0 mb-2 bg-neutral-800 border border-neutral-700 rounded shadow-lg max-h-[300px] overflow-y-auto w-auto",role:"menu",onClick:p=>p.stopPropagation(),children:a?E.jsxs("ul",{className:"py-2",role:"list",children:[E.jsxs("li",{className:"px-4 py-2 cursor-pointer hover:bg-neutral-700 flex items-center",onClick:h,role:"menuitem",children:[E.jsx(gF,{className:"h-4 w-4 mr-2","aria-hidden":"true"}),"Back to Seasons"]}),a.episodes.map(p=>E.jsxs("li",{className:"px-4 py-2 cursor-pointer hover:bg-neutral-700 flex gap-4 items-center min-w-max",onClick:v=>m(v,p),role:"menuitem",children:[(l==null?void 0:l.id)===p.id||r===p.id?E.jsx(vw,{className:"h-4 w-4","aria-hidden":"true"}):E.jsx("section",{className:"h-4 w-4"}),E.jsx("img",{src:p.images.banner,alt:p.title,className:"w-16 h-9 rounded-md"}),E.jsxs("span",{className:"text-nowrap",children:["Episode ",p.number,": ",p.title]})]},p.id))]}):E.jsx("ul",{className:"py-2",role:"list",children:e.length>0?e.map(p=>E.jsxs("li",{className:"px-4 py-2 cursor-pointer hover:bg-neutral-700 flex justify-between items-center",onClick:v=>f(v,p),role:"menuitem",children:[E.jsxs("span",{className:"text-nowrap",children:["Season ",p.season_number]}),E.jsx(vF,{className:"h-4 w-4","aria-hidden":"true"})]},p.season_id)):E.jsx("li",{className:"px-4 py-2 text-neutral-400",role:"menuitem",children:"No seasons available"})})})]})},EF=()=>{var tn,jn,rn,xn,nt,Gr;const t=L.useRef(null),e=L.useRef(null),r=L.useRef(null),[n,i]=L.useState(0),[s,a]=L.useState(null),[o,l]=L.useState([]),[u,c]=L.useState([]),[d,f]=L.useState([]),[m,h]=L.useState(null),[p,v]=L.useState(null),[g,y]=L.useState(null),[x,S]=L.useState(!0),[T,C]=L.useState(!1),[_,b]=L.useState(!1),[I,A]=L.useState(1),[k,O]=L.useState(I),{id:P,type:G}=VS(),K=Br(),{data:H}=ur(`/api/medias/media/${G}/${P}`);let se;const W=L.useCallback(Ae=>{K(`/watch/${G}/${Ae.id}`)},[K,G]),F=Ae=>{if(!Ae)return"0:00";const qe=Math.floor(Ae/3600),R=Math.floor((Ae-qe*3600)/60),N=Math.floor(Ae-qe*3600-R*60),$=String(N).padStart(2,"0"),re=String(R).padStart(2,"0"),Z=String(qe).padStart(2,"0");return qe>0?`${Z}:${re}:${$}`:R>0?`${re}:${$}`:`00:${$}`},{updateProfileData:j,updateAccessToken:te}=Ua();L.useEffect(()=>{var qe;i(0),S(!0),l([]),c([]),f([]),h(null),v(null),y(null),s&&(s.destroy(),a(null)),t.current&&(t.current.src="",t.current.load());let Ae=`/api/watch/${G}/${P}`;if((qe=H==null?void 0:H.data)!=null&&qe._source&&(Ae=H.data._source),t.current)if(kr.isSupported()){const R=new kr({xhrSetup:(N,$)=>{var re;N.open("GET",$,!0),$.includes("")&&(N.setRequestHeader("Authorization",`Bearer ${localStorage.getItem("access_token")}`),N.setRequestHeader("X-Current-Time",String(((re=t.current)==null?void 0:re.currentTime)||0))),N.onreadystatechange=async()=>{var Z;if(N.readyState===4&&N.status===200)try{if(JSON.parse(N.responseText).code===246){const oe=await(await fetch("/api/auth/refresh",{method:"POST",body:JSON.stringify({refresh_token:localStorage.getItem("refresh_token")}),headers:{"Content-Type":"application/json"}})).json();if(oe.error){K("/login");return}else{let xe=oe.data.access_token;localStorage.setItem("access_token",xe),te(oe.data.access_token),j(oe.data.user),N.open("GET",$,!0),$.includes("")&&(N.setRequestHeader("Authorization",`Bearer ${xe}`),N.setRequestHeader("X-Current-Time",String(((Z=t.current)==null?void 0:Z.currentTime)||0))),N.send()}}}catch(X){console.error(`Error parsing response: ${X}`)}}}});R.loadSource(Ae),R.attachMedia(t.current),R.on(kr.Events.MANIFEST_PARSED,()=>{var N;(N=t.current)==null||N.play()}),R.on(kr.Events.AUDIO_TRACKS_UPDATED,()=>{l(R.audioTracks);let N=R.audioTracks.find($=>$.default);N||(N=R.audioTracks[0]),h(N)}),R.on(kr.Events.SUBTITLE_TRACKS_UPDATED,()=>{c(R.subtitleTracks)}),R.on(kr.Events.BUFFER_CREATED,()=>{S(!0)}),R.on(kr.Events.FRAG_BUFFERED,()=>{S(!1)}),t.current.addEventListener("timeupdate",()=>{var $;i((($=t.current)==null?void 0:$.currentTime)||0);let N=R.levels;N.find(re=>re.height===-1)===void 0&&N.push({height:-1,name:"auto"}),f(N)}),a(R)}else t.current.canPlayType("application/vnd.apple.mpegurl")&&(t.current.src=Ae);return()=>{s&&s.destroy()}},[P,G,(tn=H==null?void 0:H.data)==null?void 0:tn._source]),L.useEffect(()=>{if(!t.current)return;const Ae=()=>{var R;(R=H==null?void 0:H.data)!=null&&R.last_duration&&t.current&&(t.current.currentTime=H.data.last_duration,t.current.play())},qe=()=>{t.current&&t.current.play()};return t.current.addEventListener("loadedmetadata",Ae),t.current.addEventListener("loadeddata",qe),()=>{t.current&&(t.current.removeEventListener("loadedmetadata",Ae),t.current.removeEventListener("loadeddata",qe))}},[(jn=H==null?void 0:H.data)==null?void 0:jn.last_duration]),L.useEffect(()=>{const Ae=localStorage.getItem("video-volume");if(Ae&&t.current){const qe=Number(Ae);A(qe),t.current.volume=qe}},[]);const ee=Ae=>{t.current&&(t.current.currentTime=Number(Ae.target.value),i(Number(Ae.target.value)))},fe=Ae=>{const qe=Number(Ae.target.value);A(qe),t.current&&(t.current.volume=qe),localStorage.setItem("video-volume",String(qe))};L.useEffect(()=>{if(s){if(m)try{s.audioTrack=s.audioTracks.findIndex(Ae=>Ae.id===m.id)}catch{}p?s.subtitleTrack=s.subtitleTracks.findIndex(Ae=>Ae.id===p.id):s.subtitleTrack=-1,g&&(s.currentLevel=s.levels.findIndex(Ae=>Ae.height===g.height))}},[m,p,g,s]);const ye=()=>{e.current&&(_?document.exitFullscreen():e.current.requestFullscreen().catch(Ae=>console.log(Ae)),b(!_))},Re=()=>{C(!0),clearTimeout(se),se=setTimeout(()=>{var Ae;(Ae=r.current)!=null&&Ae.matches(":hover")||C(!1)},5e3)},Ee=()=>{I>0?(O(I),A(0),t.current&&(t.current.volume=0)):(A(k),t.current&&(t.current.volume=k))},Fe=()=>{if(s){const Ae=s.subtitleTrack===-1?0:-1;s.subtitleTrack=Ae}},st=L.useCallback(Ae=>{var qe,R;if(t.current)switch(Ae.key){case"f":ye();break;case"m":Ee();break;case"c":Fe();break;case" ":Ae.preventDefault(),t.current.paused?t.current.play():t.current.pause();break;case"ArrowLeft":t.current.currentTime=Math.max(0,t.current.currentTime-10);break;case"ArrowRight":t.current.currentTime=Math.min(t.current.duration,t.current.currentTime+10);break;case"ArrowUp":A(N=>{const $=Math.min(1,N+.05);return t.current&&(t.current.volume=$),$});break;case"ArrowDown":A(N=>{const $=Math.max(0,N-.05);return t.current&&(t.current.volume=$),$});break;case"PageUp":(qe=H==null?void 0:H.data)!=null&&qe._next&&K(`/watch/${G}/${H.data._next}`);break;case"PageDown":(R=H==null?void 0:H.data)!=null&&R._previous&&K(`/watch/${G}/${H.data._previous}`);break}},[ye,Ee,Fe]);L.useEffect(()=>(document.addEventListener("keydown",st),()=>{document.removeEventListener("keydown",st)}),[st]);const br=()=>I===0?E.jsx(dF,{}):I<=.3?E.jsx(cF,{}):I<=.6?E.jsx(uF,{}):E.jsx(fF,{});return E.jsxs("section",{className:`bg-black relative ${T?"":"cursor-none"}`,ref:e,onMouseMove:Re,children:[E.jsx("video",{ref:t,className:"w-full h-screen"},P),E.jsx(_s,{className:`top-0 left-0 fixed h-screen w-screen transition-all duration-300 pointer-events-none z-50 ${x?"opacity-100":"opacity-0"}`}),E.jsx("section",{className:`absolute bottom-0 w-full flex flex-col justify-end z-20 ${T?"opacity-100":"opacity-0"} transition-opacity duration-300`,ref:r,children:E.jsxs("section",{className:"flex items-center justify-between px-4 py-2 bg-neutral-800 bg-opacity-75 gap-4",children:[E.jsx("button",{onClick:()=>{var Ae,qe,R;return(Ae=t.current)!=null&&Ae.paused?(qe=t.current)==null?void 0:qe.play():(R=t.current)==null?void 0:R.pause()},className:"hover:bg-neutral-700 p-1 rounded",children:(rn=t.current)!=null&&rn.paused?E.jsx(aF,{}):E.jsx(sF,{})}),E.jsx("div",{className:"volume-hover relative group flex items-center",children:E.jsxs("div",{className:"flex items-center group-hover:bg-neutral-700 p-1 rounded relative",children:[E.jsx("button",{className:"flex items-center",title:"Volume",onClick:Ee,children:br()}),E.jsx("input",{type:"range",min:0,max:1,step:.01,value:I,onChange:fe,className:"volume-slider"})]})}),E.jsx("input",{type:"range",className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700",min:0,max:((xn=t.current)==null?void 0:xn.duration)||0,value:n,onChange:ee}),E.jsxs("span",{children:[F(n),"/",F((nt=t.current)==null?void 0:nt.duration)]}),E.jsxs("section",{className:"flex gap-2 items-center",children:[(o==null?void 0:o.length)>1&&E.jsx(Bf,{icon:E.jsx(pF,{}),values:o,selectedValue:m,setSelectedValue:h}),(u==null?void 0:u.length)>0&&E.jsx(Bf,{icon:E.jsx(lF,{}),values:u,selectedValue:p,setSelectedValue:v,canDeselect:!0}),((Gr=H==null?void 0:H.data)==null?void 0:Gr.serie_representation)&&E.jsx(SF,{seasons:H.data.serie_representation,onSelect:W,icon:E.jsx(mF,{}),currentEpisodeId:parseInt(P||"0")}),E.jsx(Bf,{icon:E.jsx(oF,{}),values:d,selectedValue:g,setSelectedValue:y}),E.jsx("button",{className:"hover:bg-neutral-700 p-1 rounded",children:E.jsx(hF,{})}),E.jsx("button",{onClick:ye,className:"hover:bg-neutral-700 p-1 rounded",children:_?E.jsx(yF,{}):E.jsx(xF,{})})]})]})})]})};var me={},op={exports:{}};(function(t,e){(function(r,n){var i="1.0.38",s="",a="?",o="function",l="undefined",u="object",c="string",d="major",f="model",m="name",h="type",p="vendor",v="version",g="architecture",y="console",x="mobile",S="tablet",T="smarttv",C="wearable",_="embedded",b=500,I="Amazon",A="Apple",k="ASUS",O="BlackBerry",P="Browser",G="Chrome",K="Edge",H="Firefox",se="Google",W="Huawei",F="LG",j="Microsoft",te="Motorola",ee="Opera",fe="Samsung",ye="Sharp",Re="Sony",Ee="Xiaomi",Fe="Zebra",st="Facebook",br="Chromium OS",tn="Mac OS",jn=function(oe,xe){var ce={};for(var Ge in oe)xe[Ge]&&xe[Ge].length%2===0?ce[Ge]=xe[Ge].concat(oe[Ge]):ce[Ge]=oe[Ge];return ce},rn=function(oe){for(var xe={},ce=0;ce<oe.length;ce++)xe[oe[ce].toUpperCase()]=oe[ce];return xe},xn=function(oe,xe){return typeof oe===c?nt(xe).indexOf(nt(oe))!==-1:!1},nt=function(oe){return oe.toLowerCase()},Gr=function(oe){return typeof oe===c?oe.replace(/[^\d\.]/g,s).split(".")[0]:n},Ae=function(oe,xe){if(typeof oe===c)return oe=oe.replace(/^\s\s*/,s),typeof xe===l?oe:oe.substring(0,b)},qe=function(oe,xe){for(var ce=0,Ge,nr,mt,Pe,Le,Nt;ce<xe.length&&!Le;){var Xi=xe[ce],hr=xe[ce+1];for(Ge=nr=0;Ge<Xi.length&&!Le&&Xi[Ge];)if(Le=Xi[Ge++].exec(oe),Le)for(mt=0;mt<hr.length;mt++)Nt=Le[++nr],Pe=hr[mt],typeof Pe===u&&Pe.length>0?Pe.length===2?typeof Pe[1]==o?this[Pe[0]]=Pe[1].call(this,Nt):this[Pe[0]]=Pe[1]:Pe.length===3?typeof Pe[1]===o&&!(Pe[1].exec&&Pe[1].test)?this[Pe[0]]=Nt?Pe[1].call(this,Nt,Pe[2]):n:this[Pe[0]]=Nt?Nt.replace(Pe[1],Pe[2]):n:Pe.length===4&&(this[Pe[0]]=Nt?Pe[3].call(this,Nt.replace(Pe[1],Pe[2])):n):this[Pe]=Nt||n;ce+=2}},R=function(oe,xe){for(var ce in xe)if(typeof xe[ce]===u&&xe[ce].length>0){for(var Ge=0;Ge<xe[ce].length;Ge++)if(xn(xe[ce][Ge],oe))return ce===a?n:ce}else if(xn(xe[ce],oe))return ce===a?n:ce;return oe},N={"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"},$={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},re={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[v,[m,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[v,[m,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[m,v],[/opios[\/ ]+([\w\.]+)/i],[v,[m,ee+" Mini"]],[/\bop(?:rg)?x\/([\w\.]+)/i],[v,[m,ee+" GX"]],[/\bopr\/([\w\.]+)/i],[v,[m,ee]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[v,[m,"Baidu"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim)\s?(?:browser)?[\/ ]?([\w\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[m,v],[/\bddg\/([\w\.]+)/i],[v,[m,"DuckDuckGo"]],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[v,[m,"UC"+P]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[v,[m,"WeChat"]],[/konqueror\/([\w\.]+)/i],[v,[m,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[v,[m,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[v,[m,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[v,[m,"Smart Lenovo "+P]],[/(avast|avg)\/([\w\.]+)/i],[[m,/(.+)/,"$1 Secure "+P],v],[/\bfocus\/([\w\.]+)/i],[v,[m,H+" Focus"]],[/\bopt\/([\w\.]+)/i],[v,[m,ee+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[v,[m,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[v,[m,"Dolphin"]],[/coast\/([\w\.]+)/i],[v,[m,ee+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[v,[m,"MIUI "+P]],[/fxios\/([-\w\.]+)/i],[v,[m,H]],[/\bqihu|(qi?ho?o?|360)browser/i],[[m,"360 "+P]],[/(oculus|sailfish|huawei|vivo)browser\/([\w\.]+)/i],[[m,/(.+)/,"$1 "+P],v],[/samsungbrowser\/([\w\.]+)/i],[v,[m,fe+" Internet"]],[/(comodo_dragon)\/([\w\.]+)/i],[[m,/_/g," "],v],[/metasr[\/ ]?([\d\.]+)/i],[v,[m,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[m,"Sogou Mobile"],v],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345Explorer)[\/ ]?([\w\.]+)/i],[m,v],[/(lbbrowser)/i,/\[(linkedin)app\]/i],[m],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[m,st],v],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(twitter)(?:and| f.+e\/([\w\.]+))/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[m,v],[/\bgsa\/([\w\.]+) .*safari\//i],[v,[m,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[v,[m,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[v,[m,G+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[m,G+" WebView"],v],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[v,[m,"Android "+P]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[m,v],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[v,[m,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[v,m],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[m,[v,R,N]],[/(webkit|khtml)\/([\w\.]+)/i],[m,v],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[m,"Netscape"],v],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[v,[m,H+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[m,v],[/(cobalt)\/([\w\.]+)/i],[m,[v,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[g,"amd64"]],[/(ia32(?=;))/i],[[g,nt]],[/((?:i[346]|x)86)[;\)]/i],[[g,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[g,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[g,"armhf"]],[/windows (ce|mobile); ppc;/i],[[g,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[g,/ower/,s,nt]],[/(sun4\w)[;\)]/i],[[g,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[g,nt]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[f,[p,fe],[h,S]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[f,[p,fe],[h,x]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[f,[p,A],[h,x]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[f,[p,A],[h,S]],[/(macintosh);/i],[f,[p,A]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[f,[p,ye],[h,x]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[f,[p,W],[h,S]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[f,[p,W],[h,x]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[f,/_/g," "],[p,Ee],[h,x]],[/oid[^\)]+; (2\d{4}(283|rpbf)[cgl])( bui|\))/i,/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[f,/_/g," "],[p,Ee],[h,S]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[f,[p,"OPPO"],[h,x]],[/\b(opd2\d{3}a?) bui/i],[f,[p,"OPPO"],[h,S]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[f,[p,"Vivo"],[h,x]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[f,[p,"Realme"],[h,x]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[f,[p,te],[h,x]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[f,[p,te],[h,S]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[f,[p,F],[h,S]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[f,[p,F],[h,x]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[f,[p,"Lenovo"],[h,S]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[f,/_/g," "],[p,"Nokia"],[h,x]],[/(pixel c)\b/i],[f,[p,se],[h,S]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[f,[p,se],[h,x]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[f,[p,Re],[h,x]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[f,"Xperia Tablet"],[p,Re],[h,S]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[f,[p,"OnePlus"],[h,x]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[f,[p,I],[h,S]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[f,/(.+)/g,"Fire Phone $1"],[p,I],[h,x]],[/(playbook);[-\w\),; ]+(rim)/i],[f,p,[h,S]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[f,[p,O],[h,x]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[f,[p,k],[h,S]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[f,[p,k],[h,x]],[/(nexus 9)/i],[f,[p,"HTC"],[h,S]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[p,[f,/_/g," "],[h,x]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[f,[p,"Acer"],[h,S]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[f,[p,"Meizu"],[h,x]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[f,[p,"Ulefone"],[h,x]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[p,f,[h,x]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[p,f,[h,S]],[/(surface duo)/i],[f,[p,j],[h,S]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[f,[p,"Fairphone"],[h,x]],[/(u304aa)/i],[f,[p,"AT&T"],[h,x]],[/\bsie-(\w*)/i],[f,[p,"Siemens"],[h,x]],[/\b(rct\w+) b/i],[f,[p,"RCA"],[h,S]],[/\b(venue[\d ]{2,7}) b/i],[f,[p,"Dell"],[h,S]],[/\b(q(?:mv|ta)\w+) b/i],[f,[p,"Verizon"],[h,S]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[f,[p,"Barnes & Noble"],[h,S]],[/\b(tm\d{3}\w+) b/i],[f,[p,"NuVision"],[h,S]],[/\b(k88) b/i],[f,[p,"ZTE"],[h,S]],[/\b(nx\d{3}j) b/i],[f,[p,"ZTE"],[h,x]],[/\b(gen\d{3}) b.+49h/i],[f,[p,"Swiss"],[h,x]],[/\b(zur\d{3}) b/i],[f,[p,"Swiss"],[h,S]],[/\b((zeki)?tb.*\b) b/i],[f,[p,"Zeki"],[h,S]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[p,"Dragon Touch"],f,[h,S]],[/\b(ns-?\w{0,9}) b/i],[f,[p,"Insignia"],[h,S]],[/\b((nxa|next)-?\w{0,9}) b/i],[f,[p,"NextBook"],[h,S]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[p,"Voice"],f,[h,x]],[/\b(lvtel\-)?(v1[12]) b/i],[[p,"LvTel"],f,[h,x]],[/\b(ph-1) /i],[f,[p,"Essential"],[h,x]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[f,[p,"Envizen"],[h,S]],[/\b(trio[-\w\. ]+) b/i],[f,[p,"MachSpeed"],[h,S]],[/\btu_(1491) b/i],[f,[p,"Rotor"],[h,S]],[/(shield[\w ]+) b/i],[f,[p,"Nvidia"],[h,S]],[/(sprint) (\w+)/i],[p,f,[h,x]],[/(kin\.[onetw]{3})/i],[[f,/\./g," "],[p,j],[h,x]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[f,[p,Fe],[h,S]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[f,[p,Fe],[h,x]],[/smart-tv.+(samsung)/i],[p,[h,T]],[/hbbtv.+maple;(\d+)/i],[[f,/^/,"SmartTV"],[p,fe],[h,T]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[p,F],[h,T]],[/(apple) ?tv/i],[p,[f,A+" TV"],[h,T]],[/crkey/i],[[f,G+"cast"],[p,se],[h,T]],[/droid.+aft(\w+)( bui|\))/i],[f,[p,I],[h,T]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[f,[p,ye],[h,T]],[/(bravia[\w ]+)( bui|\))/i],[f,[p,Re],[h,T]],[/(mitv-\w{5}) bui/i],[f,[p,Ee],[h,T]],[/Hbbtv.*(technisat) (.*);/i],[p,f,[h,T]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[p,Ae],[f,Ae],[h,T]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[h,T]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[p,f,[h,y]],[/droid.+; (shield) bui/i],[f,[p,"Nvidia"],[h,y]],[/(playstation [345portablevi]+)/i],[f,[p,Re],[h,y]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[f,[p,j],[h,y]],[/((pebble))app/i],[p,f,[h,C]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[f,[p,A],[h,C]],[/droid.+; (glass) \d/i],[f,[p,se],[h,C]],[/droid.+; (wt63?0{2,3})\)/i],[f,[p,Fe],[h,C]],[/(quest( \d| pro)?)/i],[f,[p,st],[h,C]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[p,[h,_]],[/(aeobc)\b/i],[f,[p,I],[h,_]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[f,[h,x]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[f,[h,S]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[h,S]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[h,x]],[/(android[-\w\. ]{0,9});.+buil/i],[f,[p,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[v,[m,K+"HTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[v,[m,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[m,v],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[v,m]],os:[[/microsoft (windows) (vista|xp)/i],[m,v],[/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i],[m,[v,R,$]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[v,R,$],[m,"Windows"]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[v,/_/g,"."],[m,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[m,tn],[v,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[v,m],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[m,v],[/\(bb(10);/i],[v,[m,O]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[v,[m,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[v,[m,H+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[v,[m,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[v,[m,"watchOS"]],[/crkey\/([\d\.]+)/i],[v,[m,G+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[m,br],v],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[m,v],[/(sunos) ?([\w\.\d]*)/i],[[m,"Solaris"],v],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[m,v]]},Z=function(oe,xe){if(typeof oe===u&&(xe=oe,oe=n),!(this instanceof Z))return new Z(oe,xe).getResult();var ce=typeof r!==l&&r.navigator?r.navigator:n,Ge=oe||(ce&&ce.userAgent?ce.userAgent:s),nr=ce&&ce.userAgentData?ce.userAgentData:n,mt=xe?jn(re,xe):re,Pe=ce&&ce.userAgent==Ge;return this.getBrowser=function(){var Le={};return Le[m]=n,Le[v]=n,qe.call(Le,Ge,mt.browser),Le[d]=Gr(Le[v]),Pe&&ce&&ce.brave&&typeof ce.brave.isBrave==o&&(Le[m]="Brave"),Le},this.getCPU=function(){var Le={};return Le[g]=n,qe.call(Le,Ge,mt.cpu),Le},this.getDevice=function(){var Le={};return Le[p]=n,Le[f]=n,Le[h]=n,qe.call(Le,Ge,mt.device),Pe&&!Le[h]&&nr&&nr.mobile&&(Le[h]=x),Pe&&Le[f]=="Macintosh"&&ce&&typeof ce.standalone!==l&&ce.maxTouchPoints&&ce.maxTouchPoints>2&&(Le[f]="iPad",Le[h]=S),Le},this.getEngine=function(){var Le={};return Le[m]=n,Le[v]=n,qe.call(Le,Ge,mt.engine),Le},this.getOS=function(){var Le={};return Le[m]=n,Le[v]=n,qe.call(Le,Ge,mt.os),Pe&&!Le[m]&&nr&&nr.platform&&nr.platform!="Unknown"&&(Le[m]=nr.platform.replace(/chrome os/i,br).replace(/macos/i,tn)),Le},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return Ge},this.setUA=function(Le){return Ge=typeof Le===c&&Le.length>b?Ae(Le,b):Le,this},this.setUA(Ge),this};Z.VERSION=i,Z.BROWSER=rn([m,v,d]),Z.CPU=rn([g]),Z.DEVICE=rn([f,p,h,y,x,T,S,C,_]),Z.ENGINE=Z.OS=rn([m,v]),t.exports&&(e=t.exports=Z),e.UAParser=Z;var X=typeof r!==l&&(r.jQuery||r.Zepto);if(X&&!X.ua){var ge=new Z;X.ua=ge.getResult(),X.ua.get=function(){return ge.getUA()},X.ua.set=function(oe){ge.setUA(oe);var xe=ge.getResult();for(var ce in xe)X.ua[ce]=xe[ce]}}})(typeof window=="object"?window:wb)})(op,op.exports);var TF=op.exports;Object.defineProperty(me,"__esModule",{value:!0});function wF(t){return t&&typeof t=="object"&&"default"in t?t.default:t}var Jt=L,ut=wF(Jt),yw=TF,Yi=new yw,rr=Yi.getBrowser(),bF=Yi.getCPU(),Vr=Yi.getDevice(),Gm=Yi.getEngine(),qi=Yi.getOS(),bl=Yi.getUA(),xw=function(e){return Yi.setUA(e)},Ll=function(e){if(!e){console.error("No userAgent string was provided");return}var r=new yw(e);return{UA:r,browser:r.getBrowser(),cpu:r.getCPU(),device:r.getDevice(),engine:r.getEngine(),os:r.getOS(),ua:r.getUA(),setUserAgent:function(i){return r.setUA(i)}}},Sw=Object.freeze({ClientUAInstance:Yi,browser:rr,cpu:bF,device:Vr,engine:Gm,os:qi,ua:bl,setUa:xw,parseUserAgent:Ll});function cy(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function LF(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?cy(Object(r),!0).forEach(function(n){RF(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):cy(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Ro(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Ro=function(e){return typeof e}:Ro=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ro(t)}function AF(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _F(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function CF(t,e,r){return e&&_F(t.prototype,e),t}function RF(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lp(){return lp=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},lp.apply(this,arguments)}function IF(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&cp(t,e)}function up(t){return up=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},up(t)}function cp(t,e){return cp=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},cp(t,e)}function kF(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,s;for(s=0;s<n.length;s++)i=n[s],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function en(t,e){if(t==null)return{};var r=kF(t,e),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function ju(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function DF(t,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ju(t)}function PF(t,e){return OF(t)||MF(t,e)||NF(t,e)||FF()}function OF(t){if(Array.isArray(t))return t}function MF(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n=[],i=!0,s=!1,a,o;try{for(r=r.call(t);!(i=(a=r.next()).done)&&(n.push(a.value),!(e&&n.length===e));i=!0);}catch(l){s=!0,o=l}finally{try{!i&&r.return!=null&&r.return()}finally{if(s)throw o}}return n}}function NF(t,e){if(t){if(typeof t=="string")return dy(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dy(t,e)}}function dy(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function FF(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Zt={Mobile:"mobile",Tablet:"tablet",SmartTv:"smarttv",Console:"console",Wearable:"wearable",Embedded:"embedded",Browser:void 0},wr={Chrome:"Chrome",Firefox:"Firefox",Opera:"Opera",Yandex:"Yandex",Safari:"Safari",InternetExplorer:"Internet Explorer",Edge:"Edge",Chromium:"Chromium",Ie:"IE",MobileSafari:"Mobile Safari",EdgeChromium:"Edge Chromium",MIUI:"MIUI Browser",SamsungBrowser:"Samsung Browser"},ja={IOS:"iOS",Android:"Android",WindowsPhone:"Windows Phone",Windows:"Windows",MAC_OS:"Mac OS"},UF={isMobile:!1,isTablet:!1,isBrowser:!1,isSmartTV:!1,isConsole:!1,isWearable:!1},BF=function(e){switch(e){case Zt.Mobile:return{isMobile:!0};case Zt.Tablet:return{isTablet:!0};case Zt.SmartTv:return{isSmartTV:!0};case Zt.Console:return{isConsole:!0};case Zt.Wearable:return{isWearable:!0};case Zt.Browser:return{isBrowser:!0};case Zt.Embedded:return{isEmbedded:!0};default:return UF}},$F=function(e){return xw(e)},De=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"none";return e||r},zm=function(){return typeof window<"u"&&(window.navigator||navigator)?window.navigator||navigator:!1},Hm=function(e){var r=zm();return r&&r.platform&&(r.platform.indexOf(e)!==-1||r.platform==="MacIntel"&&r.maxTouchPoints>1&&!window.MSStream)},jF=function(e,r,n,i,s){return{isBrowser:e,browserMajorVersion:De(r.major),browserFullVersion:De(r.version),browserName:De(r.name),engineName:De(n.name),engineVersion:De(n.version),osName:De(i.name),osVersion:De(i.version),userAgent:De(s)}},fy=function(e,r,n,i){return LF({},e,{vendor:De(r.vendor),model:De(r.model),os:De(n.name),osVersion:De(n.version),ua:De(i)})},VF=function(e,r,n,i){return{isSmartTV:e,engineName:De(r.name),engineVersion:De(r.version),osName:De(n.name),osVersion:De(n.version),userAgent:De(i)}},GF=function(e,r,n,i){return{isConsole:e,engineName:De(r.name),engineVersion:De(r.version),osName:De(n.name),osVersion:De(n.version),userAgent:De(i)}},zF=function(e,r,n,i){return{isWearable:e,engineName:De(r.name),engineVersion:De(r.version),osName:De(n.name),osVersion:De(n.version),userAgent:De(i)}},HF=function(e,r,n,i,s){return{isEmbedded:e,vendor:De(r.vendor),model:De(r.model),engineName:De(n.name),engineVersion:De(n.version),osName:De(i.name),osVersion:De(i.version),userAgent:De(s)}};function WF(t){var e=t?Ll(t):Sw,r=e.device,n=e.browser,i=e.engine,s=e.os,a=e.ua,o=BF(r.type),l=o.isBrowser,u=o.isMobile,c=o.isTablet,d=o.isSmartTV,f=o.isConsole,m=o.isWearable,h=o.isEmbedded;if(l)return jF(l,n,i,s,a);if(d)return VF(d,i,s,a);if(f)return GF(f,i,s,a);if(u||c)return fy(o,r,s,a);if(m)return zF(m,i,s,a);if(h)return HF(h,r,i,s,a)}var Ew=function(e){var r=e.type;return r===Zt.Mobile},Tw=function(e){var r=e.type;return r===Zt.Tablet},ww=function(e){var r=e.type;return r===Zt.Mobile||r===Zt.Tablet},bw=function(e){var r=e.type;return r===Zt.SmartTv},Wc=function(e){var r=e.type;return r===Zt.Browser},Lw=function(e){var r=e.type;return r===Zt.Wearable},Aw=function(e){var r=e.type;return r===Zt.Console},_w=function(e){var r=e.type;return r===Zt.Embedded},Cw=function(e){var r=e.vendor;return De(r)},Rw=function(e){var r=e.model;return De(r)},Iw=function(e){var r=e.type;return De(r,"browser")},kw=function(e){var r=e.name;return r===ja.Android},Dw=function(e){var r=e.name;return r===ja.Windows},Pw=function(e){var r=e.name;return r===ja.MAC_OS},Ow=function(e){var r=e.name;return r===ja.WindowsPhone},Mw=function(e){var r=e.name;return r===ja.IOS},Nw=function(e){var r=e.version;return De(r)},Fw=function(e){var r=e.name;return De(r)},Uw=function(e){var r=e.name;return r===wr.Chrome},Bw=function(e){var r=e.name;return r===wr.Firefox},$w=function(e){var r=e.name;return r===wr.Chromium},Kc=function(e){var r=e.name;return r===wr.Edge},jw=function(e){var r=e.name;return r===wr.Yandex},Vw=function(e){var r=e.name;return r===wr.Safari||r===wr.MobileSafari},Gw=function(e){var r=e.name;return r===wr.MobileSafari},zw=function(e){var r=e.name;return r===wr.Opera},Hw=function(e){var r=e.name;return r===wr.InternetExplorer||r===wr.Ie},Ww=function(e){var r=e.name;return r===wr.MIUI},Kw=function(e){var r=e.name;return r===wr.SamsungBrowser},Yw=function(e){var r=e.version;return De(r)},qw=function(e){var r=e.major;return De(r)},Xw=function(e){var r=e.name;return De(r)},Zw=function(e){var r=e.name;return De(r)},Qw=function(e){var r=e.version;return De(r)},Jw=function(){var e=zm(),r=e&&e.userAgent&&e.userAgent.toLowerCase();return typeof r=="string"?/electron/.test(r):!1},ha=function(e){return typeof e=="string"&&e.indexOf("Edg/")!==-1},eb=function(){var e=zm();return e&&(/iPad|iPhone|iPod/.test(e.platform)||e.platform==="MacIntel"&&e.maxTouchPoints>1)&&!window.MSStream},_n=function(){return Hm("iPad")},tb=function(){return Hm("iPhone")},rb=function(){return Hm("iPod")},nb=function(e){return De(e)};function ib(t){var e=t||Sw,r=e.device,n=e.browser,i=e.os,s=e.engine,a=e.ua;return{isSmartTV:bw(r),isConsole:Aw(r),isWearable:Lw(r),isEmbedded:_w(r),isMobileSafari:Gw(n)||_n(),isChromium:$w(n),isMobile:ww(r)||_n(),isMobileOnly:Ew(r),isTablet:Tw(r)||_n(),isBrowser:Wc(r),isDesktop:Wc(r),isAndroid:kw(i),isWinPhone:Ow(i),isIOS:Mw(i)||_n(),isChrome:Uw(n),isFirefox:Bw(n),isSafari:Vw(n),isOpera:zw(n),isIE:Hw(n),osVersion:Nw(i),osName:Fw(i),fullBrowserVersion:Yw(n),browserVersion:qw(n),browserName:Xw(n),mobileVendor:Cw(r),mobileModel:Rw(r),engineName:Zw(s),engineVersion:Qw(s),getUA:nb(a),isEdge:Kc(n)||ha(a),isYandex:jw(n),deviceType:Iw(r),isIOS13:eb(),isIPad13:_n(),isIPhone13:tb(),isIPod13:rb(),isElectron:Jw(),isEdgeChromium:ha(a),isLegacyEdge:Kc(n)&&!ha(a),isWindows:Dw(i),isMacOs:Pw(i),isMIUI:Ww(n),isSamsungBrowser:Kw(n)}}var sb=bw(Vr),ab=Aw(Vr),ob=Lw(Vr),KF=_w(Vr),YF=Gw(rr)||_n(),qF=$w(rr),bd=ww(Vr)||_n(),lb=Ew(Vr),ub=Tw(Vr)||_n(),cb=Wc(Vr),XF=Wc(Vr),db=kw(qi),fb=Ow(qi),hb=Mw(qi)||_n(),ZF=Uw(rr),QF=Bw(rr),JF=Vw(rr),e2=zw(rr),pb=Hw(rr),t2=Nw(qi),r2=Fw(qi),n2=Yw(rr),i2=qw(rr),s2=Xw(rr),a2=Cw(Vr),o2=Rw(Vr),l2=Zw(Gm),u2=Qw(Gm),c2=nb(bl),d2=Kc(rr)||ha(bl),f2=jw(rr),h2=Iw(Vr),p2=eb(),m2=_n(),g2=tb(),v2=rb(),y2=Jw(),x2=ha(bl),S2=Kc(rr)&&!ha(bl),E2=Dw(qi),T2=Pw(qi),w2=Ww(rr),b2=Kw(rr),L2=function(e){if(!e||typeof e!="string"){console.error("No valid user agent string was provided");return}var r=Ll(e),n=r.device,i=r.browser,s=r.os,a=r.engine,o=r.ua;return ib({device:n,browser:i,os:s,engine:a,ua:o})},A2=function(e){var r=e.renderWithFragment,n=e.children,i=en(e,["renderWithFragment","children"]);return db?r?ut.createElement(Jt.Fragment,null,n):ut.createElement("div",i,n):null},_2=function(e){var r=e.renderWithFragment,n=e.children,i=en(e,["renderWithFragment","children"]);return cb?r?ut.createElement(Jt.Fragment,null,n):ut.createElement("div",i,n):null},C2=function(e){var r=e.renderWithFragment,n=e.children,i=en(e,["renderWithFragment","children"]);return pb?r?ut.createElement(Jt.Fragment,null,n):ut.createElement("div",i,n):null},R2=function(e){var r=e.renderWithFragment,n=e.children,i=en(e,["renderWithFragment","children"]);return hb?r?ut.createElement(Jt.Fragment,null,n):ut.createElement("div",i,n):null},I2=function(e){var r=e.renderWithFragment,n=e.children,i=en(e,["renderWithFragment","children"]);return bd?r?ut.createElement(Jt.Fragment,null,n):ut.createElement("div",i,n):null},k2=function(e){var r=e.renderWithFragment,n=e.children,i=en(e,["renderWithFragment","children"]);return ub?r?ut.createElement(Jt.Fragment,null,n):ut.createElement("div",i,n):null},D2=function(e){var r=e.renderWithFragment,n=e.children,i=en(e,["renderWithFragment","children"]);return fb?r?ut.createElement(Jt.Fragment,null,n):ut.createElement("div",i,n):null},P2=function(e){var r=e.renderWithFragment,n=e.children;e.viewClassName,e.style;var i=en(e,["renderWithFragment","children","viewClassName","style"]);return lb?r?ut.createElement(Jt.Fragment,null,n):ut.createElement("div",i,n):null},O2=function(e){var r=e.renderWithFragment,n=e.children,i=en(e,["renderWithFragment","children"]);return sb?r?ut.createElement(Jt.Fragment,null,n):ut.createElement("div",i,n):null},M2=function(e){var r=e.renderWithFragment,n=e.children,i=en(e,["renderWithFragment","children"]);return ab?r?ut.createElement(Jt.Fragment,null,n):ut.createElement("div",i,n):null},N2=function(e){var r=e.renderWithFragment,n=e.children,i=en(e,["renderWithFragment","children"]);return ob?r?ut.createElement(Jt.Fragment,null,n):ut.createElement("div",i,n):null},F2=function(e){var r=e.renderWithFragment,n=e.children;e.viewClassName,e.style;var i=e.condition,s=en(e,["renderWithFragment","children","viewClassName","style","condition"]);return i?r?ut.createElement(Jt.Fragment,null,n):ut.createElement("div",s,n):null};function U2(t){return function(e){IF(r,e);function r(n){var i;return AF(this,r),i=DF(this,up(r).call(this,n)),i.isEventListenerAdded=!1,i.handleOrientationChange=i.handleOrientationChange.bind(ju(i)),i.onOrientationChange=i.onOrientationChange.bind(ju(i)),i.onPageLoad=i.onPageLoad.bind(ju(i)),i.state={isLandscape:!1,isPortrait:!1},i}return CF(r,[{key:"handleOrientationChange",value:function(){this.isEventListenerAdded||(this.isEventListenerAdded=!0);var i=window.innerWidth>window.innerHeight?90:0;this.setState({isPortrait:i===0,isLandscape:i===90})}},{key:"onOrientationChange",value:function(){this.handleOrientationChange()}},{key:"onPageLoad",value:function(){this.handleOrientationChange()}},{key:"componentDidMount",value:function(){(typeof window>"u"?"undefined":Ro(window))!==void 0&&bd&&(this.isEventListenerAdded?window.removeEventListener("load",this.onPageLoad,!1):(this.handleOrientationChange(),window.addEventListener("load",this.onPageLoad,!1)),window.addEventListener("resize",this.onOrientationChange,!1))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onOrientationChange,!1)}},{key:"render",value:function(){return ut.createElement(t,lp({},this.props,{isLandscape:this.state.isLandscape,isPortrait:this.state.isPortrait}))}}]),r}(ut.Component)}function B2(){var t=Jt.useState(function(){var s=window.innerWidth>window.innerHeight?90:0;return{isPortrait:s===0,isLandscape:s===90,orientation:s===0?"portrait":"landscape"}}),e=PF(t,2),r=e[0],n=e[1],i=Jt.useCallback(function(){var s=window.innerWidth>window.innerHeight?90:0,a={isPortrait:s===0,isLandscape:s===90,orientation:s===0?"portrait":"landscape"};r.orientation!==a.orientation&&n(a)},[r.orientation]);return Jt.useEffect(function(){return(typeof window>"u"?"undefined":Ro(window))!==void 0&&bd&&(i(),window.addEventListener("load",i,!1),window.addEventListener("resize",i,!1)),function(){window.removeEventListener("resize",i,!1),window.removeEventListener("load",i,!1)}},[i]),r}function mb(t){var e=t||window.navigator.userAgent;return Ll(e)}function $2(t){var e=t||window.navigator.userAgent,r=mb(e),n=ib(r);return[n,r]}me.AndroidView=A2;me.BrowserTypes=wr;me.BrowserView=_2;me.ConsoleView=M2;me.CustomView=F2;me.IEView=C2;me.IOSView=R2;me.MobileOnlyView=P2;me.MobileView=I2;me.OsTypes=ja;me.SmartTVView=O2;me.TabletView=k2;me.WearableView=N2;me.WinPhoneView=D2;me.browserName=s2;me.browserVersion=i2;me.deviceDetect=WF;me.deviceType=h2;me.engineName=l2;me.engineVersion=u2;me.fullBrowserVersion=n2;me.getSelectorsByUserAgent=L2;me.getUA=c2;me.isAndroid=db;me.isBrowser=cb;me.isChrome=ZF;me.isChromium=qF;me.isConsole=ab;me.isDesktop=XF;me.isEdge=d2;me.isEdgeChromium=x2;me.isElectron=y2;me.isEmbedded=KF;me.isFirefox=QF;me.isIE=pb;me.isIOS=hb;me.isIOS13=p2;me.isIPad13=m2;me.isIPhone13=g2;me.isIPod13=v2;me.isLegacyEdge=S2;me.isMIUI=w2;me.isMacOs=T2;var gb=me.isMobile=bd;me.isMobileOnly=lb;me.isMobileSafari=YF;me.isOpera=e2;me.isSafari=JF;me.isSamsungBrowser=b2;me.isSmartTV=sb;me.isTablet=ub;me.isWearable=ob;me.isWinPhone=fb;me.isWindows=E2;me.isYandex=f2;me.mobileModel=o2;me.mobileVendor=a2;me.osName=r2;me.osVersion=t2;me.parseUserAgent=Ll;me.setUserAgent=$F;me.useDeviceData=mb;me.useDeviceSelectors=$2;me.useMobileOrientation=B2;me.withOrientationChange=U2;function j2(t){return Mt({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M233.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 338.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z"},child:[]}]})(t)}const hy=()=>{const[t,e]=L.useState(!1),{profileData:r}=dm(),n=()=>{e(!1)};return E.jsxs("section",{className:"relative flex items-center gap-4",children:[E.jsx("img",{src:r==null?void 0:r.profile_picture,alt:r==null?void 0:r.name,className:"w-8 h-8 rounded-md"}),E.jsx(j2,{onClick:()=>e(!t),className:`cursor-pointer ${t?"transform -rotate-180":""} transition-transform duration-300`}),E.jsxs("ul",{className:`absolute top-[100%] right-0 bg-neutral-900 rounded-lg px-4 overflow-hidden ${t?"h-auto p-4":"h-0 p-0"} transition-all duration-300`,children:[E.jsx("li",{children:E.jsx(Lu,{to:"/profil",onClick:n,children:"Profil"})}),E.jsx("li",{children:E.jsx(Lu,{to:"/settings",onClick:n,children:"Settings"})}),E.jsx("li",{children:E.jsx(Lu,{to:"/logout",onClick:n,children:"Logout"})})]})]})};function V2(t){return Mt({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"},child:[]}]})(t)}const py=({onSearch:t})=>{const[e,r]=L.useState(""),n=Br(),i=a=>{r(a.target.value)},s=a=>{a.preventDefault(),t(e),n(`?query=${e}`)};return L.useEffect(()=>{const a=new URLSearchParams(window.location.search).get("query");a&&r(a)},[]),E.jsxs("form",{onSubmit:s,className:`flex gap-2 ${gb?"items-center":""}`,children:[E.jsx("input",{className:"w-48 sm:w-auto px-4 py-2 rounded-lg bg-neutral-900 focus:outline-none focus:ring-2 focus:ring-neutral-500",type:"text",placeholder:"Search...",value:e,onChange:i}),E.jsx("button",{type:"submit",children:E.jsx(V2,{})})]})},G2=()=>{const[t,e]=L.useState(!1),{setSearchTerm:r}=L.useContext(wl),n=Br(),i=s=>{r(s)};return gb?E.jsxs("section",{className:`${t?"overflow-hidden":""}`,children:[E.jsxs("section",{children:[E.jsxs("header",{className:"flex justify-between items-center py-4 px-8 text-white",children:[E.jsx("button",{onClick:()=>e(!t),className:"pointer-events-auto",children:E.jsxs("div",{className:`hamburger ${t?"active":""}`,children:[E.jsx("div",{className:"line"}),E.jsx("div",{className:"line"}),E.jsx("div",{className:"line"})]})}),E.jsx(py,{onSearch:i}),E.jsx(hy,{})]}),E.jsxs("aside",{className:`fixed pl-8 pt-4 flex flex-col gap-24 top-0 left-0 h-full bg-[--black] z-40 transform transition-transform duration-300 ease-in-out overflow-hidden w-full ${t?"translate-x-0":"-translate-x-full"}`,children:[E.jsxs("section",{className:"flex justify-between items-center py-4 pr-8",children:[E.jsx("img",{src:"/logo.png",alt:"Logo",className:"w-12 h-12"}),E.jsx("button",{onClick:()=>e(!t),className:"pointer-events-auto",children:E.jsxs("div",{className:`hamburger ${t?"active":""}`,children:[E.jsx("div",{className:"line"}),E.jsx("div",{className:"line"}),E.jsx("div",{className:"line"})]})})]}),E.jsxs("nav",{className:"flex flex-col gap-6",children:[E.jsx(qt,{onClick:()=>e(!1),className:"text-2xl",to:"/home",children:"Home"}),E.jsx(qt,{onClick:()=>e(!1),className:"text-2xl",to:"/movies",children:"Movies"}),E.jsx(qt,{onClick:()=>e(!1),className:"text-2xl",to:"/shows",children:"TV Shows"}),E.jsx(qt,{onClick:()=>e(!1),className:"text-2xl",to:"/live-tv",children:"Live TV"}),E.jsx(qt,{onClick:()=>e(!1),className:"text-2xl",to:"/musics",children:"Musics"}),E.jsx(qt,{onClick:()=>e(!1),className:"text-2xl",to:"/books",children:"Books"}),E.jsx(qt,{onClick:()=>e(!1),className:"text-2xl",to:"/games",children:"Games"}),E.jsx(qt,{onClick:()=>e(!1),className:"text-2xl",to:"/others",children:"Others"})]})]})]}),E.jsx(_0,{})]}):E.jsxs("section",{children:[E.jsxs("header",{className:"flex justify-between items-center py-4 px-16 text-white sticky top-0 left-0 w-full z-[99999]",children:[E.jsxs("section",{className:"flex gap-4 items-center",children:[E.jsx("img",{src:"/logo.png",alt:"Logo",className:"w-12 h-12 cursor-pointer",onClick:()=>n("/home")}),E.jsxs("nav",{className:"flex gap-4",children:[E.jsx(qt,{to:"/home",children:"Home"}),E.jsx(qt,{to:"/movies",children:"Movies"}),E.jsx(qt,{to:"/shows",children:"TV Shows"}),E.jsx(qt,{to:"/live-tv",children:"Live TV"}),E.jsx(qt,{to:"/musics",children:"Musics"}),E.jsx(qt,{to:"/books",children:"Books"}),E.jsx(qt,{to:"/games",children:"Games"}),E.jsx(qt,{to:"/others",children:"Others"})]})]}),E.jsxs("section",{className:"flex gap-8",children:[E.jsx(py,{onSearch:i}),E.jsx(hy,{})]})]}),E.jsx(_0,{})]})},my=({children:t})=>{const{data:e}=ur("/api/settings/libraries"),r=Br();return L.useEffect(()=>{e&&(!e.data||e.data.length==0)&&r("/settings#libraries")},[e]),E.jsxs(E.Fragment,{children:[E.jsx(G2,{}),E.jsx("main",{children:t})]})},z2=()=>{const[t,e]=L.useState(!0),[r,n]=L.useState(""),[i,s]=L.useState(""),[a,o]=L.useState(""),[l,u]=L.useState(""),[c,d]=L.useState(!1),{handleSubmit:f}=Ss(),m=async()=>{await f({url:"/api/settings/general",body:{ChocolateSettings:{language:r,allowdownload:c},APIKeys:{tmdb:i,igdbid:a,igdbsecret:l}}})},{data:h,loading:p}=ur("/api/settings/general"),{data:v,loading:g}=ur("/api/settings/languages");return L.useEffect(()=>{e(p&&g)},[p,g]),L.useEffect(()=>{h&&h.data&&h.data.ChocolateSettings&&h.data.APIKeys&&(n(h.data.ChocolateSettings.language),d(h.data.ChocolateSettings.allowdownload==="true"),s(h.data.APIKeys.tmdb),o(h.data.APIKeys.igdbid),u(h.data.APIKeys.igdbsecret))},[h]),E.jsxs(E.Fragment,{children:[E.jsx(_s,{className:"w-3/4 h-screen top-0 fixed bg-[--black] transition-all duration-300 pointer-events-none z-50 "+(t?"opacity-100":"opacity-0")}),E.jsx("h2",{className:`text-xl font-bold mb-4 ${t?"hidden":""}`,children:"General Settings"}),E.jsxs("div",{className:`flex flex-col items-start gap-6 px-8 ${t?"hidden":""}`,children:[E.jsxs("div",{className:"w-full max-w-md",children:[E.jsx("h2",{className:"text-xl font-bold mb-4",children:"Settings"}),E.jsxs("div",{className:"mb-4",children:[E.jsx("label",{htmlFor:"language-select",className:"block mb-2",children:"Language:"}),E.jsx("select",{id:"language-select",value:r,onChange:y=>n(y.target.value),className:"w-full px-4 py-2 rounded-lg bg-neutral-900 focus:outline-none focus:ring-2 focus:ring-neutral-500",children:v&&v.data&&v.data.map(y=>E.jsx("option",{value:y.code,children:y.name},y.code))})]}),E.jsxs("div",{className:"mb-4 flex items-center gap-4",children:[E.jsx("label",{htmlFor:"allow-downloads",className:"block",children:"Allow Downloads:"}),E.jsx("input",{type:"checkbox",id:"allow-downloads",checked:c,onChange:y=>d(y.target.checked),className:"w-4 h-4 rounded-lg bg-neutral-900 border-0 outline-none ring-0 focus:outline-none focus:ring-2 focus:ring-neutral-500"})]})]}),E.jsxs("div",{className:"w-full max-w-md",children:[E.jsx("h2",{className:"text-xl font-bold mb-4",children:"API Keys"}),E.jsxs("div",{className:"mb-4",children:[E.jsx("label",{htmlFor:"tmdb-api-key",className:"block mb-2",children:"TMDB API Key:"}),E.jsx("input",{type:"text",id:"tmdb-api-key",value:i,onChange:y=>s(y.target.value),placeholder:"afa...fdp",className:"w-full px-4 py-2 rounded-lg bg-neutral-900 focus:outline-none focus:ring-2 focus:ring-neutral-500"})]}),E.jsxs("div",{className:"mb-4",children:[E.jsx("label",{htmlFor:"igdb-id-key",className:"block mb-2",children:"IGDB ID Key:"}),E.jsx("input",{type:"text",id:"igdb-id-key",value:a,onChange:y=>o(y.target.value),placeholder:"161...b3f",className:"w-full px-4 py-2 rounded-lg bg-neutral-900 focus:outline-none focus:ring-2 focus:ring-neutral-500"})]}),E.jsxs("div",{className:"mb-4",children:[E.jsx("label",{htmlFor:"igdb-secret-key",className:"block mb-2",children:"IGDB Secret Key:"}),E.jsx("input",{type:"password",id:"igdb-secret-key",autoComplete:"new-password",value:l,onChange:y=>u(y.target.value),placeholder:"161...b3f",className:"w-full px-4 py-2 rounded-lg bg-neutral-900 focus:outline-none focus:ring-2 focus:ring-neutral-500"})]})]}),E.jsx(Rn,{state:"primary",onClick:m,children:"Save Settings"})]})]})},Ar=-161,H2=()=>{var h,p,v;const[t,e]=L.useState([]),[r,n]=L.useState(!0),{data:i,loading:s,fetchData:a}=ur("/api/settings/accounts"),{handleSubmit:o}=Ss(),{handleSubmit:l}=iE(),{handleSubmit:u}=sE();L.useEffect(()=>{i&&i.data&&e(i.data),n(s)},[i,s]),L.useEffect(()=>{t.find(y=>y.id===Ar)||e(y=>[...y,{id:Ar,name:"",account_type:"Admin"}])},[i,t]);const c=(g,y,x)=>{e(S=>S.map(T=>T.id===g?{...T,[y]:x}:T))},d=async g=>{await o({url:"/api/settings/accounts",body:g}),a()},f=async g=>{await l({url:"/api/settings/accounts",body:g}),a()},m=async()=>{const g=t.find(y=>y.id===Ar);g&&await u({url:"/api/settings/accounts",body:{...g}}),a(),c(Ar,"name",""),c(Ar,"password",""),c(Ar,"account_type","Admin")};return E.jsxs(E.Fragment,{children:[E.jsx(_s,{className:"w-3/4 h-screen top-0 fixed bg-[--black] transition-all duration-300 pointer-events-none z-50 "+(r?"opacity-100":"opacity-0")}),E.jsx("h2",{className:`text-xl font-bold mb-4 ${r?"hidden":""}`,children:"Accounts Settings"}),E.jsxs("div",{className:`grid grid-cols-4 items-start gap-6 w-full ${r?"hidden":""}`,children:[t.map(g=>g.id!==Ar&&E.jsxs("div",{className:"max-w-md p-4 mb-4 rounded-lg bg-neutral-900 flex flex-col gap-2",children:[E.jsxs("h3",{className:"text-lg font-bold",children:["Account ID: ",g.id]}),E.jsx("input",{type:"text",value:g.name,onChange:y=>c(g.id,"name",y.target.value),className:"p-2 rounded bg-neutral-800 text-white"}),E.jsxs("select",{value:g.account_type,onChange:y=>c(g.id,"account_type",y.target.value),className:"p-2 rounded bg-neutral-800 text-white",children:[E.jsx("option",{value:"Admin",children:"Admin"}),E.jsx("option",{value:"Adult",children:"Adult"}),E.jsx("option",{value:"Teen",children:"Teen"}),E.jsx("option",{value:"Kid",children:"Kid"})]}),E.jsx(Rn,{state:"primary",onClick:()=>d(g),children:"Save Account"}),E.jsx(Rn,{state:"danger",onClick:()=>f(g),children:"Delete Account"})]},g.id)),E.jsxs("div",{className:"max-w-md p-4 mb-4 rounded-lg bg-neutral-900 flex flex-col gap-2",children:[E.jsx("h3",{className:"text-lg font-bold",children:"Create New Account"}),E.jsx("input",{type:"text",placeholder:"Name",autoComplete:"new-password",value:(h=t.find(g=>g.id===Ar))==null?void 0:h.name,onChange:g=>c(Ar,"name",g.target.value),className:"p-2 rounded bg-neutral-800 text-white"}),E.jsxs("select",{value:(p=t.find(g=>g.id===Ar))==null?void 0:p.account_type,onChange:g=>c(Ar,"account_type",g.target.value),className:" p-2 rounded bg-neutral-800 text-white",children:[E.jsx("option",{value:"Admin",children:"Admin"}),E.jsx("option",{value:"Adult",children:"Adult"}),E.jsx("option",{value:"Teen",children:"Teen"}),E.jsx("option",{value:"Kid",children:"Kid"})]}),E.jsx("input",{type:"password",placeholder:"Password",autoComplete:"new-password",value:(v=t.find(g=>g.id===Ar))==null?void 0:v.password,onChange:g=>c(Ar,"password",g.target.value),className:"p-2 rounded bg-neutral-800 text-white"}),E.jsx(Rn,{state:"primary",onClick:m,children:"Create Account"})]})]})]})},_r=-162,W2=()=>{var v,g,y;const[t,e]=L.useState([]),[r,n]=L.useState(!0),{data:i,loading:s,fetchData:a}=ur("/api/settings/libraries"),{handleSubmit:o}=Ss(),{handleSubmit:l}=Ss(),{handleSubmit:u}=iE(),{handleSubmit:c}=sE();L.useEffect(()=>{i&&i.data&&e(i.data),n(s)},[i,s]),L.useEffect(()=>{t.find(S=>S.id===_r)||e(S=>[...S,{id:_r,name:"",path:"",type:"movies"}])},[i,t]);const d=(x,S,T)=>{e(C=>C.map(_=>_.id===x?{..._,[S]:T}:_))},f=async x=>{await o({url:"/api/settings/libraries",body:x}),a()},m=async x=>{await l({url:"/api/settings/libraries",body:{...x,scan:!0}})},h=async x=>{await u({url:"/api/settings/libraries",body:x}),a()},p=async()=>{const x=t.find(S=>S.id===_r);x&&await c({url:"/api/settings/libraries",body:{...x}}),a(),d(_r,"name",""),d(_r,"path",""),d(_r,"type","movies")};return E.jsxs(E.Fragment,{children:[E.jsx(_s,{className:"w-3/4 h-screen top-0 fixed bg-[--black] transition-all duration-300 pointer-events-none z-50 "+(r?"opacity-100":"opacity-0")}),E.jsx("h2",{className:`text-xl font-bold mb-4 ${r?"hidden":""}`,children:"Libraries Settings"}),E.jsxs("div",{className:`grid grid-cols-4 items-start gap-6 w-full ${r?"hidden":""}`,children:[t.map(x=>x.id!==_r&&E.jsxs("div",{className:"max-w-md p-4 mb-4 rounded-lg bg-neutral-900 flex flex-col gap-2",children:[E.jsxs("h3",{className:"text-lg font-bold",children:["Library ID: ",x.id]}),E.jsx("input",{type:"text",value:x.name,onChange:S=>d(x.id,"name",S.target.value),className:"p-2 rounded bg-neutral-800 text-white"}),E.jsx("input",{type:"text",value:x.path,onChange:S=>d(x.id,"path",S.target.value),className:"p-2 rounded bg-neutral-800 text-white"}),E.jsxs("select",{value:x.type,onChange:S=>d(x.id,"type",S.target.value),className:"p-2 rounded bg-neutral-800 text-white",children:[E.jsx("option",{value:"movies",children:"Movies"}),E.jsx("option",{value:"series",children:"Series"}),E.jsx("option",{value:"tv",children:"TV"}),E.jsx("option",{value:"books",children:"Books"}),E.jsx("option",{value:"music",children:"Music"}),E.jsx("option",{value:"other",children:"Other"})]}),E.jsx(Rn,{state:"primary",onClick:()=>f(x),children:"Save Library"}),E.jsx(Rn,{state:"secondary",className:"border border-zinc-700",onClick:()=>m(x),children:"Scan Library"}),E.jsx(Rn,{state:"danger",onClick:()=>h(x),children:"Delete Library"})]},x.id)),E.jsxs("div",{className:"max-w-md p-4 mb-4 rounded-lg bg-neutral-900 flex flex-col gap-2",children:[E.jsx("h3",{className:"text-lg font-bold",children:"Create New Library"}),E.jsx("input",{type:"text",placeholder:"Name",value:(v=t.find(x=>x.id===_r))==null?void 0:v.name,onChange:x=>d(_r,"name",x.target.value),className:"p-2 rounded bg-neutral-800 text-white"}),E.jsx("input",{type:"text",placeholder:"Path",value:(g=t.find(x=>x.id===_r))==null?void 0:g.path,onChange:x=>d(_r,"path",x.target.value),className:"p-2 rounded bg-neutral-800 text-white"}),E.jsxs("select",{value:(y=t.find(x=>x.id===_r))==null?void 0:y.type,onChange:x=>d(_r,"type",x.target.value),className:"p-2 rounded bg-neutral-800 text-white",children:[E.jsx("option",{value:"movies",children:"Movies"}),E.jsx("option",{value:"series",children:"Series"}),E.jsx("option",{value:"tv",children:"TV"}),E.jsx("option",{value:"books",children:"Books"}),E.jsx("option",{value:"music",children:"Music"}),E.jsx("option",{value:"other",children:"Other"})]}),E.jsx(Rn,{state:"primary",onClick:p,children:"Create Library"})]})]})]})},K2=()=>{const[t,e]=L.useState(window.location.hash||"#general"),{data:r}=ur("/api/auth/check"),n=Br();return L.useEffect(()=>{r&&(!r.data||r.data.account_type!=="Admin")&&n("/")},[r]),L.useEffect(()=>{const i=()=>{e(window.location.hash||"#general")};return window.addEventListener("hashchange",i),()=>{window.removeEventListener("hashchange",i)}},[]),E.jsxs("div",{className:"flex h-screen",children:[E.jsxs("div",{className:"w-1/6 border-r-2 border-zinc-800 text-white p-4",children:[E.jsx("h2",{className:"text-xl font-bold mb-4",children:"Settings"}),E.jsxs("ul",{children:[E.jsx("li",{className:"mb-2",children:E.jsx("a",{href:"#general",className:`hover:underline ${t==="#general"?"font-bold":""}`,children:"General"})}),E.jsx("li",{className:"mb-2",children:E.jsx("a",{href:"#accounts",className:`hover:underline ${t==="#accounts"?"font-bold":""}`,children:"Accounts"})}),E.jsx("li",{className:"mb-2",children:E.jsx("a",{href:"#libraries",className:`hover:underline ${t==="#libraries"?"font-bold":""}`,children:"Libraries"})})]})]}),E.jsxs("div",{className:"w-5/6 p-4 overflow-y-scroll",children:[t==="#general"&&E.jsx(z2,{}),t==="#accounts"&&E.jsx(H2,{}),t==="#libraries"&&E.jsx(W2,{})]})]})};function Y2(){const{data:t}=ur("/api/profil"),{handleSubmit:e}=Ss(),[r,n]=L.useState(null),[i,s]=L.useState(""),[a,o]=L.useState(""),[l,u]=L.useState(""),[c,d]=L.useState(null);L.useEffect(()=>{t&&(n(t.data.id),s(t.data.name),u(t.data.profile_picture))},[t]);const f=h=>{var v;const p=(v=h.target.files)==null?void 0:v[0];if(p){d(p);const g=new FileReader;g.onloadend=()=>{const y=new Image;y.src=g.result,y.onload=()=>{const x=document.createElement("canvas"),S=Math.min(y.width,y.height);x.width=S,x.height=S;const T=x.getContext("2d");T&&(T.drawImage(y,(y.width-S)/2,(y.height-S)/2,S,S,0,0,S,S),u(x.toDataURL("image/jpeg")))}},g.readAsDataURL(p)}},m=async h=>{h.preventDefault();const p={id:r,name:i,image:l,password:a};try{await e({url:"/api/profil",body:p}).then(()=>{Ke.success("Profil updated")})}catch{Ke.error("Error updating profil")}};return E.jsxs(Sm,{className:"w-full max-w-md mx-auto mt-8",children:[E.jsx(Em,{children:E.jsx(Tm,{className:"text-2xl font-bold text-center",children:"Profil"})}),E.jsx($E,{children:E.jsxs("form",{onSubmit:m,className:"space-y-4",children:[E.jsxs("div",{className:"space-y-2",children:[E.jsx(Ao,{htmlFor:"avatar",children:"Photo de profil"}),E.jsxs("div",{className:"flex items-center space-x-4",children:[E.jsx("img",{src:l,alt:"avatar",className:"w-12 h-12 rounded-full"}),E.jsx(fs,{id:"avatar",type:"file",accept:"image/*",onChange:f,className:"w-full"})]})]}),E.jsxs("div",{className:"space-y-2",children:[E.jsx(Ao,{htmlFor:"name",children:"Nom"}),E.jsx(fs,{id:"name",type:"text",value:i,onChange:h=>s(h.target.value),placeholder:"Votre nom"})]}),E.jsxs("div",{className:"space-y-2",children:[E.jsx(Ao,{htmlFor:"password",children:"Mot de passe"}),E.jsx(fs,{id:"password",type:"password",value:a,onChange:h=>o(h.target.value),placeholder:"Nouveau mot de passe"})]})]})}),E.jsx(jE,{children:E.jsx(xm,{onClick:m,className:"w-full",children:"Enregistrer"})})]})}const q2=()=>E.jsx("section",{className:"flex justify-center items-center w-screen h-screen fixed top-0",children:E.jsxs("div",{className:"text-center flex flex-col items-center gap-2",children:[E.jsx("h1",{className:"font-bold text-4xl",children:"404"}),E.jsx("h1",{className:"font-bold text-2xl",children:"Page Not Found"}),E.jsx("p",{children:"Sorry, the page you are looking for does not exist."}),E.jsx("p",{children:"If you were redirected here, the page is not implemented yet."}),E.jsx(Rn,{state:"primary",to:"/",className:"mt-4 w-fit",children:"Go Home"})]})}),X2=()=>{const{type:t}=VS();return t&&["movie","show","live-tv","other"].includes(t)?E.jsx(EF,{}):E.jsx(HS,{to:"/home"})},Z2=g_([{path:"/login",element:E.jsx(AC,{})},{path:"/logout",element:E.jsx(_C,{})},{path:"/invite",element:E.jsx(KI,{})},{path:"/",element:E.jsx(my,{}),children:[{path:"/",element:E.jsx(HS,{to:"/home"})},{path:"/home",element:E.jsx(MD,{})},{path:"/movies",element:E.jsx(ND,{})},{path:"/shows",element:E.jsx(FD,{})},{path:"/watch/:type/:id",element:E.jsx(X2,{})},{path:"/settings",element:E.jsx(K2,{})},{path:"/profil",element:E.jsx(Y2,{})}]},{path:"*",element:E.jsx(my,{}),children:[{path:"*",element:E.jsx(q2,{})}]}]);RS(document.getElementById("root")).render(E.jsxs(E.Fragment,{children:[E.jsx(OD,{children:E.jsx(b_,{router:Z2})}),E.jsx(G_,{theme:"colored",position:"bottom-right"})]}));
